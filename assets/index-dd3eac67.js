var g1=Object.defineProperty;var m1=(i,t,e)=>t in i?g1(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var he=(i,t,e)=>(m1(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var Yi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Xe={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,t){(function(){var e,n="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,d="__lodash_placeholder__",g=1,m=2,v=4,x=1,A=2,T=1,R=2,M=4,E=8,P=16,U=32,z=64,G=128,k=256,Z=512,rt=30,V="...",J=800,W=16,O=1,dt=2,_t=3,Y=1/0,vt=9007199254740991,Ut=17976931348623157e292,H=0/0,et=4294967295,yt=et-1,Ct=et>>>1,Rt=[["ary",G],["bind",T],["bindKey",R],["curry",E],["curryRight",P],["flip",Z],["partial",U],["partialRight",z],["rearg",k]],Ft="[object Arguments]",Lt="[object Array]",Jt="[object AsyncFunction]",$t="[object Boolean]",Qt="[object Date]",ee="[object DOMException]",Pt="[object Error]",Ot="[object Function]",Vt="[object GeneratorFunction]",Yt="[object Map]",fe="[object Number]",nn="[object Null]",hi="[object Object]",Sl="[object Promise]",Bp="[object Proxy]",ur="[object RegExp]",$e="[object Set]",cr="[object String]",Zr="[object Symbol]",Fp="[object Undefined]",fr="[object WeakMap]",Lp="[object WeakSet]",dr="[object ArrayBuffer]",In="[object DataView]",Oo="[object Float32Array]",No="[object Float64Array]",Uo="[object Int8Array]",ko="[object Int16Array]",Go="[object Int32Array]",Ho="[object Uint8Array]",Wo="[object Uint8ClampedArray]",Xo="[object Uint16Array]",zo="[object Uint32Array]",Op=/\b__p \+= '';/g,Np=/\b(__p \+=) '' \+/g,Up=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Cl=/&(?:amp|lt|gt|quot|#39);/g,Il=/[&<>"']/g,kp=RegExp(Cl.source),Gp=RegExp(Il.source),Hp=/<%-([\s\S]+?)%>/g,Wp=/<%([\s\S]+?)%>/g,Rl=/<%=([\s\S]+?)%>/g,Xp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zp=/^\w*$/,$p=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$o=/[\\^$.*+?()[\]{}|]/g,Vp=RegExp($o.source),Vo=/^\s+/,Yp=/\s/,jp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,qp=/\{\n\/\* \[wrapped with (.+)\] \*/,Kp=/,? & /,Zp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Jp=/[()=,{}\[\]\/\s]/,Qp=/\\(\\)?/g,tg=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pl=/\w*$/,eg=/^[-+]0x[0-9a-f]+$/i,ig=/^0b[01]+$/i,ng=/^\[object .+?Constructor\]$/,rg=/^0o[0-7]+$/i,sg=/^(?:0|[1-9]\d*)$/,og=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Jr=/($^)/,ag=/['\n\r\u2028\u2029\\]/g,Qr="\\ud800-\\udfff",hg="\\u0300-\\u036f",lg="\\ufe20-\\ufe2f",ug="\\u20d0-\\u20ff",Ml=hg+lg+ug,Dl="\\u2700-\\u27bf",Bl="a-z\\xdf-\\xf6\\xf8-\\xff",cg="\\xac\\xb1\\xd7\\xf7",fg="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",dg="\\u2000-\\u206f",pg=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fl="A-Z\\xc0-\\xd6\\xd8-\\xde",Ll="\\ufe0e\\ufe0f",Ol=cg+fg+dg+pg,Yo="['’]",gg="["+Qr+"]",Nl="["+Ol+"]",ts="["+Ml+"]",Ul="\\d+",mg="["+Dl+"]",kl="["+Bl+"]",Gl="[^"+Qr+Ol+Ul+Dl+Bl+Fl+"]",jo="\\ud83c[\\udffb-\\udfff]",_g="(?:"+ts+"|"+jo+")",Hl="[^"+Qr+"]",qo="(?:\\ud83c[\\udde6-\\uddff]){2}",Ko="[\\ud800-\\udbff][\\udc00-\\udfff]",Rn="["+Fl+"]",Wl="\\u200d",Xl="(?:"+kl+"|"+Gl+")",vg="(?:"+Rn+"|"+Gl+")",zl="(?:"+Yo+"(?:d|ll|m|re|s|t|ve))?",$l="(?:"+Yo+"(?:D|LL|M|RE|S|T|VE))?",Vl=_g+"?",Yl="["+Ll+"]?",xg="(?:"+Wl+"(?:"+[Hl,qo,Ko].join("|")+")"+Yl+Vl+")*",yg="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",jl=Yl+Vl+xg,wg="(?:"+[mg,qo,Ko].join("|")+")"+jl,Tg="(?:"+[Hl+ts+"?",ts,qo,Ko,gg].join("|")+")",Eg=RegExp(Yo,"g"),Ag=RegExp(ts,"g"),Zo=RegExp(jo+"(?="+jo+")|"+Tg+jl,"g"),Sg=RegExp([Rn+"?"+kl+"+"+zl+"(?="+[Nl,Rn,"$"].join("|")+")",vg+"+"+$l+"(?="+[Nl,Rn+Xl,"$"].join("|")+")",Rn+"?"+Xl+"+"+zl,Rn+"+"+$l,bg,yg,Ul,wg].join("|"),"g"),Cg=RegExp("["+Wl+Qr+Ml+Ll+"]"),Ig=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Rg=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Pg=-1,Nt={};Nt[Oo]=Nt[No]=Nt[Uo]=Nt[ko]=Nt[Go]=Nt[Ho]=Nt[Wo]=Nt[Xo]=Nt[zo]=!0,Nt[Ft]=Nt[Lt]=Nt[dr]=Nt[$t]=Nt[In]=Nt[Qt]=Nt[Pt]=Nt[Ot]=Nt[Yt]=Nt[fe]=Nt[hi]=Nt[ur]=Nt[$e]=Nt[cr]=Nt[fr]=!1;var Bt={};Bt[Ft]=Bt[Lt]=Bt[dr]=Bt[In]=Bt[$t]=Bt[Qt]=Bt[Oo]=Bt[No]=Bt[Uo]=Bt[ko]=Bt[Go]=Bt[Yt]=Bt[fe]=Bt[hi]=Bt[ur]=Bt[$e]=Bt[cr]=Bt[Zr]=Bt[Ho]=Bt[Wo]=Bt[Xo]=Bt[zo]=!0,Bt[Pt]=Bt[Ot]=Bt[fr]=!1;var Mg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Dg={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Bg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Fg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Lg=parseFloat,Og=parseInt,ql=typeof Yi=="object"&&Yi&&Yi.Object===Object&&Yi,Ng=typeof self=="object"&&self&&self.Object===Object&&self,oe=ql||Ng||Function("return this")(),Jo=t&&!t.nodeType&&t,rn=Jo&&!0&&i&&!i.nodeType&&i,Kl=rn&&rn.exports===Jo,Qo=Kl&&ql.process,Le=function(){try{var C=rn&&rn.require&&rn.require("util").types;return C||Qo&&Qo.binding&&Qo.binding("util")}catch{}}(),Zl=Le&&Le.isArrayBuffer,Jl=Le&&Le.isDate,Ql=Le&&Le.isMap,tu=Le&&Le.isRegExp,eu=Le&&Le.isSet,iu=Le&&Le.isTypedArray;function Ae(C,B,D){switch(D.length){case 0:return C.call(B);case 1:return C.call(B,D[0]);case 2:return C.call(B,D[0],D[1]);case 3:return C.call(B,D[0],D[1],D[2])}return C.apply(B,D)}function Ug(C,B,D,K){for(var ut=-1,St=C==null?0:C.length;++ut<St;){var ie=C[ut];B(K,ie,D(ie),C)}return K}function Oe(C,B){for(var D=-1,K=C==null?0:C.length;++D<K&&B(C[D],D,C)!==!1;);return C}function kg(C,B){for(var D=C==null?0:C.length;D--&&B(C[D],D,C)!==!1;);return C}function nu(C,B){for(var D=-1,K=C==null?0:C.length;++D<K;)if(!B(C[D],D,C))return!1;return!0}function Ni(C,B){for(var D=-1,K=C==null?0:C.length,ut=0,St=[];++D<K;){var ie=C[D];B(ie,D,C)&&(St[ut++]=ie)}return St}function es(C,B){var D=C==null?0:C.length;return!!D&&Pn(C,B,0)>-1}function ta(C,B,D){for(var K=-1,ut=C==null?0:C.length;++K<ut;)if(D(B,C[K]))return!0;return!1}function kt(C,B){for(var D=-1,K=C==null?0:C.length,ut=Array(K);++D<K;)ut[D]=B(C[D],D,C);return ut}function Ui(C,B){for(var D=-1,K=B.length,ut=C.length;++D<K;)C[ut+D]=B[D];return C}function ea(C,B,D,K){var ut=-1,St=C==null?0:C.length;for(K&&St&&(D=C[++ut]);++ut<St;)D=B(D,C[ut],ut,C);return D}function Gg(C,B,D,K){var ut=C==null?0:C.length;for(K&&ut&&(D=C[--ut]);ut--;)D=B(D,C[ut],ut,C);return D}function ia(C,B){for(var D=-1,K=C==null?0:C.length;++D<K;)if(B(C[D],D,C))return!0;return!1}var Hg=na("length");function Wg(C){return C.split("")}function Xg(C){return C.match(Zp)||[]}function ru(C,B,D){var K;return D(C,function(ut,St,ie){if(B(ut,St,ie))return K=St,!1}),K}function is(C,B,D,K){for(var ut=C.length,St=D+(K?1:-1);K?St--:++St<ut;)if(B(C[St],St,C))return St;return-1}function Pn(C,B,D){return B===B?em(C,B,D):is(C,su,D)}function zg(C,B,D,K){for(var ut=D-1,St=C.length;++ut<St;)if(K(C[ut],B))return ut;return-1}function su(C){return C!==C}function ou(C,B){var D=C==null?0:C.length;return D?sa(C,B)/D:H}function na(C){return function(B){return B==null?e:B[C]}}function ra(C){return function(B){return C==null?e:C[B]}}function au(C,B,D,K,ut){return ut(C,function(St,ie,Dt){D=K?(K=!1,St):B(D,St,ie,Dt)}),D}function $g(C,B){var D=C.length;for(C.sort(B);D--;)C[D]=C[D].value;return C}function sa(C,B){for(var D,K=-1,ut=C.length;++K<ut;){var St=B(C[K]);St!==e&&(D=D===e?St:D+St)}return D}function oa(C,B){for(var D=-1,K=Array(C);++D<C;)K[D]=B(D);return K}function Vg(C,B){return kt(B,function(D){return[D,C[D]]})}function hu(C){return C&&C.slice(0,fu(C)+1).replace(Vo,"")}function Se(C){return function(B){return C(B)}}function aa(C,B){return kt(B,function(D){return C[D]})}function pr(C,B){return C.has(B)}function lu(C,B){for(var D=-1,K=C.length;++D<K&&Pn(B,C[D],0)>-1;);return D}function uu(C,B){for(var D=C.length;D--&&Pn(B,C[D],0)>-1;);return D}function Yg(C,B){for(var D=C.length,K=0;D--;)C[D]===B&&++K;return K}var jg=ra(Mg),qg=ra(Dg);function Kg(C){return"\\"+Fg[C]}function Zg(C,B){return C==null?e:C[B]}function Mn(C){return Cg.test(C)}function Jg(C){return Ig.test(C)}function Qg(C){for(var B,D=[];!(B=C.next()).done;)D.push(B.value);return D}function ha(C){var B=-1,D=Array(C.size);return C.forEach(function(K,ut){D[++B]=[ut,K]}),D}function cu(C,B){return function(D){return C(B(D))}}function ki(C,B){for(var D=-1,K=C.length,ut=0,St=[];++D<K;){var ie=C[D];(ie===B||ie===d)&&(C[D]=d,St[ut++]=D)}return St}function ns(C){var B=-1,D=Array(C.size);return C.forEach(function(K){D[++B]=K}),D}function tm(C){var B=-1,D=Array(C.size);return C.forEach(function(K){D[++B]=[K,K]}),D}function em(C,B,D){for(var K=D-1,ut=C.length;++K<ut;)if(C[K]===B)return K;return-1}function im(C,B,D){for(var K=D+1;K--;)if(C[K]===B)return K;return K}function Dn(C){return Mn(C)?rm(C):Hg(C)}function Ve(C){return Mn(C)?sm(C):Wg(C)}function fu(C){for(var B=C.length;B--&&Yp.test(C.charAt(B)););return B}var nm=ra(Bg);function rm(C){for(var B=Zo.lastIndex=0;Zo.test(C);)++B;return B}function sm(C){return C.match(Zo)||[]}function om(C){return C.match(Sg)||[]}var am=function C(B){B=B==null?oe:Bn.defaults(oe.Object(),B,Bn.pick(oe,Rg));var D=B.Array,K=B.Date,ut=B.Error,St=B.Function,ie=B.Math,Dt=B.Object,la=B.RegExp,hm=B.String,Ne=B.TypeError,rs=D.prototype,lm=St.prototype,Fn=Dt.prototype,ss=B["__core-js_shared__"],os=lm.toString,Mt=Fn.hasOwnProperty,um=0,du=function(){var r=/[^.]+$/.exec(ss&&ss.keys&&ss.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),as=Fn.toString,cm=os.call(Dt),fm=oe._,dm=la("^"+os.call(Mt).replace($o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),hs=Kl?B.Buffer:e,Gi=B.Symbol,ls=B.Uint8Array,pu=hs?hs.allocUnsafe:e,us=cu(Dt.getPrototypeOf,Dt),gu=Dt.create,mu=Fn.propertyIsEnumerable,cs=rs.splice,_u=Gi?Gi.isConcatSpreadable:e,gr=Gi?Gi.iterator:e,sn=Gi?Gi.toStringTag:e,fs=function(){try{var r=un(Dt,"defineProperty");return r({},"",{}),r}catch{}}(),pm=B.clearTimeout!==oe.clearTimeout&&B.clearTimeout,gm=K&&K.now!==oe.Date.now&&K.now,mm=B.setTimeout!==oe.setTimeout&&B.setTimeout,ds=ie.ceil,ps=ie.floor,ua=Dt.getOwnPropertySymbols,_m=hs?hs.isBuffer:e,vu=B.isFinite,vm=rs.join,xm=cu(Dt.keys,Dt),ne=ie.max,de=ie.min,ym=K.now,bm=B.parseInt,xu=ie.random,wm=rs.reverse,ca=un(B,"DataView"),mr=un(B,"Map"),fa=un(B,"Promise"),Ln=un(B,"Set"),_r=un(B,"WeakMap"),vr=un(Dt,"create"),gs=_r&&new _r,On={},Tm=cn(ca),Em=cn(mr),Am=cn(fa),Sm=cn(Ln),Cm=cn(_r),ms=Gi?Gi.prototype:e,xr=ms?ms.valueOf:e,yu=ms?ms.toString:e;function y(r){if(jt(r)&&!ct(r)&&!(r instanceof bt)){if(r instanceof Ue)return r;if(Mt.call(r,"__wrapped__"))return bc(r)}return new Ue(r)}var Nn=function(){function r(){}return function(o){if(!Ht(o))return{};if(gu)return gu(o);r.prototype=o;var u=new r;return r.prototype=e,u}}();function _s(){}function Ue(r,o){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}y.templateSettings={escape:Hp,evaluate:Wp,interpolate:Rl,variable:"",imports:{_:y}},y.prototype=_s.prototype,y.prototype.constructor=y,Ue.prototype=Nn(_s.prototype),Ue.prototype.constructor=Ue;function bt(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=et,this.__views__=[]}function Im(){var r=new bt(this.__wrapped__);return r.__actions__=xe(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=xe(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=xe(this.__views__),r}function Rm(){if(this.__filtered__){var r=new bt(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function Pm(){var r=this.__wrapped__.value(),o=this.__dir__,u=ct(r),p=o<0,_=u?r.length:0,b=W_(0,_,this.__views__),w=b.start,S=b.end,I=S-w,F=p?S:w-1,L=this.__iteratees__,N=L.length,$=0,Q=de(I,this.__takeCount__);if(!u||!p&&_==I&&Q==I)return zu(r,this.__actions__);var at=[];t:for(;I--&&$<Q;){F+=o;for(var gt=-1,ht=r[F];++gt<N;){var xt=L[gt],Tt=xt.iteratee,Re=xt.type,_e=Tt(ht);if(Re==dt)ht=_e;else if(!_e){if(Re==O)continue t;break t}}at[$++]=ht}return at}bt.prototype=Nn(_s.prototype),bt.prototype.constructor=bt;function on(r){var o=-1,u=r==null?0:r.length;for(this.clear();++o<u;){var p=r[o];this.set(p[0],p[1])}}function Mm(){this.__data__=vr?vr(null):{},this.size=0}function Dm(r){var o=this.has(r)&&delete this.__data__[r];return this.size-=o?1:0,o}function Bm(r){var o=this.__data__;if(vr){var u=o[r];return u===c?e:u}return Mt.call(o,r)?o[r]:e}function Fm(r){var o=this.__data__;return vr?o[r]!==e:Mt.call(o,r)}function Lm(r,o){var u=this.__data__;return this.size+=this.has(r)?0:1,u[r]=vr&&o===e?c:o,this}on.prototype.clear=Mm,on.prototype.delete=Dm,on.prototype.get=Bm,on.prototype.has=Fm,on.prototype.set=Lm;function bi(r){var o=-1,u=r==null?0:r.length;for(this.clear();++o<u;){var p=r[o];this.set(p[0],p[1])}}function Om(){this.__data__=[],this.size=0}function Nm(r){var o=this.__data__,u=vs(o,r);if(u<0)return!1;var p=o.length-1;return u==p?o.pop():cs.call(o,u,1),--this.size,!0}function Um(r){var o=this.__data__,u=vs(o,r);return u<0?e:o[u][1]}function km(r){return vs(this.__data__,r)>-1}function Gm(r,o){var u=this.__data__,p=vs(u,r);return p<0?(++this.size,u.push([r,o])):u[p][1]=o,this}bi.prototype.clear=Om,bi.prototype.delete=Nm,bi.prototype.get=Um,bi.prototype.has=km,bi.prototype.set=Gm;function wi(r){var o=-1,u=r==null?0:r.length;for(this.clear();++o<u;){var p=r[o];this.set(p[0],p[1])}}function Hm(){this.size=0,this.__data__={hash:new on,map:new(mr||bi),string:new on}}function Wm(r){var o=Ps(this,r).delete(r);return this.size-=o?1:0,o}function Xm(r){return Ps(this,r).get(r)}function zm(r){return Ps(this,r).has(r)}function $m(r,o){var u=Ps(this,r),p=u.size;return u.set(r,o),this.size+=u.size==p?0:1,this}wi.prototype.clear=Hm,wi.prototype.delete=Wm,wi.prototype.get=Xm,wi.prototype.has=zm,wi.prototype.set=$m;function an(r){var o=-1,u=r==null?0:r.length;for(this.__data__=new wi;++o<u;)this.add(r[o])}function Vm(r){return this.__data__.set(r,c),this}function Ym(r){return this.__data__.has(r)}an.prototype.add=an.prototype.push=Vm,an.prototype.has=Ym;function Ye(r){var o=this.__data__=new bi(r);this.size=o.size}function jm(){this.__data__=new bi,this.size=0}function qm(r){var o=this.__data__,u=o.delete(r);return this.size=o.size,u}function Km(r){return this.__data__.get(r)}function Zm(r){return this.__data__.has(r)}function Jm(r,o){var u=this.__data__;if(u instanceof bi){var p=u.__data__;if(!mr||p.length<s-1)return p.push([r,o]),this.size=++u.size,this;u=this.__data__=new wi(p)}return u.set(r,o),this.size=u.size,this}Ye.prototype.clear=jm,Ye.prototype.delete=qm,Ye.prototype.get=Km,Ye.prototype.has=Zm,Ye.prototype.set=Jm;function bu(r,o){var u=ct(r),p=!u&&fn(r),_=!u&&!p&&$i(r),b=!u&&!p&&!_&&Hn(r),w=u||p||_||b,S=w?oa(r.length,hm):[],I=S.length;for(var F in r)(o||Mt.call(r,F))&&!(w&&(F=="length"||_&&(F=="offset"||F=="parent")||b&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||Si(F,I)))&&S.push(F);return S}function wu(r){var o=r.length;return o?r[Ta(0,o-1)]:e}function Qm(r,o){return Ms(xe(r),hn(o,0,r.length))}function t_(r){return Ms(xe(r))}function da(r,o,u){(u!==e&&!je(r[o],u)||u===e&&!(o in r))&&Ti(r,o,u)}function yr(r,o,u){var p=r[o];(!(Mt.call(r,o)&&je(p,u))||u===e&&!(o in r))&&Ti(r,o,u)}function vs(r,o){for(var u=r.length;u--;)if(je(r[u][0],o))return u;return-1}function e_(r,o,u,p){return Hi(r,function(_,b,w){o(p,_,u(_),w)}),p}function Tu(r,o){return r&&ui(o,se(o),r)}function i_(r,o){return r&&ui(o,be(o),r)}function Ti(r,o,u){o=="__proto__"&&fs?fs(r,o,{configurable:!0,enumerable:!0,value:u,writable:!0}):r[o]=u}function pa(r,o){for(var u=-1,p=o.length,_=D(p),b=r==null;++u<p;)_[u]=b?e:ja(r,o[u]);return _}function hn(r,o,u){return r===r&&(u!==e&&(r=r<=u?r:u),o!==e&&(r=r>=o?r:o)),r}function ke(r,o,u,p,_,b){var w,S=o&g,I=o&m,F=o&v;if(u&&(w=_?u(r,p,_,b):u(r)),w!==e)return w;if(!Ht(r))return r;var L=ct(r);if(L){if(w=z_(r),!S)return xe(r,w)}else{var N=pe(r),$=N==Ot||N==Vt;if($i(r))return Yu(r,S);if(N==hi||N==Ft||$&&!_){if(w=I||$?{}:fc(r),!S)return I?B_(r,i_(w,r)):D_(r,Tu(w,r))}else{if(!Bt[N])return _?r:{};w=$_(r,N,S)}}b||(b=new Ye);var Q=b.get(r);if(Q)return Q;b.set(r,w),Hc(r)?r.forEach(function(ht){w.add(ke(ht,o,u,ht,r,b))}):kc(r)&&r.forEach(function(ht,xt){w.set(xt,ke(ht,o,u,xt,r,b))});var at=F?I?Fa:Ba:I?be:se,gt=L?e:at(r);return Oe(gt||r,function(ht,xt){gt&&(xt=ht,ht=r[xt]),yr(w,xt,ke(ht,o,u,xt,r,b))}),w}function n_(r){var o=se(r);return function(u){return Eu(u,r,o)}}function Eu(r,o,u){var p=u.length;if(r==null)return!p;for(r=Dt(r);p--;){var _=u[p],b=o[_],w=r[_];if(w===e&&!(_ in r)||!b(w))return!1}return!0}function Au(r,o,u){if(typeof r!="function")throw new Ne(h);return Cr(function(){r.apply(e,u)},o)}function br(r,o,u,p){var _=-1,b=es,w=!0,S=r.length,I=[],F=o.length;if(!S)return I;u&&(o=kt(o,Se(u))),p?(b=ta,w=!1):o.length>=s&&(b=pr,w=!1,o=new an(o));t:for(;++_<S;){var L=r[_],N=u==null?L:u(L);if(L=p||L!==0?L:0,w&&N===N){for(var $=F;$--;)if(o[$]===N)continue t;I.push(L)}else b(o,N,p)||I.push(L)}return I}var Hi=Ju(li),Su=Ju(ma,!0);function r_(r,o){var u=!0;return Hi(r,function(p,_,b){return u=!!o(p,_,b),u}),u}function xs(r,o,u){for(var p=-1,_=r.length;++p<_;){var b=r[p],w=o(b);if(w!=null&&(S===e?w===w&&!Ie(w):u(w,S)))var S=w,I=b}return I}function s_(r,o,u,p){var _=r.length;for(u=pt(u),u<0&&(u=-u>_?0:_+u),p=p===e||p>_?_:pt(p),p<0&&(p+=_),p=u>p?0:Xc(p);u<p;)r[u++]=o;return r}function Cu(r,o){var u=[];return Hi(r,function(p,_,b){o(p,_,b)&&u.push(p)}),u}function ae(r,o,u,p,_){var b=-1,w=r.length;for(u||(u=Y_),_||(_=[]);++b<w;){var S=r[b];o>0&&u(S)?o>1?ae(S,o-1,u,p,_):Ui(_,S):p||(_[_.length]=S)}return _}var ga=Qu(),Iu=Qu(!0);function li(r,o){return r&&ga(r,o,se)}function ma(r,o){return r&&Iu(r,o,se)}function ys(r,o){return Ni(o,function(u){return Ci(r[u])})}function ln(r,o){o=Xi(o,r);for(var u=0,p=o.length;r!=null&&u<p;)r=r[ci(o[u++])];return u&&u==p?r:e}function Ru(r,o,u){var p=o(r);return ct(r)?p:Ui(p,u(r))}function ge(r){return r==null?r===e?Fp:nn:sn&&sn in Dt(r)?H_(r):t0(r)}function _a(r,o){return r>o}function o_(r,o){return r!=null&&Mt.call(r,o)}function a_(r,o){return r!=null&&o in Dt(r)}function h_(r,o,u){return r>=de(o,u)&&r<ne(o,u)}function va(r,o,u){for(var p=u?ta:es,_=r[0].length,b=r.length,w=b,S=D(b),I=1/0,F=[];w--;){var L=r[w];w&&o&&(L=kt(L,Se(o))),I=de(L.length,I),S[w]=!u&&(o||_>=120&&L.length>=120)?new an(w&&L):e}L=r[0];var N=-1,$=S[0];t:for(;++N<_&&F.length<I;){var Q=L[N],at=o?o(Q):Q;if(Q=u||Q!==0?Q:0,!($?pr($,at):p(F,at,u))){for(w=b;--w;){var gt=S[w];if(!(gt?pr(gt,at):p(r[w],at,u)))continue t}$&&$.push(at),F.push(Q)}}return F}function l_(r,o,u,p){return li(r,function(_,b,w){o(p,u(_),b,w)}),p}function wr(r,o,u){o=Xi(o,r),r=mc(r,o);var p=r==null?r:r[ci(He(o))];return p==null?e:Ae(p,r,u)}function Pu(r){return jt(r)&&ge(r)==Ft}function u_(r){return jt(r)&&ge(r)==dr}function c_(r){return jt(r)&&ge(r)==Qt}function Tr(r,o,u,p,_){return r===o?!0:r==null||o==null||!jt(r)&&!jt(o)?r!==r&&o!==o:f_(r,o,u,p,Tr,_)}function f_(r,o,u,p,_,b){var w=ct(r),S=ct(o),I=w?Lt:pe(r),F=S?Lt:pe(o);I=I==Ft?hi:I,F=F==Ft?hi:F;var L=I==hi,N=F==hi,$=I==F;if($&&$i(r)){if(!$i(o))return!1;w=!0,L=!1}if($&&!L)return b||(b=new Ye),w||Hn(r)?lc(r,o,u,p,_,b):k_(r,o,I,u,p,_,b);if(!(u&x)){var Q=L&&Mt.call(r,"__wrapped__"),at=N&&Mt.call(o,"__wrapped__");if(Q||at){var gt=Q?r.value():r,ht=at?o.value():o;return b||(b=new Ye),_(gt,ht,u,p,b)}}return $?(b||(b=new Ye),G_(r,o,u,p,_,b)):!1}function d_(r){return jt(r)&&pe(r)==Yt}function xa(r,o,u,p){var _=u.length,b=_,w=!p;if(r==null)return!b;for(r=Dt(r);_--;){var S=u[_];if(w&&S[2]?S[1]!==r[S[0]]:!(S[0]in r))return!1}for(;++_<b;){S=u[_];var I=S[0],F=r[I],L=S[1];if(w&&S[2]){if(F===e&&!(I in r))return!1}else{var N=new Ye;if(p)var $=p(F,L,I,r,o,N);if(!($===e?Tr(L,F,x|A,p,N):$))return!1}}return!0}function Mu(r){if(!Ht(r)||q_(r))return!1;var o=Ci(r)?dm:ng;return o.test(cn(r))}function p_(r){return jt(r)&&ge(r)==ur}function g_(r){return jt(r)&&pe(r)==$e}function m_(r){return jt(r)&&Ns(r.length)&&!!Nt[ge(r)]}function Du(r){return typeof r=="function"?r:r==null?we:typeof r=="object"?ct(r)?Lu(r[0],r[1]):Fu(r):tf(r)}function ya(r){if(!Sr(r))return xm(r);var o=[];for(var u in Dt(r))Mt.call(r,u)&&u!="constructor"&&o.push(u);return o}function __(r){if(!Ht(r))return Q_(r);var o=Sr(r),u=[];for(var p in r)p=="constructor"&&(o||!Mt.call(r,p))||u.push(p);return u}function ba(r,o){return r<o}function Bu(r,o){var u=-1,p=ye(r)?D(r.length):[];return Hi(r,function(_,b,w){p[++u]=o(_,b,w)}),p}function Fu(r){var o=Oa(r);return o.length==1&&o[0][2]?pc(o[0][0],o[0][1]):function(u){return u===r||xa(u,r,o)}}function Lu(r,o){return Ua(r)&&dc(o)?pc(ci(r),o):function(u){var p=ja(u,r);return p===e&&p===o?qa(u,r):Tr(o,p,x|A)}}function bs(r,o,u,p,_){r!==o&&ga(o,function(b,w){if(_||(_=new Ye),Ht(b))v_(r,o,w,u,bs,p,_);else{var S=p?p(Ga(r,w),b,w+"",r,o,_):e;S===e&&(S=b),da(r,w,S)}},be)}function v_(r,o,u,p,_,b,w){var S=Ga(r,u),I=Ga(o,u),F=w.get(I);if(F){da(r,u,F);return}var L=b?b(S,I,u+"",r,o,w):e,N=L===e;if(N){var $=ct(I),Q=!$&&$i(I),at=!$&&!Q&&Hn(I);L=I,$||Q||at?ct(S)?L=S:qt(S)?L=xe(S):Q?(N=!1,L=Yu(I,!0)):at?(N=!1,L=ju(I,!0)):L=[]:Ir(I)||fn(I)?(L=S,fn(S)?L=zc(S):(!Ht(S)||Ci(S))&&(L=fc(I))):N=!1}N&&(w.set(I,L),_(L,I,p,b,w),w.delete(I)),da(r,u,L)}function Ou(r,o){var u=r.length;if(u)return o+=o<0?u:0,Si(o,u)?r[o]:e}function Nu(r,o,u){o.length?o=kt(o,function(b){return ct(b)?function(w){return ln(w,b.length===1?b[0]:b)}:b}):o=[we];var p=-1;o=kt(o,Se(ot()));var _=Bu(r,function(b,w,S){var I=kt(o,function(F){return F(b)});return{criteria:I,index:++p,value:b}});return $g(_,function(b,w){return M_(b,w,u)})}function x_(r,o){return Uu(r,o,function(u,p){return qa(r,p)})}function Uu(r,o,u){for(var p=-1,_=o.length,b={};++p<_;){var w=o[p],S=ln(r,w);u(S,w)&&Er(b,Xi(w,r),S)}return b}function y_(r){return function(o){return ln(o,r)}}function wa(r,o,u,p){var _=p?zg:Pn,b=-1,w=o.length,S=r;for(r===o&&(o=xe(o)),u&&(S=kt(r,Se(u)));++b<w;)for(var I=0,F=o[b],L=u?u(F):F;(I=_(S,L,I,p))>-1;)S!==r&&cs.call(S,I,1),cs.call(r,I,1);return r}function ku(r,o){for(var u=r?o.length:0,p=u-1;u--;){var _=o[u];if(u==p||_!==b){var b=_;Si(_)?cs.call(r,_,1):Sa(r,_)}}return r}function Ta(r,o){return r+ps(xu()*(o-r+1))}function b_(r,o,u,p){for(var _=-1,b=ne(ds((o-r)/(u||1)),0),w=D(b);b--;)w[p?b:++_]=r,r+=u;return w}function Ea(r,o){var u="";if(!r||o<1||o>vt)return u;do o%2&&(u+=r),o=ps(o/2),o&&(r+=r);while(o);return u}function mt(r,o){return Ha(gc(r,o,we),r+"")}function w_(r){return wu(Wn(r))}function T_(r,o){var u=Wn(r);return Ms(u,hn(o,0,u.length))}function Er(r,o,u,p){if(!Ht(r))return r;o=Xi(o,r);for(var _=-1,b=o.length,w=b-1,S=r;S!=null&&++_<b;){var I=ci(o[_]),F=u;if(I==="__proto__"||I==="constructor"||I==="prototype")return r;if(_!=w){var L=S[I];F=p?p(L,I,S):e,F===e&&(F=Ht(L)?L:Si(o[_+1])?[]:{})}yr(S,I,F),S=S[I]}return r}var Gu=gs?function(r,o){return gs.set(r,o),r}:we,E_=fs?function(r,o){return fs(r,"toString",{configurable:!0,enumerable:!1,value:Za(o),writable:!0})}:we;function A_(r){return Ms(Wn(r))}function Ge(r,o,u){var p=-1,_=r.length;o<0&&(o=-o>_?0:_+o),u=u>_?_:u,u<0&&(u+=_),_=o>u?0:u-o>>>0,o>>>=0;for(var b=D(_);++p<_;)b[p]=r[p+o];return b}function S_(r,o){var u;return Hi(r,function(p,_,b){return u=o(p,_,b),!u}),!!u}function ws(r,o,u){var p=0,_=r==null?p:r.length;if(typeof o=="number"&&o===o&&_<=Ct){for(;p<_;){var b=p+_>>>1,w=r[b];w!==null&&!Ie(w)&&(u?w<=o:w<o)?p=b+1:_=b}return _}return Aa(r,o,we,u)}function Aa(r,o,u,p){var _=0,b=r==null?0:r.length;if(b===0)return 0;o=u(o);for(var w=o!==o,S=o===null,I=Ie(o),F=o===e;_<b;){var L=ps((_+b)/2),N=u(r[L]),$=N!==e,Q=N===null,at=N===N,gt=Ie(N);if(w)var ht=p||at;else F?ht=at&&(p||$):S?ht=at&&$&&(p||!Q):I?ht=at&&$&&!Q&&(p||!gt):Q||gt?ht=!1:ht=p?N<=o:N<o;ht?_=L+1:b=L}return de(b,yt)}function Hu(r,o){for(var u=-1,p=r.length,_=0,b=[];++u<p;){var w=r[u],S=o?o(w):w;if(!u||!je(S,I)){var I=S;b[_++]=w===0?0:w}}return b}function Wu(r){return typeof r=="number"?r:Ie(r)?H:+r}function Ce(r){if(typeof r=="string")return r;if(ct(r))return kt(r,Ce)+"";if(Ie(r))return yu?yu.call(r):"";var o=r+"";return o=="0"&&1/r==-Y?"-0":o}function Wi(r,o,u){var p=-1,_=es,b=r.length,w=!0,S=[],I=S;if(u)w=!1,_=ta;else if(b>=s){var F=o?null:N_(r);if(F)return ns(F);w=!1,_=pr,I=new an}else I=o?[]:S;t:for(;++p<b;){var L=r[p],N=o?o(L):L;if(L=u||L!==0?L:0,w&&N===N){for(var $=I.length;$--;)if(I[$]===N)continue t;o&&I.push(N),S.push(L)}else _(I,N,u)||(I!==S&&I.push(N),S.push(L))}return S}function Sa(r,o){return o=Xi(o,r),r=mc(r,o),r==null||delete r[ci(He(o))]}function Xu(r,o,u,p){return Er(r,o,u(ln(r,o)),p)}function Ts(r,o,u,p){for(var _=r.length,b=p?_:-1;(p?b--:++b<_)&&o(r[b],b,r););return u?Ge(r,p?0:b,p?b+1:_):Ge(r,p?b+1:0,p?_:b)}function zu(r,o){var u=r;return u instanceof bt&&(u=u.value()),ea(o,function(p,_){return _.func.apply(_.thisArg,Ui([p],_.args))},u)}function Ca(r,o,u){var p=r.length;if(p<2)return p?Wi(r[0]):[];for(var _=-1,b=D(p);++_<p;)for(var w=r[_],S=-1;++S<p;)S!=_&&(b[_]=br(b[_]||w,r[S],o,u));return Wi(ae(b,1),o,u)}function $u(r,o,u){for(var p=-1,_=r.length,b=o.length,w={};++p<_;){var S=p<b?o[p]:e;u(w,r[p],S)}return w}function Ia(r){return qt(r)?r:[]}function Ra(r){return typeof r=="function"?r:we}function Xi(r,o){return ct(r)?r:Ua(r,o)?[r]:yc(It(r))}var C_=mt;function zi(r,o,u){var p=r.length;return u=u===e?p:u,!o&&u>=p?r:Ge(r,o,u)}var Vu=pm||function(r){return oe.clearTimeout(r)};function Yu(r,o){if(o)return r.slice();var u=r.length,p=pu?pu(u):new r.constructor(u);return r.copy(p),p}function Pa(r){var o=new r.constructor(r.byteLength);return new ls(o).set(new ls(r)),o}function I_(r,o){var u=o?Pa(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.byteLength)}function R_(r){var o=new r.constructor(r.source,Pl.exec(r));return o.lastIndex=r.lastIndex,o}function P_(r){return xr?Dt(xr.call(r)):{}}function ju(r,o){var u=o?Pa(r.buffer):r.buffer;return new r.constructor(u,r.byteOffset,r.length)}function qu(r,o){if(r!==o){var u=r!==e,p=r===null,_=r===r,b=Ie(r),w=o!==e,S=o===null,I=o===o,F=Ie(o);if(!S&&!F&&!b&&r>o||b&&w&&I&&!S&&!F||p&&w&&I||!u&&I||!_)return 1;if(!p&&!b&&!F&&r<o||F&&u&&_&&!p&&!b||S&&u&&_||!w&&_||!I)return-1}return 0}function M_(r,o,u){for(var p=-1,_=r.criteria,b=o.criteria,w=_.length,S=u.length;++p<w;){var I=qu(_[p],b[p]);if(I){if(p>=S)return I;var F=u[p];return I*(F=="desc"?-1:1)}}return r.index-o.index}function Ku(r,o,u,p){for(var _=-1,b=r.length,w=u.length,S=-1,I=o.length,F=ne(b-w,0),L=D(I+F),N=!p;++S<I;)L[S]=o[S];for(;++_<w;)(N||_<b)&&(L[u[_]]=r[_]);for(;F--;)L[S++]=r[_++];return L}function Zu(r,o,u,p){for(var _=-1,b=r.length,w=-1,S=u.length,I=-1,F=o.length,L=ne(b-S,0),N=D(L+F),$=!p;++_<L;)N[_]=r[_];for(var Q=_;++I<F;)N[Q+I]=o[I];for(;++w<S;)($||_<b)&&(N[Q+u[w]]=r[_++]);return N}function xe(r,o){var u=-1,p=r.length;for(o||(o=D(p));++u<p;)o[u]=r[u];return o}function ui(r,o,u,p){var _=!u;u||(u={});for(var b=-1,w=o.length;++b<w;){var S=o[b],I=p?p(u[S],r[S],S,u,r):e;I===e&&(I=r[S]),_?Ti(u,S,I):yr(u,S,I)}return u}function D_(r,o){return ui(r,Na(r),o)}function B_(r,o){return ui(r,uc(r),o)}function Es(r,o){return function(u,p){var _=ct(u)?Ug:e_,b=o?o():{};return _(u,r,ot(p,2),b)}}function Un(r){return mt(function(o,u){var p=-1,_=u.length,b=_>1?u[_-1]:e,w=_>2?u[2]:e;for(b=r.length>3&&typeof b=="function"?(_--,b):e,w&&me(u[0],u[1],w)&&(b=_<3?e:b,_=1),o=Dt(o);++p<_;){var S=u[p];S&&r(o,S,p,b)}return o})}function Ju(r,o){return function(u,p){if(u==null)return u;if(!ye(u))return r(u,p);for(var _=u.length,b=o?_:-1,w=Dt(u);(o?b--:++b<_)&&p(w[b],b,w)!==!1;);return u}}function Qu(r){return function(o,u,p){for(var _=-1,b=Dt(o),w=p(o),S=w.length;S--;){var I=w[r?S:++_];if(u(b[I],I,b)===!1)break}return o}}function F_(r,o,u){var p=o&T,_=Ar(r);function b(){var w=this&&this!==oe&&this instanceof b?_:r;return w.apply(p?u:this,arguments)}return b}function tc(r){return function(o){o=It(o);var u=Mn(o)?Ve(o):e,p=u?u[0]:o.charAt(0),_=u?zi(u,1).join(""):o.slice(1);return p[r]()+_}}function kn(r){return function(o){return ea(Jc(Zc(o).replace(Eg,"")),r,"")}}function Ar(r){return function(){var o=arguments;switch(o.length){case 0:return new r;case 1:return new r(o[0]);case 2:return new r(o[0],o[1]);case 3:return new r(o[0],o[1],o[2]);case 4:return new r(o[0],o[1],o[2],o[3]);case 5:return new r(o[0],o[1],o[2],o[3],o[4]);case 6:return new r(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new r(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var u=Nn(r.prototype),p=r.apply(u,o);return Ht(p)?p:u}}function L_(r,o,u){var p=Ar(r);function _(){for(var b=arguments.length,w=D(b),S=b,I=Gn(_);S--;)w[S]=arguments[S];var F=b<3&&w[0]!==I&&w[b-1]!==I?[]:ki(w,I);if(b-=F.length,b<u)return sc(r,o,As,_.placeholder,e,w,F,e,e,u-b);var L=this&&this!==oe&&this instanceof _?p:r;return Ae(L,this,w)}return _}function ec(r){return function(o,u,p){var _=Dt(o);if(!ye(o)){var b=ot(u,3);o=se(o),u=function(S){return b(_[S],S,_)}}var w=r(o,u,p);return w>-1?_[b?o[w]:w]:e}}function ic(r){return Ai(function(o){var u=o.length,p=u,_=Ue.prototype.thru;for(r&&o.reverse();p--;){var b=o[p];if(typeof b!="function")throw new Ne(h);if(_&&!w&&Rs(b)=="wrapper")var w=new Ue([],!0)}for(p=w?p:u;++p<u;){b=o[p];var S=Rs(b),I=S=="wrapper"?La(b):e;I&&ka(I[0])&&I[1]==(G|E|U|k)&&!I[4].length&&I[9]==1?w=w[Rs(I[0])].apply(w,I[3]):w=b.length==1&&ka(b)?w[S]():w.thru(b)}return function(){var F=arguments,L=F[0];if(w&&F.length==1&&ct(L))return w.plant(L).value();for(var N=0,$=u?o[N].apply(this,F):L;++N<u;)$=o[N].call(this,$);return $}})}function As(r,o,u,p,_,b,w,S,I,F){var L=o&G,N=o&T,$=o&R,Q=o&(E|P),at=o&Z,gt=$?e:Ar(r);function ht(){for(var xt=arguments.length,Tt=D(xt),Re=xt;Re--;)Tt[Re]=arguments[Re];if(Q)var _e=Gn(ht),Pe=Yg(Tt,_e);if(p&&(Tt=Ku(Tt,p,_,Q)),b&&(Tt=Zu(Tt,b,w,Q)),xt-=Pe,Q&&xt<F){var Kt=ki(Tt,_e);return sc(r,o,As,ht.placeholder,u,Tt,Kt,S,I,F-xt)}var qe=N?u:this,Ri=$?qe[r]:r;return xt=Tt.length,S?Tt=e0(Tt,S):at&&xt>1&&Tt.reverse(),L&&I<xt&&(Tt.length=I),this&&this!==oe&&this instanceof ht&&(Ri=gt||Ar(Ri)),Ri.apply(qe,Tt)}return ht}function nc(r,o){return function(u,p){return l_(u,r,o(p),{})}}function Ss(r,o){return function(u,p){var _;if(u===e&&p===e)return o;if(u!==e&&(_=u),p!==e){if(_===e)return p;typeof u=="string"||typeof p=="string"?(u=Ce(u),p=Ce(p)):(u=Wu(u),p=Wu(p)),_=r(u,p)}return _}}function Ma(r){return Ai(function(o){return o=kt(o,Se(ot())),mt(function(u){var p=this;return r(o,function(_){return Ae(_,p,u)})})})}function Cs(r,o){o=o===e?" ":Ce(o);var u=o.length;if(u<2)return u?Ea(o,r):o;var p=Ea(o,ds(r/Dn(o)));return Mn(o)?zi(Ve(p),0,r).join(""):p.slice(0,r)}function O_(r,o,u,p){var _=o&T,b=Ar(r);function w(){for(var S=-1,I=arguments.length,F=-1,L=p.length,N=D(L+I),$=this&&this!==oe&&this instanceof w?b:r;++F<L;)N[F]=p[F];for(;I--;)N[F++]=arguments[++S];return Ae($,_?u:this,N)}return w}function rc(r){return function(o,u,p){return p&&typeof p!="number"&&me(o,u,p)&&(u=p=e),o=Ii(o),u===e?(u=o,o=0):u=Ii(u),p=p===e?o<u?1:-1:Ii(p),b_(o,u,p,r)}}function Is(r){return function(o,u){return typeof o=="string"&&typeof u=="string"||(o=We(o),u=We(u)),r(o,u)}}function sc(r,o,u,p,_,b,w,S,I,F){var L=o&E,N=L?w:e,$=L?e:w,Q=L?b:e,at=L?e:b;o|=L?U:z,o&=~(L?z:U),o&M||(o&=~(T|R));var gt=[r,o,_,Q,N,at,$,S,I,F],ht=u.apply(e,gt);return ka(r)&&_c(ht,gt),ht.placeholder=p,vc(ht,r,o)}function Da(r){var o=ie[r];return function(u,p){if(u=We(u),p=p==null?0:de(pt(p),292),p&&vu(u)){var _=(It(u)+"e").split("e"),b=o(_[0]+"e"+(+_[1]+p));return _=(It(b)+"e").split("e"),+(_[0]+"e"+(+_[1]-p))}return o(u)}}var N_=Ln&&1/ns(new Ln([,-0]))[1]==Y?function(r){return new Ln(r)}:th;function oc(r){return function(o){var u=pe(o);return u==Yt?ha(o):u==$e?tm(o):Vg(o,r(o))}}function Ei(r,o,u,p,_,b,w,S){var I=o&R;if(!I&&typeof r!="function")throw new Ne(h);var F=p?p.length:0;if(F||(o&=~(U|z),p=_=e),w=w===e?w:ne(pt(w),0),S=S===e?S:pt(S),F-=_?_.length:0,o&z){var L=p,N=_;p=_=e}var $=I?e:La(r),Q=[r,o,u,p,_,L,N,b,w,S];if($&&J_(Q,$),r=Q[0],o=Q[1],u=Q[2],p=Q[3],_=Q[4],S=Q[9]=Q[9]===e?I?0:r.length:ne(Q[9]-F,0),!S&&o&(E|P)&&(o&=~(E|P)),!o||o==T)var at=F_(r,o,u);else o==E||o==P?at=L_(r,o,S):(o==U||o==(T|U))&&!_.length?at=O_(r,o,u,p):at=As.apply(e,Q);var gt=$?Gu:_c;return vc(gt(at,Q),r,o)}function ac(r,o,u,p){return r===e||je(r,Fn[u])&&!Mt.call(p,u)?o:r}function hc(r,o,u,p,_,b){return Ht(r)&&Ht(o)&&(b.set(o,r),bs(r,o,e,hc,b),b.delete(o)),r}function U_(r){return Ir(r)?e:r}function lc(r,o,u,p,_,b){var w=u&x,S=r.length,I=o.length;if(S!=I&&!(w&&I>S))return!1;var F=b.get(r),L=b.get(o);if(F&&L)return F==o&&L==r;var N=-1,$=!0,Q=u&A?new an:e;for(b.set(r,o),b.set(o,r);++N<S;){var at=r[N],gt=o[N];if(p)var ht=w?p(gt,at,N,o,r,b):p(at,gt,N,r,o,b);if(ht!==e){if(ht)continue;$=!1;break}if(Q){if(!ia(o,function(xt,Tt){if(!pr(Q,Tt)&&(at===xt||_(at,xt,u,p,b)))return Q.push(Tt)})){$=!1;break}}else if(!(at===gt||_(at,gt,u,p,b))){$=!1;break}}return b.delete(r),b.delete(o),$}function k_(r,o,u,p,_,b,w){switch(u){case In:if(r.byteLength!=o.byteLength||r.byteOffset!=o.byteOffset)return!1;r=r.buffer,o=o.buffer;case dr:return!(r.byteLength!=o.byteLength||!b(new ls(r),new ls(o)));case $t:case Qt:case fe:return je(+r,+o);case Pt:return r.name==o.name&&r.message==o.message;case ur:case cr:return r==o+"";case Yt:var S=ha;case $e:var I=p&x;if(S||(S=ns),r.size!=o.size&&!I)return!1;var F=w.get(r);if(F)return F==o;p|=A,w.set(r,o);var L=lc(S(r),S(o),p,_,b,w);return w.delete(r),L;case Zr:if(xr)return xr.call(r)==xr.call(o)}return!1}function G_(r,o,u,p,_,b){var w=u&x,S=Ba(r),I=S.length,F=Ba(o),L=F.length;if(I!=L&&!w)return!1;for(var N=I;N--;){var $=S[N];if(!(w?$ in o:Mt.call(o,$)))return!1}var Q=b.get(r),at=b.get(o);if(Q&&at)return Q==o&&at==r;var gt=!0;b.set(r,o),b.set(o,r);for(var ht=w;++N<I;){$=S[N];var xt=r[$],Tt=o[$];if(p)var Re=w?p(Tt,xt,$,o,r,b):p(xt,Tt,$,r,o,b);if(!(Re===e?xt===Tt||_(xt,Tt,u,p,b):Re)){gt=!1;break}ht||(ht=$=="constructor")}if(gt&&!ht){var _e=r.constructor,Pe=o.constructor;_e!=Pe&&"constructor"in r&&"constructor"in o&&!(typeof _e=="function"&&_e instanceof _e&&typeof Pe=="function"&&Pe instanceof Pe)&&(gt=!1)}return b.delete(r),b.delete(o),gt}function Ai(r){return Ha(gc(r,e,Ec),r+"")}function Ba(r){return Ru(r,se,Na)}function Fa(r){return Ru(r,be,uc)}var La=gs?function(r){return gs.get(r)}:th;function Rs(r){for(var o=r.name+"",u=On[o],p=Mt.call(On,o)?u.length:0;p--;){var _=u[p],b=_.func;if(b==null||b==r)return _.name}return o}function Gn(r){var o=Mt.call(y,"placeholder")?y:r;return o.placeholder}function ot(){var r=y.iteratee||Ja;return r=r===Ja?Du:r,arguments.length?r(arguments[0],arguments[1]):r}function Ps(r,o){var u=r.__data__;return j_(o)?u[typeof o=="string"?"string":"hash"]:u.map}function Oa(r){for(var o=se(r),u=o.length;u--;){var p=o[u],_=r[p];o[u]=[p,_,dc(_)]}return o}function un(r,o){var u=Zg(r,o);return Mu(u)?u:e}function H_(r){var o=Mt.call(r,sn),u=r[sn];try{r[sn]=e;var p=!0}catch{}var _=as.call(r);return p&&(o?r[sn]=u:delete r[sn]),_}var Na=ua?function(r){return r==null?[]:(r=Dt(r),Ni(ua(r),function(o){return mu.call(r,o)}))}:eh,uc=ua?function(r){for(var o=[];r;)Ui(o,Na(r)),r=us(r);return o}:eh,pe=ge;(ca&&pe(new ca(new ArrayBuffer(1)))!=In||mr&&pe(new mr)!=Yt||fa&&pe(fa.resolve())!=Sl||Ln&&pe(new Ln)!=$e||_r&&pe(new _r)!=fr)&&(pe=function(r){var o=ge(r),u=o==hi?r.constructor:e,p=u?cn(u):"";if(p)switch(p){case Tm:return In;case Em:return Yt;case Am:return Sl;case Sm:return $e;case Cm:return fr}return o});function W_(r,o,u){for(var p=-1,_=u.length;++p<_;){var b=u[p],w=b.size;switch(b.type){case"drop":r+=w;break;case"dropRight":o-=w;break;case"take":o=de(o,r+w);break;case"takeRight":r=ne(r,o-w);break}}return{start:r,end:o}}function X_(r){var o=r.match(qp);return o?o[1].split(Kp):[]}function cc(r,o,u){o=Xi(o,r);for(var p=-1,_=o.length,b=!1;++p<_;){var w=ci(o[p]);if(!(b=r!=null&&u(r,w)))break;r=r[w]}return b||++p!=_?b:(_=r==null?0:r.length,!!_&&Ns(_)&&Si(w,_)&&(ct(r)||fn(r)))}function z_(r){var o=r.length,u=new r.constructor(o);return o&&typeof r[0]=="string"&&Mt.call(r,"index")&&(u.index=r.index,u.input=r.input),u}function fc(r){return typeof r.constructor=="function"&&!Sr(r)?Nn(us(r)):{}}function $_(r,o,u){var p=r.constructor;switch(o){case dr:return Pa(r);case $t:case Qt:return new p(+r);case In:return I_(r,u);case Oo:case No:case Uo:case ko:case Go:case Ho:case Wo:case Xo:case zo:return ju(r,u);case Yt:return new p;case fe:case cr:return new p(r);case ur:return R_(r);case $e:return new p;case Zr:return P_(r)}}function V_(r,o){var u=o.length;if(!u)return r;var p=u-1;return o[p]=(u>1?"& ":"")+o[p],o=o.join(u>2?", ":" "),r.replace(jp,`{
/* [wrapped with `+o+`] */
`)}function Y_(r){return ct(r)||fn(r)||!!(_u&&r&&r[_u])}function Si(r,o){var u=typeof r;return o=o??vt,!!o&&(u=="number"||u!="symbol"&&sg.test(r))&&r>-1&&r%1==0&&r<o}function me(r,o,u){if(!Ht(u))return!1;var p=typeof o;return(p=="number"?ye(u)&&Si(o,u.length):p=="string"&&o in u)?je(u[o],r):!1}function Ua(r,o){if(ct(r))return!1;var u=typeof r;return u=="number"||u=="symbol"||u=="boolean"||r==null||Ie(r)?!0:zp.test(r)||!Xp.test(r)||o!=null&&r in Dt(o)}function j_(r){var o=typeof r;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?r!=="__proto__":r===null}function ka(r){var o=Rs(r),u=y[o];if(typeof u!="function"||!(o in bt.prototype))return!1;if(r===u)return!0;var p=La(u);return!!p&&r===p[0]}function q_(r){return!!du&&du in r}var K_=ss?Ci:ih;function Sr(r){var o=r&&r.constructor,u=typeof o=="function"&&o.prototype||Fn;return r===u}function dc(r){return r===r&&!Ht(r)}function pc(r,o){return function(u){return u==null?!1:u[r]===o&&(o!==e||r in Dt(u))}}function Z_(r){var o=Ls(r,function(p){return u.size===f&&u.clear(),p}),u=o.cache;return o}function J_(r,o){var u=r[1],p=o[1],_=u|p,b=_<(T|R|G),w=p==G&&u==E||p==G&&u==k&&r[7].length<=o[8]||p==(G|k)&&o[7].length<=o[8]&&u==E;if(!(b||w))return r;p&T&&(r[2]=o[2],_|=u&T?0:M);var S=o[3];if(S){var I=r[3];r[3]=I?Ku(I,S,o[4]):S,r[4]=I?ki(r[3],d):o[4]}return S=o[5],S&&(I=r[5],r[5]=I?Zu(I,S,o[6]):S,r[6]=I?ki(r[5],d):o[6]),S=o[7],S&&(r[7]=S),p&G&&(r[8]=r[8]==null?o[8]:de(r[8],o[8])),r[9]==null&&(r[9]=o[9]),r[0]=o[0],r[1]=_,r}function Q_(r){var o=[];if(r!=null)for(var u in Dt(r))o.push(u);return o}function t0(r){return as.call(r)}function gc(r,o,u){return o=ne(o===e?r.length-1:o,0),function(){for(var p=arguments,_=-1,b=ne(p.length-o,0),w=D(b);++_<b;)w[_]=p[o+_];_=-1;for(var S=D(o+1);++_<o;)S[_]=p[_];return S[o]=u(w),Ae(r,this,S)}}function mc(r,o){return o.length<2?r:ln(r,Ge(o,0,-1))}function e0(r,o){for(var u=r.length,p=de(o.length,u),_=xe(r);p--;){var b=o[p];r[p]=Si(b,u)?_[b]:e}return r}function Ga(r,o){if(!(o==="constructor"&&typeof r[o]=="function")&&o!="__proto__")return r[o]}var _c=xc(Gu),Cr=mm||function(r,o){return oe.setTimeout(r,o)},Ha=xc(E_);function vc(r,o,u){var p=o+"";return Ha(r,V_(p,i0(X_(p),u)))}function xc(r){var o=0,u=0;return function(){var p=ym(),_=W-(p-u);if(u=p,_>0){if(++o>=J)return arguments[0]}else o=0;return r.apply(e,arguments)}}function Ms(r,o){var u=-1,p=r.length,_=p-1;for(o=o===e?p:o;++u<o;){var b=Ta(u,_),w=r[b];r[b]=r[u],r[u]=w}return r.length=o,r}var yc=Z_(function(r){var o=[];return r.charCodeAt(0)===46&&o.push(""),r.replace($p,function(u,p,_,b){o.push(_?b.replace(Qp,"$1"):p||u)}),o});function ci(r){if(typeof r=="string"||Ie(r))return r;var o=r+"";return o=="0"&&1/r==-Y?"-0":o}function cn(r){if(r!=null){try{return os.call(r)}catch{}try{return r+""}catch{}}return""}function i0(r,o){return Oe(Rt,function(u){var p="_."+u[0];o&u[1]&&!es(r,p)&&r.push(p)}),r.sort()}function bc(r){if(r instanceof bt)return r.clone();var o=new Ue(r.__wrapped__,r.__chain__);return o.__actions__=xe(r.__actions__),o.__index__=r.__index__,o.__values__=r.__values__,o}function n0(r,o,u){(u?me(r,o,u):o===e)?o=1:o=ne(pt(o),0);var p=r==null?0:r.length;if(!p||o<1)return[];for(var _=0,b=0,w=D(ds(p/o));_<p;)w[b++]=Ge(r,_,_+=o);return w}function r0(r){for(var o=-1,u=r==null?0:r.length,p=0,_=[];++o<u;){var b=r[o];b&&(_[p++]=b)}return _}function s0(){var r=arguments.length;if(!r)return[];for(var o=D(r-1),u=arguments[0],p=r;p--;)o[p-1]=arguments[p];return Ui(ct(u)?xe(u):[u],ae(o,1))}var o0=mt(function(r,o){return qt(r)?br(r,ae(o,1,qt,!0)):[]}),a0=mt(function(r,o){var u=He(o);return qt(u)&&(u=e),qt(r)?br(r,ae(o,1,qt,!0),ot(u,2)):[]}),h0=mt(function(r,o){var u=He(o);return qt(u)&&(u=e),qt(r)?br(r,ae(o,1,qt,!0),e,u):[]});function l0(r,o,u){var p=r==null?0:r.length;return p?(o=u||o===e?1:pt(o),Ge(r,o<0?0:o,p)):[]}function u0(r,o,u){var p=r==null?0:r.length;return p?(o=u||o===e?1:pt(o),o=p-o,Ge(r,0,o<0?0:o)):[]}function c0(r,o){return r&&r.length?Ts(r,ot(o,3),!0,!0):[]}function f0(r,o){return r&&r.length?Ts(r,ot(o,3),!0):[]}function d0(r,o,u,p){var _=r==null?0:r.length;return _?(u&&typeof u!="number"&&me(r,o,u)&&(u=0,p=_),s_(r,o,u,p)):[]}function wc(r,o,u){var p=r==null?0:r.length;if(!p)return-1;var _=u==null?0:pt(u);return _<0&&(_=ne(p+_,0)),is(r,ot(o,3),_)}function Tc(r,o,u){var p=r==null?0:r.length;if(!p)return-1;var _=p-1;return u!==e&&(_=pt(u),_=u<0?ne(p+_,0):de(_,p-1)),is(r,ot(o,3),_,!0)}function Ec(r){var o=r==null?0:r.length;return o?ae(r,1):[]}function p0(r){var o=r==null?0:r.length;return o?ae(r,Y):[]}function g0(r,o){var u=r==null?0:r.length;return u?(o=o===e?1:pt(o),ae(r,o)):[]}function m0(r){for(var o=-1,u=r==null?0:r.length,p={};++o<u;){var _=r[o];p[_[0]]=_[1]}return p}function Ac(r){return r&&r.length?r[0]:e}function _0(r,o,u){var p=r==null?0:r.length;if(!p)return-1;var _=u==null?0:pt(u);return _<0&&(_=ne(p+_,0)),Pn(r,o,_)}function v0(r){var o=r==null?0:r.length;return o?Ge(r,0,-1):[]}var x0=mt(function(r){var o=kt(r,Ia);return o.length&&o[0]===r[0]?va(o):[]}),y0=mt(function(r){var o=He(r),u=kt(r,Ia);return o===He(u)?o=e:u.pop(),u.length&&u[0]===r[0]?va(u,ot(o,2)):[]}),b0=mt(function(r){var o=He(r),u=kt(r,Ia);return o=typeof o=="function"?o:e,o&&u.pop(),u.length&&u[0]===r[0]?va(u,e,o):[]});function w0(r,o){return r==null?"":vm.call(r,o)}function He(r){var o=r==null?0:r.length;return o?r[o-1]:e}function T0(r,o,u){var p=r==null?0:r.length;if(!p)return-1;var _=p;return u!==e&&(_=pt(u),_=_<0?ne(p+_,0):de(_,p-1)),o===o?im(r,o,_):is(r,su,_,!0)}function E0(r,o){return r&&r.length?Ou(r,pt(o)):e}var A0=mt(Sc);function Sc(r,o){return r&&r.length&&o&&o.length?wa(r,o):r}function S0(r,o,u){return r&&r.length&&o&&o.length?wa(r,o,ot(u,2)):r}function C0(r,o,u){return r&&r.length&&o&&o.length?wa(r,o,e,u):r}var I0=Ai(function(r,o){var u=r==null?0:r.length,p=pa(r,o);return ku(r,kt(o,function(_){return Si(_,u)?+_:_}).sort(qu)),p});function R0(r,o){var u=[];if(!(r&&r.length))return u;var p=-1,_=[],b=r.length;for(o=ot(o,3);++p<b;){var w=r[p];o(w,p,r)&&(u.push(w),_.push(p))}return ku(r,_),u}function Wa(r){return r==null?r:wm.call(r)}function P0(r,o,u){var p=r==null?0:r.length;return p?(u&&typeof u!="number"&&me(r,o,u)?(o=0,u=p):(o=o==null?0:pt(o),u=u===e?p:pt(u)),Ge(r,o,u)):[]}function M0(r,o){return ws(r,o)}function D0(r,o,u){return Aa(r,o,ot(u,2))}function B0(r,o){var u=r==null?0:r.length;if(u){var p=ws(r,o);if(p<u&&je(r[p],o))return p}return-1}function F0(r,o){return ws(r,o,!0)}function L0(r,o,u){return Aa(r,o,ot(u,2),!0)}function O0(r,o){var u=r==null?0:r.length;if(u){var p=ws(r,o,!0)-1;if(je(r[p],o))return p}return-1}function N0(r){return r&&r.length?Hu(r):[]}function U0(r,o){return r&&r.length?Hu(r,ot(o,2)):[]}function k0(r){var o=r==null?0:r.length;return o?Ge(r,1,o):[]}function G0(r,o,u){return r&&r.length?(o=u||o===e?1:pt(o),Ge(r,0,o<0?0:o)):[]}function H0(r,o,u){var p=r==null?0:r.length;return p?(o=u||o===e?1:pt(o),o=p-o,Ge(r,o<0?0:o,p)):[]}function W0(r,o){return r&&r.length?Ts(r,ot(o,3),!1,!0):[]}function X0(r,o){return r&&r.length?Ts(r,ot(o,3)):[]}var z0=mt(function(r){return Wi(ae(r,1,qt,!0))}),$0=mt(function(r){var o=He(r);return qt(o)&&(o=e),Wi(ae(r,1,qt,!0),ot(o,2))}),V0=mt(function(r){var o=He(r);return o=typeof o=="function"?o:e,Wi(ae(r,1,qt,!0),e,o)});function Y0(r){return r&&r.length?Wi(r):[]}function j0(r,o){return r&&r.length?Wi(r,ot(o,2)):[]}function q0(r,o){return o=typeof o=="function"?o:e,r&&r.length?Wi(r,e,o):[]}function Xa(r){if(!(r&&r.length))return[];var o=0;return r=Ni(r,function(u){if(qt(u))return o=ne(u.length,o),!0}),oa(o,function(u){return kt(r,na(u))})}function Cc(r,o){if(!(r&&r.length))return[];var u=Xa(r);return o==null?u:kt(u,function(p){return Ae(o,e,p)})}var K0=mt(function(r,o){return qt(r)?br(r,o):[]}),Z0=mt(function(r){return Ca(Ni(r,qt))}),J0=mt(function(r){var o=He(r);return qt(o)&&(o=e),Ca(Ni(r,qt),ot(o,2))}),Q0=mt(function(r){var o=He(r);return o=typeof o=="function"?o:e,Ca(Ni(r,qt),e,o)}),tv=mt(Xa);function ev(r,o){return $u(r||[],o||[],yr)}function iv(r,o){return $u(r||[],o||[],Er)}var nv=mt(function(r){var o=r.length,u=o>1?r[o-1]:e;return u=typeof u=="function"?(r.pop(),u):e,Cc(r,u)});function Ic(r){var o=y(r);return o.__chain__=!0,o}function rv(r,o){return o(r),r}function Ds(r,o){return o(r)}var sv=Ai(function(r){var o=r.length,u=o?r[0]:0,p=this.__wrapped__,_=function(b){return pa(b,r)};return o>1||this.__actions__.length||!(p instanceof bt)||!Si(u)?this.thru(_):(p=p.slice(u,+u+(o?1:0)),p.__actions__.push({func:Ds,args:[_],thisArg:e}),new Ue(p,this.__chain__).thru(function(b){return o&&!b.length&&b.push(e),b}))});function ov(){return Ic(this)}function av(){return new Ue(this.value(),this.__chain__)}function hv(){this.__values__===e&&(this.__values__=Wc(this.value()));var r=this.__index__>=this.__values__.length,o=r?e:this.__values__[this.__index__++];return{done:r,value:o}}function lv(){return this}function uv(r){for(var o,u=this;u instanceof _s;){var p=bc(u);p.__index__=0,p.__values__=e,o?_.__wrapped__=p:o=p;var _=p;u=u.__wrapped__}return _.__wrapped__=r,o}function cv(){var r=this.__wrapped__;if(r instanceof bt){var o=r;return this.__actions__.length&&(o=new bt(this)),o=o.reverse(),o.__actions__.push({func:Ds,args:[Wa],thisArg:e}),new Ue(o,this.__chain__)}return this.thru(Wa)}function fv(){return zu(this.__wrapped__,this.__actions__)}var dv=Es(function(r,o,u){Mt.call(r,u)?++r[u]:Ti(r,u,1)});function pv(r,o,u){var p=ct(r)?nu:r_;return u&&me(r,o,u)&&(o=e),p(r,ot(o,3))}function gv(r,o){var u=ct(r)?Ni:Cu;return u(r,ot(o,3))}var mv=ec(wc),_v=ec(Tc);function vv(r,o){return ae(Bs(r,o),1)}function xv(r,o){return ae(Bs(r,o),Y)}function yv(r,o,u){return u=u===e?1:pt(u),ae(Bs(r,o),u)}function Rc(r,o){var u=ct(r)?Oe:Hi;return u(r,ot(o,3))}function Pc(r,o){var u=ct(r)?kg:Su;return u(r,ot(o,3))}var bv=Es(function(r,o,u){Mt.call(r,u)?r[u].push(o):Ti(r,u,[o])});function wv(r,o,u,p){r=ye(r)?r:Wn(r),u=u&&!p?pt(u):0;var _=r.length;return u<0&&(u=ne(_+u,0)),Us(r)?u<=_&&r.indexOf(o,u)>-1:!!_&&Pn(r,o,u)>-1}var Tv=mt(function(r,o,u){var p=-1,_=typeof o=="function",b=ye(r)?D(r.length):[];return Hi(r,function(w){b[++p]=_?Ae(o,w,u):wr(w,o,u)}),b}),Ev=Es(function(r,o,u){Ti(r,u,o)});function Bs(r,o){var u=ct(r)?kt:Bu;return u(r,ot(o,3))}function Av(r,o,u,p){return r==null?[]:(ct(o)||(o=o==null?[]:[o]),u=p?e:u,ct(u)||(u=u==null?[]:[u]),Nu(r,o,u))}var Sv=Es(function(r,o,u){r[u?0:1].push(o)},function(){return[[],[]]});function Cv(r,o,u){var p=ct(r)?ea:au,_=arguments.length<3;return p(r,ot(o,4),u,_,Hi)}function Iv(r,o,u){var p=ct(r)?Gg:au,_=arguments.length<3;return p(r,ot(o,4),u,_,Su)}function Rv(r,o){var u=ct(r)?Ni:Cu;return u(r,Os(ot(o,3)))}function Pv(r){var o=ct(r)?wu:w_;return o(r)}function Mv(r,o,u){(u?me(r,o,u):o===e)?o=1:o=pt(o);var p=ct(r)?Qm:T_;return p(r,o)}function Dv(r){var o=ct(r)?t_:A_;return o(r)}function Bv(r){if(r==null)return 0;if(ye(r))return Us(r)?Dn(r):r.length;var o=pe(r);return o==Yt||o==$e?r.size:ya(r).length}function Fv(r,o,u){var p=ct(r)?ia:S_;return u&&me(r,o,u)&&(o=e),p(r,ot(o,3))}var Lv=mt(function(r,o){if(r==null)return[];var u=o.length;return u>1&&me(r,o[0],o[1])?o=[]:u>2&&me(o[0],o[1],o[2])&&(o=[o[0]]),Nu(r,ae(o,1),[])}),Fs=gm||function(){return oe.Date.now()};function Ov(r,o){if(typeof o!="function")throw new Ne(h);return r=pt(r),function(){if(--r<1)return o.apply(this,arguments)}}function Mc(r,o,u){return o=u?e:o,o=r&&o==null?r.length:o,Ei(r,G,e,e,e,e,o)}function Dc(r,o){var u;if(typeof o!="function")throw new Ne(h);return r=pt(r),function(){return--r>0&&(u=o.apply(this,arguments)),r<=1&&(o=e),u}}var za=mt(function(r,o,u){var p=T;if(u.length){var _=ki(u,Gn(za));p|=U}return Ei(r,p,o,u,_)}),Bc=mt(function(r,o,u){var p=T|R;if(u.length){var _=ki(u,Gn(Bc));p|=U}return Ei(o,p,r,u,_)});function Fc(r,o,u){o=u?e:o;var p=Ei(r,E,e,e,e,e,e,o);return p.placeholder=Fc.placeholder,p}function Lc(r,o,u){o=u?e:o;var p=Ei(r,P,e,e,e,e,e,o);return p.placeholder=Lc.placeholder,p}function Oc(r,o,u){var p,_,b,w,S,I,F=0,L=!1,N=!1,$=!0;if(typeof r!="function")throw new Ne(h);o=We(o)||0,Ht(u)&&(L=!!u.leading,N="maxWait"in u,b=N?ne(We(u.maxWait)||0,o):b,$="trailing"in u?!!u.trailing:$);function Q(Kt){var qe=p,Ri=_;return p=_=e,F=Kt,w=r.apply(Ri,qe),w}function at(Kt){return F=Kt,S=Cr(xt,o),L?Q(Kt):w}function gt(Kt){var qe=Kt-I,Ri=Kt-F,ef=o-qe;return N?de(ef,b-Ri):ef}function ht(Kt){var qe=Kt-I,Ri=Kt-F;return I===e||qe>=o||qe<0||N&&Ri>=b}function xt(){var Kt=Fs();if(ht(Kt))return Tt(Kt);S=Cr(xt,gt(Kt))}function Tt(Kt){return S=e,$&&p?Q(Kt):(p=_=e,w)}function Re(){S!==e&&Vu(S),F=0,p=I=_=S=e}function _e(){return S===e?w:Tt(Fs())}function Pe(){var Kt=Fs(),qe=ht(Kt);if(p=arguments,_=this,I=Kt,qe){if(S===e)return at(I);if(N)return Vu(S),S=Cr(xt,o),Q(I)}return S===e&&(S=Cr(xt,o)),w}return Pe.cancel=Re,Pe.flush=_e,Pe}var Nv=mt(function(r,o){return Au(r,1,o)}),Uv=mt(function(r,o,u){return Au(r,We(o)||0,u)});function kv(r){return Ei(r,Z)}function Ls(r,o){if(typeof r!="function"||o!=null&&typeof o!="function")throw new Ne(h);var u=function(){var p=arguments,_=o?o.apply(this,p):p[0],b=u.cache;if(b.has(_))return b.get(_);var w=r.apply(this,p);return u.cache=b.set(_,w)||b,w};return u.cache=new(Ls.Cache||wi),u}Ls.Cache=wi;function Os(r){if(typeof r!="function")throw new Ne(h);return function(){var o=arguments;switch(o.length){case 0:return!r.call(this);case 1:return!r.call(this,o[0]);case 2:return!r.call(this,o[0],o[1]);case 3:return!r.call(this,o[0],o[1],o[2])}return!r.apply(this,o)}}function Gv(r){return Dc(2,r)}var Hv=C_(function(r,o){o=o.length==1&&ct(o[0])?kt(o[0],Se(ot())):kt(ae(o,1),Se(ot()));var u=o.length;return mt(function(p){for(var _=-1,b=de(p.length,u);++_<b;)p[_]=o[_].call(this,p[_]);return Ae(r,this,p)})}),$a=mt(function(r,o){var u=ki(o,Gn($a));return Ei(r,U,e,o,u)}),Nc=mt(function(r,o){var u=ki(o,Gn(Nc));return Ei(r,z,e,o,u)}),Wv=Ai(function(r,o){return Ei(r,k,e,e,e,o)});function Xv(r,o){if(typeof r!="function")throw new Ne(h);return o=o===e?o:pt(o),mt(r,o)}function zv(r,o){if(typeof r!="function")throw new Ne(h);return o=o==null?0:ne(pt(o),0),mt(function(u){var p=u[o],_=zi(u,0,o);return p&&Ui(_,p),Ae(r,this,_)})}function $v(r,o,u){var p=!0,_=!0;if(typeof r!="function")throw new Ne(h);return Ht(u)&&(p="leading"in u?!!u.leading:p,_="trailing"in u?!!u.trailing:_),Oc(r,o,{leading:p,maxWait:o,trailing:_})}function Vv(r){return Mc(r,1)}function Yv(r,o){return $a(Ra(o),r)}function jv(){if(!arguments.length)return[];var r=arguments[0];return ct(r)?r:[r]}function qv(r){return ke(r,v)}function Kv(r,o){return o=typeof o=="function"?o:e,ke(r,v,o)}function Zv(r){return ke(r,g|v)}function Jv(r,o){return o=typeof o=="function"?o:e,ke(r,g|v,o)}function Qv(r,o){return o==null||Eu(r,o,se(o))}function je(r,o){return r===o||r!==r&&o!==o}var tx=Is(_a),ex=Is(function(r,o){return r>=o}),fn=Pu(function(){return arguments}())?Pu:function(r){return jt(r)&&Mt.call(r,"callee")&&!mu.call(r,"callee")},ct=D.isArray,ix=Zl?Se(Zl):u_;function ye(r){return r!=null&&Ns(r.length)&&!Ci(r)}function qt(r){return jt(r)&&ye(r)}function nx(r){return r===!0||r===!1||jt(r)&&ge(r)==$t}var $i=_m||ih,rx=Jl?Se(Jl):c_;function sx(r){return jt(r)&&r.nodeType===1&&!Ir(r)}function ox(r){if(r==null)return!0;if(ye(r)&&(ct(r)||typeof r=="string"||typeof r.splice=="function"||$i(r)||Hn(r)||fn(r)))return!r.length;var o=pe(r);if(o==Yt||o==$e)return!r.size;if(Sr(r))return!ya(r).length;for(var u in r)if(Mt.call(r,u))return!1;return!0}function ax(r,o){return Tr(r,o)}function hx(r,o,u){u=typeof u=="function"?u:e;var p=u?u(r,o):e;return p===e?Tr(r,o,e,u):!!p}function Va(r){if(!jt(r))return!1;var o=ge(r);return o==Pt||o==ee||typeof r.message=="string"&&typeof r.name=="string"&&!Ir(r)}function lx(r){return typeof r=="number"&&vu(r)}function Ci(r){if(!Ht(r))return!1;var o=ge(r);return o==Ot||o==Vt||o==Jt||o==Bp}function Uc(r){return typeof r=="number"&&r==pt(r)}function Ns(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=vt}function Ht(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}function jt(r){return r!=null&&typeof r=="object"}var kc=Ql?Se(Ql):d_;function ux(r,o){return r===o||xa(r,o,Oa(o))}function cx(r,o,u){return u=typeof u=="function"?u:e,xa(r,o,Oa(o),u)}function fx(r){return Gc(r)&&r!=+r}function dx(r){if(K_(r))throw new ut(a);return Mu(r)}function px(r){return r===null}function gx(r){return r==null}function Gc(r){return typeof r=="number"||jt(r)&&ge(r)==fe}function Ir(r){if(!jt(r)||ge(r)!=hi)return!1;var o=us(r);if(o===null)return!0;var u=Mt.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&os.call(u)==cm}var Ya=tu?Se(tu):p_;function mx(r){return Uc(r)&&r>=-vt&&r<=vt}var Hc=eu?Se(eu):g_;function Us(r){return typeof r=="string"||!ct(r)&&jt(r)&&ge(r)==cr}function Ie(r){return typeof r=="symbol"||jt(r)&&ge(r)==Zr}var Hn=iu?Se(iu):m_;function _x(r){return r===e}function vx(r){return jt(r)&&pe(r)==fr}function xx(r){return jt(r)&&ge(r)==Lp}var yx=Is(ba),bx=Is(function(r,o){return r<=o});function Wc(r){if(!r)return[];if(ye(r))return Us(r)?Ve(r):xe(r);if(gr&&r[gr])return Qg(r[gr]());var o=pe(r),u=o==Yt?ha:o==$e?ns:Wn;return u(r)}function Ii(r){if(!r)return r===0?r:0;if(r=We(r),r===Y||r===-Y){var o=r<0?-1:1;return o*Ut}return r===r?r:0}function pt(r){var o=Ii(r),u=o%1;return o===o?u?o-u:o:0}function Xc(r){return r?hn(pt(r),0,et):0}function We(r){if(typeof r=="number")return r;if(Ie(r))return H;if(Ht(r)){var o=typeof r.valueOf=="function"?r.valueOf():r;r=Ht(o)?o+"":o}if(typeof r!="string")return r===0?r:+r;r=hu(r);var u=ig.test(r);return u||rg.test(r)?Og(r.slice(2),u?2:8):eg.test(r)?H:+r}function zc(r){return ui(r,be(r))}function wx(r){return r?hn(pt(r),-vt,vt):r===0?r:0}function It(r){return r==null?"":Ce(r)}var Tx=Un(function(r,o){if(Sr(o)||ye(o)){ui(o,se(o),r);return}for(var u in o)Mt.call(o,u)&&yr(r,u,o[u])}),$c=Un(function(r,o){ui(o,be(o),r)}),ks=Un(function(r,o,u,p){ui(o,be(o),r,p)}),Ex=Un(function(r,o,u,p){ui(o,se(o),r,p)}),Ax=Ai(pa);function Sx(r,o){var u=Nn(r);return o==null?u:Tu(u,o)}var Cx=mt(function(r,o){r=Dt(r);var u=-1,p=o.length,_=p>2?o[2]:e;for(_&&me(o[0],o[1],_)&&(p=1);++u<p;)for(var b=o[u],w=be(b),S=-1,I=w.length;++S<I;){var F=w[S],L=r[F];(L===e||je(L,Fn[F])&&!Mt.call(r,F))&&(r[F]=b[F])}return r}),Ix=mt(function(r){return r.push(e,hc),Ae(Vc,e,r)});function Rx(r,o){return ru(r,ot(o,3),li)}function Px(r,o){return ru(r,ot(o,3),ma)}function Mx(r,o){return r==null?r:ga(r,ot(o,3),be)}function Dx(r,o){return r==null?r:Iu(r,ot(o,3),be)}function Bx(r,o){return r&&li(r,ot(o,3))}function Fx(r,o){return r&&ma(r,ot(o,3))}function Lx(r){return r==null?[]:ys(r,se(r))}function Ox(r){return r==null?[]:ys(r,be(r))}function ja(r,o,u){var p=r==null?e:ln(r,o);return p===e?u:p}function Nx(r,o){return r!=null&&cc(r,o,o_)}function qa(r,o){return r!=null&&cc(r,o,a_)}var Ux=nc(function(r,o,u){o!=null&&typeof o.toString!="function"&&(o=as.call(o)),r[o]=u},Za(we)),kx=nc(function(r,o,u){o!=null&&typeof o.toString!="function"&&(o=as.call(o)),Mt.call(r,o)?r[o].push(u):r[o]=[u]},ot),Gx=mt(wr);function se(r){return ye(r)?bu(r):ya(r)}function be(r){return ye(r)?bu(r,!0):__(r)}function Hx(r,o){var u={};return o=ot(o,3),li(r,function(p,_,b){Ti(u,o(p,_,b),p)}),u}function Wx(r,o){var u={};return o=ot(o,3),li(r,function(p,_,b){Ti(u,_,o(p,_,b))}),u}var Xx=Un(function(r,o,u){bs(r,o,u)}),Vc=Un(function(r,o,u,p){bs(r,o,u,p)}),zx=Ai(function(r,o){var u={};if(r==null)return u;var p=!1;o=kt(o,function(b){return b=Xi(b,r),p||(p=b.length>1),b}),ui(r,Fa(r),u),p&&(u=ke(u,g|m|v,U_));for(var _=o.length;_--;)Sa(u,o[_]);return u});function $x(r,o){return Yc(r,Os(ot(o)))}var Vx=Ai(function(r,o){return r==null?{}:x_(r,o)});function Yc(r,o){if(r==null)return{};var u=kt(Fa(r),function(p){return[p]});return o=ot(o),Uu(r,u,function(p,_){return o(p,_[0])})}function Yx(r,o,u){o=Xi(o,r);var p=-1,_=o.length;for(_||(_=1,r=e);++p<_;){var b=r==null?e:r[ci(o[p])];b===e&&(p=_,b=u),r=Ci(b)?b.call(r):b}return r}function jx(r,o,u){return r==null?r:Er(r,o,u)}function qx(r,o,u,p){return p=typeof p=="function"?p:e,r==null?r:Er(r,o,u,p)}var jc=oc(se),qc=oc(be);function Kx(r,o,u){var p=ct(r),_=p||$i(r)||Hn(r);if(o=ot(o,4),u==null){var b=r&&r.constructor;_?u=p?new b:[]:Ht(r)?u=Ci(b)?Nn(us(r)):{}:u={}}return(_?Oe:li)(r,function(w,S,I){return o(u,w,S,I)}),u}function Zx(r,o){return r==null?!0:Sa(r,o)}function Jx(r,o,u){return r==null?r:Xu(r,o,Ra(u))}function Qx(r,o,u,p){return p=typeof p=="function"?p:e,r==null?r:Xu(r,o,Ra(u),p)}function Wn(r){return r==null?[]:aa(r,se(r))}function ty(r){return r==null?[]:aa(r,be(r))}function ey(r,o,u){return u===e&&(u=o,o=e),u!==e&&(u=We(u),u=u===u?u:0),o!==e&&(o=We(o),o=o===o?o:0),hn(We(r),o,u)}function iy(r,o,u){return o=Ii(o),u===e?(u=o,o=0):u=Ii(u),r=We(r),h_(r,o,u)}function ny(r,o,u){if(u&&typeof u!="boolean"&&me(r,o,u)&&(o=u=e),u===e&&(typeof o=="boolean"?(u=o,o=e):typeof r=="boolean"&&(u=r,r=e)),r===e&&o===e?(r=0,o=1):(r=Ii(r),o===e?(o=r,r=0):o=Ii(o)),r>o){var p=r;r=o,o=p}if(u||r%1||o%1){var _=xu();return de(r+_*(o-r+Lg("1e-"+((_+"").length-1))),o)}return Ta(r,o)}var ry=kn(function(r,o,u){return o=o.toLowerCase(),r+(u?Kc(o):o)});function Kc(r){return Ka(It(r).toLowerCase())}function Zc(r){return r=It(r),r&&r.replace(og,jg).replace(Ag,"")}function sy(r,o,u){r=It(r),o=Ce(o);var p=r.length;u=u===e?p:hn(pt(u),0,p);var _=u;return u-=o.length,u>=0&&r.slice(u,_)==o}function oy(r){return r=It(r),r&&Gp.test(r)?r.replace(Il,qg):r}function ay(r){return r=It(r),r&&Vp.test(r)?r.replace($o,"\\$&"):r}var hy=kn(function(r,o,u){return r+(u?"-":"")+o.toLowerCase()}),ly=kn(function(r,o,u){return r+(u?" ":"")+o.toLowerCase()}),uy=tc("toLowerCase");function cy(r,o,u){r=It(r),o=pt(o);var p=o?Dn(r):0;if(!o||p>=o)return r;var _=(o-p)/2;return Cs(ps(_),u)+r+Cs(ds(_),u)}function fy(r,o,u){r=It(r),o=pt(o);var p=o?Dn(r):0;return o&&p<o?r+Cs(o-p,u):r}function dy(r,o,u){r=It(r),o=pt(o);var p=o?Dn(r):0;return o&&p<o?Cs(o-p,u)+r:r}function py(r,o,u){return u||o==null?o=0:o&&(o=+o),bm(It(r).replace(Vo,""),o||0)}function gy(r,o,u){return(u?me(r,o,u):o===e)?o=1:o=pt(o),Ea(It(r),o)}function my(){var r=arguments,o=It(r[0]);return r.length<3?o:o.replace(r[1],r[2])}var _y=kn(function(r,o,u){return r+(u?"_":"")+o.toLowerCase()});function vy(r,o,u){return u&&typeof u!="number"&&me(r,o,u)&&(o=u=e),u=u===e?et:u>>>0,u?(r=It(r),r&&(typeof o=="string"||o!=null&&!Ya(o))&&(o=Ce(o),!o&&Mn(r))?zi(Ve(r),0,u):r.split(o,u)):[]}var xy=kn(function(r,o,u){return r+(u?" ":"")+Ka(o)});function yy(r,o,u){return r=It(r),u=u==null?0:hn(pt(u),0,r.length),o=Ce(o),r.slice(u,u+o.length)==o}function by(r,o,u){var p=y.templateSettings;u&&me(r,o,u)&&(o=e),r=It(r),o=ks({},o,p,ac);var _=ks({},o.imports,p.imports,ac),b=se(_),w=aa(_,b),S,I,F=0,L=o.interpolate||Jr,N="__p += '",$=la((o.escape||Jr).source+"|"+L.source+"|"+(L===Rl?tg:Jr).source+"|"+(o.evaluate||Jr).source+"|$","g"),Q="//# sourceURL="+(Mt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Pg+"]")+`
`;r.replace($,function(ht,xt,Tt,Re,_e,Pe){return Tt||(Tt=Re),N+=r.slice(F,Pe).replace(ag,Kg),xt&&(S=!0,N+=`' +
__e(`+xt+`) +
'`),_e&&(I=!0,N+=`';
`+_e+`;
__p += '`),Tt&&(N+=`' +
((__t = (`+Tt+`)) == null ? '' : __t) +
'`),F=Pe+ht.length,ht}),N+=`';
`;var at=Mt.call(o,"variable")&&o.variable;if(!at)N=`with (obj) {
`+N+`
}
`;else if(Jp.test(at))throw new ut(l);N=(I?N.replace(Op,""):N).replace(Np,"$1").replace(Up,"$1;"),N="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(S?", __e = _.escape":"")+(I?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+N+`return __p
}`;var gt=Qc(function(){return St(b,Q+"return "+N).apply(e,w)});if(gt.source=N,Va(gt))throw gt;return gt}function wy(r){return It(r).toLowerCase()}function Ty(r){return It(r).toUpperCase()}function Ey(r,o,u){if(r=It(r),r&&(u||o===e))return hu(r);if(!r||!(o=Ce(o)))return r;var p=Ve(r),_=Ve(o),b=lu(p,_),w=uu(p,_)+1;return zi(p,b,w).join("")}function Ay(r,o,u){if(r=It(r),r&&(u||o===e))return r.slice(0,fu(r)+1);if(!r||!(o=Ce(o)))return r;var p=Ve(r),_=uu(p,Ve(o))+1;return zi(p,0,_).join("")}function Sy(r,o,u){if(r=It(r),r&&(u||o===e))return r.replace(Vo,"");if(!r||!(o=Ce(o)))return r;var p=Ve(r),_=lu(p,Ve(o));return zi(p,_).join("")}function Cy(r,o){var u=rt,p=V;if(Ht(o)){var _="separator"in o?o.separator:_;u="length"in o?pt(o.length):u,p="omission"in o?Ce(o.omission):p}r=It(r);var b=r.length;if(Mn(r)){var w=Ve(r);b=w.length}if(u>=b)return r;var S=u-Dn(p);if(S<1)return p;var I=w?zi(w,0,S).join(""):r.slice(0,S);if(_===e)return I+p;if(w&&(S+=I.length-S),Ya(_)){if(r.slice(S).search(_)){var F,L=I;for(_.global||(_=la(_.source,It(Pl.exec(_))+"g")),_.lastIndex=0;F=_.exec(L);)var N=F.index;I=I.slice(0,N===e?S:N)}}else if(r.indexOf(Ce(_),S)!=S){var $=I.lastIndexOf(_);$>-1&&(I=I.slice(0,$))}return I+p}function Iy(r){return r=It(r),r&&kp.test(r)?r.replace(Cl,nm):r}var Ry=kn(function(r,o,u){return r+(u?" ":"")+o.toUpperCase()}),Ka=tc("toUpperCase");function Jc(r,o,u){return r=It(r),o=u?e:o,o===e?Jg(r)?om(r):Xg(r):r.match(o)||[]}var Qc=mt(function(r,o){try{return Ae(r,e,o)}catch(u){return Va(u)?u:new ut(u)}}),Py=Ai(function(r,o){return Oe(o,function(u){u=ci(u),Ti(r,u,za(r[u],r))}),r});function My(r){var o=r==null?0:r.length,u=ot();return r=o?kt(r,function(p){if(typeof p[1]!="function")throw new Ne(h);return[u(p[0]),p[1]]}):[],mt(function(p){for(var _=-1;++_<o;){var b=r[_];if(Ae(b[0],this,p))return Ae(b[1],this,p)}})}function Dy(r){return n_(ke(r,g))}function Za(r){return function(){return r}}function By(r,o){return r==null||r!==r?o:r}var Fy=ic(),Ly=ic(!0);function we(r){return r}function Ja(r){return Du(typeof r=="function"?r:ke(r,g))}function Oy(r){return Fu(ke(r,g))}function Ny(r,o){return Lu(r,ke(o,g))}var Uy=mt(function(r,o){return function(u){return wr(u,r,o)}}),ky=mt(function(r,o){return function(u){return wr(r,u,o)}});function Qa(r,o,u){var p=se(o),_=ys(o,p);u==null&&!(Ht(o)&&(_.length||!p.length))&&(u=o,o=r,r=this,_=ys(o,se(o)));var b=!(Ht(u)&&"chain"in u)||!!u.chain,w=Ci(r);return Oe(_,function(S){var I=o[S];r[S]=I,w&&(r.prototype[S]=function(){var F=this.__chain__;if(b||F){var L=r(this.__wrapped__),N=L.__actions__=xe(this.__actions__);return N.push({func:I,args:arguments,thisArg:r}),L.__chain__=F,L}return I.apply(r,Ui([this.value()],arguments))})}),r}function Gy(){return oe._===this&&(oe._=fm),this}function th(){}function Hy(r){return r=pt(r),mt(function(o){return Ou(o,r)})}var Wy=Ma(kt),Xy=Ma(nu),zy=Ma(ia);function tf(r){return Ua(r)?na(ci(r)):y_(r)}function $y(r){return function(o){return r==null?e:ln(r,o)}}var Vy=rc(),Yy=rc(!0);function eh(){return[]}function ih(){return!1}function jy(){return{}}function qy(){return""}function Ky(){return!0}function Zy(r,o){if(r=pt(r),r<1||r>vt)return[];var u=et,p=de(r,et);o=ot(o),r-=et;for(var _=oa(p,o);++u<r;)o(u);return _}function Jy(r){return ct(r)?kt(r,ci):Ie(r)?[r]:xe(yc(It(r)))}function Qy(r){var o=++um;return It(r)+o}var t1=Ss(function(r,o){return r+o},0),e1=Da("ceil"),i1=Ss(function(r,o){return r/o},1),n1=Da("floor");function r1(r){return r&&r.length?xs(r,we,_a):e}function s1(r,o){return r&&r.length?xs(r,ot(o,2),_a):e}function o1(r){return ou(r,we)}function a1(r,o){return ou(r,ot(o,2))}function h1(r){return r&&r.length?xs(r,we,ba):e}function l1(r,o){return r&&r.length?xs(r,ot(o,2),ba):e}var u1=Ss(function(r,o){return r*o},1),c1=Da("round"),f1=Ss(function(r,o){return r-o},0);function d1(r){return r&&r.length?sa(r,we):0}function p1(r,o){return r&&r.length?sa(r,ot(o,2)):0}return y.after=Ov,y.ary=Mc,y.assign=Tx,y.assignIn=$c,y.assignInWith=ks,y.assignWith=Ex,y.at=Ax,y.before=Dc,y.bind=za,y.bindAll=Py,y.bindKey=Bc,y.castArray=jv,y.chain=Ic,y.chunk=n0,y.compact=r0,y.concat=s0,y.cond=My,y.conforms=Dy,y.constant=Za,y.countBy=dv,y.create=Sx,y.curry=Fc,y.curryRight=Lc,y.debounce=Oc,y.defaults=Cx,y.defaultsDeep=Ix,y.defer=Nv,y.delay=Uv,y.difference=o0,y.differenceBy=a0,y.differenceWith=h0,y.drop=l0,y.dropRight=u0,y.dropRightWhile=c0,y.dropWhile=f0,y.fill=d0,y.filter=gv,y.flatMap=vv,y.flatMapDeep=xv,y.flatMapDepth=yv,y.flatten=Ec,y.flattenDeep=p0,y.flattenDepth=g0,y.flip=kv,y.flow=Fy,y.flowRight=Ly,y.fromPairs=m0,y.functions=Lx,y.functionsIn=Ox,y.groupBy=bv,y.initial=v0,y.intersection=x0,y.intersectionBy=y0,y.intersectionWith=b0,y.invert=Ux,y.invertBy=kx,y.invokeMap=Tv,y.iteratee=Ja,y.keyBy=Ev,y.keys=se,y.keysIn=be,y.map=Bs,y.mapKeys=Hx,y.mapValues=Wx,y.matches=Oy,y.matchesProperty=Ny,y.memoize=Ls,y.merge=Xx,y.mergeWith=Vc,y.method=Uy,y.methodOf=ky,y.mixin=Qa,y.negate=Os,y.nthArg=Hy,y.omit=zx,y.omitBy=$x,y.once=Gv,y.orderBy=Av,y.over=Wy,y.overArgs=Hv,y.overEvery=Xy,y.overSome=zy,y.partial=$a,y.partialRight=Nc,y.partition=Sv,y.pick=Vx,y.pickBy=Yc,y.property=tf,y.propertyOf=$y,y.pull=A0,y.pullAll=Sc,y.pullAllBy=S0,y.pullAllWith=C0,y.pullAt=I0,y.range=Vy,y.rangeRight=Yy,y.rearg=Wv,y.reject=Rv,y.remove=R0,y.rest=Xv,y.reverse=Wa,y.sampleSize=Mv,y.set=jx,y.setWith=qx,y.shuffle=Dv,y.slice=P0,y.sortBy=Lv,y.sortedUniq=N0,y.sortedUniqBy=U0,y.split=vy,y.spread=zv,y.tail=k0,y.take=G0,y.takeRight=H0,y.takeRightWhile=W0,y.takeWhile=X0,y.tap=rv,y.throttle=$v,y.thru=Ds,y.toArray=Wc,y.toPairs=jc,y.toPairsIn=qc,y.toPath=Jy,y.toPlainObject=zc,y.transform=Kx,y.unary=Vv,y.union=z0,y.unionBy=$0,y.unionWith=V0,y.uniq=Y0,y.uniqBy=j0,y.uniqWith=q0,y.unset=Zx,y.unzip=Xa,y.unzipWith=Cc,y.update=Jx,y.updateWith=Qx,y.values=Wn,y.valuesIn=ty,y.without=K0,y.words=Jc,y.wrap=Yv,y.xor=Z0,y.xorBy=J0,y.xorWith=Q0,y.zip=tv,y.zipObject=ev,y.zipObjectDeep=iv,y.zipWith=nv,y.entries=jc,y.entriesIn=qc,y.extend=$c,y.extendWith=ks,Qa(y,y),y.add=t1,y.attempt=Qc,y.camelCase=ry,y.capitalize=Kc,y.ceil=e1,y.clamp=ey,y.clone=qv,y.cloneDeep=Zv,y.cloneDeepWith=Jv,y.cloneWith=Kv,y.conformsTo=Qv,y.deburr=Zc,y.defaultTo=By,y.divide=i1,y.endsWith=sy,y.eq=je,y.escape=oy,y.escapeRegExp=ay,y.every=pv,y.find=mv,y.findIndex=wc,y.findKey=Rx,y.findLast=_v,y.findLastIndex=Tc,y.findLastKey=Px,y.floor=n1,y.forEach=Rc,y.forEachRight=Pc,y.forIn=Mx,y.forInRight=Dx,y.forOwn=Bx,y.forOwnRight=Fx,y.get=ja,y.gt=tx,y.gte=ex,y.has=Nx,y.hasIn=qa,y.head=Ac,y.identity=we,y.includes=wv,y.indexOf=_0,y.inRange=iy,y.invoke=Gx,y.isArguments=fn,y.isArray=ct,y.isArrayBuffer=ix,y.isArrayLike=ye,y.isArrayLikeObject=qt,y.isBoolean=nx,y.isBuffer=$i,y.isDate=rx,y.isElement=sx,y.isEmpty=ox,y.isEqual=ax,y.isEqualWith=hx,y.isError=Va,y.isFinite=lx,y.isFunction=Ci,y.isInteger=Uc,y.isLength=Ns,y.isMap=kc,y.isMatch=ux,y.isMatchWith=cx,y.isNaN=fx,y.isNative=dx,y.isNil=gx,y.isNull=px,y.isNumber=Gc,y.isObject=Ht,y.isObjectLike=jt,y.isPlainObject=Ir,y.isRegExp=Ya,y.isSafeInteger=mx,y.isSet=Hc,y.isString=Us,y.isSymbol=Ie,y.isTypedArray=Hn,y.isUndefined=_x,y.isWeakMap=vx,y.isWeakSet=xx,y.join=w0,y.kebabCase=hy,y.last=He,y.lastIndexOf=T0,y.lowerCase=ly,y.lowerFirst=uy,y.lt=yx,y.lte=bx,y.max=r1,y.maxBy=s1,y.mean=o1,y.meanBy=a1,y.min=h1,y.minBy=l1,y.stubArray=eh,y.stubFalse=ih,y.stubObject=jy,y.stubString=qy,y.stubTrue=Ky,y.multiply=u1,y.nth=E0,y.noConflict=Gy,y.noop=th,y.now=Fs,y.pad=cy,y.padEnd=fy,y.padStart=dy,y.parseInt=py,y.random=ny,y.reduce=Cv,y.reduceRight=Iv,y.repeat=gy,y.replace=my,y.result=Yx,y.round=c1,y.runInContext=C,y.sample=Pv,y.size=Bv,y.snakeCase=_y,y.some=Fv,y.sortedIndex=M0,y.sortedIndexBy=D0,y.sortedIndexOf=B0,y.sortedLastIndex=F0,y.sortedLastIndexBy=L0,y.sortedLastIndexOf=O0,y.startCase=xy,y.startsWith=yy,y.subtract=f1,y.sum=d1,y.sumBy=p1,y.template=by,y.times=Zy,y.toFinite=Ii,y.toInteger=pt,y.toLength=Xc,y.toLower=wy,y.toNumber=We,y.toSafeInteger=wx,y.toString=It,y.toUpper=Ty,y.trim=Ey,y.trimEnd=Ay,y.trimStart=Sy,y.truncate=Cy,y.unescape=Iy,y.uniqueId=Qy,y.upperCase=Ry,y.upperFirst=Ka,y.each=Rc,y.eachRight=Pc,y.first=Ac,Qa(y,function(){var r={};return li(y,function(o,u){Mt.call(y.prototype,u)||(r[u]=o)}),r}(),{chain:!1}),y.VERSION=n,Oe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){y[r].placeholder=y}),Oe(["drop","take"],function(r,o){bt.prototype[r]=function(u){u=u===e?1:ne(pt(u),0);var p=this.__filtered__&&!o?new bt(this):this.clone();return p.__filtered__?p.__takeCount__=de(u,p.__takeCount__):p.__views__.push({size:de(u,et),type:r+(p.__dir__<0?"Right":"")}),p},bt.prototype[r+"Right"]=function(u){return this.reverse()[r](u).reverse()}}),Oe(["filter","map","takeWhile"],function(r,o){var u=o+1,p=u==O||u==_t;bt.prototype[r]=function(_){var b=this.clone();return b.__iteratees__.push({iteratee:ot(_,3),type:u}),b.__filtered__=b.__filtered__||p,b}}),Oe(["head","last"],function(r,o){var u="take"+(o?"Right":"");bt.prototype[r]=function(){return this[u](1).value()[0]}}),Oe(["initial","tail"],function(r,o){var u="drop"+(o?"":"Right");bt.prototype[r]=function(){return this.__filtered__?new bt(this):this[u](1)}}),bt.prototype.compact=function(){return this.filter(we)},bt.prototype.find=function(r){return this.filter(r).head()},bt.prototype.findLast=function(r){return this.reverse().find(r)},bt.prototype.invokeMap=mt(function(r,o){return typeof r=="function"?new bt(this):this.map(function(u){return wr(u,r,o)})}),bt.prototype.reject=function(r){return this.filter(Os(ot(r)))},bt.prototype.slice=function(r,o){r=pt(r);var u=this;return u.__filtered__&&(r>0||o<0)?new bt(u):(r<0?u=u.takeRight(-r):r&&(u=u.drop(r)),o!==e&&(o=pt(o),u=o<0?u.dropRight(-o):u.take(o-r)),u)},bt.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},bt.prototype.toArray=function(){return this.take(et)},li(bt.prototype,function(r,o){var u=/^(?:filter|find|map|reject)|While$/.test(o),p=/^(?:head|last)$/.test(o),_=y[p?"take"+(o=="last"?"Right":""):o],b=p||/^find/.test(o);_&&(y.prototype[o]=function(){var w=this.__wrapped__,S=p?[1]:arguments,I=w instanceof bt,F=S[0],L=I||ct(w),N=function(xt){var Tt=_.apply(y,Ui([xt],S));return p&&$?Tt[0]:Tt};L&&u&&typeof F=="function"&&F.length!=1&&(I=L=!1);var $=this.__chain__,Q=!!this.__actions__.length,at=b&&!$,gt=I&&!Q;if(!b&&L){w=gt?w:new bt(this);var ht=r.apply(w,S);return ht.__actions__.push({func:Ds,args:[N],thisArg:e}),new Ue(ht,$)}return at&&gt?r.apply(this,S):(ht=this.thru(N),at?p?ht.value()[0]:ht.value():ht)})}),Oe(["pop","push","shift","sort","splice","unshift"],function(r){var o=rs[r],u=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",p=/^(?:pop|shift)$/.test(r);y.prototype[r]=function(){var _=arguments;if(p&&!this.__chain__){var b=this.value();return o.apply(ct(b)?b:[],_)}return this[u](function(w){return o.apply(ct(w)?w:[],_)})}}),li(bt.prototype,function(r,o){var u=y[o];if(u){var p=u.name+"";Mt.call(On,p)||(On[p]=[]),On[p].push({name:o,func:u})}}),On[As(e,R).name]=[{name:"wrapper",func:e}],bt.prototype.clone=Im,bt.prototype.reverse=Rm,bt.prototype.value=Pm,y.prototype.at=sv,y.prototype.chain=ov,y.prototype.commit=av,y.prototype.next=hv,y.prototype.plant=uv,y.prototype.reverse=cv,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=fv,y.prototype.first=y.prototype.head,gr&&(y.prototype[gr]=lv),y},Bn=am();rn?((rn.exports=Bn)._=Bn,Jo._=Bn):oe._=Bn}).call(Yi)})(Xe,Xe.exports);const Xn=Xe.exports;var Cn=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(Cn||{}),Rh=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(Rh||{}),lt=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(lt||{}),gi=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(gi||{}),X=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(X||{}),er=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(er||{}),st=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(st||{}),Ph=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(Ph||{}),Di=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Di||{}),Ki=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(Ki||{}),xi=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(xi||{}),ai=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(ai||{}),di=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(di||{}),al=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(al||{}),ze=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(ze||{}),re=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(re||{}),te=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(te||{}),mi=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(mi||{});const _1={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},q={ADAPTER:_1,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var nh=/iPhone/i,nf=/iPod/i,rf=/iPad/i,sf=/\biOS-universal(?:.+)Mac\b/i,rh=/\bAndroid(?:.+)Mobile\b/i,of=/Android/i,zn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Gs=/Silk/i,Pi=/Windows Phone/i,af=/\bWindows(?:.+)ARM\b/i,hf=/BlackBerry/i,lf=/BB10/i,uf=/Opera Mini/i,cf=/\b(CriOS|Chrome)(?:.+)Mobile/i,ff=/Mobile(?:.+)Firefox\b/i,df=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function v1(i){return function(t){return t.test(i)}}function x1(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,n=e.split("[FBAN");typeof n[1]<"u"&&(e=n[0]),n=e.split("Twitter"),typeof n[1]<"u"&&(e=n[0]);var s=v1(e),a={apple:{phone:s(nh)&&!s(Pi),ipod:s(nf),tablet:!s(nh)&&(s(rf)||df(t))&&!s(Pi),universal:s(sf),device:(s(nh)||s(nf)||s(rf)||s(sf)||df(t))&&!s(Pi)},amazon:{phone:s(zn),tablet:!s(zn)&&s(Gs),device:s(zn)||s(Gs)},android:{phone:!s(Pi)&&s(zn)||!s(Pi)&&s(rh),tablet:!s(Pi)&&!s(zn)&&!s(rh)&&(s(Gs)||s(of)),device:!s(Pi)&&(s(zn)||s(Gs)||s(rh)||s(of))||s(/\bokhttp\b/i)},windows:{phone:s(Pi),tablet:s(af),device:s(Pi)||s(af)},other:{blackberry:s(hf),blackberry10:s(lf),opera:s(uf),firefox:s(ff),chrome:s(cf),device:s(hf)||s(lf)||s(uf)||s(ff)||s(cf)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}const Bi=x1(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/;q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ud={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function s(c,f,d){this.fn=c,this.context=f,this.once=d||!1}function a(c,f,d,g,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var v=new s(d,g||c,m),x=e?e+f:f;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],v]:c._events[x].push(v):(c._events[x]=v,c._eventsCount++),c}function h(c,f){--c._eventsCount===0?c._events=new n:delete c._events[f]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var f=[],d,g;if(this._eventsCount===0)return f;for(g in d=this._events)t.call(d,g)&&f.push(e?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},l.prototype.listeners=function(f){var d=e?e+f:f,g=this._events[d];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,v=g.length,x=new Array(v);m<v;m++)x[m]=g[m].fn;return x},l.prototype.listenerCount=function(f){var d=e?e+f:f,g=this._events[d];return g?g.fn?1:g.length:0},l.prototype.emit=function(f,d,g,m,v,x){var A=e?e+f:f;if(!this._events[A])return!1;var T=this._events[A],R=arguments.length,M,E;if(T.fn){switch(T.once&&this.removeListener(f,T.fn,void 0,!0),R){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,d),!0;case 3:return T.fn.call(T.context,d,g),!0;case 4:return T.fn.call(T.context,d,g,m),!0;case 5:return T.fn.call(T.context,d,g,m,v),!0;case 6:return T.fn.call(T.context,d,g,m,v,x),!0}for(E=1,M=new Array(R-1);E<R;E++)M[E-1]=arguments[E];T.fn.apply(T.context,M)}else{var P=T.length,U;for(E=0;E<P;E++)switch(T[E].once&&this.removeListener(f,T[E].fn,void 0,!0),R){case 1:T[E].fn.call(T[E].context);break;case 2:T[E].fn.call(T[E].context,d);break;case 3:T[E].fn.call(T[E].context,d,g);break;case 4:T[E].fn.call(T[E].context,d,g,m);break;default:if(!M)for(U=1,M=new Array(R-1);U<R;U++)M[U-1]=arguments[U];T[E].fn.apply(T[E].context,M)}}return!0},l.prototype.on=function(f,d,g){return a(this,f,d,g,!1)},l.prototype.once=function(f,d,g){return a(this,f,d,g,!0)},l.prototype.removeListener=function(f,d,g,m){var v=e?e+f:f;if(!this._events[v])return this;if(!d)return h(this,v),this;var x=this._events[v];if(x.fn)x.fn===d&&(!m||x.once)&&(!g||x.context===g)&&h(this,v);else{for(var A=0,T=[],R=x.length;A<R;A++)(x[A].fn!==d||m&&!x[A].once||g&&x[A].context!==g)&&T.push(x[A]);T.length?this._events[v]=T.length===1?T[0]:T:h(this,v)}return this},l.prototype.removeAllListeners=function(f){var d;return f?(d=e?e+f:f,this._events[d]&&h(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,i.exports=l})(ud);const jr=ud.exports;var hl={exports:{}};hl.exports=Co;hl.exports.default=Co;function Co(i,t,e){e=e||2;var n=t&&t.length,s=n?t[0]*e:i.length,a=cd(i,0,s,e,!0),h=[];if(!a||a.next===a.prev)return h;var l,c,f,d,g,m,v;if(n&&(a=E1(i,t,a,e)),i.length>80*e){l=f=i[0],c=d=i[1];for(var x=e;x<s;x+=e)g=i[x],m=i[x+1],g<l&&(l=g),m<c&&(c=m),g>f&&(f=g),m>d&&(d=m);v=Math.max(f-l,d-c),v=v!==0?32767/v:0}return kr(a,h,e,l,c,v,0),h}function cd(i,t,e,n,s){var a,h;if(s===Bh(i,t,e,n)>0)for(a=t;a<e;a+=n)h=pf(a,i[a],i[a+1],h);else for(a=e-n;a>=t;a-=n)h=pf(a,i[a],i[a+1],h);return h&&Io(h,h.next)&&(Hr(h),h=h.next),h}function En(i,t){if(!i)return i;t||(t=i);var e=i,n;do if(n=!1,!e.steiner&&(Io(e,e.next)||Xt(e.prev,e,e.next)===0)){if(Hr(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function kr(i,t,e,n,s,a,h){if(i){!h&&a&&R1(i,n,s,a);for(var l=i,c,f;i.prev!==i.next;){if(c=i.prev,f=i.next,a?b1(i,n,s,a):y1(i)){t.push(c.i/e|0),t.push(i.i/e|0),t.push(f.i/e|0),Hr(i),i=f.next,l=f.next;continue}if(i=f,i===l){h?h===1?(i=w1(En(i),t,e),kr(i,t,e,n,s,a,2)):h===2&&T1(i,t,e,n,s,a):kr(En(i),t,e,n,s,a,1);break}}}}function y1(i){var t=i.prev,e=i,n=i.next;if(Xt(t,e,n)>=0)return!1;for(var s=t.x,a=e.x,h=n.x,l=t.y,c=e.y,f=n.y,d=s<a?s<h?s:h:a<h?a:h,g=l<c?l<f?l:f:c<f?c:f,m=s>a?s>h?s:h:a>h?a:h,v=l>c?l>f?l:f:c>f?c:f,x=n.next;x!==t;){if(x.x>=d&&x.x<=m&&x.y>=g&&x.y<=v&&Jn(s,l,a,c,h,f,x.x,x.y)&&Xt(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function b1(i,t,e,n){var s=i.prev,a=i,h=i.next;if(Xt(s,a,h)>=0)return!1;for(var l=s.x,c=a.x,f=h.x,d=s.y,g=a.y,m=h.y,v=l<c?l<f?l:f:c<f?c:f,x=d<g?d<m?d:m:g<m?g:m,A=l>c?l>f?l:f:c>f?c:f,T=d>g?d>m?d:m:g>m?g:m,R=Mh(v,x,t,e,n),M=Mh(A,T,t,e,n),E=i.prevZ,P=i.nextZ;E&&E.z>=R&&P&&P.z<=M;){if(E.x>=v&&E.x<=A&&E.y>=x&&E.y<=T&&E!==s&&E!==h&&Jn(l,d,c,g,f,m,E.x,E.y)&&Xt(E.prev,E,E.next)>=0||(E=E.prevZ,P.x>=v&&P.x<=A&&P.y>=x&&P.y<=T&&P!==s&&P!==h&&Jn(l,d,c,g,f,m,P.x,P.y)&&Xt(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;E&&E.z>=R;){if(E.x>=v&&E.x<=A&&E.y>=x&&E.y<=T&&E!==s&&E!==h&&Jn(l,d,c,g,f,m,E.x,E.y)&&Xt(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;P&&P.z<=M;){if(P.x>=v&&P.x<=A&&P.y>=x&&P.y<=T&&P!==s&&P!==h&&Jn(l,d,c,g,f,m,P.x,P.y)&&Xt(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function w1(i,t,e){var n=i;do{var s=n.prev,a=n.next.next;!Io(s,a)&&fd(s,n,n.next,a)&&Gr(s,a)&&Gr(a,s)&&(t.push(s.i/e|0),t.push(n.i/e|0),t.push(a.i/e|0),Hr(n),Hr(n.next),n=i=a),n=n.next}while(n!==i);return En(n)}function T1(i,t,e,n,s,a){var h=i;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&D1(h,l)){var c=dd(h,l);h=En(h,h.next),c=En(c,c.next),kr(h,t,e,n,s,a,0),kr(c,t,e,n,s,a,0);return}l=l.next}h=h.next}while(h!==i)}function E1(i,t,e,n){var s=[],a,h,l,c,f;for(a=0,h=t.length;a<h;a++)l=t[a]*n,c=a<h-1?t[a+1]*n:i.length,f=cd(i,l,c,n,!1),f===f.next&&(f.steiner=!0),s.push(M1(f));for(s.sort(A1),a=0;a<s.length;a++)e=S1(s[a],e);return e}function A1(i,t){return i.x-t.x}function S1(i,t){var e=C1(i,t);if(!e)return t;var n=dd(e,i);return En(n,n.next),En(e,e.next)}function C1(i,t){var e=t,n=i.x,s=i.y,a=-1/0,h;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var l=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=n&&l>a&&(a=l,h=e.x<e.next.x?e:e.next,l===n))return h}e=e.next}while(e!==t);if(!h)return null;var c=h,f=h.x,d=h.y,g=1/0,m;e=h;do n>=e.x&&e.x>=f&&n!==e.x&&Jn(s<d?n:a,s,f,d,s<d?a:n,s,e.x,e.y)&&(m=Math.abs(s-e.y)/(n-e.x),Gr(e,i)&&(m<g||m===g&&(e.x>h.x||e.x===h.x&&I1(h,e)))&&(h=e,g=m)),e=e.next;while(e!==c);return h}function I1(i,t){return Xt(i.prev,i,t.prev)<0&&Xt(t.next,i,i.next)<0}function R1(i,t,e,n){var s=i;do s.z===0&&(s.z=Mh(s.x,s.y,t,e,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,P1(s)}function P1(i){var t,e,n,s,a,h,l,c,f=1;do{for(e=i,i=null,a=null,h=0;e;){for(h++,n=e,l=0,t=0;t<f&&(l++,n=n.nextZ,!!n);t++);for(c=f;l>0||c>0&&n;)l!==0&&(c===0||!n||e.z<=n.z)?(s=e,e=e.nextZ,l--):(s=n,n=n.nextZ,c--),a?a.nextZ=s:i=s,s.prevZ=a,a=s;e=n}a.nextZ=null,f*=2}while(h>1);return i}function Mh(i,t,e,n,s){return i=(i-e)*s|0,t=(t-n)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function M1(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Jn(i,t,e,n,s,a,h,l){return(s-h)*(t-l)>=(i-h)*(a-l)&&(i-h)*(n-l)>=(e-h)*(t-l)&&(e-h)*(a-l)>=(s-h)*(n-l)}function D1(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!B1(i,t)&&(Gr(i,t)&&Gr(t,i)&&F1(i,t)&&(Xt(i.prev,i,t.prev)||Xt(i,t.prev,t))||Io(i,t)&&Xt(i.prev,i,i.next)>0&&Xt(t.prev,t,t.next)>0)}function Xt(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Io(i,t){return i.x===t.x&&i.y===t.y}function fd(i,t,e,n){var s=Ws(Xt(i,t,e)),a=Ws(Xt(i,t,n)),h=Ws(Xt(e,n,i)),l=Ws(Xt(e,n,t));return!!(s!==a&&h!==l||s===0&&Hs(i,e,t)||a===0&&Hs(i,n,t)||h===0&&Hs(e,i,n)||l===0&&Hs(e,t,n))}function Hs(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Ws(i){return i>0?1:i<0?-1:0}function B1(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&fd(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Gr(i,t){return Xt(i.prev,i,i.next)<0?Xt(i,t,i.next)>=0&&Xt(i,i.prev,t)>=0:Xt(i,t,i.prev)<0||Xt(i,i.next,t)<0}function F1(i,t){var e=i,n=!1,s=(i.x+t.x)/2,a=(i.y+t.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&s<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==i);return n}function dd(i,t){var e=new Dh(i.i,i.x,i.y),n=new Dh(t.i,t.x,t.y),s=i.next,a=t.prev;return i.next=t,t.prev=i,e.next=s,s.prev=e,n.next=e,e.prev=n,a.next=n,n.prev=a,n}function pf(i,t,e,n){var s=new Dh(i,t,e);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function Hr(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Dh(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Co.deviation=function(i,t,e,n){var s=t&&t.length,a=s?t[0]*e:i.length,h=Math.abs(Bh(i,0,a,e));if(s)for(var l=0,c=t.length;l<c;l++){var f=t[l]*e,d=l<c-1?t[l+1]*e:i.length;h-=Math.abs(Bh(i,f,d,e))}var g=0;for(l=0;l<n.length;l+=3){var m=n[l]*e,v=n[l+1]*e,x=n[l+2]*e;g+=Math.abs((i[m]-i[x])*(i[v+1]-i[m+1])-(i[m]-i[v])*(i[x+1]-i[m+1]))}return h===0&&g===0?0:Math.abs((g-h)/h)};function Bh(i,t,e,n){for(var s=0,a=t,h=e-n;a<e;a+=n)s+=(i[h]-i[a])*(i[a+1]+i[h+1]),h=a;return s}Co.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},n=0,s=0;s<i.length;s++){for(var a=0;a<i[s].length;a++)for(var h=0;h<t;h++)e.vertices.push(i[s][a][h]);s>0&&(n+=i[s-1].length,e.holes.push(n))}return e};var Fh={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(i,t){(function(e){var n=t&&!t.nodeType&&t,s=i&&!i.nodeType&&i,a=typeof Yi=="object"&&Yi;(a.global===a||a.window===a||a.self===a)&&(e=a);var h,l=2147483647,c=36,f=1,d=26,g=38,m=700,v=72,x=128,A="-",T=/^xn--/,R=/[^\x20-\x7E]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=c-f,U=Math.floor,z=String.fromCharCode,G;function k(H){throw RangeError(E[H])}function Z(H,et){for(var yt=H.length,Ct=[];yt--;)Ct[yt]=et(H[yt]);return Ct}function rt(H,et){var yt=H.split("@"),Ct="";yt.length>1&&(Ct=yt[0]+"@",H=yt[1]),H=H.replace(M,".");var Rt=H.split("."),Ft=Z(Rt,et).join(".");return Ct+Ft}function V(H){for(var et=[],yt=0,Ct=H.length,Rt,Ft;yt<Ct;)Rt=H.charCodeAt(yt++),Rt>=55296&&Rt<=56319&&yt<Ct?(Ft=H.charCodeAt(yt++),(Ft&64512)==56320?et.push(((Rt&1023)<<10)+(Ft&1023)+65536):(et.push(Rt),yt--)):et.push(Rt);return et}function J(H){return Z(H,function(et){var yt="";return et>65535&&(et-=65536,yt+=z(et>>>10&1023|55296),et=56320|et&1023),yt+=z(et),yt}).join("")}function W(H){return H-48<10?H-22:H-65<26?H-65:H-97<26?H-97:c}function O(H,et){return H+22+75*(H<26)-((et!=0)<<5)}function dt(H,et,yt){var Ct=0;for(H=yt?U(H/m):H>>1,H+=U(H/et);H>P*d>>1;Ct+=c)H=U(H/P);return U(Ct+(P+1)*H/(H+g))}function _t(H){var et=[],yt=H.length,Ct,Rt=0,Ft=x,Lt=v,Jt,$t,Qt,ee,Pt,Ot,Vt,Yt,fe;for(Jt=H.lastIndexOf(A),Jt<0&&(Jt=0),$t=0;$t<Jt;++$t)H.charCodeAt($t)>=128&&k("not-basic"),et.push(H.charCodeAt($t));for(Qt=Jt>0?Jt+1:0;Qt<yt;){for(ee=Rt,Pt=1,Ot=c;Qt>=yt&&k("invalid-input"),Vt=W(H.charCodeAt(Qt++)),(Vt>=c||Vt>U((l-Rt)/Pt))&&k("overflow"),Rt+=Vt*Pt,Yt=Ot<=Lt?f:Ot>=Lt+d?d:Ot-Lt,!(Vt<Yt);Ot+=c)fe=c-Yt,Pt>U(l/fe)&&k("overflow"),Pt*=fe;Ct=et.length+1,Lt=dt(Rt-ee,Ct,ee==0),U(Rt/Ct)>l-Ft&&k("overflow"),Ft+=U(Rt/Ct),Rt%=Ct,et.splice(Rt++,0,Ft)}return J(et)}function Y(H){var et,yt,Ct,Rt,Ft,Lt,Jt,$t,Qt,ee,Pt,Ot=[],Vt,Yt,fe,nn;for(H=V(H),Vt=H.length,et=x,yt=0,Ft=v,Lt=0;Lt<Vt;++Lt)Pt=H[Lt],Pt<128&&Ot.push(z(Pt));for(Ct=Rt=Ot.length,Rt&&Ot.push(A);Ct<Vt;){for(Jt=l,Lt=0;Lt<Vt;++Lt)Pt=H[Lt],Pt>=et&&Pt<Jt&&(Jt=Pt);for(Yt=Ct+1,Jt-et>U((l-yt)/Yt)&&k("overflow"),yt+=(Jt-et)*Yt,et=Jt,Lt=0;Lt<Vt;++Lt)if(Pt=H[Lt],Pt<et&&++yt>l&&k("overflow"),Pt==et){for($t=yt,Qt=c;ee=Qt<=Ft?f:Qt>=Ft+d?d:Qt-Ft,!($t<ee);Qt+=c)nn=$t-ee,fe=c-ee,Ot.push(z(O(ee+nn%fe,0))),$t=U(nn/fe);Ot.push(z(O($t,0))),Ft=dt(yt,Yt,Ct==Rt),yt=0,++Ct}++yt,++et}return Ot.join("")}function vt(H){return rt(H,function(et){return T.test(et)?_t(et.slice(4).toLowerCase()):et})}function Ut(H){return rt(H,function(et){return R.test(et)?"xn--"+Y(et):et})}if(h={version:"1.3.2",ucs2:{decode:V,encode:J},decode:_t,encode:Y,toASCII:Ut,toUnicode:vt},n&&s)if(i.exports==n)s.exports=h;else for(G in h)h.hasOwnProperty(G)&&(n[G]=h[G]);else e.punycode=h})(Yi)})(Fh,Fh.exports);var L1={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},Wr={};function O1(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var N1=function(i,t,e,n){t=t||"&",e=e||"=";var s={};if(typeof i!="string"||i.length===0)return s;var a=/\+/g;i=i.split(t);var h=1e3;n&&typeof n.maxKeys=="number"&&(h=n.maxKeys);var l=i.length;h>0&&l>h&&(l=h);for(var c=0;c<l;++c){var f=i[c].replace(a,"%20"),d=f.indexOf(e),g,m,v,x;d>=0?(g=f.substr(0,d),m=f.substr(d+1)):(g=f,m=""),v=decodeURIComponent(g),x=decodeURIComponent(m),O1(s,v)?Array.isArray(s[v])?s[v].push(x):s[v]=[s[v],x]:s[v]=x}return s},Rr=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},U1=function(i,t,e,n){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(s){var a=encodeURIComponent(Rr(s))+e;return Array.isArray(i[s])?i[s].map(function(h){return a+encodeURIComponent(Rr(h))}).join(t):a+encodeURIComponent(Rr(i[s]))}).join(t):n?encodeURIComponent(Rr(n))+e+encodeURIComponent(Rr(i)):""};Wr.decode=Wr.parse=N1;Wr.encode=Wr.stringify=U1;var k1=Fh.exports,pi=L1,G1=Ro,H1=J1,W1=Z1;function ri(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var X1=/^([a-z0-9.+-]+:)/i,z1=/:[0-9]*$/,$1=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,V1=["<",">",'"',"`"," ","\r",`
`,"	"],Y1=["{","}","|","\\","^","`"].concat(V1),Lh=["'"].concat(Y1),gf=["%","/","?",";","#"].concat(Lh),mf=["/","?","#"],j1=255,_f=/^[+a-z0-9A-Z_-]{0,63}$/,q1=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,K1={javascript:!0,"javascript:":!0},Oh={javascript:!0,"javascript:":!0},ir={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Nh=Wr;function Ro(i,t,e){if(i&&pi.isObject(i)&&i instanceof ri)return i;var n=new ri;return n.parse(i,t,e),n}ri.prototype.parse=function(i,t,e){if(!pi.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var n=i.indexOf("?"),s=n!==-1&&n<i.indexOf("#")?"?":"#",a=i.split(s),h=/\\/g;a[0]=a[0].replace(h,"/"),i=a.join(s);var l=i;if(l=l.trim(),!e&&i.split("#").length===1){var c=$1.exec(l);if(c)return this.path=l,this.href=l,this.pathname=c[1],c[2]?(this.search=c[2],t?this.query=Nh.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=X1.exec(l);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,l=l.substr(f.length)}if(e||f||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var g=l.substr(0,2)==="//";g&&!(f&&Oh[f])&&(l=l.substr(2),this.slashes=!0)}if(!Oh[f]&&(g||f&&!ir[f])){for(var m=-1,v=0;v<mf.length;v++){var x=l.indexOf(mf[v]);x!==-1&&(m===-1||x<m)&&(m=x)}var A,T;m===-1?T=l.lastIndexOf("@"):T=l.lastIndexOf("@",m),T!==-1&&(A=l.slice(0,T),l=l.slice(T+1),this.auth=decodeURIComponent(A)),m=-1;for(var v=0;v<gf.length;v++){var x=l.indexOf(gf[v]);x!==-1&&(m===-1||x<m)&&(m=x)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var R=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!R)for(var M=this.hostname.split(/\./),v=0,E=M.length;v<E;v++){var P=M[v];if(P&&!P.match(_f)){for(var U="",z=0,G=P.length;z<G;z++)P.charCodeAt(z)>127?U+="x":U+=P[z];if(!U.match(_f)){var k=M.slice(0,v),Z=M.slice(v+1),rt=P.match(q1);rt&&(k.push(rt[1]),Z.unshift(rt[2])),Z.length&&(l="/"+Z.join(".")+l),this.hostname=k.join(".");break}}}this.hostname.length>j1?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=k1.toASCII(this.hostname));var V=this.port?":"+this.port:"",J=this.hostname||"";this.host=J+V,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!K1[d])for(var v=0,E=Lh.length;v<E;v++){var W=Lh[v];if(l.indexOf(W)!==-1){var O=encodeURIComponent(W);O===W&&(O=escape(W)),l=l.split(W).join(O)}}var dt=l.indexOf("#");dt!==-1&&(this.hash=l.substr(dt),l=l.slice(0,dt));var _t=l.indexOf("?");if(_t!==-1?(this.search=l.substr(_t),this.query=l.substr(_t+1),t&&(this.query=Nh.parse(this.query)),l=l.slice(0,_t)):t&&(this.search="",this.query={}),l&&(this.pathname=l),ir[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var V=this.pathname||"",Y=this.search||"";this.path=V+Y}return this.href=this.format(),this};function Z1(i){return pi.isString(i)&&(i=Ro(i)),i instanceof ri?i.format():ri.prototype.format.call(i)}ri.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",n=this.hash||"",s=!1,a="";this.host?s=i+this.host:this.hostname&&(s=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&pi.isObject(this.query)&&Object.keys(this.query).length&&(a=Nh.stringify(this.query));var h=this.search||a&&"?"+a||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||ir[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),n&&n.charAt(0)!=="#"&&(n="#"+n),h&&h.charAt(0)!=="?"&&(h="?"+h),e=e.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),h=h.replace("#","%23"),t+s+e+h+n};function J1(i,t){return Ro(i,!1,!0).resolve(t)}ri.prototype.resolve=function(i){return this.resolveObject(Ro(i,!1,!0)).format()};ri.prototype.resolveObject=function(i){if(pi.isString(i)){var t=new ri;t.parse(i,!1,!0),i=t}for(var e=new ri,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];e[a]=this[a]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var h=Object.keys(i),l=0;l<h.length;l++){var c=h[l];c!=="protocol"&&(e[c]=i[c])}return ir[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!ir[i.protocol]){for(var f=Object.keys(i),d=0;d<f.length;d++){var g=f[d];e[g]=i[g]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!Oh[i.protocol]){for(var E=(i.pathname||"").split("/");E.length&&!(i.host=E.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),E[0]!==""&&E.unshift(""),E.length<2&&E.unshift(""),e.pathname=E.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var m=e.pathname||"",v=e.search||"";e.path=m+v}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var x=e.pathname&&e.pathname.charAt(0)==="/",A=i.host||i.pathname&&i.pathname.charAt(0)==="/",T=A||x||e.host&&i.pathname,R=T,M=e.pathname&&e.pathname.split("/")||[],E=i.pathname&&i.pathname.split("/")||[],P=e.protocol&&!ir[e.protocol];if(P&&(e.hostname="",e.port=null,e.host&&(M[0]===""?M[0]=e.host:M.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(E[0]===""?E[0]=i.host:E.unshift(i.host)),i.host=null),T=T&&(E[0]===""||M[0]==="")),A)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,M=E;else if(E.length)M||(M=[]),M.pop(),M=M.concat(E),e.search=i.search,e.query=i.query;else if(!pi.isNullOrUndefined(i.search)){if(P){e.hostname=e.host=M.shift();var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.host=e.hostname=U.shift())}return e.search=i.search,e.query=i.query,(!pi.isNull(e.pathname)||!pi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!M.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var z=M.slice(-1)[0],G=(e.host||i.host||M.length>1)&&(z==="."||z==="..")||z==="",k=0,Z=M.length;Z>=0;Z--)z=M[Z],z==="."?M.splice(Z,1):z===".."?(M.splice(Z,1),k++):k&&(M.splice(Z,1),k--);if(!T&&!R)for(;k--;k)M.unshift("..");T&&M[0]!==""&&(!M[0]||M[0].charAt(0)!=="/")&&M.unshift(""),G&&M.join("/").substr(-1)!=="/"&&M.push("");var rt=M[0]===""||M[0]&&M[0].charAt(0)==="/";if(P){e.hostname=e.host=rt?"":M.length?M.shift():"";var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.host=e.hostname=U.shift())}return T=T||e.host&&M.length,T&&!rt&&M.unshift(""),M.length?e.pathname=M.join("/"):(e.pathname=null,e.path=null),(!pi.isNull(e.pathname)||!pi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};ri.prototype.parseHost=function(){var i=this.host,t=z1.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const Q1={parse:G1,format:W1,resolve:H1};function Ke(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function Pr(i){return i.split("?")[0].split("#")[0]}function tb(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function eb(i,t,e){return i.replace(new RegExp(tb(t),"g"),e)}function ib(i,t){let e="",n=0,s=-1,a=0,h=-1;for(let l=0;l<=i.length;++l){if(l<i.length)h=i.charCodeAt(l);else{if(h===47)break;h=47}if(h===47){if(!(s===l-1||a===1))if(s!==l-1&&a===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",n=0):(e=e.slice(0,c),n=e.length-1-e.lastIndexOf("/")),s=l,a=0;continue}}else if(e.length===2||e.length===1){e="",n=0,s=l,a=0;continue}}t&&(e.length>0?e+="/..":e="..",n=2)}else e.length>0?e+=`/${i.slice(s+1,l)}`:e=i.slice(s+1,l),n=l-s-1;s=l,a=0}else h===46&&a!==-1?++a:a=-1}return e}const ce={toPosix(i){return eb(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){Ke(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),n=/^[^/:]+:\/\//.exec(i),s=/^[^/:]+:\//.exec(i);if(e||n||s){const a=(e==null?void 0:e[0])||(n==null?void 0:n[0])||(s==null?void 0:s[0]);t=a,i=i.slice(a.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const n=Pr(this.toPosix(t??q.ADAPTER.getBaseUrl())),s=Pr(this.toPosix(e??this.rootname(n)));return Ke(i),i=this.toPosix(i),i.startsWith("/")?ce.join(s,i.slice(1)):this.isAbsolute(i)?i:this.join(n,i)},normalize(i){if(i=this.toPosix(i),Ke(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const n=i.endsWith("/");return i=ib(i,!1),i.length>0&&n&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return Ke(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const n=i[e];if(Ke(n),n.length>0)if(t===void 0)t=n;else{const s=i[e-1]??"";this.extname(s)?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(Ke(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let n=-1,s=!0;const a=this.getProtocol(i),h=i;i=i.slice(a.length);for(let l=i.length-1;l>=1;--l)if(t=i.charCodeAt(l),t===47){if(!s){n=l;break}}else s=!1;return n===-1?e?"/":this.isUrl(h)?a+i:a:e&&n===1?"//":a+i.slice(0,n)},rootname(i){Ke(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){Ke(i),t&&Ke(t),i=Pr(this.toPosix(i));let e=0,n=-1,s=!0,a;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let h=t.length-1,l=-1;for(a=i.length-1;a>=0;--a){const c=i.charCodeAt(a);if(c===47){if(!s){e=a+1;break}}else l===-1&&(s=!1,l=a+1),h>=0&&(c===t.charCodeAt(h)?--h===-1&&(n=a):(h=-1,n=l))}return e===n?n=l:n===-1&&(n=i.length),i.slice(e,n)}for(a=i.length-1;a>=0;--a)if(i.charCodeAt(a)===47){if(!s){e=a+1;break}}else n===-1&&(s=!1,n=a+1);return n===-1?"":i.slice(e,n)},extname(i){Ke(i),i=Pr(this.toPosix(i));let t=-1,e=0,n=-1,s=!0,a=0;for(let h=i.length-1;h>=0;--h){const l=i.charCodeAt(h);if(l===47){if(!s){e=h+1;break}continue}n===-1&&(s=!1,n=h+1),l===46?t===-1?t=h:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||n===-1||a===0||a===1&&t===n-1&&t===e+1?"":i.slice(t,n)},parse(i){Ke(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=Pr(this.toPosix(i));let e=i.charCodeAt(0);const n=this.isAbsolute(i);let s;t.root=this.rootname(i),n||this.hasProtocol(i)?s=1:s=0;let a=-1,h=0,l=-1,c=!0,f=i.length-1,d=0;for(;f>=s;--f){if(e=i.charCodeAt(f),e===47){if(!c){h=f+1;break}continue}l===-1&&(c=!1,l=f+1),e===46?a===-1?a=f:d!==1&&(d=1):a!==-1&&(d=-1)}return a===-1||l===-1||d===0||d===1&&a===l-1&&a===h+1?l!==-1&&(h===0&&n?t.base=t.name=i.slice(1,l):t.base=t.name=i.slice(h,l)):(h===0&&n?(t.name=i.slice(1,a),t.base=i.slice(1,l)):(t.name=i.slice(h,a),t.base=i.slice(h,l)),t.ext=i.slice(a,l)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},vf={};function At(i,t,e=3){if(vf[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(n=n.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(n))),vf[t]=!0}let sh;function nb(){return typeof sh>"u"&&(sh=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const n=q.ADAPTER.createCanvas();let s=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);const a=!!((e=s==null?void 0:s.getContextAttributes())!=null&&e.stencil);if(s){const h=s.getExtension("WEBGL_lose_context");h&&h.loseContext()}return s=null,a}catch{return!1}}()),sh}var rb="#f0f8ff",sb="#faebd7",ob="#00ffff",ab="#7fffd4",hb="#f0ffff",lb="#f5f5dc",ub="#ffe4c4",cb="#000000",fb="#ffebcd",db="#0000ff",pb="#8a2be2",gb="#a52a2a",mb="#deb887",_b="#5f9ea0",vb="#7fff00",xb="#d2691e",yb="#ff7f50",bb="#6495ed",wb="#fff8dc",Tb="#dc143c",Eb="#00ffff",Ab="#00008b",Sb="#008b8b",Cb="#b8860b",Ib="#a9a9a9",Rb="#006400",Pb="#a9a9a9",Mb="#bdb76b",Db="#8b008b",Bb="#556b2f",Fb="#ff8c00",Lb="#9932cc",Ob="#8b0000",Nb="#e9967a",Ub="#8fbc8f",kb="#483d8b",Gb="#2f4f4f",Hb="#2f4f4f",Wb="#00ced1",Xb="#9400d3",zb="#ff1493",$b="#00bfff",Vb="#696969",Yb="#696969",jb="#1e90ff",qb="#b22222",Kb="#fffaf0",Zb="#228b22",Jb="#ff00ff",Qb="#dcdcdc",tw="#f8f8ff",ew="#daa520",iw="#ffd700",nw="#808080",rw="#008000",sw="#adff2f",ow="#808080",aw="#f0fff0",hw="#ff69b4",lw="#cd5c5c",uw="#4b0082",cw="#fffff0",fw="#f0e68c",dw="#fff0f5",pw="#e6e6fa",gw="#7cfc00",mw="#fffacd",_w="#add8e6",vw="#f08080",xw="#e0ffff",yw="#fafad2",bw="#d3d3d3",ww="#90ee90",Tw="#d3d3d3",Ew="#ffb6c1",Aw="#ffa07a",Sw="#20b2aa",Cw="#87cefa",Iw="#778899",Rw="#778899",Pw="#b0c4de",Mw="#ffffe0",Dw="#00ff00",Bw="#32cd32",Fw="#faf0e6",Lw="#ff00ff",Ow="#800000",Nw="#66cdaa",Uw="#0000cd",kw="#ba55d3",Gw="#9370db",Hw="#3cb371",Ww="#7b68ee",Xw="#00fa9a",zw="#48d1cc",$w="#c71585",Vw="#191970",Yw="#f5fffa",jw="#ffe4e1",qw="#ffe4b5",Kw="#ffdead",Zw="#000080",Jw="#fdf5e6",Qw="#808000",tT="#6b8e23",eT="#ffa500",iT="#ff4500",nT="#da70d6",rT="#eee8aa",sT="#98fb98",oT="#afeeee",aT="#db7093",hT="#ffefd5",lT="#ffdab9",uT="#cd853f",cT="#ffc0cb",fT="#dda0dd",dT="#b0e0e6",pT="#800080",gT="#663399",mT="#ff0000",_T="#bc8f8f",vT="#4169e1",xT="#8b4513",yT="#fa8072",bT="#f4a460",wT="#2e8b57",TT="#fff5ee",ET="#a0522d",AT="#c0c0c0",ST="#87ceeb",CT="#6a5acd",IT="#708090",RT="#708090",PT="#fffafa",MT="#00ff7f",DT="#4682b4",BT="#d2b48c",FT="#008080",LT="#d8bfd8",OT="#ff6347",NT="#40e0d0",UT="#ee82ee",kT="#f5deb3",GT="#ffffff",HT="#f5f5f5",WT="#ffff00",XT="#9acd32",zT={aliceblue:rb,antiquewhite:sb,aqua:ob,aquamarine:ab,azure:hb,beige:lb,bisque:ub,black:cb,blanchedalmond:fb,blue:db,blueviolet:pb,brown:gb,burlywood:mb,cadetblue:_b,chartreuse:vb,chocolate:xb,coral:yb,cornflowerblue:bb,cornsilk:wb,crimson:Tb,cyan:Eb,darkblue:Ab,darkcyan:Sb,darkgoldenrod:Cb,darkgray:Ib,darkgreen:Rb,darkgrey:Pb,darkkhaki:Mb,darkmagenta:Db,darkolivegreen:Bb,darkorange:Fb,darkorchid:Lb,darkred:Ob,darksalmon:Nb,darkseagreen:Ub,darkslateblue:kb,darkslategray:Gb,darkslategrey:Hb,darkturquoise:Wb,darkviolet:Xb,deeppink:zb,deepskyblue:$b,dimgray:Vb,dimgrey:Yb,dodgerblue:jb,firebrick:qb,floralwhite:Kb,forestgreen:Zb,fuchsia:Jb,gainsboro:Qb,ghostwhite:tw,goldenrod:ew,gold:iw,gray:nw,green:rw,greenyellow:sw,grey:ow,honeydew:aw,hotpink:hw,indianred:lw,indigo:uw,ivory:cw,khaki:fw,lavenderblush:dw,lavender:pw,lawngreen:gw,lemonchiffon:mw,lightblue:_w,lightcoral:vw,lightcyan:xw,lightgoldenrodyellow:yw,lightgray:bw,lightgreen:ww,lightgrey:Tw,lightpink:Ew,lightsalmon:Aw,lightseagreen:Sw,lightskyblue:Cw,lightslategray:Iw,lightslategrey:Rw,lightsteelblue:Pw,lightyellow:Mw,lime:Dw,limegreen:Bw,linen:Fw,magenta:Lw,maroon:Ow,mediumaquamarine:Nw,mediumblue:Uw,mediumorchid:kw,mediumpurple:Gw,mediumseagreen:Hw,mediumslateblue:Ww,mediumspringgreen:Xw,mediumturquoise:zw,mediumvioletred:$w,midnightblue:Vw,mintcream:Yw,mistyrose:jw,moccasin:qw,navajowhite:Kw,navy:Zw,oldlace:Jw,olive:Qw,olivedrab:tT,orange:eT,orangered:iT,orchid:nT,palegoldenrod:rT,palegreen:sT,paleturquoise:oT,palevioletred:aT,papayawhip:hT,peachpuff:lT,peru:uT,pink:cT,plum:fT,powderblue:dT,purple:pT,rebeccapurple:gT,red:mT,rosybrown:_T,royalblue:vT,saddlebrown:xT,salmon:yT,sandybrown:bT,seagreen:wT,seashell:TT,sienna:ET,silver:AT,skyblue:ST,slateblue:CT,slategray:IT,slategrey:RT,snow:PT,springgreen:MT,steelblue:DT,tan:BT,teal:FT,thistle:LT,tomato:OT,turquoise:NT,violet:UT,wheat:kT,white:GT,whitesmoke:HT,yellow:WT,yellowgreen:XT};function Xr(i,t=[]){return t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,t}function pd(i){let t=i.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function ll(i){if(typeof i=="string"&&(i=zT[i.toLowerCase()]||i,i[0]==="#"&&(i=i.slice(1)),i.length===3)){const[t,e,n]=i;i=t+t+e+e+n+n}return parseInt(i,16)}function $T(){const i=[],t=[];for(let n=0;n<32;n++)i[n]=n,t[n]=n;i[lt.NORMAL_NPM]=lt.NORMAL,i[lt.ADD_NPM]=lt.ADD,i[lt.SCREEN_NPM]=lt.SCREEN,t[lt.NORMAL]=lt.NORMAL_NPM,t[lt.ADD]=lt.ADD_NPM,t[lt.SCREEN]=lt.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const gd=$T();function md(i,t){return gd[t?1:0][i]}function VT(i,t,e,n){return e=e||new Float32Array(4),n||n===void 0?(e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t):(e[0]=i[0],e[1]=i[1],e[2]=i[2]),e[3]=t,e}function ul(i,t){if(t===1)return(t*255<<24)+i;if(t===0)return 0;let e=i>>16&255,n=i>>8&255,s=i&255;return e=e*t+.5|0,n=n*t+.5|0,s=s*t+.5|0,(t*255<<24)+(e<<16)+(n<<8)+s}function _d(i,t,e,n){return e=e||new Float32Array(4),e[0]=(i>>16&255)/255,e[1]=(i>>8&255)/255,e[2]=(i&255)/255,(n||n===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function YT(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let n=0,s=0;n<e;n+=6,s+=4)t[n+0]=s+0,t[n+1]=s+1,t[n+2]=s+2,t[n+3]=s+0,t[n+4]=s+2,t[n+5]=s+3;return t}function vd(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function go(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function xf(i){return!(i&i-1)&&!!i}function yf(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function nr(i,t,e){const n=i.length;let s;if(t>=n||e===0)return;e=t+e>n?n-t:e;const a=n-e;for(s=t;s<a;++s)i[s]=i[s+e];i.length=a}function Qn(i){return i===0?0:i<0?-1:1}let jT=0;function An(){return++jT}const xd=class{constructor(i,t,e,n){this.left=i,this.top=t,this.right=e,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Uh=xd;Uh.EMPTY=new xd(0,0,0,0);const bf={},fi=Object.create(null),Vi=Object.create(null);class wf{constructor(t,e,n){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||q.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Tf(i,t,e){for(let n=0,s=4*e*t;n<t;++n,s+=4)if(i[s+3]!==0)return!1;return!0}function Ef(i,t,e,n,s){const a=4*t;for(let h=n,l=n*a+4*e;h<=s;++h,l+=a)if(i[l+3]!==0)return!1;return!0}function qT(i){const{width:t,height:e}=i,n=i.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const a=n.getImageData(0,0,t,e).data;let h=0,l=0,c=t-1,f=e-1;for(;l<e&&Tf(a,t,l);)++l;if(l===e)return Uh.EMPTY;for(;Tf(a,t,f);)--f;for(;Ef(a,t,h,l,f);)++h;for(;Ef(a,t,c,l,f);)--c;return++c,++f,new Uh(h,l,c,f)}function KT(i){const t=qT(i),{width:e,height:n}=t;let s=null;if(!t.isEmpty()){const a=i.getContext("2d");if(a===null)throw new TypeError("Failed to get canvas 2D context");s=a.getImageData(t.left,t.top,e,n)}return{width:e,height:n,data:s}}let Xs;function ZT(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,Xs||(Xs=document.createElement("a")),Xs.href=i;const e=Q1.parse(Xs.href),n=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!n||e.protocol!==t.protocol?"anonymous":""}function Zi(i,t=1){var n;const e=(n=q.RETINA_PREFIX)==null?void 0:n.exec(i);return e?parseFloat(e[1]):t}var j=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(j||{});const kh=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Af=(i,t)=>kh(i).priority??t,nt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(kh).forEach(t=>{t.type.forEach(e=>{var n,s;return(s=(n=this._removeHandlers)[e])==null?void 0:s.call(n,t)})}),this},add(...i){return i.map(kh).forEach(t=>{t.type.forEach(e=>{const n=this._addHandlers,s=this._queue;n[e]?n[e](t):(s[e]=s[e]||[],s[e].push(t))})}),this},handle(i,t,e){const n=this._addHandlers,s=this._removeHandlers;if(n[i]||s[i])throw new Error(`Extension type ${i} already has a handler`);n[i]=t,s[i]=e;const a=this._queue;return a[i]&&(a[i].forEach(h=>t(h)),delete a[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((s,a)=>Af(a,e)-Af(s,e)))},n=>{const s=t.indexOf(n.ref);s!==-1&&t.splice(s,1)})}};class Gh{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const JT=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function QT(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function tE(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=JT.replace(/%forloop%/gi,QT(i));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const oh=0,ah=1,hh=2,lh=3,uh=4,ch=5;class Oi{constructor(){this.data=0,this.blendMode=lt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<oh)}set blend(t){!!(this.data&1<<oh)!==t&&(this.data^=1<<oh)}get offsets(){return!!(this.data&1<<ah)}set offsets(t){!!(this.data&1<<ah)!==t&&(this.data^=1<<ah)}get culling(){return!!(this.data&1<<hh)}set culling(t){!!(this.data&1<<hh)!==t&&(this.data^=1<<hh)}get depthTest(){return!!(this.data&1<<lh)}set depthTest(t){!!(this.data&1<<lh)!==t&&(this.data^=1<<lh)}get depthMask(){return!!(this.data&1<<ch)}set depthMask(t){!!(this.data&1<<ch)!==t&&(this.data^=1<<ch)}get clockwiseFrontFace(){return!!(this.data&1<<uh)}set clockwiseFrontFace(t){!!(this.data&1<<uh)!==t&&(this.data^=1<<uh)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==lt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Oi;return t.depthTest=!1,t.blend=!0,t}}const Hh=[];function yd(i,t){if(!i)return null;let e="";if(typeof i=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);n&&(e=n[1].toLowerCase())}for(let n=Hh.length-1;n>=0;--n){const s=Hh[n];if(s.test&&s.test(i,e))return new s(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class si{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,s,a,h,l,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:f,items:d}=this;this._aliasCount++;for(let g=0,m=d.length;g<m;g++)d[g][f](t,e,n,s,a,h,l,c);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(si.prototype,{dispatch:{value:si.prototype.emit},run:{value:si.prototype.emit}});class zr{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new si("setRealSize"),this.onUpdate=new si("update"),this.onError=new si("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class qr extends zr{constructor(t,e){const{width:n,height:s}=e||{};if(!n||!s)throw new Error("BufferResource width or height invalid");super(n,s),this.data=t}upload(t,e,n){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ai.UNPACK);const a=e.realWidth,h=e.realHeight;return n.width===a&&n.height===h?s.texSubImage2D(e.target,0,0,0,a,h,e.format,n.type,this.data):(n.width=a,n.height=h,s.texImage2D(e.target,0,n.internalFormat,a,h,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const eE={scaleMode:Di.NEAREST,format:X.RGBA,alphaMode:ai.NPM},Yn=class extends jr{constructor(i=null,t=null){super(),t=Object.assign({},Yn.defaultOptions,t);const{alphaMode:e,mipmap:n,anisotropicLevel:s,scaleMode:a,width:h,height:l,wrapMode:c,format:f,type:d,target:g,resolution:m,resourceOptions:v}=t;i&&!(i instanceof zr)&&(i=yd(i,v),i.internal=!0),this.resolution=m||q.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=s,this._wrapMode=c,this._scaleMode=a,this.format=f,this.type=d,this.target=g,this.alphaMode=e,this.uid=An(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=xf(this.realWidth)&&xf(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Vi[this.cacheId],delete fi[this.cacheId],this.cacheId=null),this.dispose(),Yn.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=q.STRICT_TEXTURE_CACHE){const n=typeof i=="string";let s=null;if(n)s=i;else{if(!i._pixiId){const h=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${h}_${An()}`}s=i._pixiId}let a=Vi[s];if(n&&e&&!a)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return a||(a=new Yn(i,t),a.cacheId=s,Yn.addToCache(a,s)),a}static fromBuffer(i,t,e,n){i=i||new Float32Array(t*e*4);const s=new qr(i,{width:t,height:e}),a=i instanceof Float32Array?st.FLOAT:st.UNSIGNED_BYTE;return new Yn(s,Object.assign({},eE,n||{width:t,height:e,type:a}))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),Vi[t]&&Vi[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Vi[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=Vi[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete Vi[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete Vi[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let ft=Yn;ft.defaultOptions={mipmap:xi.POW2,anisotropicLevel:0,scaleMode:Di.LINEAR,wrapMode:Ki.CLAMP,alphaMode:ai.UNPACK,target:er.TEXTURE_2D,format:X.RGBA,type:st.UNSIGNED_BYTE};ft._globalBatch=0;class Wh{constructor(){this.texArray=null,this.blend=0,this.type=gi.TRIANGLES,this.start=0,this.size=0,this.data=null}}let iE=0;class Zt{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=iE++,this.disposeRunner=new si("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?mi.ELEMENT_ARRAY_BUFFER:mi.ARRAY_BUFFER}get index(){return this.type===mi.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Zt(t)}}class mo{constructor(t,e=0,n=!1,s=st.FLOAT,a,h,l,c=1){this.buffer=t,this.size=e,this.normalized=n,this.type=s,this.stride=a,this.start=h,this.instance=l,this.divisor=c}destroy(){this.buffer=null}static from(t,e,n,s,a){return new mo(t,e,n,s,a)}}const nE={Float32Array,Uint32Array,Int32Array,Uint8Array};function rE(i,t){let e=0,n=0;const s={};for(let c=0;c<i.length;c++)n+=t[c],e+=i[c].length;const a=new ArrayBuffer(e*4);let h=null,l=0;for(let c=0;c<i.length;c++){const f=t[c],d=i[c],g=vd(d);s[g]||(s[g]=new nE[g](a)),h=s[g];for(let m=0;m<d.length;m++){const v=(m/f|0)*n+l,x=m%f;h[v+x]=d[m]}l+=f}return new Float32Array(a)}const Sf={5126:4,5123:2,5121:1};let sE=0;const oE={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ji{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=sE++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new si("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,s=!1,a,h,l,c=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Zt||(e instanceof Array&&(e=new Float32Array(e)),e=new Zt(e));const f=t.split("|");if(f.length>1){for(let g=0;g<f.length;g++)this.addAttribute(f[g],e,n,s,a);return this}let d=this.buffers.indexOf(e);return d===-1&&(this.buffers.push(e),d=this.buffers.length-1),this.attributes[t]=new mo(d,n,s,a,h,l,c),this.instanced=this.instanced||c,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Zt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Zt(t)),t.type=mi.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],n=new Zt;let s;for(s in this.attributes){const a=this.attributes[s],h=this.buffers[a.buffer];t.push(h.data),e.push(a.size*Sf[a.type]/4),a.buffer=0}for(n.data=rE(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Ji;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Zt(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new mo(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=mi.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Ji,n=[],s=[],a=[];let h;for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)s[c]=s[c]||0,s[c]+=h.buffers[c].data.length,a[c]=0}for(let l=0;l<h.buffers.length;l++)n[l]=new oE[vd(h.buffers[l].data)](s[l]),e.buffers[l]=new Zt(n[l]);for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)n[c].set(h.buffers[c].data,a[c]),a[c]+=h.buffers[c].data.length}if(e.attributes=h.attributes,h.indexBuffer){e.indexBuffer=e.buffers[h.buffers.indexOf(h.indexBuffer)],e.indexBuffer.type=mi.ELEMENT_ARRAY_BUFFER;let l=0,c=0,f=0,d=0;for(let g=0;g<h.buffers.length;g++)if(h.buffers[g]!==h.indexBuffer){d=g;break}for(const g in h.attributes){const m=h.attributes[g];(m.buffer|0)===d&&(c+=m.size*Sf[m.type]/4)}for(let g=0;g<t.length;g++){const m=t[g].indexBuffer.data;for(let v=0;v<m.length;v++)e.indexBuffer.data[v+f]+=l;l+=t[g].buffers[d].data.length/c,f+=m.length}}return e}}class bd extends Ji{constructor(t=!1){super(),this._buffer=new Zt(null,t,!1),this._indexBuffer=new Zt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,st.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,st.FLOAT).addAttribute("aColor",this._buffer,4,!0,st.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,st.FLOAT).addIndex(this._indexBuffer)}}const _o=Math.PI*2,aE=180/Math.PI,hE=Math.PI/180;var ue=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(ue||{});class Et{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Et(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const zs=[new Et,new Et,new Et,new Et];class wt{constructor(t=0,e=0,n=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(s),this.type=ue.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new wt(0,0,0,0)}clone(){return new wt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const k=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=k)return!1;const rt=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>rt}const n=this.left,s=this.right,a=this.top,h=this.bottom;if(s<=n||h<=a)return!1;const l=zs[0].set(t.left,t.top),c=zs[1].set(t.left,t.bottom),f=zs[2].set(t.right,t.top),d=zs[3].set(t.right,t.bottom);if(f.x<=l.x||c.y<=l.y)return!1;const g=Math.sign(e.a*e.d-e.b*e.c);if(g===0||(e.apply(l,l),e.apply(c,c),e.apply(f,f),e.apply(d,d),Math.max(l.x,c.x,f.x,d.x)<=n||Math.min(l.x,c.x,f.x,d.x)>=s||Math.max(l.y,c.y,f.y,d.y)<=a||Math.min(l.y,c.y,f.y,d.y)>=h))return!1;const m=g*(c.y-l.y),v=g*(l.x-c.x),x=m*n+v*a,A=m*s+v*a,T=m*n+v*h,R=m*s+v*h;if(Math.max(x,A,T,R)<=m*l.x+v*l.y||Math.min(x,A,T,R)>=m*d.x+v*d.y)return!1;const M=g*(l.y-f.y),E=g*(f.x-l.x),P=M*n+E*a,U=M*s+E*a,z=M*n+E*h,G=M*s+E*h;return!(Math.max(P,U,z,G)<=M*l.x+E*l.y||Math.min(P,U,z,G)>=M*d.x+E*d.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),a=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=s,this.height=Math.max(a-s,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),a=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=s,this.height=a-s,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class cl{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=ue.CIRC}clone(){return new cl(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let s=this.x-t,a=this.y-e;return s*=s,a*=a,s+a<=n}getBounds(){return new wt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class fl{constructor(t=0,e=0,n=0,s=0){this.x=t,this.y=e,this.width=n,this.height=s,this.type=ue.ELIP}clone(){return new fl(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,s=(e-this.y)/this.height;return n*=n,s*=s,n+s<=1}getBounds(){return new wt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class rr{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let s=0,a=e.length;s<a;s++)n.push(e[s].x,e[s].y);e=n}this.points=e,this.type=ue.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new rr(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const s=this.points.length/2;for(let a=0,h=s-1;a<s;h=a++){const l=this.points[a*2],c=this.points[a*2+1],f=this.points[h*2],d=this.points[h*2+1];c>e!=d>e&&t<(f-l)*((e-c)/(d-c))+l&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class dl{constructor(t=0,e=0,n=0,s=0,a=20){this.x=t,this.y=e,this.width=n,this.height=s,this.radius=a,this.type=ue.RREC}clone(){return new dl(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let s=t-(this.x+n),a=e-(this.y+n);const h=n*n;if(s*s+a*a<=h||(s=t-(this.x+this.width-n),s*s+a*a<=h)||(a=e-(this.y+this.height-n),s*s+a*a<=h)||(s=t-(this.x+n),s*s+a*a<=h))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Gt{constructor(t=1,e=0,n=0,s=1,a=0,h=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=s,this.tx=a,this.ty=h}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,s,a,h){return this.a=t,this.b=e,this.c=n,this.d=s,this.tx=a,this.ty=h,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new Et;const n=t.x,s=t.y;return e.x=this.a*n+this.c*s+this.tx,e.y=this.b*n+this.d*s+this.ty,e}applyInverse(t,e){e=e||new Et;const n=1/(this.a*this.d+this.c*-this.b),s=t.x,a=t.y;return e.x=this.d*n*s+-this.c*n*a+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*a+-this.b*n*s+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),s=this.a,a=this.c,h=this.tx;return this.a=s*e-this.b*n,this.b=s*n+this.b*e,this.c=a*e-this.d*n,this.d=a*n+this.d*e,this.tx=h*e-this.ty*n,this.ty=h*n+this.ty*e,this}append(t){const e=this.a,n=this.b,s=this.c,a=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*n+t.b*a,this.c=t.c*e+t.d*s,this.d=t.c*n+t.d*a,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*n+t.ty*a+this.ty,this}setTransform(t,e,n,s,a,h,l,c,f){return this.a=Math.cos(l+f)*a,this.b=Math.sin(l+f)*a,this.c=-Math.sin(l-c)*h,this.d=Math.cos(l-c)*h,this.tx=t-(n*this.a+s*this.c),this.ty=e-(n*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,s=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,s=this.c,a=this.d,h=t.pivot,l=-Math.atan2(-s,a),c=Math.atan2(n,e),f=Math.abs(l+c);return f<1e-5||Math.abs(_o-f)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=c),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(s*s+a*a),t.position.x=this.tx+(h.x*e+h.y*s),t.position.y=this.ty+(h.x*n+h.y*a),t}invert(){const t=this.a,e=this.b,n=this.c,s=this.d,a=this.tx,h=t*s-e*n;return this.a=s/h,this.b=-e/h,this.c=-n/h,this.d=t/h,this.tx=(n*this.ty-s*a)/h,this.ty=-(t*this.ty-e*a)/h,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Gt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Gt}static get TEMP_MATRIX(){return new Gt}}const gn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],mn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],_n=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],vn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Xh=[],wd=[],$s=Math.sign;function lE(){for(let i=0;i<16;i++){const t=[];Xh.push(t);for(let e=0;e<16;e++){const n=$s(gn[i]*gn[e]+_n[i]*mn[e]),s=$s(mn[i]*gn[e]+vn[i]*mn[e]),a=$s(gn[i]*_n[e]+_n[i]*vn[e]),h=$s(mn[i]*_n[e]+vn[i]*vn[e]);for(let l=0;l<16;l++)if(gn[l]===n&&mn[l]===s&&_n[l]===a&&vn[l]===h){t.push(l);break}}}for(let i=0;i<16;i++){const t=new Gt;t.set(gn[i],mn[i],_n[i],vn[i],0,0),wd.push(t)}}lE();const Wt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>gn[i],uY:i=>mn[i],vX:i=>_n[i],vY:i=>vn[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Xh[i][t],sub:(i,t)=>Xh[i][Wt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?Wt.S:Wt.N:Math.abs(t)*2<=Math.abs(i)?i>0?Wt.E:Wt.W:t>0?i>0?Wt.SE:Wt.SW:i>0?Wt.NE:Wt.NW,matrixAppendRotationInv:(i,t,e=0,n=0)=>{const s=wd[Wt.inv(t)];s.tx=e,s.ty=n,i.append(s)}};class qi{constructor(t,e,n=0,s=0){this._x=n,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new qi(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const Td=class{constructor(){this.worldTransform=new Gt,this.localTransform=new Gt,this.position=new qi(this.onChange,this,0,0),this.scale=new qi(this.onChange,this,1,1),this.pivot=new qi(this.onChange,this,0,0),this.skew=new qi(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,n=this.worldTransform;n.a=t.a*e.a+t.b*e.c,n.b=t.a*e.b+t.b*e.d,n.c=t.c*e.a+t.d*e.c,n.d=t.c*e.b+t.d*e.d,n.tx=t.tx*e.a+t.ty*e.c+e.tx,n.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let pl=Td;pl.IDENTITY=new Td;var uE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,cE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Cf(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}function fh(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Ed(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return fh(2*t);case"bvec3":return fh(3*t);case"bvec4":return fh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const sr=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],fE={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},dE={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function pE(i,t){var n;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in i.uniforms){const a=t[s];if(!a){(n=i.uniforms[s])!=null&&n.group&&(i.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const h=i.uniforms[s];let l=!1;for(let c=0;c<sr.length;c++)if(sr[c].test(a,h)){e.push(sr[c].code(s,h)),l=!0;break}if(!l){const f=(a.size===1&&!a.isArray?fE:dE)[a.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Ad={};let $n=Ad;function gE(){if($n===Ad||$n!=null&&$n.isContextLost()){const i=q.ADAPTER.createCanvas();let t;q.PREFER_ENV>=Cn.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),$n=t}return $n}let Vs;function mE(){if(!Vs){Vs=ze.MEDIUM;const i=gE();i&&i.getShaderPrecisionFormat&&(Vs=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?ze.HIGH:ze.MEDIUM)}return Vs}function If(i,t){const e=i.getShaderSource(t).split(`
`).map((f,d)=>`${d}: ${f}`),n=i.getShaderInfoLog(t),s=n.split(`
`),a={},h=s.map(f=>parseFloat(f.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(f=>f&&!a[f]?(a[f]=!0,!0):!1),l=[""];h.forEach(f=>{e[f-1]=`%c${e[f-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=e.join(`
`);l[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function _E(i,t,e,n){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||If(i,e),i.getShaderParameter(n,i.COMPILE_STATUS)||If(i,n),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const vE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Sd(i){return vE[i]}let Ys=null;const Rf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Cd(i,t){if(!Ys){const e=Object.keys(Rf);Ys={};for(let n=0;n<e.length;++n){const s=e[n];Ys[i[s]]=Rf[s]}}return Ys[t]}function Pf(i,t,e){if(i.substring(0,9)!=="precision"){let n=t;return t===ze.HIGH&&e!==ze.HIGH&&(n=ze.MEDIUM),`precision ${n} float;
${i}`}else if(e!==ze.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Mr;function xE(){if(typeof Mr=="boolean")return Mr;try{Mr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Mr=!1}return Mr}let yE=0;const js={},jn=class{constructor(i,t,e="pixi-shader",n={}){this.extra={},this.id=yE++,this.vertexSrc=i||jn.defaultVertexSrc,this.fragmentSrc=t||jn.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),js[e]?(js[e]++,e+=`-${js[e]}`):js[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=Pf(this.vertexSrc,jn.defaultVertexPrecision,ze.HIGH),this.fragmentSrc=Pf(this.fragmentSrc,jn.defaultFragmentPrecision,mE())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return cE}static get defaultFragmentSrc(){return uE}static from(i,t,e){const n=i+t;let s=bf[n];return s||(bf[n]=s=new jn(i,t,e)),s}};let ni=jn;ni.defaultVertexPrecision=ze.HIGH;ni.defaultFragmentPrecision=Bi.apple.device?ze.HIGH:ze.MEDIUM;let bE=0;class oi{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=bE++,this.static=!!e,this.ubo=!!n,t instanceof Zt?(this.buffer=t,this.buffer.type=mi.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Zt(new Float32Array(1)),this.buffer.type=mi.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(!this.ubo)this.uniforms[t]=new oi(e,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,n){return new oi(t,e,n)}static uboFrom(t,e){return new oi(t,e??!0,!0)}}class _i{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof oi?this.uniformGroup=e:this.uniformGroup=new oi(e):this.uniformGroup=new oi({}),this.disposeRunner=new si("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const s=e.uniforms[n];if(s.group&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const s=ni.from(t,e);return new _i(s,n)}}class wE{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const n=new Int32Array(t);for(let a=0;a<t;a++)n[a]=a;this.defaultGroupCache[t]=oi.from({uSamplers:n},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ni(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Gt,default:this.defaultGroupCache[t]};return new _i(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let n=0;n<t;n++)n>0&&(e+=`
else `),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class zh{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function TE(){return!Bi.apple.device}function EE(i){let t=!0;const e=q.ADAPTER.getNavigator();if(Bi.tablet||Bi.phone){if(Bi.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if(Bi.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?i:4}class Po{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var AE=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,SE=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Je=class extends Po{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=bd,this.vertexSize=6,this.state=Oi.for2d(),this.size=Je.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??EE(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??TE(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return At("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return SE}static get defaultFragmentTemplate(){return AE}setShaderGenerator({vertex:i=Je.defaultVertexSrc,fragment:t=Je.defaultFragmentTemplate}={}){this.shaderGenerator=new wE(i,t)}contextChange(){const i=this.renderer.gl;q.PREFER_ENV===Cn.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),Je.defaultMaxTextures),this.maxTextures=tE(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=Je,e=this.size/4,n=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new Wh);for(;t.length<n;)t.push(new zh);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=Je._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,a=this.renderer.textureGC.count;let h=++ft._globalBatch,l=0,c=e[0],f=0;n.copyBoundTextures(s,t);for(let d=0;d<this._bufferSize;++d){const g=i[d];i[d]=null,g._batchEnabled!==h&&(c.count>=t&&(n.boundArray(c,s,h,t),this.buildDrawCalls(c,f,d),f=d,c=e[++l],++h),g._batchEnabled=h,g.touched=a,c.elements[c.count++]=g)}c.count>0&&(n.boundArray(c,s,h,t),this.buildDrawCalls(c,f,this._bufferSize),++l,++h);for(let d=0;d<s.length;d++)s[d]=null;ft._globalBatch=h}buildDrawCalls(i,t,e){const{_bufferedElements:n,_attributeBuffer:s,_indexBuffer:a,vertexSize:h}=this,l=Je._drawCallPool;let c=this._dcIndex,f=this._aIndex,d=this._iIndex,g=l[c];g.start=this._iIndex,g.texArray=i;for(let m=t;m<e;++m){const v=n[m],x=v._texture.baseTexture,A=gd[x.alphaMode?1:0][v.blendMode];n[m]=null,t<m&&g.blend!==A&&(g.size=d-g.start,t=m,g=l[++c],g.texArray=i,g.start=d),this.packInterleavedGeometry(v,s,a,f,d),f+=v.vertexData.length/2*h,d+=v.indices.length,g.blend=A}t<e&&(g.size=d-g.start,++c),this._dcIndex=c,this._aIndex=f,this._iIndex=d}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;Je.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,n=Je._drawCallPool;let s=null;for(let a=0;a<i;a++){const{texArray:h,type:l,size:c,start:f,blend:d}=n[a];s!==h&&(s=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,e.set(this.state),t.drawElements(l,c,t.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Je.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=go(Math.ceil(i/8)),e=yf(t),n=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let s=this._aBuffers[n];return s||(this._aBuffers[n]=s=new Gh(n*this.vertexSize*4)),s}getIndexBuffer(i){const t=go(Math.ceil(i/12)),e=yf(t),n=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let s=this._iBuffers[e];return s||(this._iBuffers[e]=s=new Uint16Array(n)),s}packInterleavedGeometry(i,t,e,n,s){const{uint32View:a,float32View:h}=t,l=n/this.vertexSize,c=i.uvs,f=i.indices,d=i.vertexData,g=i._texture.baseTexture._batchLocation,m=Math.min(i.worldAlpha,1),v=m<1&&i._texture.baseTexture.alphaMode?ul(i._tintRGB,m):i._tintRGB+(m*255<<24);for(let x=0;x<d.length;x+=2)h[n++]=d[x],h[n++]=d[x+1],h[n++]=c[x],h[n++]=c[x+1],a[n++]=v,h[n++]=g;for(let x=0;x<f.length;x++)e[s++]=l+f[x]}};let ei=Je;ei.defaultBatchSize=4096;ei.extension={name:"batch",type:j.RendererPlugin};ei._drawCallPool=[];ei._textureArrayPool=[];nt.add(ei);var CE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,IE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Lr=class extends _i{constructor(i,t,e){const n=ni.from(i||Lr.defaultVertexSrc,t||Lr.defaultFragmentSrc);super(n,e),this.padding=0,this.resolution=Lr.defaultResolution,this.multisample=Lr.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Oi}apply(i,t,e,n,s){i.applyFilter(this,t,e,n)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return IE}static get defaultFragmentSrc(){return CE}};let ve=Lr;ve.defaultResolution=1;ve.defaultMultisample=te.NONE;class Id{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?ll(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=pd(t),Xr(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Id.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"background"};nt.add(Id);class Rd{constructor(t){this.renderer=t,this.emptyRenderer=new Po(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=n[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,n,s){const{elements:a,ids:h,count:l}=t;let c=0;for(let f=0;f<l;f++){const d=a[f],g=d._batchLocation;if(g>=0&&g<s&&e[g]===d){h[f]=g;continue}for(;c<s;){const m=e[c];if(m&&m._batchEnabled===n&&m._batchLocation===c){c++;continue}h[f]=c,d._batchLocation=c,e[c]=d;break}}}destroy(){this.renderer=null}}Rd.extension={type:j.RendererSystem,name:"batch"};nt.add(Rd);let Mf=0;class Pd{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Mf++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Mf++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(q.PREFER_ENV>=Cn.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Pd.extension={type:j.RendererSystem,name:"context"};nt.add(Pd);class RE extends qr{upload(t,e,n){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ai.UNPACK);const a=e.realWidth,h=e.realHeight;return n.width===a&&n.height===h?s.texSubImage2D(e.target,0,0,0,a,h,e.format,n.type,this.data):(n.width=a,n.height=h,s.texImage2D(e.target,0,n.internalFormat,a,h,0,e.format,n.type,this.data)),!0}}class $h{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new si("disposeFramebuffer"),this.multisample=te.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new ft(null,{scaleMode:Di.NEAREST,resolution:1,mipmap:xi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ft(new RE(null,{width:this.width,height:this.height}),{scaleMode:Di.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:xi.OFF,format:X.DEPTH_COMPONENT,type:st.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const s=this.colorTextures[n],a=s.resolution;s.setSize(t/a,e/a)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Md extends ft{constructor(t={}){if(typeof t=="number"){const e=arguments[0],n=arguments[1],s=arguments[2],a=arguments[3];t={width:e,height:n,scaleMode:s,resolution:a}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=te.NONE),super(null,t),this.mipmap=xi.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new $h(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Qi extends zr{constructor(t){const e=t,n=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;super(n,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){n===void 0&&!e.startsWith("data:")?t.crossOrigin=ZT(e):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")}upload(t,e,n,s){const a=t.gl,h=e.realWidth,l=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1&&s.buffered.length===0)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ai.UNPACK),!this.noSubImage&&e.target===a.TEXTURE_2D&&n.width===h&&n.height===l?a.texSubImage2D(a.TEXTURE_2D,0,0,0,e.format,n.type,s):(n.width=h,n.height=l,a.texImage2D(e.target,0,n.internalFormat,e.format,n.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class Dd extends Qi{constructor(t,e){if(e=e||{},typeof t=="string"){const n=new Image;Qi.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,n)=>{const s=this.source;this.url=s.src;const a=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.resize(s.width,s.height),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?a():(s.onload=a,s.onerror=h=>{n(h),this.onError.emit(h)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ai.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,n){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let s=!0;const a=e._glTextures;for(const h in a){const l=a[h];if(l!==n&&l.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Bd{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const s=e.width,a=e.height;if(n){const h=t.width/2/s,l=t.height/2/a,c=t.x/s+h,f=t.y/a+l;n=Wt.add(n,Wt.NW),this.x0=c+h*Wt.uX(n),this.y0=f+l*Wt.uY(n),n=Wt.add(n,2),this.x1=c+h*Wt.uX(n),this.y1=f+l*Wt.uY(n),n=Wt.add(n,2),this.x2=c+h*Wt.uX(n),this.y2=f+l*Wt.uY(n),n=Wt.add(n,2),this.x3=c+h*Wt.uX(n),this.y3=f+l*Wt.uY(n)}else this.x0=t.x/s,this.y0=t.y/a,this.x1=(t.x+t.width)/s,this.y1=t.y/a,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/a,this.x3=t.x/s,this.y3=(t.y+t.height)/a;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const Df=new Bd;function qs(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class it extends jr{constructor(t,e,n,s,a,h){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new wt(0,0,1,1)),t instanceof it&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this._uvs=Df,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(a||0),a===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=h?new Et(h.x,h.y):new Et(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&fi[e.url]&&it.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,it.removeFromCache(this),this.textureCacheIds=null}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new it(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===Df&&(this._uvs=new Bd),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=q.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let a=null;if(s)a=t;else if(t instanceof ft){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${An()}`,ft.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${An()}`}a=t._pixiId}let h=fi[a];if(s&&n&&!h)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return!h&&!(t instanceof ft)?(e.resolution||(e.resolution=Zi(t)),h=new it(new ft(t,e)),h.baseTexture.cacheId=a,ft.addToCache(h.baseTexture,a),it.addToCache(h,a)):!h&&t instanceof ft&&(h=new it(t),it.addToCache(h,a)),h}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=it.from(t,Object.assign({resourceOptions:n},e),!1),a=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):a.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,n,s){return new it(ft.fromBuffer(t,e,n,s))}static fromLoader(t,e,n,s){const a=new ft(t,Object.assign({scaleMode:q.SCALE_MODE,resolution:Zi(e)},s)),{resource:h}=a;h instanceof Dd&&(h.url=e);const l=new it(a);return n||(n=e),ft.addToCache(l.baseTexture,n),it.addToCache(l,n),n!==e&&(ft.addToCache(l.baseTexture,e),it.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(c=>{l.baseTexture.once("loaded",()=>c(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),fi[e]&&fi[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),fi[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=fi[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete fi[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)fi[t.textureCacheIds[e]]===t&&delete fi[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:s,height:a}=t,h=e+s>this.baseTexture.width,l=n+a>this.baseTexture.height;if(h||l){const c=h&&l?"and":"or",f=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,d=`Y: ${n} + ${a} = ${n+a} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${f} ${c} ${d}`)}this.valid=s&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return it._EMPTY||(it._EMPTY=new it(new ft),qs(it._EMPTY),qs(it._EMPTY.baseTexture)),it._EMPTY}static get WHITE(){if(!it._WHITE){const t=q.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),it._WHITE=new it(ft.from(t)),qs(it._WHITE),qs(it._WHITE.baseTexture)}return it._WHITE}}class tn extends it{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const s=this.baseTexture.resolution,a=Math.round(t*s)/s,h=Math.round(e*s)/s;this.valid=a>0&&h>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=h,n&&this.baseTexture.resize(a,h),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new tn(new Md(t))}}class Fd{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=te.NONE){const s=new Md(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new tn(s)}getOptimalTexture(t,e,n=1,s=te.NONE){let a;t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=go(t),e=go(e),a=((t&65535)<<16|e&65535)>>>0,s>1&&(a+=s*4294967296)):a=s>1?-s:-1,this.texturePool[a]||(this.texturePool[a]=[]);let h=this.texturePool[a].pop();return h||(h=this.createTexture(t,e,s)),h.filterPoolKey=a,h.setResolution(n),h}getFilterTexture(t,e,n){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||te.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const n=this.texturePool[e];if(n)for(let s=0;s<n.length;s++)n[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const n=this.texturePool[e];if(n)for(let s=0;s<n.length;s++)n[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Fd.SCREEN_KEY=-1;class PE extends Ji{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Ld extends Ji{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Zt(this.vertices),this.uvBuffer=new Zt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,s=0;return this.uvs[0]=n,this.uvs[1]=s,this.uvs[2]=n+e.width/t.width,this.uvs[3]=s,this.uvs[4]=n+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=n,this.uvs[7]=s+e.height/t.height,n=e.x,s=e.y,this.vertices[0]=n,this.vertices[1]=s,this.vertices[2]=n+e.width,this.vertices[3]=s,this.vertices[4]=n+e.width,this.vertices[5]=s+e.height,this.vertices[6]=n,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class ME{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=te.NONE,this.sourceFrame=new wt,this.destinationFrame=new wt,this.bindingSourceFrame=new wt,this.bindingDestinationFrame=new wt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Ks=[new Et,new Et,new Et,new Et],dh=new Gt;class Od{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Fd,this.statePool=[],this.quad=new PE,this.quadUv=new Ld,this.tempRect=new wt,this.activeState={},this.globalUniforms=new oi({outputFrame:new wt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,s=this.defaultFilterStack,a=this.statePool.pop()||new ME,h=this.renderer.renderTexture;let l=e[0].resolution,c=e[0].multisample,f=e[0].padding,d=e[0].autoFit,g=e[0].legacy??!0;for(let x=1;x<e.length;x++){const A=e[x];l=Math.min(l,A.resolution),c=Math.min(c,A.multisample),f=this.useMaxPadding?Math.max(f,A.padding):f+A.padding,d=d&&A.autoFit,g=g||(A.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),s.push(a),a.resolution=l,a.multisample=c,a.legacy=g,a.target=t,a.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),a.sourceFrame.pad(f);const m=this.tempRect.copyFrom(h.sourceFrame);n.projection.transform&&this.transformAABB(dh.copyFrom(n.projection.transform).invert(),m),d?(a.sourceFrame.fit(m),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(m)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,h.current?h.current.resolution:n.resolution,h.sourceFrame,h.destinationFrame,n.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,l,c),a.filters=e,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=a.sourceFrame.width,v.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(h.sourceFrame),a.bindingDestinationFrame.copyFrom(h.destinationFrame),a.transform=n.projection.transform,n.projection.transform=null,h.bind(a.renderTexture,a.sourceFrame,v),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const a=s.inputSize,h=s.inputPixel,l=s.inputClamp;if(a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],h[0]=Math.round(a[0]*e.resolution),h[1]=Math.round(a[1]*e.resolution),h[2]=1/h[0],h[3]=1/h[1],l[0]=.5*h[2],l[1]=.5*h[3],l[2]=e.sourceFrame.width*a[2]-.5*h[2],l[3]=e.sourceFrame.height*a[3]-.5*h[3],e.legacy){const f=s.filterArea;f[0]=e.destinationFrame.width,f[1]=e.destinationFrame.height,f[2]=e.sourceFrame.x,f[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const c=t[t.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,e.renderTexture,c.renderTexture,di.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let f=e.renderTexture,d=this.getOptimalFilterTexture(f.width,f.height,e.resolution);d.filterFrame=f.filterFrame;let g=0;for(g=0;g<n.length-1;++g){g===1&&e.multisample>1&&(d=this.getOptimalFilterTexture(f.width,f.height,e.resolution),d.filterFrame=f.filterFrame),n[g].apply(this,f,d,di.CLEAR,e);const m=f;f=d,d=m}n[g].apply(this,f,c.renderTexture,di.BLEND,e),g>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(f),this.returnFilterTexture(d)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=di.CLEAR){const{renderTexture:n,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const h=this.tempRect;h.x=0,h.y=0,h.width=t.filterFrame.width,h.height=t.filterFrame.height,n.bind(t,t.filterFrame,h)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const a=s.stateId&1||this.forceClear;(e===di.CLEAR||e===di.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,s){const a=this.renderer;a.state.set(t.state),this.bindAndClear(n,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(gi.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(gi.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:s}=this.activeState,{orig:a}=e._texture,h=t.set(s.width,0,0,s.height,n.x,n.y),l=e.worldTransform.copyTo(Gt.TEMP_MATRIX);return l.invert(),h.prepend(l),h.scale(1/a.width,1/a.height),h.translate(e.anchor.x,e.anchor.y),h}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,s=te.NONE){return this.texturePool.getOptimalTexture(t,e,n,s)}getFilterTexture(t,e,n){if(typeof t=="number"){const a=t;t=e,e=a}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||te.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=Ks[0],s=Ks[1],a=Ks[2],h=Ks[3];n.set(e.left,e.top),s.set(e.left,e.bottom),a.set(e.right,e.top),h.set(e.right,e.bottom),t.apply(n,n),t.apply(s,s),t.apply(a,a),t.apply(h,h);const l=Math.min(n.x,s.x,a.x,h.x),c=Math.min(n.y,s.y,a.y,h.y),f=Math.max(n.x,s.x,a.x,h.x),d=Math.max(n.y,s.y,a.y,h.y);e.x=l,e.y=c,e.width=f-l,e.height=d-c}roundFrame(t,e,n,s,a){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(a){const{a:h,b:l,c,d:f}=a;if((Math.abs(l)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(h)>1e-4||Math.abs(f)>1e-4))return}a=a?dh.copyFrom(a):dh.identity(),a.translate(-n.x,-n.y).scale(s.width/n.width,s.height/n.height).translate(s.x,s.y),this.transformAABB(a,t),t.ceil(e),this.transformAABB(a.invert(),t)}}}Od.extension={type:j.RendererSystem,name:"filter"};nt.add(Od);class DE{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=te.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const BE=new wt;class Nd{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new $h(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new wt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===Cn.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:s}=this;if(t){const a=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,a.mipLevel=n),a.dirtyId!==t.dirtyId&&(a.dirtyId=t.dirtyId,a.dirtyFormat!==t.dirtyFormat?(a.dirtyFormat=t.dirtyFormat,a.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):a.dirtySize!==t.dirtySize&&(a.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let h=0;h<t.colorTextures.length;h++){const l=t.colorTextures[h];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const h=e.width>>n,l=e.height>>n,c=h/e.width;this.setViewport(e.x*c,e.y*c,h,l)}else{const h=t.width>>n,l=t.height>>n;this.setViewport(0,0,h,l)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,s){const a=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),s=Math.round(s),(a.width!==n||a.height!==s||a.x!==t||a.y!==e)&&(a.x=t,a.y=e,a.width=n,a.height=s,this.gl.viewport(t,e,n,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,s,a=Rh.COLOR|Rh.DEPTH){const{gl:h}=this;h.clearColor(t,e,n,s),h.clear(a)}initFramebuffer(t){const{gl:e}=this,n=new DE(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const s=t.colorTextures;let a=s.length;e.drawBuffers||(a=Math.min(a,1));for(let h=0;h<a;h++){const l=s[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,s=t.glFramebuffers[this.CONTEXT_UID],a=t.colorTextures;let h=a.length;n.drawBuffers||(h=Math.min(h,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||n.createRenderbuffer():s.msaaBuffer&&(n.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const l=[];for(let c=0;c<h;c++){const f=a[c],d=f.parentTextureArray||f;this.renderer.texture.bind(d,0),c===0&&s.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,s.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,s.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,f.target,d._glTextures[this.CONTEXT_UID].texture,e),l.push(n.COLOR_ATTACHMENT0+c))}if(l.length>1&&n.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const f=t.depthTexture;this.renderer.texture.bind(f,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(s.stencil=s.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,s.stencil),s.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,s.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,s.stencil)):s.stencil&&(n.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=te.NONE;if(t<=1||e===null)return n;for(let s=0;s<e.length;s++)if(e[s]<=t){n=e[s];break}return n===1&&(n=te.NONE),n}blit(t,e,n){const{current:s,renderer:a,gl:h,CONTEXT_UID:l}=this;if(a.context.webGLVersion!==2||!s)return;const c=s.glFramebuffers[l];if(!c)return;if(!t){if(!c.msaaBuffer)return;const d=s.colorTextures[0];if(!d)return;c.blitFramebuffer||(c.blitFramebuffer=new $h(s.width,s.height),c.blitFramebuffer.addColorTexture(0,d)),t=c.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=BE,e.width=s.width,e.height=s.height),n||(n=e);const f=e.width===n.width&&e.height===n.height;this.bind(t),h.bindFramebuffer(h.READ_FRAMEBUFFER,c.framebuffer),h.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,h.COLOR_BUFFER_BIT,f?h.NEAREST:h.LINEAR)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const a=this.managedFramebuffers.indexOf(t);a>=0&&this.managedFramebuffers.splice(a,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&s.deleteRenderbuffer(n.msaaBuffer),n.stencil&&s.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const n=t.width,s=t.height,a=this.gl,h=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,h),e.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,e.multisample,a.DEPTH24_STENCIL8,n,s):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,n,s),e.stencil=h,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,h)}reset(){this.current=this.unknownFramebuffer,this.viewport=new wt}destroy(){this.renderer=null}}Nd.extension={type:j.RendererSystem,name:"framebuffer"};nt.add(Nd);const ph={5126:4,5123:2,5121:1};class Ud{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===Cn.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=()=>n.createVertexArrayOES(),t.bindVertexArray=s=>n.bindVertexArrayOES(s),t.deleteVertexArray=s=>n.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const n=t.getExtension("ANGLE_instanced_arrays");n?(t.vertexAttribDivisor=(s,a)=>n.vertexAttribDivisorANGLE(s,a),t.drawElementsInstanced=(s,a,h,l,c)=>n.drawElementsInstancedANGLE(s,a,h,l,c),t.drawArraysInstanced=(s,a,h,l)=>n.drawArraysInstancedANGLE(s,a,h,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],a=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},a=!0);const h=s[e.program.id]||this.initGeometryVao(t,e,a);this._activeGeometry=t,this._activeVao!==h&&(this._activeVao=h,this.hasVao?n.bindVertexArray(h):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const s=t.buffers[n];e.update(s)}}checkCompatibility(t,e){const n=t.attributes,s=e.attributeData;for(const a in s)if(!n[a])throw new Error(`shader and geometry incompatible, geometry missing the "${a}" attribute`)}getSignature(t,e){const n=t.attributes,s=e.attributeData,a=["g",t.id];for(const h in n)s[h]&&a.push(h,s[h].location);return a.join("-")}initGeometryVao(t,e,n=!0){const s=this.gl,a=this.CONTEXT_UID,h=this.renderer.buffer,l=e.program;l.glPrograms[a]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const c=this.getSignature(t,l),f=t.glVertexArrayObjects[this.CONTEXT_UID];let d=f[c];if(d)return f[l.id]=d,d;const g=t.buffers,m=t.attributes,v={},x={};for(const A in g)v[A]=0,x[A]=0;for(const A in m)!m[A].size&&l.attributeData[A]?m[A].size=l.attributeData[A].size:m[A].size||console.warn(`PIXI Geometry attribute '${A}' size cannot be determined (likely the bound shader does not have the attribute)`),v[m[A].buffer]+=m[A].size*ph[m[A].type];for(const A in m){const T=m[A],R=T.size;T.stride===void 0&&(v[T.buffer]===R*ph[T.type]?T.stride=0:T.stride=v[T.buffer]),T.start===void 0&&(T.start=x[T.buffer],x[T.buffer]+=R*ph[T.type])}d=s.createVertexArray(),s.bindVertexArray(d);for(let A=0;A<g.length;A++){const T=g[A];h.bind(T),n&&T._glBuffers[a].refCount++}return this.activateVao(t,l),f[l.id]=d,f[c]=d,s.bindVertexArray(null),h.unbind(mi.ARRAY_BUFFER),d}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,a=t.buffers,h=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!n){if(h)for(let c=0;c<a.length;c++){const f=a[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!e&&h.dispose(a[c],e))}if(!e){for(const c in n)if(c[0]==="g"){const f=n[c];this._activeVao===f&&this.unbind(),s.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,s=this.CONTEXT_UID,a=this.renderer.buffer,h=t.buffers,l=t.attributes;t.indexBuffer&&a.bind(t.indexBuffer);let c=null;for(const f in l){const d=l[f],g=h[d.buffer],m=g._glBuffers[s];if(e.attributeData[f]){c!==m&&(a.bind(g),c=m);const v=e.attributeData[f].location;if(n.enableVertexAttribArray(v),n.vertexAttribPointer(v,d.size,d.type||n.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)n.vertexAttribDivisor(v,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,n,s){const{gl:a}=this,h=this._activeGeometry;if(h.indexBuffer){const l=h.indexBuffer.data.BYTES_PER_ELEMENT,c=l===2?a.UNSIGNED_SHORT:a.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?h.instanced?a.drawElementsInstanced(t,e||h.indexBuffer.data.length,c,(n||0)*l,s||1):a.drawElements(t,e||h.indexBuffer.data.length,c,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else h.instanced?a.drawArraysInstanced(t,n,e||h.getSize(),s||1):a.drawArrays(t,n,e||h.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Ud.extension={type:j.RendererSystem,name:"geometry"};nt.add(Ud);const Bf=new Gt;class kd{constructor(t,e){this._texture=t,this.mapCoord=new Gt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let s=0;s<t.length;s+=2){const a=t[s],h=t[s+1];e[s]=a*n.a+h*n.c+n.tx,e[s+1]=a*n.b+h*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const s=e.orig,a=e.trim;a&&(Bf.set(s.width/a.width,0,0,s.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(Bf));const h=e.baseTexture,l=this.uClampFrame,c=this.clampMargin/h.resolution,f=this.clampOffset;return l[0]=(e._frame.x+c+f)/h.width,l[1]=(e._frame.y+c+f)/h.height,l[2]=(e._frame.x+e._frame.width-c+f)/h.width,l[3]=(e._frame.y+e._frame.height-c+f)/h.height,this.uClampOffset[0]=f/h.realWidth,this.uClampOffset[1]=f/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0}}var FE=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,LE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class OE extends ve{constructor(t,e,n){let s=null;typeof t!="string"&&e===void 0&&n===void 0&&(s=t,t=void 0,e=void 0,n=void 0),super(t||LE,e||FE,n),this.maskSprite=s,this.maskMatrix=new Gt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,s){const a=this._maskSprite,h=a._texture;h.valid&&(h.uvMatrix||(h.uvMatrix=new kd(h,0)),h.uvMatrix.update(),this.uniforms.npmAlpha=h.baseTexture.alphaMode?0:1,this.uniforms.mask=h,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,a).prepend(h.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=h.uvMatrix.uClampFrame,t.applyFilter(this,e,n,s))}}class NE{constructor(t=null){this.type=re.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=q.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=re.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Gd{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const a=this.maskDataPool.pop()||new NE;a.pooled=!0,a.maskObject=e,n=a}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(s),n._colorMask=s?s._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==re.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case re.SCISSOR:this.renderer.scissor.push(n);break;case re.STENCIL:this.renderer.stencil.push(n);break;case re.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case re.COLOR:this.pushColorMask(n);break}n.type===re.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case re.SCISSOR:this.renderer.scissor.pop(e);break;case re.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case re.SPRITE:this.popSpriteMask(e);break;case re.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===re.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=re.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=re.SCISSOR:t.type=re.STENCIL:t.type=re.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new OE]));const a=this.renderer,h=a.renderTexture;let l,c;if(h.current){const d=h.current;l=t.resolution||d.resolution,c=t.multisample??d.multisample}else l=t.resolution||a.resolution,c=t.multisample??a.multisample;s[0].resolution=l,s[0].multisample=c,s[0].maskSprite=e;const f=n.filterArea;n.filterArea=e.getBounds(!0),a.filter.push(n,s),n.filterArea=f,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}Gd.extension={type:j.RendererSystem,name:"mask"};nt.add(Gd);class Hd{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==n&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Ff=new Gt,Lf=[],ho=class extends Hd{constructor(i){super(i),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:n}=this,s=n.renderTexture,a=e.getBounds(!0,Lf.pop()??new wt);this.roundFrameToPixels(a,s.current?s.current.resolution:n.resolution,s.sourceFrame,s.destinationFrame,n.projection.transform),t&&a.fit(t),i._scissorRectLocal=a}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:n,d:s}=i;return(Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||ho.isMatrixRotated(t.worldTransform)||ho.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,n,s){ho.isMatrixRotated(s)||(s=s?Ff.copyFrom(s):Ff.identity(),s.translate(-e.x,-e.y).scale(n.width/e.width,n.height/e.height).translate(n.x,n.y),this.renderer.filter.transformAABB(s,i),i.fit(n),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&Lf.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let Wd=ho;Wd.extension={type:j.RendererSystem,name:"scissor"};nt.add(Wd);class Xd extends Hd{constructor(t){super(t),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const a=t._colorMask;a!==0&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,s,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,a!==0&&(t._colorMask=a,n.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=n?n._colorMask:15;s!==0&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(n._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Xd.extension={type:j.RendererSystem,name:"stencil"};nt.add(Xd);class zd{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}zd.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_plugin"};nt.add(zd);class $d{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Gt,this.transform=null}update(t,e,n,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,s),this.transform&&this.projectionMatrix.append(this.transform);const a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)}calculateProjection(t,e,n,s){const a=this.projectionMatrix,h=s?-1:1;a.identity(),a.a=1/e.width*2,a.d=h*(1/e.height*2),a.tx=-1-e.x*a.a,a.ty=-h-e.y*a.d}setTransform(t){}destroy(){this.renderer=null}}$d.extension={type:j.RendererSystem,name:"projection"};nt.add($d);const UE=new pl;class Vd{constructor(t){this.renderer=t,this._tempMatrix=new Gt}generateTexture(t,e){const{region:n,...s}=e||{},a=n||t.getLocalBounds(null,!0);a.width===0&&(a.width=1),a.height===0&&(a.height=1);const h=tn.create({width:a.width,height:a.height,...s});this._tempMatrix.tx=-a.x,this._tempMatrix.ty=-a.y;const l=t.transform;return t.transform=UE,this.renderer.render(t,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,h}destroy(){}}Vd.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"textureGenerator"};nt.add(Vd);const dn=new wt,Dr=new wt;class Yd{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new wt,this.destinationFrame=new wt,this.viewportFrame=new wt}bind(t=null,e,n){const s=this.renderer;this.current=t;let a,h,l;t?(a=t.baseTexture,l=a.resolution,e||(dn.width=t.frame.width,dn.height=t.frame.height,e=dn),n||(Dr.x=t.frame.x,Dr.y=t.frame.y,Dr.width=e.width,Dr.height=e.height,n=Dr),h=a.framebuffer):(l=s.resolution,e||(dn.width=s._view.screen.width,dn.height=s._view.screen.height,e=dn),n||(n=dn,n.width=e.width,n.height=e.height));const c=this.viewportFrame;c.x=n.x*l,c.y=n.y*l,c.width=n.width*l,c.height=n.height*l,t||(c.y=s.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(h,c),this.renderer.projection.update(n,e,l,!h),t?this.renderer.mask.setMaskStack(a.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const n=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==s.width||n.height!==s.height;if(a){let{x:h,y:l,width:c,height:f}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,f)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Yd.extension={type:j.RendererSystem,name:"renderTexture"};nt.add(Yd);class kE{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function GE(i,t){const e={},n=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let s=0;s<n;s++){const a=t.getActiveAttrib(i,s);if(a.name.startsWith("gl_"))continue;const h=Cd(t,a.type),l={type:h,name:a.name,size:Sd(h),location:t.getAttribLocation(i,a.name)};e[a.name]=l}return e}function HE(i,t){const e={},n=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let s=0;s<n;s++){const a=t.getActiveUniform(i,s),h=a.name.replace(/\[.*?\]$/,""),l=!!a.name.match(/\[.*?\]$/),c=Cd(t,a.type);e[h]={name:h,index:s,type:c,size:a.size,isArray:l,value:Ed(c,a.size)}}return e}function WE(i,t){var c;const e=Cf(i,i.VERTEX_SHADER,t.vertexSrc),n=Cf(i,i.FRAGMENT_SHADER,t.fragmentSrc),s=i.createProgram();i.attachShader(s,e),i.attachShader(s,n);const a=(c=t.extra)==null?void 0:c.transformFeedbackVaryings;if(a&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(s,a.names,a.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||_E(i,s,e,n),t.attributeData=GE(s,i),t.uniformData=HE(s,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const f=Object.keys(t.attributeData);f.sort((d,g)=>d>g?1:-1);for(let d=0;d<f.length;d++)t.attributeData[f[d]].location=d,i.bindAttribLocation(s,d,f[d]);i.linkProgram(s)}i.deleteShader(e),i.deleteShader(n);const h={};for(const f in t.uniformData){const d=t.uniformData[f];h[f]={location:i.getUniformLocation(s,f),value:Ed(d.type,d.size)}}return new kE(s,h)}function XE(i,t,e,n,s){e.buffer.update(s)}const zE={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},jd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function $E(i){const t=i.map(a=>({data:a,offset:0,dataLen:0,dirty:0}));let e=0,n=0,s=0;for(let a=0;a<t.length;a++){const h=t[a];if(e=jd[h.data.type],h.data.size>1&&(e=Math.max(e,16)*h.data.size),h.dataLen=e,n%e!==0&&n<16){const l=n%e%16;n+=l,s+=l}n+e>16?(s=Math.ceil(s/16)*16,h.offset=s,s+=e,n=e):(h.offset=s,n+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function VE(i,t){const e=[];for(const n in i)t[n]&&e.push(t[n]);return e.sort((n,s)=>n.index-s.index),e}function YE(i,t){if(!i.autoManage)return{size:0,syncFunc:XE};const e=VE(i.uniforms,t),{uboElements:n,size:s}=$E(e),a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let h=0;h<n.length;h++){const l=n[h],c=i.uniforms[l.data.name],f=l.data.name;let d=!1;for(let g=0;g<sr.length;g++){const m=sr[g];if(m.codeUbo&&m.test(l.data,c)){a.push(`offset = ${l.offset/4};`,sr[g].codeUbo(l.data.name,c)),d=!0;break}}if(!d)if(l.data.size>1){const g=Sd(l.data.type),m=Math.max(jd[l.data.type]/16,1),v=g/m,x=(4-v%4)%4;a.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*m}; i++)
                {
                    for(var j = 0; j < ${v}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${x};
                }

                `)}else{const g=zE[l.data.type];a.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};
                ${g};
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}let jE=0;const Zs={textureCount:0,uboCount:0};class qd{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=jE++}systemCheck(){if(!xE())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,s=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(s.program)),e||(Zs.textureCount=0,Zs.uboCount=0,this.syncUniformGroup(t.uniformGroup,Zs)),s}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=pE(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||t.dirtyId!==0||!n.uniformGroups[t.id]){t.dirtyId=0;const s=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),s(n.uniformData,t.uniforms,this.renderer,Zs,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const a=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,a,this.shader.uniformBindCount),this.shader.uniformBindCount++;const h=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[h];if(l||(l=this._uboCache[h]=YE(t,this.shader.program.uniformData)),t.autoManage){const c=new Float32Array(l.size/4);t.buffer.update(c)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const s=t.uniforms,a=[`${n}-`];for(const h in s)a.push(h),e[h]&&a.push(e[h].type);return a.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,s=WE(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}qd.extension={type:j.RendererSystem,name:"shader"};nt.add(qd);class Kd{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}Kd.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"startup"};nt.add(Kd);function qE(i,t=[]){return t[lt.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD]=[i.ONE,i.ONE],t[lt.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.NONE]=[0,0],t[lt.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[lt.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[lt.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[lt.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[lt.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[lt.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[lt.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const KE=0,ZE=1,JE=2,QE=3,tA=4,eA=5,Vh=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=lt.NONE,this._blendEq=!1,this.map=[],this.map[KE]=this.setBlend,this.map[ZE]=this.setOffset,this.map[JE]=this.setCullFace,this.map[QE]=this.setDepthTest,this.map[tA]=this.setFrontFace,this.map[eA]=this.setDepthMask,this.checks=[],this.defaultState=new Oi,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=qE(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(Vh.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(Vh.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Zd=Vh;Zd.extension={type:j.RendererSystem,name:"state"};nt.add(Zd);class iA extends jr{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),n=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of n)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new si(e)})}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const s in this.runners)this.runners[s].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach(s=>{const a=n.find(h=>this._systemsHash[h]===s);s[t.name](e[a])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const lo=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=lo.defaultMaxIdle,this.checkCountMax=lo.defaultCheckCountMax,this.mode=lo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==al.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let n=0;n<t.length;n++){const s=t[n];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(i.destroyTexture(s,!0),t[n]=null,e=!0)}if(e){let n=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[n++]=t[s]);t.length=n}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let n=i.children.length-1;n>=0;n--)this.unload(i.children[n])}destroy(){this.renderer=null}};let ii=lo;ii.defaultMode=al.AUTO;ii.defaultMaxIdle=60*60;ii.defaultCheckCountMax=60*10;ii.extension={type:j.RendererSystem,name:"textureGC"};nt.add(ii);class gh{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=st.UNSIGNED_BYTE,this.internalFormat=X.RGBA,this.samplerType=0}}function nA(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[st.UNSIGNED_BYTE]:{[X.RGBA]:i.RGBA8,[X.RGB]:i.RGB8,[X.RG]:i.RG8,[X.RED]:i.R8,[X.RGBA_INTEGER]:i.RGBA8UI,[X.RGB_INTEGER]:i.RGB8UI,[X.RG_INTEGER]:i.RG8UI,[X.RED_INTEGER]:i.R8UI,[X.ALPHA]:i.ALPHA,[X.LUMINANCE]:i.LUMINANCE,[X.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.BYTE]:{[X.RGBA]:i.RGBA8_SNORM,[X.RGB]:i.RGB8_SNORM,[X.RG]:i.RG8_SNORM,[X.RED]:i.R8_SNORM,[X.RGBA_INTEGER]:i.RGBA8I,[X.RGB_INTEGER]:i.RGB8I,[X.RG_INTEGER]:i.RG8I,[X.RED_INTEGER]:i.R8I},[st.UNSIGNED_SHORT]:{[X.RGBA_INTEGER]:i.RGBA16UI,[X.RGB_INTEGER]:i.RGB16UI,[X.RG_INTEGER]:i.RG16UI,[X.RED_INTEGER]:i.R16UI,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[st.SHORT]:{[X.RGBA_INTEGER]:i.RGBA16I,[X.RGB_INTEGER]:i.RGB16I,[X.RG_INTEGER]:i.RG16I,[X.RED_INTEGER]:i.R16I},[st.UNSIGNED_INT]:{[X.RGBA_INTEGER]:i.RGBA32UI,[X.RGB_INTEGER]:i.RGB32UI,[X.RG_INTEGER]:i.RG32UI,[X.RED_INTEGER]:i.R32UI,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[st.INT]:{[X.RGBA_INTEGER]:i.RGBA32I,[X.RGB_INTEGER]:i.RGB32I,[X.RG_INTEGER]:i.RG32I,[X.RED_INTEGER]:i.R32I},[st.FLOAT]:{[X.RGBA]:i.RGBA32F,[X.RGB]:i.RGB32F,[X.RG]:i.RG32F,[X.RED]:i.R32F,[X.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[st.HALF_FLOAT]:{[X.RGBA]:i.RGBA16F,[X.RGB]:i.RGB16F,[X.RG]:i.RG16F,[X.RED]:i.R16F},[st.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:i.RGB565},[st.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:i.RGBA4},[st.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:i.RGB5_A1},[st.UNSIGNED_INT_2_10_10_10_REV]:{[X.RGBA]:i.RGB10_A2,[X.RGBA_INTEGER]:i.RGB10_A2UI},[st.UNSIGNED_INT_10F_11F_11F_REV]:{[X.RGB]:i.R11F_G11F_B10F},[st.UNSIGNED_INT_5_9_9_9_REV]:{[X.RGB]:i.RGB9_E5},[st.UNSIGNED_INT_24_8]:{[X.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[st.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[X.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[st.UNSIGNED_BYTE]:{[X.RGBA]:i.RGBA,[X.RGB]:i.RGB,[X.ALPHA]:i.ALPHA,[X.LUMINANCE]:i.LUMINANCE,[X.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.UNSIGNED_SHORT_5_6_5]:{[X.RGB]:i.RGB},[st.UNSIGNED_SHORT_4_4_4_4]:{[X.RGBA]:i.RGBA},[st.UNSIGNED_SHORT_5_5_5_1]:{[X.RGBA]:i.RGBA}},t}class Jd{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ft,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=nA(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const n=new gh(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new gh(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:n}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<n.length;s++)n[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<n.length;s++)n[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:s}=this;if(n)for(let a=t-1;a>=0;--a){const h=e[a];h&&h._glTextures[s].samplerType!==Ph.FLOAT&&this.renderer.texture.unbind(h)}}initTexture(t){const e=new gh(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var n;e.internalFormat=((n=this.internalFormats[t.type])==null?void 0:n[t.format])??t.format,this.webGLVersion===2&&t.type===st.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),(s=t.resource)!=null&&s.upload(n,t,e))e.samplerType!==Ph.FLOAT&&(this.hasIntegerTextures=!0);else{const a=t.realWidth,h=t.realHeight,l=n.gl;(e.width!==a||e.height!==h||e.dirtyId<0)&&(e.width=a,e.height=h,l.texImage2D(t.target,0,e.internalFormat,a,h,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&nr(this.managedTextures,s,1)}}updateTextureStyle(t){var n;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===xi.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Ki.CLAMP:e.wrapMode=t.wrapMode,(n=t.resource)!=null&&n.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==xi.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Di.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Di.LINEAR){const a=Math.min(t.anisotropicLevel,n.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Di.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Di.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}Jd.extension={type:j.RendererSystem,name:"texture"};nt.add(Jd);class Qd{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:s}=this;e&&s.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:s}=this,a=e.createTransformFeedback();t._glTransformFeedbacks[s]=a,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,a);for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];l&&(n.buffer.update(l),l._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,h,l._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),a}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const a=this.renderer.buffer;if(a)for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];if(!l)continue;const c=l._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!e&&a.dispose(l,e))}n&&(e||s.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Qd.extension={type:j.RendererSystem,name:"transformFeedback"};nt.add(Qd);class tp{constructor(t){this.renderer=t}init(t){this.screen=new wt(0,0,t.width,t.height),this.element=t.view||q.ADAPTER.createCanvas(),this.resolution=t.resolution||q.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=n,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",n,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}tp.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_view"};nt.add(tp);q.PREFER_ENV=Cn.WEBGL2;q.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(q,{WRAP_MODE:{get(){return ft.defaultOptions.wrapMode},set(i){At("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),ft.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return ft.defaultOptions.scaleMode},set(i){At("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),ft.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return ft.defaultOptions.mipmap},set(i){At("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),ft.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return ft.defaultOptions.anisotropicLevel},set(i){At("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),ft.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return At("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ve.defaultResolution},set(i){ve.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return At("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ve.defaultMultisample},set(i){ve.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return ei.defaultMaxTextures},set(i){At("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ei.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return ei.defaultBatchSize},set(i){At("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ei.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return ei.canUploadSameBuffer},set(i){At("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ei.canUploadSameBuffer=i}},GC_MODE:{get(){return ii.defaultMode},set(i){At("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),ii.defaultMode=i}},GC_MAX_IDLE:{get(){return ii.defaultMaxIdle},set(i){At("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),ii.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return ii.defaultCheckCountMax},set(i){At("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),ii.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return ni.defaultVertexPrecision},set(i){At("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ni.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return ni.defaultFragmentPrecision},set(i){At("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ni.defaultFragmentPrecision=i}}});var or=(i=>(i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(or||{});class mh{constructor(t,e=null,n=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Me=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new mh(null,null,1/0),this.deltaMS=1/Me.targetFPMS,this.elapsedMS=1/Me.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=or.NORMAL){return this._addListener(new mh(i,t,e))}addOnce(i,t,e=or.NORMAL){return this._addListener(new mh(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=i-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=i-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Me.targetFPMS;const e=this._head;let n=e.next;for(;n;)n=n.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,Me.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Me._shared){const i=Me._shared=new Me;i.autoStart=!0,i._protected=!0}return Me._shared}static get system(){if(!Me._system){const i=Me._system=new Me;i.autoStart=!0,i._protected=!0}return Me._system}};let Ee=Me;Ee.targetFPMS=.06;Object.defineProperties(q,{TARGET_FPMS:{get(){return Ee.targetFPMS},set(i){At("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ee.targetFPMS=i}}});class ep{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,or.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ee.shared:new Ee,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}ep.extension=j.Application;nt.add(ep);const ip=[];nt.handleByList(j.Renderer,ip);function rA(i){for(const t of ip)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var sA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,oA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const aA=sA,np=oA;class rp{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=te.HIGH?this.multisample=te.HIGH:e>=te.MEDIUM?this.multisample=te.MEDIUM:e>=te.LOW?this.multisample=te.LOW:this.multisample=te.NONE}destroy(){}}rp.extension={type:j.RendererSystem,name:"_multisample"};nt.add(rp);class hA{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class sp{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const a=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,a.buffer)}}bindBufferRange(t,e,n){const{gl:s,CONTEXT_UID:a}=this;n=n||0;const h=t._glBuffers[a]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,h.buffer,n*256,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,s=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const a=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,a)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),n&&(e||s.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new hA(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}sp.extension={type:j.RendererSystem,name:"buffer"};nt.add(sp);class op{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let s,a,h,l;if(e&&(s=e.renderTexture,a=e.clear,h=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!s,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=h,!n.context.isLost){if(s||(this.lastObjectRendered=t),!l){const c=t.enableTempParent();t.updateTransform(),t.disableTempParent(c)}n.renderTexture.bind(s),n.batch.currentRenderer.start(),(a??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),s&&(e.blit&&n.framebuffer.blit(),s.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}op.extension={type:j.RendererSystem,name:"objectRenderer"};nt.add(op);const Yh=class extends iA{constructor(i){super(),i=Object.assign({},q.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new oi({projectionMatrix:new Gt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Yh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&(At("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha);const e={hello:i.hello,_plugin:Yh.__plugins,background:{alpha:i.backgroundAlpha,color:i.background??i.backgroundColor,clearBeforeRender:i.clearBeforeRender},_view:{height:i.height,width:i.width,autoDensity:i.autoDensity,resolution:i.resolution,view:i.view},context:{antialias:i.antialias,context:i.context,powerPreference:i.powerPreference,premultipliedAlpha:i.premultipliedAlpha,preserveDrawingBuffer:i.preserveDrawingBuffer}};this.startup.run(e),this.options=i}static test(i){return i!=null&&i.forceCanvas?!1:nb()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return At("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return At("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return At("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return At("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){At("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return At("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(i){At("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return At("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let hr=Yh;hr.extension={type:j.Renderer,priority:1};hr.__plugins={};hr.__systems={};nt.handleByMap(j.RendererPlugin,hr.__plugins);nt.handleByMap(j.RendererSystem,hr.__systems);nt.add(hr);class ap extends zr{constructor(t,e){const{width:n,height:s}=e||{};super(n,s),this.items=[],this.itemDirtyIds=[];for(let a=0;a<t;a++){const h=new ft;this.items.push(h),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof zr?this.addResourceAt(t[n],n):this.addResourceAt(yd(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:s}=this.items[0];return this.resize(n,s),Promise.resolve(this)}),this._load}}class lA extends ap{constructor(t,e){const{width:n,height:s}=e||{};let a,h;Array.isArray(t)?(a=t,h=t.length):h=t,super(h,{width:n,height:s}),a&&this.initFromArray(a,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=er.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:s,itemDirtyIds:a,items:h}=this,{gl:l}=t;n.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,s,0,e.format,n.type,null);for(let c=0;c<s;c++){const f=h[c];a[c]<f.dirtyId&&(a[c]=f.dirtyId,f.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,c,f.resource.width,f.resource.height,1,e.format,n.type,f.resource.source))}return!0}}class uA extends Qi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Or=class extends ap{constructor(i,t){const{width:e,height:n,autoLoad:s,linkBaseTexture:a}=t||{};if(i&&i.length!==Or.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:n});for(let h=0;h<Or.SIDES;h++)this.items[h].target=er.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=a!==!1,i&&this.initFromArray(i,t),s!==!1&&this.load()}bind(i){super.bind(i),i.target=er.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=er.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const n=this.itemDirtyIds;for(let s=0;s<Or.SIDES;s++){const a=this.items[s];(n[s]<a.dirtyId||e.dirtyId<t.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(i,a,e),n[s]=a.dirtyId):n[s]<-1&&(i.gl.texImage2D(a.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),n[s]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===Or.SIDES}};let hp=Or;hp.SIDES=6;class tr extends Qi{constructor(t,e){var n=(...s)=>{super(...s)};e=e||{},typeof t=="string"?(n(tr.EMPTY),this.url=t):(n(t),this.url=null),this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const n=await q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await n.blob();if(this.destroyed)return;const a=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ai.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=a,this.update(),t(this)}catch(n){if(this.destroyed)return;e(n),this.onError.emit(n)}}),this._load)}upload(t,e,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return tr._EMPTY=tr._EMPTY??q.ADAPTER.createCanvas(0,0),tr._EMPTY}}const uo=class extends Qi{constructor(i,t){t=t||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},uo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;Qi.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,s=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/e*t,s=this._overrideHeight||this._overrideWidth/t*e),n=Math.round(n),s=Math.round(s);const a=this.source;a.width=n,a.height=s,a._pixiId=`canvas_${An()}`,a.getContext("2d").drawImage(i,0,0,t,e,0,0,n,s),this._resolve(),this._resolve=null}}static getSize(i){const t=uo.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&uo.SVG_XML.test(i)}};let $r=uo;$r.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;$r.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const jh=class extends Qi{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const n=i[0].src||i[0];Qi.crossOrigin(e,n,t.crossorigin);for(let s=0;s<i.length;++s){const a=document.createElement("source");let{src:h,mime:l}=i[s];h=h||i[s];const c=h.split("?").shift().toLowerCase(),f=c.slice(c.lastIndexOf(".")+1);l=l||jh.MIME_TYPES[f]||`video/${f}`,a.src=h,a.type=l,e.appendChild(a)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=Ee.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ee.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ee.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(Ee.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(Ee.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ee.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||jh.TYPES.includes(t)}};let gl=jh;gl.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];gl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Hh.push(tr,Dd,uA,gl,$r,qr,hp,lA);class vo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?wt.EMPTY:(t=t||new wt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:s,c:a,d:h,tx:l,ty:c}=t,f=n*e.x+a*e.y+l,d=s*e.x+h*e.y+c;this.minX=Math.min(this.minX,f),this.maxX=Math.max(this.maxX,f),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let e=this.minX,n=this.minY,s=this.maxX,a=this.maxY,h=t[0],l=t[1];e=h<e?h:e,n=l<n?l:n,s=h>s?h:s,a=l>a?l:a,h=t[2],l=t[3],e=h<e?h:e,n=l<n?l:n,s=h>s?h:s,a=l>a?l:a,h=t[4],l=t[5],e=h<e?h:e,n=l<n?l:n,s=h>s?h:s,a=l>a?l:a,h=t[6],l=t[7],e=h<e?h:e,n=l<n?l:n,s=h>s?h:s,a=l>a?l:a,this.minX=e,this.minY=n,this.maxX=s,this.maxY=a}addFrame(t,e,n,s,a){this.addFrameMatrix(t.worldTransform,e,n,s,a)}addFrameMatrix(t,e,n,s,a){const h=t.a,l=t.b,c=t.c,f=t.d,d=t.tx,g=t.ty;let m=this.minX,v=this.minY,x=this.maxX,A=this.maxY,T=h*e+c*n+d,R=l*e+f*n+g;m=T<m?T:m,v=R<v?R:v,x=T>x?T:x,A=R>A?R:A,T=h*s+c*n+d,R=l*s+f*n+g,m=T<m?T:m,v=R<v?R:v,x=T>x?T:x,A=R>A?R:A,T=h*e+c*a+d,R=l*e+f*a+g,m=T<m?T:m,v=R<v?R:v,x=T>x?T:x,A=R>A?R:A,T=h*s+c*a+d,R=l*s+f*a+g,m=T<m?T:m,v=R<v?R:v,x=T>x?T:x,A=R>A?R:A,this.minX=m,this.minY=v,this.maxX=x,this.maxY=A}addVertexData(t,e,n){let s=this.minX,a=this.minY,h=this.maxX,l=this.maxY;for(let c=e;c<n;c+=2){const f=t[c],d=t[c+1];s=f<s?f:s,a=d<a?d:a,h=f>h?f:h,l=d>l?d:l}this.minX=s,this.minY=a,this.maxX=h,this.maxY=l}addVertices(t,e,n,s){this.addVerticesMatrix(t.worldTransform,e,n,s)}addVerticesMatrix(t,e,n,s,a=0,h=a){const l=t.a,c=t.b,f=t.c,d=t.d,g=t.tx,m=t.ty;let v=this.minX,x=this.minY,A=this.maxX,T=this.maxY;for(let R=n;R<s;R+=2){const M=e[R],E=e[R+1],P=l*M+f*E+g,U=d*E+c*M+m;v=Math.min(v,P-a),A=Math.max(A,P+a),x=Math.min(x,U-h),T=Math.max(T,U+h)}this.minX=v,this.minY=x,this.maxX=A,this.maxY=T}addBounds(t){const e=this.minX,n=this.minY,s=this.maxX,a=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>a?t.maxY:a}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,a=t.maxX<e.maxX?t.maxX:e.maxX,h=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=a&&s<=h){const l=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<l?n:l,this.minY=s<c?s:c,this.maxX=a>f?a:f,this.maxY=h>d?h:d}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,a=t.maxX<e.x+e.width?t.maxX:e.x+e.width,h=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=a&&s<=h){const l=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<l?n:l,this.minY=s<c?s:c,this.maxX=a>f?a:f,this.maxY=h>d?h:d}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,s,a,h){t-=a,e-=h,n+=a,s+=h,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class zt extends jr{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new pl,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new vo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const s=e[n];Object.defineProperty(zt.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new wt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new wt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new vo);const e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const h=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-a,h}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,s){return e&&(t=e.toGlobal(t,n,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,n=1,s=1,a=0,h=0,l=0,c=0,f=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=s||1,this.rotation=a,this.skew.x=h,this.skew.y=l,this.pivot.x=c,this.pivot.y=f,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new cA),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*aE}set angle(t){this.transform.rotation=t*hE}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class cA extends zt{constructor(){super(...arguments),this.sortDirty=null}}zt.prototype.displayObjectUpdateTransform=zt.prototype.updateTransform;const fA=new Gt;function dA(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const qh=class extends zt{constructor(){super(),this.children=[],this.sortableChildren=qh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.addChild(i[t]);else{const t=i[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return i[0]}addChildAt(i,t){if(t<0||t>this.children.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(t,0,i),this._boundsID++,this.onChildrenChange(t),i.emit("added",this),this.emit("childAdded",i,this,t),i}swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=i,this.onChildrenChange(e<n?e:n)}getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(i);nr(this.children,e,1),this.children.splice(t,0,i),this.onChildrenChange(t)}getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.removeChild(i[t]);else{const t=i[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,nr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return i[0]}removeChildAt(i){const t=this.getChildAt(i);return t.parent=null,t.transform._parentID=-1,nr(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i),t}removeChildren(i=0,t=this.children.length){const e=i,n=t,s=n-e;let a;if(s>0&&s<=n){a=this.children.splice(e,s);for(let h=0;h<a.length;++h)a[h].parent=null,a[h].transform&&(a[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let h=0;h<a.length;++h)a[h].emit("removed",this),this.emit("childRemoved",a[h],this,h);return a}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let t=0,e=this.children.length;t<e;++t){const n=this.children[t];n._lastSortedIndex=t,!i&&n.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort(dA),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,t=this.children.length;i<t;++i){const e=this.children[i];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){const t=this.children[i];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(i,t=!1){const e=super.getLocalBounds(i);if(!t)for(let n=0,s=this.children.length;n<s;++n){const a=this.children[n];a.visible&&a.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(i){const t=i.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,n;this.cullArea?(e=this.cullArea,n=this.worldTransform):this._render!==qh.prototype._render&&(e=this.getBounds(!0));const s=i.projection.transform;if(s&&(n?(n=fA.copyFrom(n),n.prepend(s)):n=s),e&&t.intersects(e,n))this._render(i);else if(this.cullArea)return;for(let a=0,h=this.children.length;a<h;++a){const l=this.children[a],c=l.cullable;l.cullable=c||!this.cullArea,l.render(i),l.cullable=c}}render(i){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(i)}}renderAdvanced(i){var s,a,h;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const n=t&&((s=this._enabledFilters)==null?void 0:s.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==re.NONE));if(n&&i.batch.flush(),t&&((a=this._enabledFilters)!=null&&a.length)&&i.filter.push(this,this._enabledFilters),e&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let l=0,c=this.children.length;l<c;++l)this.children[l].render(i)}n&&i.batch.flush(),e&&i.mask.pop(this),t&&((h=this._enabledFilters)!=null&&h.length)&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;const t=typeof i=="boolean"?i:i==null?void 0:i.children,e=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<e.length;++n)e[n].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){const t=this.getLocalBounds().width;t!==0?this.scale.x=i/t:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){const t=this.getLocalBounds().height;t!==0?this.scale.y=i/t:this.scale.y=1,this._height=i}};let Fe=qh;Fe.defaultSortableChildren=!1;Fe.prototype.containerUpdateTransform=Fe.prototype.updateTransform;Object.defineProperties(q,{SORTABLE_CHILDREN:{get(){return Fe.defaultSortableChildren},set(i){At("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Fe.defaultSortableChildren=i}}});const Br=new Et,pA=new Uint16Array([0,1,2,0,2,3]);class lr extends Fe{constructor(t){super(),this._anchor=new qi(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=lt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||it.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=pA,this.pluginName="batch",this.isSprite=!0,this._roundPixels=q.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Qn(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Qn(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,s=e.b,a=e.c,h=e.d,l=e.tx,c=e.ty,f=this.vertexData,d=t.trim,g=t.orig,m=this._anchor;let v=0,x=0,A=0,T=0;if(d?(x=d.x-m._x*g.width,v=x+d.width,T=d.y-m._y*g.height,A=T+d.height):(x=-m._x*g.width,v=x+g.width,T=-m._y*g.height,A=T+g.height),f[0]=n*x+a*T+l,f[1]=h*T+s*x+c,f[2]=n*v+a*T+l,f[3]=h*T+s*v+c,f[4]=n*v+a*A+l,f[5]=h*A+s*v+c,f[6]=n*x+a*A+l,f[7]=h*A+s*x+c,this._roundPixels){const R=q.RESOLUTION;for(let M=0;M<f.length;++M)f[M]=Math.round(f[M]*R)/R}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,s=this._anchor,a=this.transform.worldTransform,h=a.a,l=a.b,c=a.c,f=a.d,d=a.tx,g=a.ty,m=-s._x*n.width,v=m+n.width,x=-s._y*n.height,A=x+n.height;e[0]=h*m+c*x+d,e[1]=f*x+l*m+g,e[2]=h*v+c*x+d,e[3]=f*x+l*v+g,e[4]=h*v+c*A+d,e[5]=f*A+l*v+g,e[6]=h*m+c*A+d,e[7]=f*A+l*m+g}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new vo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new wt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Br);const e=this._texture.orig.width,n=this._texture.orig.height,s=-e*this.anchor.x;let a=0;return Br.x>=s&&Br.x<s+e&&(a=-n*this.anchor.y,Br.y>=a&&Br.y<a+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(t,e){const n=t instanceof it?t:it.from(t,e);return new lr(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=Qn(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=Qn(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||it.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const lp=new Gt;zt.prototype._cacheAsBitmap=!1;zt.prototype._cacheData=null;zt.prototype._cacheAsBitmapResolution=null;zt.prototype._cacheAsBitmapMultisample=null;class gA{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(zt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new gA),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});zt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};zt.prototype._initCachedDisplayObject=function(t){var m,v;if((m=this._cacheData)!=null&&m.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(null,!0).clone();if((v=this.filters)!=null&&v.length){const x=this.filters[0].padding;n.pad(x)}n.ceil(q.RESOLUTION);const s=t.renderTexture.current,a=t.renderTexture.sourceFrame.clone(),h=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,c=tn.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),f=`cacheAsBitmap_${An()}`;this._cacheData.textureCacheId=f,ft.addToCache(c.baseTexture,f),it.addToCache(c,f);const d=this.transform.localTransform.copyTo(lp).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(s,a,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const g=new lr(c);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(n.x/n.width),g.anchor.y=-(n.y/n.height),g.alpha=e,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=g.containsPoint.bind(g)};zt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};zt.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;const s=t.canvasContext.activeContext,a=t._projTransform;e.ceil(q.RESOLUTION);const h=tn.create({width:e.width,height:e.height}),l=`cacheAsBitmap_${An()}`;this._cacheData.textureCacheId=l,ft.addToCache(h.baseTexture,l),it.addToCache(h,l);const c=lp;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=s,t._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const f=new lr(h);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(e.x/e.width),f.anchor.y=-(e.y/e.height),f.alpha=n,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)};zt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};zt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};zt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ft.removeFromCache(this._cacheData.textureCacheId),it.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};zt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};zt.prototype.name=null;Fe.prototype.getChildByName=function(t,e){for(let n=0,s=this.children.length;n<s;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,s=this.children.length;n<s;n++){const a=this.children[n];if(!a.getChildByName)continue;const h=a.getChildByName(t,!0);if(h)return h}return null};zt.prototype.getGlobalPosition=function(t=new Et,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var mA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class _A extends ve{constructor(t=1){super(aA,mA,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const vA={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},xA=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function yA(i){const t=vA[i],e=t.length;let n=xA,s="";const a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let h;for(let l=0;l<i;l++){let c=a.replace("%index%",l.toString());h=l,l>=e&&(h=i-l-1),c=c.replace("%value%",t[h].toString()),s+=c,s+=`
`}return n=n.replace("%blur%",s),n=n.replace("%size%",i.toString()),n}const bA=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function wA(i,t){const e=Math.ceil(i/2);let n=bA,s="",a;t?a="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let h=0;h<i;h++){let l=a.replace("%index%",h.toString());l=l.replace("%sampleIndex%",`${h-(e-1)}.0`),s+=l,s+=`
`}return n=n.replace("%blur%",s),n=n.replace("%size%",i.toString()),n}class Kh extends ve{constructor(t,e=8,n=4,s=q.FILTER_RESOLUTION,a=5){const h=wA(a,t),l=yA(a);super(h,l),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,s){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,n,s);else{const a=t.getFilterTexture(),h=t.renderer;let l=e,c=a;this.state.blend=!1,t.applyFilter(this,l,c,di.CLEAR);for(let f=1;f<this.passes-1;f++){t.bindAndClear(l,di.BLIT),this.uniforms.uSampler=c;const d=c;c=l,l=d,h.shader.bind(this),h.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,n,s),t.returnFilterTexture(a)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class TA extends ve{constructor(t=8,e=4,n=ve.defaultResolution,s=5){super(),this.blurXFilter=new Kh(!0,t,e,n,s),this.blurYFilter=new Kh(!1,t,e,n,s),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,s){const a=Math.abs(this.blurXFilter.strength),h=Math.abs(this.blurYFilter.strength);if(a&&h){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,di.CLEAR),this.blurYFilter.apply(t,l,n,s),t.returnFilterTexture(l)}else h?this.blurYFilter.apply(t,e,n,s):this.blurXFilter.apply(t,e,n,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var EA=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Zh extends ve{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(np,EA,t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const n=t>>16&255,s=t>>8&255,a=t&255,h=[n/255,0,0,0,0,0,s/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(h,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),s=Math.sin(t),a=Math.sqrt,h=1/3,l=a(h),c=n+(1-n)*h,f=h*(1-n)-l*s,d=h*(1-n)+l*s,g=h*(1-n)+l*s,m=n+h*(1-n),v=h*(1-n)-l*s,x=h*(1-n)-l*s,A=h*(1-n)+l*s,T=n+h*(1-n),R=[c,f,d,0,0,g,m,v,0,0,x,A,T,0,0,0,0,0,1,0];this._loadMatrix(R,e)}contrast(t,e){const n=(t||0)+1,s=-.5*(n-1),a=[n,0,0,0,s,0,n,0,0,s,0,0,n,0,s,0,0,0,1,0];this._loadMatrix(a,e)}saturate(t=0,e){const n=t*2/3+1,s=(n-1)*-.5,a=[n,s,s,0,0,s,n,s,0,0,s,s,n,0,0,0,0,0,1,0];this._loadMatrix(a,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,n,s,a){t=t||.2,e=e||.15,n=n||16770432,s=s||3375104;const h=(n>>16&255)/255,l=(n>>8&255)/255,c=(n&255)/255,f=(s>>16&255)/255,d=(s>>8&255)/255,g=(s&255)/255,m=[.3,.59,.11,0,0,h,l,c,t,0,f,d,g,e,0,h-f,l-d,c-g,0,0];this._loadMatrix(m,a)}night(t,e){t=t||.1;const n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Zh.prototype.grayscale=Zh.prototype.greyscale;var AA=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,SA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class CA extends ve{constructor(t,e){const n=new Gt;t.renderable=!1,super(SA,AA,{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,e==null&&(e=20),this.scale=new Et(e,e)}apply(t,e,n,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const a=this.maskSprite.worldTransform,h=Math.sqrt(a.a*a.a+a.b*a.b),l=Math.sqrt(a.c*a.c+a.d*a.d);h!==0&&l!==0&&(this.uniforms.rotation[0]=a.a/h,this.uniforms.rotation[1]=a.b/h,this.uniforms.rotation[2]=a.c/l,this.uniforms.rotation[3]=a.d/l),t.applyFilter(this,e,n,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var IA=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,RA=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class PA extends ve{constructor(){super(RA,IA)}}var MA=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class DA extends ve{constructor(t=.5,e=Math.random()){super(np,MA,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Of={AlphaFilter:_A,BlurFilter:TA,BlurFilterPass:Kh,ColorMatrixFilter:Zh,DisplacementFilter:CA,FXAAFilter:PA,NoiseFilter:DA};Object.entries(Of).forEach(([i,t])=>{Object.defineProperty(Of,i,{get(){return At("7.1.0",`filters.${i} has moved to ${i}`),t}})});class Kr{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Kr.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Et,this.page=new Et,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,s,a){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class xo extends Kr{constructor(){super(...arguments),this.client=new Et,this.movement=new Et,this.offset=new Et,this.global=new Et,this.screen=new Et}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,s,a,h,l,c,f,d,g,m,v,x,A){throw new Error("Method not implemented.")}}class Qe extends xo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class Jh extends xo{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const BA=2048,FA=new Et,_h=new Et;class LA{constructor(t){this.dispatch=new jr,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((n,s)=>n.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,s=e.length;n<s;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const n=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,FA.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,a=n.length-1;s<a;s++)if(t.currentTarget=n[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=n.length-2;s>=0;s--)if(t.currentTarget=n[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const s=n.children;if(s)for(let a=0;a<s.length;a++)this.all(t,e,s[a]);t.currentTarget=n,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let n=0;n<BA&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,n,s,a){if(!t||!t.visible||a(t,n))return null;if(t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const c=h[l],f=this.hitTestRecursive(c,e||c.interactive,n,s,a);if(f){if(f.length>0&&!f[f.length-1].parent)continue;return(f.length>0||t.interactive)&&f.push(t),f}}}return e&&s(t,n)?t.interactive?[t]:[]:null}hitPruneFn(t,e){var n;if(t.hitArea&&(t.worldTransform.applyInverse(e,_h),!t.hitArea.contains(_h.x,_h.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((n=s.containsPoint)!=null&&n.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var a,h;e=e??t.type;const n=`on${e}`;(h=(a=t.currentTarget)[n])==null||h.call(a,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const n=this.trackingData(t.pointerId);n.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var l;if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t),n=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.overTargets);if(s.overTargets&&a!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(t,c,a);if(this.dispatchEvent(f,"pointerout"),n&&this.dispatchEvent(f,"mouseout"),!e.composedPath().includes(a)){const d=this.createPointerEvent(t,"pointerleave",a);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),n&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(f)}if(a!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(e,c);this.dispatchEvent(f,"pointerover"),n&&this.dispatchEvent(f,"mouseover");let d=a==null?void 0:a.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const m=this.clonePointerEvent(e,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==a&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),n&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const h=this.moveOnAll?"all":"dispatchEvent";this[h](e,"pointermove"),e.pointerType==="touch"&&this[h](e,"touchmove"),n&&(this[h](e,"mousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var h;if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),s=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),s&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(h=n.target)==null?void 0:h.cursor);const a=this.clonePointerEvent(n,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),s&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(a)}mapPointerOut(t){if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const n=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),a=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(a),n&&this.dispatchEvent(a,"mouseout");const h=this.createPointerEvent(t,"pointerleave",s);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),n&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;e.overTargets=null,this.freeEvent(a),this.freeEvent(h)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.dispatchEvent(n,l?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.pressTargetsByButton[t.button]);let h=a;if(a&&!n.composedPath().includes(a)){let l=a;for(;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}l=l.parent}delete s.pressTargetsByButton[t.button],h=l}if(h){const l=this.clonePointerEvent(n,"click");l.target=h,l.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const c=s.clicksByButton[t.button];c.target===l.target&&e-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=e,l.detail=c.clickCount,l.pointerType==="mouse"?this.dispatchEvent(l,"click"):l.pointerType==="touch"&&this.dispatchEvent(l,"tap"),this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof Qe)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(n){let a=n;for(;a;)s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),a=a.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof Jh)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const s=this.allocateEvent(Qe);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=n??this.hitTest(s.global.x,s.global.y),typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(Jh);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(Qe);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Qe&&e instanceof Qe&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof xo&&e instanceof xo&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n)if("fn"in n)n.fn.call(n.context,t);else for(let s=0,a=n.length;s<a&&!t.propagationImmediatelyStopped;s++)n[s].fn.call(n[s].context,t)}}const OA=1,NA={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class up{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new LA(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Qe(null),this.rootWheelEvent=new Jh(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let n=0,s=e.length;n<s;n++){const a=e[n],h=this.bootstrapEvent(this.rootPointerEvent,a);this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,s=e.length;n<s;n++){const a=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let a=0,h=s.length;a<h;a++){const l=this.bootstrapEvent(this.rootPointerEvent,s[a]);l.type+=n,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,s=e.length;n<s;n++){const a=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const a=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*a,t.y=(n-s.top)*(this.domElement.height/s.height)*a}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,s=t.changedTouches.length;n<s;n++){const a=t.changedTouches[n];typeof a.button>"u"&&(a.button=0),typeof a.buttons>"u"&&(a.buttons=1),typeof a.isPrimary>"u"&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,a.type=t.type,e.push(a)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=OA),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=NA[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}up.extension={name:"events",type:[j.RendererSystem,j.CanvasRendererSystem]};nt.add(up);const UA={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=n?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.on(i,t,s)},removeEventListener(i,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=n?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,s)},dispatchEvent(i){if(!(i instanceof Kr))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};zt.mixin(UA);const kA={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};zt.mixin(kA);const GA=9,Js=100,HA=0,WA=0,Nf=2,Uf=1,XA=-1e3,zA=-1e3,$A=2;class cp{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Bi.tablet||Bi.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${Js}px`,e.style.height=`${Js}px`,e.style.position="absolute",e.style.top=`${HA}px`,e.style.left=`${WA}px`,e.style.zIndex=Nf.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${Uf}px`,t.style.height=`${Uf}px`,t.style.position="absolute",t.style.top=`${XA}px`,t.style.left=`${zA}px`,t.style.zIndex=$A.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}update(){const t=performance.now();if(Bi.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:s,height:a}=this.renderer.view.getBoundingClientRect(),{width:h,height:l,resolution:c}=this.renderer,f=s/h*c,d=a/l*c;let g=this.div;g.style.left=`${e}px`,g.style.top=`${n}px`,g.style.width=`${h}px`,g.style.height=`${l}px`;for(let m=0;m<this.children.length;m++){const v=this.children[m];if(v.renderId!==this.renderId)v._accessibleActive=!1,nr(this.children,m,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,m--;else{g=v._accessibleDiv;let x=v.hitArea;const A=v.worldTransform;v.hitArea?(g.style.left=`${(A.tx+x.x*A.a)*f}px`,g.style.top=`${(A.ty+x.y*A.d)*d}px`,g.style.width=`${x.width*A.a*f}px`,g.style.height=`${x.height*A.d*d}px`):(x=v.getBounds(),this.capHitArea(x),g.style.left=`${x.x*f}px`,g.style.top=`${x.y*d}px`,g.style.width=`${x.width*f}px`,g.style.height=`${x.height*d}px`,g.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(g.title=v.accessibleTitle),g.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&g.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==g.title||v.tabIndex!==g.tabIndex)&&(g.title=v.accessibleTitle,g.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(g))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${Js}px`,e.style.height=`${Js}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Nf.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,s=this.renderer.events.rootBoundary,a=Object.assign(new Kr(s),{target:n});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(h=>s.dispatchEvent(a,h))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===GA&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}cp.extension={name:"accessibility",type:[j.RendererPlugin,j.CanvasRendererPlugin]};nt.add(cp);const Qh=class{constructor(i){this.stage=new Fe,i=Object.assign({forceCanvas:!1},i),this.renderer=rA(i),Qh._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(i,t){const e=Qh._plugins.slice(0);e.reverse(),e.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(i),this.renderer=null}};let ml=Qh;ml._plugins=[];nt.handleByList(j.Application,ml._plugins);class fp{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,n;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:a}=this._resizeTo;e=s,n=a}this.renderer.resize(e,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}fp.extension=j.Application;nt.add(fp);const kf={loader:j.LoadParser,resolver:j.ResolveParser,cache:j.CacheParser,detection:j.DetectionParser};nt.handle(j.Asset,i=>{const t=i.ref;Object.entries(kf).filter(([e])=>!!t[e]).forEach(([e,n])=>nt.add(Object.assign(t[e],{extension:t[e].extension??n})))},i=>{const t=i.ref;Object.keys(kf).filter(e=>!!t[e]).forEach(e=>nt.remove(t[e]))});class VA{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function dp(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function Mo(i,t){const e=i.split("?")[0],n=ce.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Fi=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);function pp(i,t,e,n,s){const a=t[e];for(let h=0;h<a.length;h++){const l=a[h];e<t.length-1?pp(i.replace(n[e],l),t,e+1,n,s):s.push(i.replace(n[e],l))}}function YA(i){const t=/\{(.*?)\}/g,e=i.match(t),n=[];if(e){const s=[];e.forEach(a=>{const h=a.substring(1,a.length-1).split(",");s.push(h)}),pp(i,s,0,e,n)}else n.push(i);return n}const yo=i=>!Array.isArray(i);class jA{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=Fi(t);let s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(e)){s=c.getCacheableAssets(n,e);break}}s||(s={},n.forEach(l=>{s[l]=e}));const a=Object.keys(s),h={cacheKeys:a,keys:n};if(n.forEach(l=>{this._cacheMap.set(l,h)}),a.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,s[l])}),e instanceof it){const l=e;n.forEach(c=>{l.baseTexture!==it.EMPTY.baseTexture&&ft.addToCache(l.baseTexture,c),it.addToCache(l,c)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(s=>{this._cache.delete(s)}),e.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Fr=new jA;class qA{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var a,h;let s=null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((a=c.test)!=null&&a.call(c,t,e,this))){s=await c.load(t,e,this),n.parser=c;break}}if(!n.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((h=c.testParse)==null?void 0:h.call(c,s,e,this))&&(s=await c.parse(s,e,this)||s,n.parser=c)}return s})(),n}async load(t,e){let n=0;const s={},a=yo(t),h=Fi(t,f=>({src:f})),l=h.length,c=h.map(async f=>{const d=ce.toAbsolute(f.src);if(!s[f.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,f)),s[f.src]=await this.promiseCache[d].promise,e&&e(++n/l)}catch(g){throw delete this.promiseCache[d],delete s[f.src],new Error(`[Loader.load] Failed to load ${d}.
${g}`)}});return await Promise.all(c),a?s[h[0].src]:s}async unload(t){const n=Fi(t,s=>({src:s})).map(async s=>{var l,c;const a=ce.toAbsolute(s.src),h=this.promiseCache[a];if(h){const f=await h.promise;(c=(l=h.parser)==null?void 0:l.unload)==null||c.call(l,f,s,this),delete this.promiseCache[a]}});await Promise.all(n)}get parsers(){return this._parsers}}var yi=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(yi||{});const KA={extension:{type:j.LoadParser,priority:yi.Low},test(i){return ce.extname(i).toLowerCase()===".json"},async load(i){return await(await q.ADAPTER.fetch(i)).json()}};nt.add(KA);const ZA={extension:{type:j.LoadParser,priority:yi.Low},test(i){return ce.extname(i).toLowerCase()===".txt"},async load(i){return await(await q.ADAPTER.fetch(i)).text()}};nt.add(ZA);const JA=["normal","bold","100","200","300","400","500","600","700","800","900"],QA=[".ttf",".otf",".woff",".woff2"],tS=["font/ttf","font/otf","font/woff","font/woff2"];function eS(i){const t=ce.extname(i);return ce.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}const iS={extension:{type:j.LoadParser,priority:yi.Low},test(i){return dp(i,tS)||Mo(i,QA)},async load(i,t){var n,s,a;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const e=q.ADAPTER.getFontFaceSet();if(e){const h=[],l=((n=t.data)==null?void 0:n.family)??eS(i),c=((a=(s=t.data)==null?void 0:s.weights)==null?void 0:a.filter(d=>JA.includes(d)))??["normal"],f=t.data??{};for(let d=0;d<c.length;d++){const g=c[d],m=new FontFace(l,`url(${encodeURI(i)})`,{...f,weight:g});await m.load(),e.add(m),h.push(m)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>q.ADAPTER.getFontFaceSet().delete(t))}};nt.add(iS);let Gf=0,vh;const nS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",rS={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${nS}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},sS={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let xh;class oS{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([rS.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",s=>{n.terminate(),URL.revokeObjectURL(e),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){vh===void 0&&(vh=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<vh&&(xh||(xh=URL.createObjectURL(new Blob([sS.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(xh),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((s,a)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:a})});return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[Gf]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Gf++,id:n})}}const Hf=new oS;function Do(i,t,e){const n=new it(i);return n.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),n}const aS=[".jpeg",".jpg",".png",".webp",".avif"],hS=["image/jpeg","image/png","image/webp","image/avif"];async function lS(i){const t=await q.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Vr={extension:{type:j.LoadParser,priority:yi.High},config:{preferWorkers:!0},test(i){return dp(i,hS)||Mo(i,aS)},async load(i,t,e){let n=null;globalThis.createImageBitmap?this.config.preferWorkers&&await Hf.isImageBitmapSupported()?n=await Hf.loadImageBitmap(i):n=await lS(i):n=await new Promise(a=>{n=new Image,n.crossOrigin="anonymous",n.src=i,n.complete?a(n):n.onload=()=>{a(n)}});const s=new ft(n,{resolution:Zi(i),...t.data});return s.resource.src=i,Do(s,e,i)},unload(i){i.destroy(!0)}};nt.add(Vr);const uS={extension:{type:j.LoadParser,priority:yi.High},test(i){return ce.extname(i).toLowerCase()===".svg"},async testParse(i){return $r.test(i)},async parse(i,t,e){var h,l,c;const n=new $r(i,(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions),s=new ft(n,{resolution:Zi(i),...t==null?void 0:t.data});s.resource.src=i;const a=Do(s,e,i);return(c=(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions)!=null&&c.autoLoad||await n.load(),a},async load(i,t){return(await q.ADAPTER.fetch(i)).text()},unload:Vr.unload};nt.add(uS);class cS{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,e)=>`${t}${this._bundleIdConnector}${e}`,this._extractAssetIdFromBundle=(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach(s=>{if(typeof s.name=="string"){const a=this._createBundleAssetId(t,s.name);n.push(a),this.add([s.name,a],s.srcs)}else{const a=s.name.map(h=>this._createBundleAssetId(t,h));a.forEach(h=>{n.push(h)}),this.add([...s.name,...a],s.srcs)}}):Object.keys(e).forEach(s=>{n.push(this._createBundleAssetId(t,s)),this.add([s,this._createBundleAssetId(t,s)],e[s])}),this._bundles[t]=n}add(t,e,n){const s=Fi(t);s.forEach(h=>{this._assetMap[h]&&console.warn(`[Resolver] already has key: ${h} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=YA(e):e=[e]);const a=e.map(h=>{let l=h;if(typeof h=="string"){let c=!1;for(let f=0;f<this._parsers.length;f++){const d=this._parsers[f];if(d.test(h)){l=d.parse(h),c=!0;break}}c||(l={src:h})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=s),(this._basePath||this._rootPath)&&(l.src=ce.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??n,l});s.forEach(h=>{this._assetMap[h]=a})}resolveBundle(t){const e=yo(t);t=Fi(t);const n={};return t.forEach(s=>{const a=this._bundles[s];if(a){const h=this.resolve(a),l={};for(const c in h){const f=h[c];l[this._extractAssetIdFromBundle(s,c)]=f}n[s]=l}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const s in e)n[s]=e[s].src;return n}return e.src}resolve(t){const e=yo(t);t=Fi(t);const n={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let a=this._assetMap[s];const h=this._getPreferredOrder(a),l=a[0];h==null||h.priority.forEach(c=>{h.params[c].forEach(f=>{const d=a.filter(g=>g[c]?g[c]===f:!1);d.length&&(a=d)})}),this._resolverHash[s]=a[0]??l}else{let a=s;(this._basePath||this._rootPath)&&(a=ce.toAbsolute(a,this._basePath,this._rootPath)),a=this._appendDefaultSearchParams(a),this._resolverHash[s]={src:a}}n[s]=this._resolverHash[s]}),e?n[t[0]]:n}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[0],s=this._preferredOrder.find(a=>a.params.format.includes(n.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class fS{constructor(){this._detections=[],this._initialized=!1,this.resolver=new cS,this.loader=new qA,this.cache=Fr,this._backgroundLoader=new VA(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var a,h,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let c=t.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const e=((a=t.texturePreference)==null?void 0:a.resolution)??1,n=typeof e=="number"?[e]:e;let s=[];if((h=t.texturePreference)!=null&&h.format){const c=(l=t.texturePreference)==null?void 0:l.format;s=typeof c=="string"?[c]:c;for(const f of this._detections)await f.test()||(s=await f.remove(s))}else for(const c of this._detections)await c.test()&&(s=await c.add(s));this.resolver.prefer({params:{format:s,resolution:n}})}add(t,e,n){this.resolver.add(t,e,n)}async load(t,e){this._initialized||await this.init();const n=yo(t),s=Fi(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):l),a=this.resolver.resolve(s),h=await this._mapLoadToResolve(a,e);return n?h[s[0]]:h}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const s=this.resolver.resolveBundle(t),a={},h=Object.keys(s);let l=0,c=0;const f=()=>{e==null||e(++l/c)},d=h.map(g=>{const m=s[g];return c+=Object.keys(m).length,this._mapLoadToResolve(m,f).then(v=>{a[g]=v})});return await Promise.all(d),n?a[t[0]]:a}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Fr.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=Fr.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const a=await this.loader.load(n,e);this._backgroundLoader.active=!0;const h={};return n.forEach((l,c)=>{const f=a[l.src],d=[l.src];l.alias&&d.push(...l.alias),h[s[c]]=f,Fr.set(d,f)}),h}async unload(t){this._initialized||await this.init();const e=Fi(t).map(s=>typeof s!="string"?s.src:s),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=Fi(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{Fr.remove(n.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return Vr.config.preferWorkers}set preferWorkers(t){Vr.config.preferWorkers=t}}const xn=new fS;nt.handleByList(j.LoadParser,xn.loader.parsers).handleByList(j.ResolveParser,xn.resolver.parsers).handleByList(j.CacheParser,xn.cache.parsers).handleByList(j.DetectionParser,xn.detections);const dS={extension:j.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof it),getCacheableAssets:(i,t)=>{const e={};return i.forEach(n=>{t.forEach((s,a)=>{e[n+(a===0?"":a+1)]=s})}),e}};nt.add(dS);const pS={extension:{type:j.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await q.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};nt.add(pS);const gS={extension:{type:j.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await q.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};nt.add(gS);const Wf=["png","jpg","jpeg"],mS={extension:{type:j.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Wf],remove:async i=>i.filter(t=>!Wf.includes(t))};nt.add(mS);const _S={extension:j.ResolveParser,test:Vr.test,parse:i=>{var t;return{resolution:parseFloat(((t=q.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};nt.add(_S);var De=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i))(De||{});const bo={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let Mi,qn;function Xf(){qn={s3tc:Mi.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Mi.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Mi.getExtension("WEBGL_compressed_texture_etc"),etc1:Mi.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Mi.getExtension("WEBGL_compressed_texture_pvrtc")||Mi.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Mi.getExtension("WEBGL_compressed_texture_atc"),astc:Mi.getExtension("WEBGL_compressed_texture_astc")}}const vS={extension:{type:j.DetectionParser,priority:2},test:async()=>{const t=q.ADAPTER.createCanvas().getContext("webgl");return t?(Mi=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{qn||Xf();const t=[];for(const e in qn)qn[e]&&t.push(e);return[...t,...i]},remove:async i=>(qn||Xf(),i.filter(t=>!(t in qn)))};nt.add(vS);class xS extends qr{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,s;typeof t=="string"?(n=t,s=new Uint8Array):(n=null,s=t),super(s,e),this.origin=n,this.buffer=s?new Gh(s):null,this.origin&&e.autoLoad!==!1&&this.load(),s!=null&&s.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const n=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(n),this.buffer=new Gh(n),this.loaded=!0,this.onBlobLoaded(n),this.update(),this}}class Tn extends xS{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Tn._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Tn._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let h=0,l=this.levels;h<l;h++){const{levelID:c,levelWidth:f,levelHeight:d,levelBuffer:g}=this._levelBuffers[h];s.compressedTexImage2D(s.TEXTURE_2D,c,this.format,f,d,0,g)}return!0}onBlobLoaded(){this._levelBuffers=Tn._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,n,s,a,h,l){const c=new Array(n);let f=t.byteOffset,d=h,g=l,m=d+s-1&~(s-1),v=g+a-1&~(a-1),x=m*v*bo[e];for(let A=0;A<n;A++)c[A]={levelID:A,levelWidth:n>1?d:m,levelHeight:n>1?g:v,levelBuffer:new Uint8Array(t.buffer,f,x)},f+=x,d=d>>1||1,g=g>>1||1,m=d+s-1&~(s-1),v=g+a-1&~(a-1),x=m*v*bo[e];return c}}const yh=4,Qs=124,yS=32,zf=20,bS=542327876,to={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},wS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},eo={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},TS=1,ES=2,AS=4,SS=64,CS=512,IS=131072,RS=827611204,PS=861165636,MS=894720068,DS=808540228,BS=4,FS={[RS]:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,[PS]:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,[MS]:De.COMPRESSED_RGBA_S3TC_DXT5_EXT},LS={[70]:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:De.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:De.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:De.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:De.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:De.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function OS(i){const t=new Uint32Array(i);if(t[0]!==bS)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(i,0,Qs/Uint32Array.BYTES_PER_ELEMENT),s=n[to.HEIGHT],a=n[to.WIDTH],h=n[to.MIPMAP_COUNT],l=new Uint32Array(i,to.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,yS/Uint32Array.BYTES_PER_ELEMENT),c=l[TS];if(c&AS){const f=l[wS.FOURCC];if(f!==DS){const E=FS[f],P=yh+Qs,U=new Uint8Array(i,P);return[new Tn(U,{format:E,width:a,height:s,levels:h})]}const d=yh+Qs,g=new Uint32Array(t.buffer,d,zf/Uint32Array.BYTES_PER_ELEMENT),m=g[eo.DXGI_FORMAT],v=g[eo.RESOURCE_DIMENSION],x=g[eo.MISC_FLAG],A=g[eo.ARRAY_SIZE],T=LS[m];if(T===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${m}`);if(x===BS)throw new Error("DDSParser does not support cubemap textures");if(v===6)throw new Error("DDSParser does not supported 3D texture data");const R=new Array,M=yh+Qs+zf;if(A===1)R.push(new Uint8Array(i,M));else{const E=bo[T];let P=0,U=a,z=s;for(let k=0;k<h;k++){const Z=Math.max(1,U+3&-4),rt=Math.max(1,z+3&-4),V=Z*rt*E;P+=V,U=U>>>1,z=z>>>1}let G=M;for(let k=0;k<A;k++)R.push(new Uint8Array(i,G,P)),G+=P}return R.map(E=>new Tn(E,{format:T,width:a,height:s,levels:h}))}throw c&SS?new Error("DDSParser does not support uncompressed texture data."):c&CS?new Error("DDSParser does not supported YUV uncompressed texture data."):c&IS?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&ES?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const $f=[171,75,84,88,32,49,49,187,13,10,26,10],NS=67305985,Ze={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},tl=64,Vf={[st.UNSIGNED_BYTE]:1,[st.UNSIGNED_SHORT]:2,[st.INT]:4,[st.UNSIGNED_INT]:4,[st.FLOAT]:4,[st.HALF_FLOAT]:8},US={[X.RGBA]:4,[X.RGB]:3,[X.RG]:2,[X.RED]:1,[X.LUMINANCE]:1,[X.LUMINANCE_ALPHA]:2,[X.ALPHA]:1},kS={[st.UNSIGNED_SHORT_4_4_4_4]:2,[st.UNSIGNED_SHORT_5_5_5_1]:2,[st.UNSIGNED_SHORT_5_6_5]:2};function GS(i,t,e=!1){const n=new DataView(t);if(!HS(i,n))return null;const s=n.getUint32(Ze.ENDIANNESS,!0)===NS,a=n.getUint32(Ze.GL_TYPE,s),h=n.getUint32(Ze.GL_FORMAT,s),l=n.getUint32(Ze.GL_INTERNAL_FORMAT,s),c=n.getUint32(Ze.PIXEL_WIDTH,s),f=n.getUint32(Ze.PIXEL_HEIGHT,s)||1,d=n.getUint32(Ze.PIXEL_DEPTH,s)||1,g=n.getUint32(Ze.NUMBER_OF_ARRAY_ELEMENTS,s)||1,m=n.getUint32(Ze.NUMBER_OF_FACES,s),v=n.getUint32(Ze.NUMBER_OF_MIPMAP_LEVELS,s),x=n.getUint32(Ze.BYTES_OF_KEY_VALUE_DATA,s);if(f===0||d!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(g!==1)throw new Error("WebGL does not support array textures");const A=4,T=4,R=c+3&-4,M=f+3&-4,E=new Array(g);let P=c*f;a===0&&(P=R*M);let U;if(a!==0?Vf[a]?U=Vf[a]*US[h]:U=kS[a]:U=bo[l],U===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const z=e?XS(n,x,s):null;let k=P*U,Z=c,rt=f,V=R,J=M,W=tl+x;for(let O=0;O<v;O++){const dt=n.getUint32(W,s);let _t=W+4;for(let Y=0;Y<g;Y++){let vt=E[Y];vt||(vt=E[Y]=new Array(v)),vt[O]={levelID:O,levelWidth:v>1||a!==0?Z:V,levelHeight:v>1||a!==0?rt:J,levelBuffer:new Uint8Array(t,_t,k)},_t+=k}W+=dt+4,W=W%4!==0?W+4-W%4:W,Z=Z>>1||1,rt=rt>>1||1,V=Z+A-1&~(A-1),J=rt+T-1&~(T-1),k=V*J*U}return a!==0?{uncompressed:E.map(O=>{let dt=O[0].levelBuffer,_t=!1;return a===st.FLOAT?dt=new Float32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4):a===st.UNSIGNED_INT?(_t=!0,dt=new Uint32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4)):a===st.INT&&(_t=!0,dt=new Int32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4)),{resource:new qr(dt,{width:O[0].levelWidth,height:O[0].levelHeight}),type:a,format:_t?WS(h):h}}),kvData:z}:{compressed:E.map(O=>new Tn(null,{format:l,width:c,height:f,levels:v,levelBuffers:O})),kvData:z}}function HS(i,t){for(let e=0;e<$f.length;e++)if(t.getUint8(e)!==$f[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function WS(i){switch(i){case X.RGBA:return X.RGBA_INTEGER;case X.RGB:return X.RGB_INTEGER;case X.RG:return X.RG_INTEGER;case X.RED:return X.RED_INTEGER;default:return i}}function XS(i,t,e){const n=new Map;let s=0;for(;s<t;){const a=i.getUint32(tl+s,e),h=tl+s+4,l=3-(a+3)%4;if(a===0||a>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<a&&i.getUint8(h+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const f=new TextDecoder().decode(new Uint8Array(i.buffer,h,c)),d=new DataView(i.buffer,h+c+1,a-c-1);n.set(f,d),s+=4+a+l}return n}const zS={extension:{type:j.LoadParser,priority:yi.High},test(i){return Mo(i,".dds")},async load(i,t,e){const s=await(await q.ADAPTER.fetch(i)).arrayBuffer(),h=OS(s).map(l=>{const c=new ft(l,{mipmap:xi.OFF,alphaMode:ai.NO_PREMULTIPLIED_ALPHA,resolution:Zi(i),...t.data});return Do(c,e,i)});return h.length===1?h[0]:h},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};nt.add(zS);const $S={extension:{type:j.LoadParser,priority:yi.High},test(i){return Mo(i,".ktx")},async load(i,t,e){const s=await(await q.ADAPTER.fetch(i)).arrayBuffer(),{compressed:a,uncompressed:h,kvData:l}=GS(i,s),c=a??h,f={mipmap:xi.OFF,alphaMode:ai.NO_PREMULTIPLIED_ALPHA,resolution:Zi(i),...t.data},d=c.map(g=>{c===h&&Object.assign(f,{type:g.type,format:g.format});const m=new ft(g,f);return m.ktxKeyValueData=l,Do(m,e,i)});return d.length===1?d[0]:d},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};nt.add($S);const VS={extension:j.ResolveParser,test:i=>{const e=i.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:i=>{var n,s;if(i.split("?")[0].split(".").pop()==="ktx"){const a=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(a.some(h=>i.endsWith(h)))return{resolution:parseFloat(((n=q.RETINA_PREFIX.exec(i))==null?void 0:n[1])??"1"),format:a.find(h=>i.endsWith(h)),src:i}}return{resolution:parseFloat(((s=q.RETINA_PREFIX.exec(i))==null?void 0:s[1])??"1"),format:i.split(".").pop(),src:i}}};nt.add(VS);const Yf=new wt,jf=4,el=class{constructor(i){this.renderer=i}async image(i,t,e){const n=new Image;return n.src=await this.base64(i,t,e),n}async base64(i,t,e){const n=this.canvas(i);if(n.toDataURL!==void 0)return n.toDataURL(t,e);if(n.convertToBlob!==void 0){const s=await n.convertToBlob({type:t,quality:e});return await new Promise(a=>{const h=new FileReader;h.onload=()=>a(h.result),h.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(i,t){const e=this.renderer;let n,s=!1,a,h=!1;i&&(i instanceof tn?a=i:(a=this.renderer.generateTexture(i),h=!0)),a?(n=a.baseTexture.resolution,t=t??a.frame,s=!1,e.renderTexture.bind(a)):(n=e.resolution,t||(t=Yf,t.width=e.width,t.height=e.height),s=!0,e.renderTexture.bind(null));const l=Math.round(t.width*n),c=Math.round(t.height*n);let f=new wf(l,c,1);const d=new Uint8Array(jf*l*c),g=e.gl;g.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,c,g.RGBA,g.UNSIGNED_BYTE,d);const m=f.context.getImageData(0,0,l,c);if(el.arrayPostDivide(d,m.data),f.context.putImageData(m,0,0),s){const v=new wf(f.width,f.height,1);v.context.scale(1,-1),v.context.drawImage(f.canvas,0,-c),f.destroy(),f=v}return h&&a.destroy(!0),f.canvas}pixels(i,t){const e=this.renderer;let n,s,a=!1;i&&(i instanceof tn?s=i:(s=this.renderer.generateTexture(i),a=!0)),s?(n=s.baseTexture.resolution,t=t??s.frame,e.renderTexture.bind(s)):(n=e.resolution,t||(t=Yf,t.width=e.width,t.height=e.height),e.renderTexture.bind(null));const h=Math.round(t.width*n),l=Math.round(t.height*n),c=new Uint8Array(jf*h*l),f=e.gl;return f.readPixels(Math.round(t.x*n),Math.round(t.y*n),h,l,f.RGBA,f.UNSIGNED_BYTE,c),a&&s.destroy(!0),el.arrayPostDivide(c,c),c}destroy(){this.renderer=null}static arrayPostDivide(i,t){for(let e=0;e<i.length;e+=4){const n=t[e+3]=i[e+3];n!==0?(t[e]=Math.round(Math.min(i[e]*255/n,255)),t[e+1]=Math.round(Math.min(i[e+1]*255/n,255)),t[e+2]=Math.round(Math.min(i[e+2]*255/n,255))):(t[e]=i[e],t[e+1]=i[e+1],t[e+2]=i[e+2])}}};let gp=el;gp.extension={name:"extract",type:j.RendererSystem};nt.add(gp);const wo={build(i){const t=i.points;let e,n,s,a,h,l;if(i.type===ue.CIRC){const x=i.shape;e=x.x,n=x.y,h=l=x.radius,s=a=0}else if(i.type===ue.ELIP){const x=i.shape;e=x.x,n=x.y,h=x.width,l=x.height,s=a=0}else{const x=i.shape,A=x.width/2,T=x.height/2;e=x.x+A,n=x.y+T,h=l=Math.max(0,Math.min(x.radius,Math.min(A,T))),s=A-h,a=T-l}if(!(h>=0&&l>=0&&s>=0&&a>=0)){t.length=0;return}const c=Math.ceil(2.3*Math.sqrt(h+l)),f=c*8+(s?4:0)+(a?4:0);if(t.length=f,f===0)return;if(c===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=n+a,t[2]=t[4]=e-s,t[5]=t[7]=n-a;return}let d=0,g=c*4+(s?2:0)+2,m=g,v=f;{const x=s+h,A=a,T=e+x,R=e-x,M=n+A;if(t[d++]=T,t[d++]=M,t[--g]=M,t[--g]=R,a){const E=n-A;t[m++]=R,t[m++]=E,t[--v]=E,t[--v]=T}}for(let x=1;x<c;x++){const A=Math.PI/2*(x/c),T=s+Math.cos(A)*h,R=a+Math.sin(A)*l,M=e+T,E=e-T,P=n+R,U=n-R;t[d++]=M,t[d++]=P,t[--g]=P,t[--g]=E,t[m++]=E,t[m++]=U,t[--v]=U,t[--v]=M}{const x=s,A=a+l,T=e+x,R=e-x,M=n+A,E=n-A;t[d++]=T,t[d++]=M,t[--v]=E,t[--v]=T,s&&(t[d++]=R,t[d++]=M,t[--v]=E,t[--v]=R)}},triangulate(i,t){const e=i.points,n=t.points,s=t.indices;if(e.length===0)return;let a=n.length/2;const h=a;let l,c;if(i.type!==ue.RREC){const d=i.shape;l=d.x,c=d.y}else{const d=i.shape;l=d.x+d.width/2,c=d.y+d.height/2}const f=i.matrix;n.push(i.matrix?f.a*l+f.c*c+f.tx:l,i.matrix?f.b*l+f.d*c+f.ty:c),a++,n.push(e[0],e[1]);for(let d=2;d<e.length;d+=2)n.push(e[d],e[d+1]),s.push(a++,h,a);s.push(h+1,h,a)}};function qf(i,t=!1){const e=i.length;if(e<6)return;let n=0;for(let s=0,a=i[e-2],h=i[e-1];s<e;s+=2){const l=i[s],c=i[s+1];n+=(l-a)*(c+h),a=l,h=c}if(!t&&n>0||t&&n<=0){const s=e/2;for(let a=s+s%2;a<e;a+=2){const h=e-a-2,l=e-a-1,c=a,f=a+1;[i[h],i[c]]=[i[c],i[h]],[i[l],i[f]]=[i[f],i[l]]}}}const mp={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const n=i.holes,s=t.points,a=t.indices;if(e.length>=6){qf(e,!1);const h=[];for(let f=0;f<n.length;f++){const d=n[f];qf(d.points,!0),h.push(e.length/2),e=e.concat(d.points)}const l=hl.exports(e,h,2);if(!l)return;const c=s.length/2;for(let f=0;f<l.length;f+=3)a.push(l[f]+c),a.push(l[f+1]+c),a.push(l[f+2]+c);for(let f=0;f<e.length;f++)s.push(e[f])}}},YS={build(i){const t=i.shape,e=t.x,n=t.y,s=t.width,a=t.height,h=i.points;h.length=0,s>=0&&a>=0&&h.push(e,n,e+s,n,e+s,n+a,e,n+a)},triangulate(i,t){const e=i.points,n=t.points;if(e.length===0)return;const s=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},jS={build(i){wo.build(i)},triangulate(i,t){wo.triangulate(i,t)}};var ji=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(ji||{}),yn=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(yn||{});const ar={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Kf{static curveTo(t,e,n,s,a,h){const l=h[h.length-2],f=h[h.length-1]-e,d=l-t,g=s-e,m=n-t,v=Math.abs(f*m-d*g);if(v<1e-8||a===0)return(h[h.length-2]!==t||h[h.length-1]!==e)&&h.push(t,e),null;const x=f*f+d*d,A=g*g+m*m,T=f*g+d*m,R=a*Math.sqrt(x)/v,M=a*Math.sqrt(A)/v,E=R*T/x,P=M*T/A,U=R*m+M*d,z=R*g+M*f,G=d*(M+E),k=f*(M+E),Z=m*(R+P),rt=g*(R+P),V=Math.atan2(k-z,G-U),J=Math.atan2(rt-z,Z-U);return{cx:U+t,cy:z+e,radius:a,startAngle:V,endAngle:J,anticlockwise:d*g>m*f}}static arc(t,e,n,s,a,h,l,c,f){const d=l-h,g=ar._segmentsCount(Math.abs(d)*a,Math.ceil(Math.abs(d)/_o)*40),m=d/(g*2),v=m*2,x=Math.cos(m),A=Math.sin(m),T=g-1,R=T%1/T;for(let M=0;M<=T;++M){const E=M+R*M,P=m+h+v*E,U=Math.cos(P),z=-Math.sin(P);f.push((x*U+A*z)*a+n,(x*-z+A*U)*a+s)}}}class qS{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class _l{static curveLength(t,e,n,s,a,h,l,c){let d=0,g=0,m=0,v=0,x=0,A=0,T=0,R=0,M=0,E=0,P=0,U=t,z=e;for(let G=1;G<=10;++G)g=G/10,m=g*g,v=m*g,x=1-g,A=x*x,T=A*x,R=T*t+3*A*g*n+3*x*m*a+v*l,M=T*e+3*A*g*s+3*x*m*h+v*c,E=U-R,P=z-M,U=R,z=M,d+=Math.sqrt(E*E+P*P);return d}static curveTo(t,e,n,s,a,h,l){const c=l[l.length-2],f=l[l.length-1];l.length-=2;const d=ar._segmentsCount(_l.curveLength(c,f,t,e,n,s,a,h));let g=0,m=0,v=0,x=0,A=0;l.push(c,f);for(let T=1,R=0;T<=d;++T)R=T/d,g=1-R,m=g*g,v=m*g,x=R*R,A=x*R,l.push(v*c+3*m*R*t+3*g*x*n+A*a,v*f+3*m*R*e+3*g*x*s+A*h)}}function Zf(i,t,e,n,s,a,h,l){const c=i-e*s,f=t-n*s,d=i+e*a,g=t+n*a;let m,v;h?(m=n,v=-e):(m=-n,v=e);const x=c+m,A=f+v,T=d+m,R=g+v;return l.push(x,A),l.push(T,R),2}function pn(i,t,e,n,s,a,h,l){const c=e-i,f=n-t;let d=Math.atan2(c,f),g=Math.atan2(s-i,a-t);l&&d<g?d+=Math.PI*2:!l&&d>g&&(g+=Math.PI*2);let m=d;const v=g-d,x=Math.abs(v),A=Math.sqrt(c*c+f*f),T=(15*x*Math.sqrt(A)/Math.PI>>0)+1,R=v/T;if(m+=R,l){h.push(i,t),h.push(e,n);for(let M=1,E=m;M<T;M++,E+=R)h.push(i,t),h.push(i+Math.sin(E)*A,t+Math.cos(E)*A);h.push(i,t),h.push(s,a)}else{h.push(e,n),h.push(i,t);for(let M=1,E=m;M<T;M++,E+=R)h.push(i+Math.sin(E)*A,t+Math.cos(E)*A),h.push(i,t);h.push(s,a),h.push(i,t)}return T*2}function KS(i,t){const e=i.shape;let n=i.points||e.points.slice();const s=t.closePointEps;if(n.length===0)return;const a=i.lineStyle,h=new Et(n[0],n[1]),l=new Et(n[n.length-2],n[n.length-1]),c=e.type!==ue.POLY||e.closeStroke,f=Math.abs(h.x-l.x)<s&&Math.abs(h.y-l.y)<s;if(c){n=n.slice(),f&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const Y=(h.x+l.x)*.5,vt=(l.y+h.y)*.5;n.unshift(Y,vt),n.push(Y,vt)}const d=t.points,g=n.length/2;let m=n.length;const v=d.length/2,x=a.width/2,A=x*x,T=a.miterLimit*a.miterLimit;let R=n[0],M=n[1],E=n[2],P=n[3],U=0,z=0,G=-(M-P),k=R-E,Z=0,rt=0,V=Math.sqrt(G*G+k*k);G/=V,k/=V,G*=x,k*=x;const J=a.alignment,W=(1-J)*2,O=J*2;c||(a.cap===yn.ROUND?m+=pn(R-G*(W-O)*.5,M-k*(W-O)*.5,R-G*W,M-k*W,R+G*O,M+k*O,d,!0)+2:a.cap===yn.SQUARE&&(m+=Zf(R,M,G,k,W,O,!0,d))),d.push(R-G*W,M-k*W),d.push(R+G*O,M+k*O);for(let Y=1;Y<g-1;++Y){R=n[(Y-1)*2],M=n[(Y-1)*2+1],E=n[Y*2],P=n[Y*2+1],U=n[(Y+1)*2],z=n[(Y+1)*2+1],G=-(M-P),k=R-E,V=Math.sqrt(G*G+k*k),G/=V,k/=V,G*=x,k*=x,Z=-(P-z),rt=E-U,V=Math.sqrt(Z*Z+rt*rt),Z/=V,rt/=V,Z*=x,rt*=x;const vt=E-R,Ut=M-P,H=E-U,et=z-P,yt=vt*H+Ut*et,Ct=Ut*H-et*vt,Rt=Ct<0;if(Math.abs(Ct)<.001*Math.abs(yt)){d.push(E-G*W,P-k*W),d.push(E+G*O,P+k*O),yt>=0&&(a.join===ji.ROUND?m+=pn(E,P,E-G*W,P-k*W,E-Z*W,P-rt*W,d,!1)+4:m+=2,d.push(E-Z*O,P-rt*O),d.push(E+Z*W,P+rt*W));continue}const Ft=(-G+R)*(-k+P)-(-G+E)*(-k+M),Lt=(-Z+U)*(-rt+P)-(-Z+E)*(-rt+z),Jt=(vt*Lt-H*Ft)/Ct,$t=(et*Ft-Ut*Lt)/Ct,Qt=(Jt-E)*(Jt-E)+($t-P)*($t-P),ee=E+(Jt-E)*W,Pt=P+($t-P)*W,Ot=E-(Jt-E)*O,Vt=P-($t-P)*O,Yt=Math.min(vt*vt+Ut*Ut,H*H+et*et),fe=Rt?W:O,nn=Yt+fe*fe*A;Qt<=nn?a.join===ji.BEVEL||Qt/A>T?(Rt?(d.push(ee,Pt),d.push(E+G*O,P+k*O),d.push(ee,Pt),d.push(E+Z*O,P+rt*O)):(d.push(E-G*W,P-k*W),d.push(Ot,Vt),d.push(E-Z*W,P-rt*W),d.push(Ot,Vt)),m+=2):a.join===ji.ROUND?Rt?(d.push(ee,Pt),d.push(E+G*O,P+k*O),m+=pn(E,P,E+G*O,P+k*O,E+Z*O,P+rt*O,d,!0)+4,d.push(ee,Pt),d.push(E+Z*O,P+rt*O)):(d.push(E-G*W,P-k*W),d.push(Ot,Vt),m+=pn(E,P,E-G*W,P-k*W,E-Z*W,P-rt*W,d,!1)+4,d.push(E-Z*W,P-rt*W),d.push(Ot,Vt)):(d.push(ee,Pt),d.push(Ot,Vt)):(d.push(E-G*W,P-k*W),d.push(E+G*O,P+k*O),a.join===ji.ROUND?Rt?m+=pn(E,P,E+G*O,P+k*O,E+Z*O,P+rt*O,d,!0)+2:m+=pn(E,P,E-G*W,P-k*W,E-Z*W,P-rt*W,d,!1)+2:a.join===ji.MITER&&Qt/A<=T&&(Rt?(d.push(Ot,Vt),d.push(Ot,Vt)):(d.push(ee,Pt),d.push(ee,Pt)),m+=2),d.push(E-Z*W,P-rt*W),d.push(E+Z*O,P+rt*O),m+=2)}R=n[(g-2)*2],M=n[(g-2)*2+1],E=n[(g-1)*2],P=n[(g-1)*2+1],G=-(M-P),k=R-E,V=Math.sqrt(G*G+k*k),G/=V,k/=V,G*=x,k*=x,d.push(E-G*W,P-k*W),d.push(E+G*O,P+k*O),c||(a.cap===yn.ROUND?m+=pn(E-G*(W-O)*.5,P-k*(W-O)*.5,E-G*W,P-k*W,E+G*O,P+k*O,d,!1)+2:a.cap===yn.SQUARE&&(m+=Zf(E,P,G,k,W,O,!1,d)));const dt=t.indices,_t=ar.epsilon*ar.epsilon;for(let Y=v;Y<m+v-2;++Y)R=d[Y*2],M=d[Y*2+1],E=d[(Y+1)*2],P=d[(Y+1)*2+1],U=d[(Y+2)*2],z=d[(Y+2)*2+1],!(Math.abs(R*(P-z)+E*(z-M)+U*(M-P))<_t)&&dt.push(Y,Y+1,Y+2)}function ZS(i,t){let e=0;const n=i.shape,s=i.points||n.points,a=n.type!==ue.POLY||n.closeStroke;if(s.length===0)return;const h=t.points,l=t.indices,c=s.length/2,f=h.length/2;let d=f;for(h.push(s[0],s[1]),e=1;e<c;e++)h.push(s[e*2],s[e*2+1]),l.push(d,d+1),d++;a&&l.push(d,f)}function Jf(i,t){i.lineStyle.native?ZS(i,t):KS(i,t)}class vl{static curveLength(t,e,n,s,a,h){const l=t-2*n+a,c=e-2*s+h,f=2*n-2*t,d=2*s-2*e,g=4*(l*l+c*c),m=4*(l*f+c*d),v=f*f+d*d,x=2*Math.sqrt(g+m+v),A=Math.sqrt(g),T=2*g*A,R=2*Math.sqrt(v),M=m/A;return(T*x+A*m*(x-R)+(4*v*g-m*m)*Math.log((2*A+M+x)/(M+R)))/(4*T)}static curveTo(t,e,n,s,a){const h=a[a.length-2],l=a[a.length-1],c=ar._segmentsCount(vl.curveLength(h,l,t,e,n,s));let f=0,d=0;for(let g=1;g<=c;++g){const m=g/c;f=h+(t-h)*m,d=l+(e-l)*m,a.push(f+(t+(n-t)*m-f)*m,d+(e+(s-e)*m-d)*m)}}}const bh={[ue.POLY]:mp,[ue.CIRC]:wo,[ue.ELIP]:wo,[ue.RECT]:YS,[ue.RREC]:jS},Qf=[],io=[];class To{constructor(t,e=null,n=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new To(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Vn=new Et,_p=class extends bd{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new vo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),io.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t.reset(),Qf.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,t=null,e=null,n=null){const s=new To(i,t,e,n);return this.graphicsData.push(s),this.dirty++,this}drawHole(i,t=null){if(!this.graphicsData.length)return null;const e=new To(i,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=n.lineStyle,n.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){const t=this.graphicsData;for(let e=0;e<t.length;++e){const n=t[e];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(i,Vn):Vn.copyFrom(i),n.shape.contains(Vn.x,Vn.y))){let s=!1;if(n.holes){for(let a=0;a<n.holes.length;a++)if(n.holes[a].shape.contains(Vn.x,Vn.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const i=this.uvs,t=this.graphicsData;let e=null,n=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],n=e.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const c=t[l],f=c.fillStyle,d=c.lineStyle;bh[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(f.visible||d.visible)&&this.processHoles(c.holes);for(let m=0;m<2;m++){const v=m===0?f:d;if(!v.visible)continue;const x=v.texture.baseTexture,A=this.indices.length,T=this.points.length/2;x.wrapMode=Ki.REPEAT,m===0?this.processFill(c):this.processLine(c);const R=this.points.length/2-T;R!==0&&(e&&!this._compareStyles(n,v)&&(e.end(A,T),e=null),e||(e=Qf.pop()||new qS,e.begin(v,A,T),this.batches.push(e),n=v),this.addUvs(this.points,i,v.texture,T,R,v.matrix))}}const s=this.indices.length,a=this.points.length/2;if(e&&e.end(s,a),this.batches.length===0){this.batchable=!0;return}const h=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,t){return!(!i||!t||i.texture.baseTexture!==t.texture.baseTexture||i.color+i.alpha!==t.color+t.alpha||!!i.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,t=this.graphicsData.length;i<t;i++){const e=this.graphicsData[i],n=e.fillStyle,s=e.lineStyle;if(n&&!n.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const i=this.batches;for(let t=0,e=i.length;t<e;t++){const n=i[t];for(let s=0;s<n.size;s++){const a=n.start+s;this.indicesUint16[a]=this.indicesUint16[a]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const i=this.batches;for(let t=0;t<i.length;t++)if(i[t].style.native)return!1;return this.points.length<_p.BATCHABLE_SIZE*2}buildDrawCalls(){let i=++ft._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),io.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let n=io.pop();n||(n=new Wh,n.texArray=new zh),n.texArray.count=0,n.start=0,n.size=0,n.type=gi.TRIANGLES;let s=0,a=null,h=0,l=!1,c=gi.TRIANGLES,f=0;this.drawCalls.push(n);for(let d=0;d<this.batches.length;d++){const g=this.batches[d],m=8,v=g.style,x=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,c=l?gi.LINES:gi.TRIANGLES,a=null,s=m,i++),a!==x&&(a=x,x._batchEnabled!==i&&(s===m&&(i++,s=0,n.size>0&&(n=io.pop(),n||(n=new Wh,n.texArray=new zh),this.drawCalls.push(n)),n.start=f,n.size=0,n.texArray.count=0,n.type=c),x.touched=1,x._batchEnabled=i,x._batchLocation=s,x.wrapMode=Ki.REPEAT,n.texArray.elements[n.texArray.count++]=x,s++)),n.size+=g.size,f+=g.size,h=x._batchLocation,this.addColors(t,v.color,v.alpha,g.attribSize,g.attribStart),this.addTextureIds(e,h,g.attribSize,g.attribStart)}ft._globalBatch=i,this.packAttributes()}packAttributes(){const i=this.points,t=this.uvs,e=this.colors,n=this.textureIds,s=new ArrayBuffer(i.length*3*4),a=new Float32Array(s),h=new Uint32Array(s);let l=0;for(let c=0;c<i.length/2;c++)a[l++]=i[c*2],a[l++]=i[c*2+1],a[l++]=t[c*2],a[l++]=t[c*2+1],h[l++]=e[c],a[l++]=n[c];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?mp.triangulate(i,this):bh[i.type].triangulate(i,this)}processLine(i){Jf(i,this);for(let t=0;t<i.holes.length;t++)Jf(i.holes[t],this)}processHoles(i){for(let t=0;t<i.length;t++){const e=i[t];bh[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,t){for(let e=0;e<i.length/2;e++){const n=i[e*2],s=i[e*2+1];i[e*2]=t.a*n+t.c*s+t.tx,i[e*2+1]=t.b*n+t.d*s+t.ty}}addColors(i,t,e,n,s=0){const a=(t>>16)+(t&65280)+((t&255)<<16),h=ul(a,e);i.length=Math.max(i.length,s+n);for(let l=0;l<n;l++)i[s+l]=h}addTextureIds(i,t,e,n=0){i.length=Math.max(i.length,n+e);for(let s=0;s<e;s++)i[n+s]=t}addUvs(i,t,e,n,s,a=null){let h=0;const l=t.length,c=e.frame;for(;h<s;){let d=i[(n+h)*2],g=i[(n+h)*2+1];if(a){const m=a.a*d+a.c*g+a.tx;g=a.b*d+a.d*g+a.ty,d=m}h++,t.push(d/c.width,g/c.height)}const f=e.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(t,e,l,s)}adjustUvs(i,t,e,n){const s=t.baseTexture,a=1e-6,h=e+n*2,l=t.frame,c=l.width/s.width,f=l.height/s.height;let d=l.x/l.width,g=l.y/l.height,m=Math.floor(i[e]+a),v=Math.floor(i[e+1]+a);for(let x=e+2;x<h;x+=2)m=Math.min(m,Math.floor(i[x]+a)),v=Math.min(v,Math.floor(i[x+1]+a));d-=m,g-=v;for(let x=e;x<h;x+=2)i[x]=(i[x]+d)*c,i[x+1]=(i[x+1]+g)*f}};let vp=_p;vp.BATCHABLE_SIZE=100;class Bo{constructor(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new Bo;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class xl extends Bo{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=yn.BUTT,this.join=ji.MITER,this.miterLimit=10}clone(){const t=new xl;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const JS=new Float32Array(3),wh={},co=class extends Fe{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new Bo,this._lineStyle=new xl,this._matrix=null,this._holeMode=!1,this.state=Oi.for2d(),this._geometry=i||new vp,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=lt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new co(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(i){this._tint=i}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,t=0,e=1,n=.5,s=!1){return typeof i=="number"&&(i={width:i,color:t,alpha:e,alignment:n,native:s}),this.lineTextureStyle(i)}lineTextureStyle(i){i=Object.assign({width:0,texture:it.WHITE,color:i!=null&&i.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:yn.BUTT,join:ji.MITER,miterLimit:10},i),this.currentPath&&this.startPoly();const t=i.width>0&&i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:t},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const i=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new rr,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[t-2],i[t-1]))}else this.currentPath=new rr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,t){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=t,this}lineTo(i,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,n=e[e.length-2],s=e[e.length-1];return(n!==i||s!==t)&&e.push(i,t),this}_initCurve(i=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[i,t]):this.moveTo(i,t)}quadraticCurveTo(i,t,e,n){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),vl.curveTo(i,t,e,n,s),this}bezierCurveTo(i,t,e,n,s,a){return this._initCurve(),_l.curveTo(i,t,e,n,s,a,this.currentPath.points),this}arcTo(i,t,e,n,s){this._initCurve(i,t);const a=this.currentPath.points,h=Kf.curveTo(i,t,e,n,s,a);if(h){const{cx:l,cy:c,radius:f,startAngle:d,endAngle:g,anticlockwise:m}=h;this.arc(l,c,f,d,g,m)}return this}arc(i,t,e,n,s,a=!1){if(n===s)return this;if(!a&&s<=n?s+=_o:a&&n<=s&&(n+=_o),s-n===0)return this;const l=i+Math.cos(n)*e,c=t+Math.sin(n)*e,f=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const g=Math.abs(d[d.length-2]-l),m=Math.abs(d[d.length-1]-c);g<f&&m<f||d.push(l,c)}else this.moveTo(l,c),d=this.currentPath.points;return Kf.arc(l,c,i,t,e,n,s,a,d),this}beginFill(i=0,t=1){return this.beginTextureFill({texture:it.WHITE,color:i,alpha:t})}beginTextureFill(i){i=Object.assign({texture:it.WHITE,color:16777215,alpha:1,matrix:null},i),this.currentPath&&this.startPoly();const t=i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:t},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,t,e,n){return this.drawShape(new wt(i,t,e,n))}drawRoundedRect(i,t,e,n,s){return this.drawShape(new dl(i,t,e,n,s))}drawCircle(i,t,e){return this.drawShape(new cl(i,t,e))}drawEllipse(i,t,e,n){return this.drawShape(new fl(i,t,e,n))}drawPolygon(...i){let t,e=!0;const n=i[0];n.points?(e=n.closeStroke,t=n.points):Array.isArray(i[0])?t=i[0]:t=i;const s=new rr(t);return s.closeStroke=e,this.drawShape(s),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const i=this._geometry.graphicsData;return i.length===1&&i[0].shape.type===ue.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){const i=this._geometry,t=this.blendMode,e=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(i.points);for(let n=0;n<e;n++){const s=i.batches[n],a=s.style.color,h=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(i.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),c=new Uint16Array(i.indicesUint16.buffer,s.start*2,s.size),f={vertexData:h,blendMode:t,indices:c,uvs:l,_batchRGB:Xr(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[n]=f}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,i.plugins[this.pluginName].render(n)}}}_renderDirect(i){const t=this._resolveDirectShader(i),e=this._geometry,n=this.tint,s=this.worldAlpha,a=t.uniforms,h=e.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(n>>16&255)/255*s,a.tint[1]=(n>>8&255)/255*s,a.tint[2]=(n&255)/255*s,a.tint[3]=s,i.shader.bind(t),i.geometry.bind(e,t),i.state.set(this.state);for(let l=0,c=h.length;l<c;l++)this._renderDrawCallDirect(i,e.drawCalls[l])}_renderDrawCallDirect(i,t){const{texArray:e,type:n,size:s,start:a}=t,h=e.count;for(let l=0;l<h;l++)i.texture.bind(e.elements[l],l);i.geometry.draw(n,s,a)}_resolveDirectShader(i){let t=this.shader;const e=this.pluginName;if(!t){if(!wh[e]){const{maxTextures:n}=i.plugins[e],s=new Int32Array(n);for(let l=0;l<n;l++)s[l]=l;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Gt,default:oi.from({uSamplers:s},!0)},h=i.plugins[e]._shader.program;wh[e]=new _i(h,a)}t=wh[e]}return t}_calculateBounds(){this.finishPoly();const i=this._geometry;if(!i.graphicsData.length)return;const{minX:t,minY:e,maxX:n,maxY:s}=i.bounds;this._bounds.addFrame(this.transform,t,e,n,s)}containsPoint(i){return this.worldTransform.applyInverse(i,co._TEMP_POINT),this._geometry.containsPoint(co._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const i=Xr(this.tint,JS);for(let t=0;t<this.batches.length;t++){const e=this.batches[t],n=e._batchRGB,s=i[0]*n[0]*255,a=i[1]*n[1]*255,h=i[2]*n[2]*255,l=(s<<16)+(a<<8)+(h|0);e._tintRGB=(l>>16)+(l&65280)+((l&255)<<16)}}}calculateVertices(){const i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;const t=this.transform.worldTransform,e=t.a,n=t.b,s=t.c,a=t.d,h=t.tx,l=t.ty,c=this._geometry.points,f=this.vertexData;let d=0;for(let g=0;g<c.length;g+=2){const m=c[g],v=c[g+1];f[d++]=e*m+s*v+h,f[d++]=a*v+n*m+l}}closePath(){const i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};let Fo=co;Fo.curves=ar;Fo._TEMP_POINT=new Et;class QS{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const Th=new Et,td=new rr,xp=class extends Fe{constructor(i,t,e,n=gi.TRIANGLES){super(),this.geometry=i,this.shader=t,this.state=e||Oi.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=q.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(i){this._geometry!==i&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=i,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(i){this.shader=i}get material(){return this.shader}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(i){this.shader.tint=i}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(i){this.shader.texture=i}_render(i){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===gi.TRIANGLES&&t.length<xp.BATCHABLE_SIZE*2?this._renderToBatch(i):this._renderDefault(i)}_renderDefault(i){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),i.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),i.shader.bind(t),i.state.set(this.state),i.geometry.bind(this.geometry,t),i.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(i){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const n=this.material.pluginName;i.batch.setObjectRenderer(i.plugins[n]),i.plugins[n].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,a=s.a,h=s.b,l=s.c,c=s.d,f=s.tx,d=s.ty,g=this.vertexData;for(let m=0;m<g.length/2;m++){const v=e[m*2],x=e[m*2+1];g[m*2]=a*v+l*x+f,g[m*2+1]=h*v+c*x+d}if(this._roundPixels){const m=q.RESOLUTION;for(let v=0;v<g.length;++v)g[v]=Math.round(g[v]*m)/m}this.vertexDirty=n}calculateUvs(){const i=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=i.data:(this.batchUvs||(this.batchUvs=new QS(i,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(i){if(!this.getBounds().contains(i.x,i.y))return!1;this.worldTransform.applyInverse(i,Th);const t=this.geometry.getBuffer("aVertexPosition").data,e=td.points,n=this.geometry.getIndex().data,s=n.length,a=this.drawMode===4?3:1;for(let h=0;h+2<s;h+=a){const l=n[h]*2,c=n[h+1]*2,f=n[h+2]*2;if(e[0]=t[l],e[1]=t[l+1],e[2]=t[c],e[3]=t[c+1],e[4]=t[f],e[5]=t[f+1],td.contains(Th.x,Th.y))return!0}return!1}destroy(i){super.destroy(i),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let il=xp;il.BATCHABLE_SIZE=100;class tC extends Ji{constructor(t,e,n){super();const s=new Zt(t),a=new Zt(e,!0),h=new Zt(n,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,st.FLOAT).addAttribute("aTextureCoord",a,2,!1,st.FLOAT).addIndex(h),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var eC=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,iC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ed extends _i{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:Gt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(n,e.uniforms),super(e.program||ni.from(iC,eC),n),this._colorDirty=!1,this.uvMatrix=new kd(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;_d(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class id{constructor(t,e,n){this.geometry=new Ji,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let a=t[s];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||st.FLOAT,offset:a.offset},e[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Zt(YT(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new Zt(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];l.offset=s,s+=l.size,this.staticStride+=l.size}const a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Zt(this.staticData,!0,!1);for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,n){for(let s=0;s<this.dynamicProperties.length;s++){const a=this.dynamicProperties[s];a.uploadFunction(t,e,n,a.type===st.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let s=0;s<this.staticProperties.length;s++){const a=this.staticProperties[s];a.uploadFunction(t,e,n,a.type===st.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var nC=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,rC=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class yp extends Po{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Gt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:st.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=_i.from(rC,nC,{}),this.state=Oi.for2d()}render(t){const e=t.children,n=t._maxSize,s=t._batchSize,a=this.renderer;let h=e.length;if(h===0)return;h>n&&!t.autoResize&&(h=n);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const c=e[0]._texture.baseTexture,f=c.alphaMode>0;this.state.blendMode=md(t.blendMode,f),a.state.set(this.state);const d=a.gl,g=t.worldTransform.copyTo(this.tempMatrix);g.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=g.toArray(!0),this.shader.uniforms.uColor=VT(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let m=!1;for(let v=0,x=0;v<h;v+=s,x+=1){let A=h-v;A>s&&(A=s),x>=l.length&&l.push(this._generateOneMoreBuffer(t));const T=l[x];T.uploadDynamic(e,v,A);const R=t._bufferUpdateIDs[x]||0;m=m||T._updateID<R,m&&(T._updateID=t._updateID,T.uploadStatic(e,v,A)),a.geometry.bind(T.geometry),d.drawElements(d.TRIANGLES,A*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,s=t._batchSize,a=t._properties;for(let h=0;h<n;h+=s)e.push(new id(this.properties,a,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new id(this.properties,n,e)}uploadVertices(t,e,n,s,a,h){let l=0,c=0,f=0,d=0;for(let g=0;g<n;++g){const m=t[e+g],v=m._texture,x=m.scale.x,A=m.scale.y,T=v.trim,R=v.orig;T?(c=T.x-m.anchor.x*R.width,l=c+T.width,d=T.y-m.anchor.y*R.height,f=d+T.height):(l=R.width*(1-m.anchor.x),c=R.width*-m.anchor.x,f=R.height*(1-m.anchor.y),d=R.height*-m.anchor.y),s[h]=c*x,s[h+1]=d*A,s[h+a]=l*x,s[h+a+1]=d*A,s[h+a*2]=l*x,s[h+a*2+1]=f*A,s[h+a*3]=c*x,s[h+a*3+1]=f*A,h+=a*4}}uploadPosition(t,e,n,s,a,h){for(let l=0;l<n;l++){const c=t[e+l].position;s[h]=c.x,s[h+1]=c.y,s[h+a]=c.x,s[h+a+1]=c.y,s[h+a*2]=c.x,s[h+a*2+1]=c.y,s[h+a*3]=c.x,s[h+a*3+1]=c.y,h+=a*4}}uploadRotation(t,e,n,s,a,h){for(let l=0;l<n;l++){const c=t[e+l].rotation;s[h]=c,s[h+a]=c,s[h+a*2]=c,s[h+a*3]=c,h+=a*4}}uploadUvs(t,e,n,s,a,h){for(let l=0;l<n;++l){const c=t[e+l]._texture._uvs;c?(s[h]=c.x0,s[h+1]=c.y0,s[h+a]=c.x1,s[h+a+1]=c.y1,s[h+a*2]=c.x2,s[h+a*2+1]=c.y2,s[h+a*3]=c.x3,s[h+a*3+1]=c.y3,h+=a*4):(s[h]=0,s[h+1]=0,s[h+a]=0,s[h+a+1]=0,s[h+a*2]=0,s[h+a*2+1]=0,s[h+a*3]=0,s[h+a*3+1]=0,h+=a*4)}}uploadTint(t,e,n,s,a,h){for(let l=0;l<n;++l){const c=t[e+l],f=c._texture.baseTexture.alphaMode>0,d=c.alpha,g=d<1&&f?ul(c._tintRGB,d):c._tintRGB+(d*255<<24);s[h]=g,s[h+a]=g,s[h+a*2]=g,s[h+a*3]=g,h+=a*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}yp.extension={name:"particle",type:j.RendererPlugin};nt.add(yp);var Lo=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(Lo||{});const no={willReadFrequently:!0},tt=class{static get experimentalLetterSpacingSupported(){let i=tt._experimentalLetterSpacingSupported;if(i!==void 0){const t=q.ADAPTER.getCanvasRenderingContext2D().prototype;i=tt._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,n,s,a,h,l,c){this.text=i,this.style=t,this.width=e,this.height=n,this.lines=s,this.lineWidths=a,this.lineHeight=h,this.maxLineWidth=l,this.fontProperties=c}static measureText(i,t,e,n=tt._canvas){e=e??t.wordWrap;const s=t.toFontString(),a=tt.measureFont(s);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);const h=n.getContext("2d",no);h.font=s;const c=(e?tt.wordWrap(i,t,n):i).split(/(?:\r\n|\r|\n)/),f=new Array(c.length);let d=0;for(let x=0;x<c.length;x++){const A=tt._measureText(c[x],t.letterSpacing,h);f[x]=A,d=Math.max(d,A)}let g=d+t.strokeThickness;t.dropShadow&&(g+=t.dropShadowDistance);const m=t.lineHeight||a.fontSize+t.strokeThickness;let v=Math.max(m,a.fontSize+t.strokeThickness*2)+(c.length-1)*(m+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new tt(i,t,g,v,c,f,m+t.leading,d,a)}static _measureText(i,t,e){let n=!1;tt.experimentalLetterSpacingSupported&&(tt.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,n=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let s=e.measureText(i).width;return s>0&&(n?s-=t:s+=(tt.graphemeSegmenter(i).length-1)*t),s}static wordWrap(i,t,e=tt._canvas){const n=e.getContext("2d",no);let s=0,a="",h="";const l=Object.create(null),{letterSpacing:c,whiteSpace:f}=t,d=tt.collapseSpaces(f),g=tt.collapseNewlines(f);let m=!d;const v=t.wordWrapWidth+c,x=tt.tokenize(i);for(let A=0;A<x.length;A++){let T=x[A];if(tt.isNewline(T)){if(!g){h+=tt.addLine(a),m=!d,a="",s=0;continue}T=" "}if(d){const M=tt.isBreakingSpace(T),E=tt.isBreakingSpace(a[a.length-1]);if(M&&E)continue}const R=tt.getFromCache(T,c,l,n);if(R>v)if(a!==""&&(h+=tt.addLine(a),a="",s=0),tt.canBreakWords(T,t.breakWords)){const M=tt.wordWrapSplit(T);for(let E=0;E<M.length;E++){let P=M[E],U=P,z=1;for(;M[E+z];){const k=M[E+z];if(!tt.canBreakChars(U,k,T,E,t.breakWords))P+=k;else break;U=k,z++}E+=z-1;const G=tt.getFromCache(P,c,l,n);G+s>v&&(h+=tt.addLine(a),m=!1,a="",s=0),a+=P,s+=G}}else{a.length>0&&(h+=tt.addLine(a),a="",s=0);const M=A===x.length-1;h+=tt.addLine(T,!M),m=!1,a="",s=0}else R+s>v&&(m=!1,h+=tt.addLine(a),a="",s=0),(a.length>0||!tt.isBreakingSpace(T)||m)&&(a+=T,s+=R)}return h+=tt.addLine(a,!1),h}static addLine(i,t=!0){return i=tt.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,n){let s=e[i];return typeof s!="number"&&(s=tt._measureText(i,t,n)+t,e[i]=s),s}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!tt.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:tt._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:tt._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let n=0;n<i.length;n++){const s=i[n],a=i[n+1];if(tt.isBreakingSpace(s,a)||tt.isNewline(s)){e!==""&&(t.push(e),e=""),t.push(s);continue}e+=s}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,n,s){return!0}static wordWrapSplit(i){return tt.graphemeSegmenter(i)}static measureFont(i){if(tt._fonts[i])return tt._fonts[i];const t={ascent:0,descent:0,fontSize:0},e=tt._canvas,n=tt._context;n.font=i;const s=tt.METRICS_STRING+tt.BASELINE_SYMBOL,a=Math.ceil(n.measureText(s).width);let h=Math.ceil(n.measureText(tt.BASELINE_SYMBOL).width);const l=Math.ceil(tt.HEIGHT_MULTIPLIER*h);if(h=h*tt.BASELINE_MULTIPLIER|0,a===0||l===0)return tt._fonts[i]=t,t;e.width=a,e.height=l,n.fillStyle="#f00",n.fillRect(0,0,a,l),n.font=i,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,h);const c=n.getImageData(0,0,a,l).data,f=c.length,d=a*4;let g=0,m=0,v=!1;for(g=0;g<h;++g){for(let x=0;x<d;x+=4)if(c[m+x]!==255){v=!0;break}if(!v)m+=d;else break}for(t.ascent=h-g,m=f-d,v=!1,g=l;g>h;--g){for(let x=0;x<d;x+=4)if(c[m+x]!==255){v=!0;break}if(!v)m-=d;else break}return t.descent=g-h,t.fontSize=t.ascent+t.descent,tt._fonts[i]=t,t}static clearMetrics(i=""){i?delete tt._fonts[i]:tt._fonts={}}static get _canvas(){if(!tt.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",no);if(e!=null&&e.measureText)return tt.__canvas=t,t;i=q.ADAPTER.createCanvas()}catch{i=q.ADAPTER.createCanvas()}i.width=i.height=10,tt.__canvas=i}return tt.__canvas}static get _context(){return tt.__context||(tt.__context=tt._canvas.getContext("2d",no)),tt.__context}};let le=tt;le.METRICS_STRING="|ÉqÅ";le.BASELINE_SYMBOL="M";le.BASELINE_MULTIPLIER=1.4;le.HEIGHT_MULTIPLIER=2;le.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();le.experimentalLetterSpacing=!1;le._fonts={};le._newlines=[10,13];le._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const sC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Nr=class{constructor(i){this.styleID=0,this.reset(),Ah(this,i,i)}clone(){const i={};return Ah(i,this,Nr.defaultStyle),new Nr(i)}reset(){Ah(this,Nr.defaultStyle,Nr.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){const t=Eh(i);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){const t=Eh(i);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){oC(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){const t=Eh(i);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){const i=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let n=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!sC.includes(n)&&(n=`"${n}"`),t[e]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${t.join(",")}`}};let Sn=Nr;Sn.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Lo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function nd(i){return typeof i=="number"?pd(i):(typeof i=="string"&&i.startsWith("0x")&&(i=i.replace("0x","#")),i)}function Eh(i){if(Array.isArray(i)){for(let t=0;t<i.length;++t)i[t]=nd(i[t]);return i}else return nd(i)}function oC(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function Ah(i,t,e){for(const n in e)Array.isArray(t[n])?i[n]=t[n].slice():i[n]=t[n]}const aC={texture:!0,children:!1,baseTexture:!0},nl=class extends lr{constructor(i,t,e){let n=!1;e||(e=q.ADAPTER.createCanvas(),n=!0),e.width=3,e.height=3;const s=it.from(e);s.orig=new wt,s.trim=new wt,super(s),this._ownCanvas=n,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=nl.defaultResolution??q.RESOLUTION,this._autoResolution=nl.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return le.experimentalLetterSpacing}static set experimentalLetterSpacing(i){At("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),le.experimentalLetterSpacing=i}updateText(i){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();const e=this.context,n=le.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=n.width,a=n.height,h=n.lines,l=n.lineHeight,c=n.lineWidths,f=n.maxLineWidth,d=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let g,m;const v=t.dropShadow?2:1;for(let x=0;x<v;++x){const A=t.dropShadow&&x===0,T=A?Math.ceil(Math.max(1,a)+t.padding*2):0,R=T*this._resolution;if(A){e.fillStyle="black",e.strokeStyle="black";const E=t.dropShadowColor,P=Xr(typeof E=="number"?E:ll(E)),U=t.dropShadowBlur*this._resolution,z=t.dropShadowDistance*this._resolution;e.shadowColor=`rgba(${P[0]*255},${P[1]*255},${P[2]*255},${t.dropShadowAlpha})`,e.shadowBlur=U,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*z,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*z+R}else e.fillStyle=this._generateFillStyle(t,h,n),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let M=(l-d.fontSize)/2;l-d.fontSize<0&&(M=0);for(let E=0;E<h.length;E++)g=t.strokeThickness/2,m=t.strokeThickness/2+E*l+d.ascent+M,t.align==="right"?g+=f-c[E]:t.align==="center"&&(g+=(f-c[E])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(h[E],g+t.padding,m+t.padding-T,!0),t.fill&&this.drawLetterSpacing(h[E],g+t.padding,m+t.padding-T)}this.updateTexture()}drawLetterSpacing(i,t,e,n=!1){const a=this._style.letterSpacing;let h=!1;if(le.experimentalLetterSpacingSupported&&(le.experimentalLetterSpacing?(this.context.letterSpacing=`${a}px`,this.context.textLetterSpacing=`${a}px`,h=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),a===0||h){n?this.context.strokeText(i,t,e):this.context.fillText(i,t,e);return}let l=t;const c=le.graphemeSegmenter(i);let f=this.context.measureText(i).width,d=0;for(let g=0;g<c.length;++g){const m=c[g];n?this.context.strokeText(m,l,e):this.context.fillText(m,l,e);let v="";for(let x=g+1;x<c.length;++x)v+=c[x];d=this.context.measureText(v).width,l+=f-d+a,f=d}}updateTexture(){const i=this.canvas;if(this._style.trim){const a=KT(i);a.data&&(i.width=a.width,i.height=a.height,this.context.putImageData(a.data,0,0))}const t=this._texture,e=this._style,n=e.trim?0:e.padding,s=t.baseTexture;t.trim.width=t._frame.width=i.width/this._resolution,t.trim.height=t._frame.height=i.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),s.setRealSize(i.width,i.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,t){return this.updateText(!0),this._textureID===-1&&(i=!1),super.getBounds(i,t)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,t,e){const n=i.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let s;const a=i.dropShadow?i.dropShadowDistance:0,h=i.padding||0,l=this.canvas.width/this._resolution-a-h*2,c=this.canvas.height/this._resolution-a-h*2,f=n.slice(),d=i.fillGradientStops.slice();if(!d.length){const g=f.length+1;for(let m=1;m<g;++m)d.push(m/g)}if(f.unshift(n[0]),d.unshift(0),f.push(n[n.length-1]),d.push(1),i.fillGradientType===Lo.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,h,l/2,c+h);const g=e.fontProperties.fontSize+i.strokeThickness;for(let m=0;m<t.length;m++){const v=e.lineHeight*(m-1)+g,x=e.lineHeight*m;let A=x;m>0&&v>x&&(A=(x+v)/2);const T=x+g,R=e.lineHeight*(m+1);let M=T;m+1<t.length&&R<T&&(M=(T+R)/2);const E=(M-A)/c;for(let P=0;P<f.length;P++){let U=0;typeof d[P]=="number"?U=d[P]:U=P/f.length;let z=Math.min(1,Math.max(0,A/c+U*E));z=Number(z.toFixed(5)),s.addColorStop(z,f[P])}}}else{s=this.context.createLinearGradient(h,c/2,l+h,c/2);const g=f.length+1;let m=1;for(let v=0;v<f.length;v++){let x;typeof d[v]=="number"?x=d[v]:x=m/g,s.addColorStop(x,f[v]),m++}}return s}destroy(i){typeof i=="boolean"&&(i={children:i}),i=Object.assign({},aC,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);const t=Qn(this.scale.x)||1;this.scale.x=t*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);const t=Qn(this.scale.y)||1;this.scale.y=t*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){i=i||{},i instanceof Sn?this._style=i:this._style=new Sn(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};let yl=nl;yl.defaultAutoResolution=!0;class hC{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function lC(i,t){var n;let e=!1;if((n=i==null?void 0:i._textures)!=null&&n.length){for(let s=0;s<i._textures.length;s++)if(i._textures[s]instanceof it){const a=i._textures[s].baseTexture;t.includes(a)||(t.push(a),e=!0)}}return e}function uC(i,t){if(i.baseTexture instanceof ft){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function cC(i,t){if(i._texture&&i._texture instanceof it){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function fC(i,t){return t instanceof yl?(t.updateText(!0),!0):!1}function dC(i,t){if(t instanceof Sn){const e=t.toFontString();return le.measureFont(e),!0}return!1}function pC(i,t){if(i instanceof yl){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function gC(i,t){return i instanceof Sn?(t.includes(i)||t.push(i),!0):!1}const bp=class{constructor(i){this.limiter=new hC(bp.uploadsPerFrame),this.renderer=i,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(pC),this.registerFindHook(gC),this.registerFindHook(lC),this.registerFindHook(uC),this.registerFindHook(cC),this.registerUploadHook(fC),this.registerUploadHook(dC)}upload(i){return new Promise(t=>{i&&this.add(i),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Ee.system.addOnce(this.tick,this,or.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const i=this.queue[0];let t=!1;if(i&&!i._destroyed){for(let e=0,n=this.uploadHooks.length;e<n;e++)if(this.uploadHooks[e](this.uploadHookHelper,i)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Ee.system.addOnce(this.tick,this,or.UTILITY);else{this.ticking=!1;const i=this.completes.slice(0);this.completes.length=0;for(let t=0,e=i.length;t<e;t++)i[t]()}}registerFindHook(i){return i&&this.addHooks.push(i),this}registerUploadHook(i){return i&&this.uploadHooks.push(i),this}add(i){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](i,this.queue);t++);if(i instanceof Fe)for(let t=i.children.length-1;t>=0;t--)this.add(i.children[t]);return this}destroy(){this.ticking&&Ee.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Eo=bp;Eo.uploadsPerFrame=4;Object.defineProperties(q,{UPLOADS_PER_FRAME:{get(){return Eo.uploadsPerFrame},set(i){At("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Eo.uploadsPerFrame=i}}});function wp(i,t){return t instanceof ft?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function mC(i,t){if(!(t instanceof Fo))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:n}=e;for(let s=0;s<n.length;s++){const{texture:a}=n[s].style;a&&wp(i,a.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function _C(i,t){return i instanceof Fo?(t.push(i),!0):!1}class Tp extends Eo{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(_C),this.registerUploadHook(wp),this.registerUploadHook(mC)}}Tp.extension={name:"prepare",type:j.RendererSystem};nt.add(Tp);new Et;var vC=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,xC=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,yC=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,rd=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,bC=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const ro=new Gt;class Ep extends Po{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Ld,this.state=Oi.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=_i.from(rd,bC,e),this.shader=t.context.webGLVersion>1?_i.from(xC,vC,e):_i.from(rd,yC,e)}render(t){const e=this.renderer,n=this.quad;let s=n.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const a=t.uvRespectAnchor?t.anchor.x:0,h=t.uvRespectAnchor?t.anchor.y:0;s=n.uvs,s[0]=s[6]=-a,s[1]=s[3]=-h,s[2]=s[4]=1-a,s[5]=s[7]=1-h,n.invalidate();const l=t._texture,c=l.baseTexture,f=c.alphaMode>0,d=t.tileTransform.localTransform,g=t.uvMatrix;let m=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;m&&(c._glTextures[e.CONTEXT_UID]?m=c.wrapMode!==Ki.CLAMP:c.wrapMode===Ki.CLAMP&&(c.wrapMode=Ki.REPEAT));const v=m?this.simpleShader:this.shader,x=l.width,A=l.height,T=t._width,R=t._height;ro.set(d.a*x/T,d.b*x/R,d.c*A/T,d.d*A/R,d.tx/T,d.ty/R),ro.invert(),m?ro.prepend(g.mapCoord):(v.uniforms.uMapCoord=g.mapCoord.toArray(!0),v.uniforms.uClampFrame=g.uClampFrame,v.uniforms.uClampOffset=g.uClampOffset),v.uniforms.uTransform=ro.toArray(!0),v.uniforms.uColor=_d(t.tint,t.worldAlpha,v.uniforms.uColor,f),v.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),v.uniforms.uSampler=l,e.shader.bind(v),e.geometry.bind(n),this.state.blendMode=md(t.blendMode,f),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Ep.extension={name:"tilingSprite",type:j.RendererPlugin};nt.add(Ep);const Ur=class{constructor(i,t,e=null){this.linkedSheets=[],this._texture=i instanceof it?i:null,this.baseTexture=i instanceof ft?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const n=this.baseTexture.resource;this.resolution=this._updateResolution(e||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(i=null){const{scale:t}=this.data.meta;let e=Zi(i,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(i=>{this._callback=i,this._batchIndex=0,this._frameKeys.length<=Ur.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(i){let t=i;const e=Ur.BATCH_SIZE;for(;t-i<e&&t<this._frameKeys.length;){const n=this._frameKeys[t],s=this._frames[n],a=s.frame;if(a){let h=null,l=null;const c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,f=new wt(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?h=new wt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):h=new wt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new wt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[n]=new it(this.baseTexture,h,f,l,s.rotated?2:0,s.anchor),it.addToCache(this.textures[n],n)}t++}}_processAnimations(){const i=this.data.animations||{};for(const t in i){this.animations[t]=[];for(let e=0;e<i[t].length;e++){const n=i[t][e];this.animations[t].push(this.textures[n])}}}_parseComplete(){const i=this._callback;this._callback=null,this._batchIndex=0,i.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Ur.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Ur.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(i=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,i&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let rl=Ur;rl.BATCH_SIZE=1e3;const wC=["jpg","png","jpeg","avif","webp"];function Ap(i,t,e){const n={};if(i.forEach(s=>{n[s]=t}),Object.keys(t.textures).forEach(s=>{n[s]=t.textures[s]}),!e){const s=ce.dirname(i[0]);t.linkedSheets.forEach((a,h)=>{const l=Ap([`${s}/${t.data.meta.related_multi_packs[h]}`],a,!0);Object.assign(n,l)})}return n}const TC={extension:j.Asset,cache:{test:i=>i instanceof rl,getCacheableAssets:(i,t)=>Ap(i,t,!1)},resolver:{test:i=>{const e=i.split("?")[0].split("."),n=e.pop(),s=e.pop();return n==="json"&&wC.includes(s)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=q.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{extension:{type:j.LoadParser,priority:yi.Normal},async testParse(i,t){return ce.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var f,d;let n=ce.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");const s=n+i.meta.image,h=(await e.load([s]))[s],l=new rl(h.baseTexture,i,t.src);await l.parse();const c=(f=i==null?void 0:i.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(c)){const g=[];for(const v of c){if(typeof v!="string")continue;const x=n+v;(d=t.data)!=null&&d.ignoreMultiPack||g.push(e.load({src:x,data:{ignoreMultiPack:!0}}))}const m=await Promise.all(g);l.linkedSheets=m,m.forEach(v=>{v.linkedSheets=[l].concat(l.linkedSheets.filter(x=>x!==v))})}return l},unload(i){i.destroy(!0)}}};nt.add(TC);class Ao{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class fo{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const a in e){const h=e[a].match(/^[a-z]+/gm)[0],l=e[a].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const f in l){const d=l[f].split("="),g=d[0],m=d[1].replace(/"/gm,""),v=parseFloat(m),x=isNaN(v)?m:v;c[g]=x}n[h].push(c)}const s=new Ao;return n.info.forEach(a=>s.info.push({face:a.face,size:parseInt(a.size,10)})),n.common.forEach(a=>s.common.push({lineHeight:parseInt(a.lineHeight,10)})),n.page.forEach(a=>s.page.push({id:parseInt(a.id,10),file:a.file})),n.char.forEach(a=>s.char.push({id:parseInt(a.id,10),page:parseInt(a.page,10),x:parseInt(a.x,10),y:parseInt(a.y,10),width:parseInt(a.width,10),height:parseInt(a.height,10),xoffset:parseInt(a.xoffset,10),yoffset:parseInt(a.yoffset,10),xadvance:parseInt(a.xadvance,10)})),n.kerning.forEach(a=>s.kerning.push({first:parseInt(a.first,10),second:parseInt(a.second,10),amount:parseInt(a.amount,10)})),n.distanceField.forEach(a=>s.distanceField.push({distanceRange:parseInt(a.distanceRange,10),fieldType:a.fieldType})),s}}class sl{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Ao,n=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),a=t.getElementsByTagName("page"),h=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),c=t.getElementsByTagName("distanceField");for(let f=0;f<n.length;f++)e.info.push({face:n[f].getAttribute("face"),size:parseInt(n[f].getAttribute("size"),10)});for(let f=0;f<s.length;f++)e.common.push({lineHeight:parseInt(s[f].getAttribute("lineHeight"),10)});for(let f=0;f<a.length;f++)e.page.push({id:parseInt(a[f].getAttribute("id"),10)||0,file:a[f].getAttribute("file")});for(let f=0;f<h.length;f++){const d=h[f];e.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let f=0;f<l.length;f++)e.kerning.push({first:parseInt(l[f].getAttribute("first"),10),second:parseInt(l[f].getAttribute("second"),10),amount:parseInt(l[f].getAttribute("amount"),10)});for(let f=0;f<c.length;f++)e.distanceField.push({fieldType:c[f].getAttribute("fieldType"),distanceRange:parseInt(c[f].getAttribute("distanceRange"),10)});return e}}class ol{static test(t){return typeof t=="string"&&t.includes("<font>")?sl.test(q.ADAPTER.parseXML(t)):!1}static parse(t){return sl.parse(q.ADAPTER.parseXML(t))}}const Sh=[fo,sl,ol];function EC(i){for(let t=0;t<Sh.length;t++)if(Sh[t].test(i))return Sh[t];return null}function AC(i,t,e,n,s,a){const h=e.fill;if(Array.isArray(h)){if(h.length===1)return h[0]}else return h;let l;const c=e.dropShadow?e.dropShadowDistance:0,f=e.padding||0,d=i.width/n-c-f*2,g=i.height/n-c-f*2,m=h.slice(),v=e.fillGradientStops.slice();if(!v.length){const x=m.length+1;for(let A=1;A<x;++A)v.push(A/x)}if(m.unshift(h[0]),v.unshift(0),m.push(h[h.length-1]),v.push(1),e.fillGradientType===Lo.LINEAR_VERTICAL){l=t.createLinearGradient(d/2,f,d/2,g+f);let x=0;const T=(a.fontProperties.fontSize+e.strokeThickness)/g;for(let R=0;R<s.length;R++){const M=a.lineHeight*R;for(let E=0;E<m.length;E++){let P=0;typeof v[E]=="number"?P=v[E]:P=E/m.length;const U=M/g+P*T;let z=Math.max(x,U);z=Math.min(z,1),l.addColorStop(z,m[E]),x=z}}}else{l=t.createLinearGradient(f,g/2,d+f,g/2);const x=m.length+1;let A=1;for(let T=0;T<m.length;T++){let R;typeof v[T]=="number"?R=v[T]:R=A/x,l.addColorStop(R,m[T]),A++}}return l}function SC(i,t,e,n,s,a,h){const l=e.text,c=e.fontProperties;t.translate(n,s),t.scale(a,a);const f=h.strokeThickness/2,d=-(h.strokeThickness/2);if(t.font=h.toFontString(),t.lineWidth=h.strokeThickness,t.textBaseline=h.textBaseline,t.lineJoin=h.lineJoin,t.miterLimit=h.miterLimit,t.fillStyle=AC(i,t,h,a,[l],e),t.strokeStyle=h.stroke,h.dropShadow){const g=h.dropShadowColor,m=Xr(typeof g=="number"?g:ll(g)),v=h.dropShadowBlur*a,x=h.dropShadowDistance*a;t.shadowColor=`rgba(${m[0]*255},${m[1]*255},${m[2]*255},${h.dropShadowAlpha})`,t.shadowBlur=v,t.shadowOffsetX=Math.cos(h.dropShadowAngle)*x,t.shadowOffsetY=Math.sin(h.dropShadowAngle)*x}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;h.stroke&&h.strokeThickness&&t.strokeText(l,f,d+e.lineHeight-c.descent),h.fill&&t.fillText(l,f,d+e.lineHeight-c.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function po(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function Sp(i){return Array.from?Array.from(i):i.split("")}function CC(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,n=i.length;e<n;e++){const s=i[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const a=s[0].charCodeAt(0),h=s[1].charCodeAt(0);if(h<a)throw new Error("[BitmapFont]: Invalid character range.");for(let l=a,c=h;l<=c;l++)t.push(String.fromCharCode(l))}else t.push(...Sp(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const ti=class{constructor(i,t,e){var f;const[n]=i.info,[s]=i.common,[a]=i.page,[h]=i.distanceField,l=Zi(a.file),c={};this._ownsTextures=e,this.font=n.face,this.size=n.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=c;for(let d=0;d<i.page.length;d++){const{id:g,file:m}=i.page[d];c[g]=t instanceof Array?t[d]:t[m],h!=null&&h.fieldType&&h.fieldType!=="none"&&(c[g].baseTexture.alphaMode=ai.NO_PREMULTIPLIED_ALPHA,c[g].baseTexture.mipmap=xi.OFF)}for(let d=0;d<i.char.length;d++){const{id:g,page:m}=i.char[d];let{x:v,y:x,width:A,height:T,xoffset:R,yoffset:M,xadvance:E}=i.char[d];v/=l,x/=l,A/=l,T/=l,R/=l,M/=l,E/=l;const P=new wt(v+c[m].frame.x/l,x+c[m].frame.y/l,A,T);this.chars[g]={xOffset:R,yOffset:M,xAdvance:E,kerning:{},texture:new it(c[m].baseTexture,P),page:m}}for(let d=0;d<i.kerning.length;d++){let{first:g,second:m,amount:v}=i.kerning[d];g/=l,m/=l,v/=l,this.chars[m]&&(this.chars[m].kerning[g]=v)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((f=h==null?void 0:h.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const i in this.chars)this.chars[i].texture.destroy(),this.chars[i].texture=null;for(const i in this.pageTextures)this._ownsTextures&&this.pageTextures[i].destroy(!0),this.pageTextures[i]=null;this.chars=null,this.pageTextures=null}static install(i,t,e){let n;if(i instanceof Ao)n=i;else{const a=EC(i);if(!a)throw new Error("Unrecognized data format for font.");n=a.parse(i)}t instanceof it&&(t=[t]);const s=new ti(n,t,e);return ti.available[s.font]=s,s}static uninstall(i){const t=ti.available[i];if(!t)throw new Error(`No font found named '${i}'`);t.destroy(),delete ti.available[i]}static from(i,t,e){if(!i)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:s,resolution:a,textureWidth:h,textureHeight:l,...c}=Object.assign({},ti.defaultOptions,e),f=CC(n),d=t instanceof Sn?t:new Sn(t),g=h,m=new Ao;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};let v=0,x=0,A,T,R,M=0;const E=[];for(let U=0;U<f.length;U++){A||(A=q.ADAPTER.createCanvas(),A.width=h,A.height=l,T=A.getContext("2d"),R=new ft(A,{resolution:a,...c}),E.push(new it(R)),m.page.push({id:E.length-1,file:""}));const z=f[U],G=le.measureText(z,d,!1,A),k=G.width,Z=Math.ceil(G.height),rt=Math.ceil((d.fontStyle==="italic"?2:1)*k);if(x>=l-Z*a){if(x===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${z}')`);--U,A=null,T=null,R=null,x=0,v=0,M=0;continue}if(M=Math.max(Z+G.fontProperties.descent,M),rt*a+v>=g){if(v===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${z}')`);--U,x+=M*a,x=Math.ceil(x),v=0,M=0;continue}SC(A,T,G,v,x,a,d);const V=po(G.text);m.char.push({id:V,page:E.length-1,x:v/a,y:x/a,width:rt,height:Z,xoffset:0,yoffset:0,xadvance:Math.ceil(k-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),v+=(rt+2*s)*a,v=Math.ceil(v)}for(let U=0,z=f.length;U<z;U++){const G=f[U];for(let k=0;k<z;k++){const Z=f[k],rt=T.measureText(G).width,V=T.measureText(Z).width,W=T.measureText(G+Z).width-(rt+V);W&&m.kerning.push({first:po(G),second:po(Z),amount:W})}}const P=new ti(m,E,!0);return ti.available[i]!==void 0&&ti.uninstall(i),ti.available[i]=P,P}};let Te=ti;Te.ALPHA=[["a","z"],["A","Z"]," "];Te.NUMERIC=[["0","9"]];Te.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Te.ASCII=[[" ","~"]];Te.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ti.ALPHANUMERIC};Te.available={};var IC=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,RC=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const sd=[],od=[],ad=[],Cp=class extends Fe{constructor(i,t={}){super(),this._tint=16777215;const{align:e,tint:n,maxWidth:s,letterSpacing:a,fontName:h,fontSize:l}=Object.assign({},Cp.styleDefaults,t);if(!Te.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tint=n,this._font=void 0,this._fontName=h,this._fontSize=l,this.text=i,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new qi(()=>{this.dirty=!0},this,0,0),this._roundPixels=q.ROUND_PIXELS,this.dirty=!0,this._resolution=q.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var rt;const i=Te.available[this._fontName],t=this.fontSize,e=t/i.size,n=new Et,s=[],a=[],h=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=Sp(l),f=this._maxWidth*i.size/t,d=i.distanceFieldType==="none"?sd:od;let g=null,m=0,v=0,x=0,A=-1,T=0,R=0,M=0,E=0;for(let V=0;V<c.length;V++){const J=c[V],W=po(J);if(/(?:\s)/.test(J)&&(A=V,T=m,E++),J==="\r"||J===`
`){a.push(m),h.push(-1),v=Math.max(v,m),++x,++R,n.x=0,n.y+=i.lineHeight,g=null,E=0;continue}const O=i.chars[W];if(!O)continue;g&&O.kerning[g]&&(n.x+=O.kerning[g]);const dt=ad.pop()||{texture:it.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Et};dt.texture=O.texture,dt.line=x,dt.charCode=W,dt.position.x=n.x+O.xOffset+this._letterSpacing/2,dt.position.y=n.y+O.yOffset,dt.prevSpaces=E,s.push(dt),m=dt.position.x+Math.max(O.xAdvance-O.xOffset,O.texture.orig.width),n.x+=O.xAdvance+this._letterSpacing,M=Math.max(M,O.yOffset+O.texture.height),g=W,A!==-1&&f>0&&n.x>f&&(++R,nr(s,1+A-R,1+V-A),V=A,A=-1,a.push(T),h.push(s.length>0?s[s.length-1].prevSpaces:0),v=Math.max(v,T),x++,n.x=0,n.y+=i.lineHeight,g=null,E=0)}const P=c[c.length-1];P!=="\r"&&P!==`
`&&(/(?:\s)/.test(P)&&(m=T),a.push(m),v=Math.max(v,m),h.push(-1));const U=[];for(let V=0;V<=x;V++){let J=0;this._align==="right"?J=v-a[V]:this._align==="center"?J=(v-a[V])/2:this._align==="justify"&&(J=h[V]<0?0:(v-a[V])/h[V]),U.push(J)}const z=s.length,G={},k=[],Z=this._activePagesMeshData;d.push(...Z);for(let V=0;V<z;V++){const J=s[V].texture,W=J.baseTexture.uid;if(!G[W]){let O=d.pop();if(!O){const _t=new tC;let Y,vt;i.distanceFieldType==="none"?(Y=new ed(it.EMPTY),vt=lt.NORMAL):(Y=new ed(it.EMPTY,{program:ni.from(RC,IC),uniforms:{uFWidth:0}}),vt=lt.NORMAL_NPM);const Ut=new il(_t,Y);Ut.blendMode=vt,O={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ut,vertices:null,uvs:null,indices:null}}O.index=0,O.indexCount=0,O.vertexCount=0,O.uvsCount=0,O.total=0;const{_textureCache:dt}=this;dt[W]=dt[W]||new it(J.baseTexture),O.mesh.texture=dt[W],O.mesh.tint=this._tint,k.push(O),G[W]=O}G[W].total++}for(let V=0;V<Z.length;V++)k.includes(Z[V])||this.removeChild(Z[V].mesh);for(let V=0;V<k.length;V++)k[V].mesh.parent!==this&&this.addChild(k[V].mesh);this._activePagesMeshData=k;for(const V in G){const J=G[V],W=J.total;if(!(((rt=J.indices)==null?void 0:rt.length)>6*W)||J.vertices.length<il.BATCHABLE_SIZE*2)J.vertices=new Float32Array(4*2*W),J.uvs=new Float32Array(4*2*W),J.indices=new Uint16Array(6*W);else{const O=J.total,dt=J.vertices;for(let _t=O*4*2;_t<dt.length;_t++)dt[_t]=0}J.mesh.size=6*W}for(let V=0;V<z;V++){const J=s[V];let W=J.position.x+U[J.line]*(this._align==="justify"?J.prevSpaces:1);this._roundPixels&&(W=Math.round(W));const O=W*e,dt=J.position.y*e,_t=J.texture,Y=G[_t.baseTexture.uid],vt=_t.frame,Ut=_t._uvs,H=Y.index++;Y.indices[H*6+0]=0+H*4,Y.indices[H*6+1]=1+H*4,Y.indices[H*6+2]=2+H*4,Y.indices[H*6+3]=0+H*4,Y.indices[H*6+4]=2+H*4,Y.indices[H*6+5]=3+H*4,Y.vertices[H*8+0]=O,Y.vertices[H*8+1]=dt,Y.vertices[H*8+2]=O+vt.width*e,Y.vertices[H*8+3]=dt,Y.vertices[H*8+4]=O+vt.width*e,Y.vertices[H*8+5]=dt+vt.height*e,Y.vertices[H*8+6]=O,Y.vertices[H*8+7]=dt+vt.height*e,Y.uvs[H*8+0]=Ut.x0,Y.uvs[H*8+1]=Ut.y0,Y.uvs[H*8+2]=Ut.x1,Y.uvs[H*8+3]=Ut.y1,Y.uvs[H*8+4]=Ut.x2,Y.uvs[H*8+5]=Ut.y2,Y.uvs[H*8+6]=Ut.x3,Y.uvs[H*8+7]=Ut.y3}this._textWidth=v*e,this._textHeight=(n.y+i.lineHeight)*e;for(const V in G){const J=G[V];if(this.anchor.x!==0||this.anchor.y!==0){let _t=0;const Y=this._textWidth*this.anchor.x,vt=this._textHeight*this.anchor.y;for(let Ut=0;Ut<J.total;Ut++)J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt}this._maxLineHeight=M*e;const W=J.mesh.geometry.getBuffer("aVertexPosition"),O=J.mesh.geometry.getBuffer("aTextureCoord"),dt=J.mesh.geometry.getIndex();W.data=J.vertices,O.data=J.uvs,dt.data=J.indices,W.update(),O.update(),dt.update()}for(let V=0;V<s.length;V++)ad.push(s[V]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:n}=Te.available[this._fontName];if(e!=="none"){const{a:s,b:a,c:h,d:l}=this.worldTransform,c=Math.sqrt(s*s+a*a),f=Math.sqrt(h*h+l*l),d=(Math.abs(c)+Math.abs(f))/2,g=this.fontSize/n,m=i._view.resolution;for(const v of this._activePagesMeshData)v.mesh.shader.uniforms.uFWidth=d*t*g*m}super._render(i)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const i=Te.available[this._fontName];if(!i)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==i&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(i){if(this._tint!==i){this._tint=i;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=i}}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.dirty=!0)}get fontName(){return this._fontName}set fontName(i){if(!Te.available[i])throw new Error(`Missing BitmapFont "${i}"`);this._fontName!==i&&(this._fontName=i,this.dirty=!0)}get fontSize(){return this._fontSize??Te.available[this._fontName].size}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.dirty=!0)}get anchor(){return this._anchor}set anchor(i){typeof i=="number"?this._anchor.set(i):this._anchor.copyFrom(i)}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(i){this._maxWidth!==i&&(this._maxWidth=i,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(i){i!==this._roundPixels&&(this._roundPixels=i,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}destroy(i){const{_textureCache:t}=this,n=Te.available[this._fontName].distanceFieldType==="none"?sd:od;n.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],n.filter(s=>t[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=it.EMPTY});for(const s in t)t[s].destroy(),delete t[s];this._font=null,this._textureCache=null,super.destroy(i)}};let PC=Cp;PC.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const MC=[".xml",".fnt"],DC={extension:{type:j.LoadParser,priority:yi.Normal},test(i){return MC.includes(ce.extname(i).toLowerCase())},async testParse(i){return fo.test(i)||ol.test(i)},async parse(i,t,e){const n=fo.test(i)?fo.parse(i):ol.parse(i),{src:s}=t,{page:a}=n,h=[];for(let f=0;f<a.length;++f){const d=a[f].file,g=ce.join(ce.dirname(s),d);h.push(g)}const l=await e.load(h),c=h.map(f=>l[f]);return Te.install(n,c,!0)},async load(i,t){return(await q.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};nt.add(DC);const BC={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},FC={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"};let Ip;const Rp={width:100,height:44,map:{width:74,height:39,x:13,y:3}},Kn=window.innerWidth/Rp.width,bn={};async function LC(i){Ip=new ml({view:i,width:window.innerWidth,height:Kn*Rp.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await OC()}const OC=async()=>(bn.ascii=await xn.load("/skulltooth/fonts/menlo-bold.json"),bn.text=await xn.load("/skulltooth/fonts/menlo-bold-half.json"),bn.tile=await xn.load("/skulltooth/tile.png"),bn),NC=i=>bn.ascii.textures[BC[i]],UC=i=>bn.text.textures[FC[i]],kC=()=>bn.tile;class so{constructor(t){he(this,"x",0);he(this,"y",0);he(this,"halfWidth",!1);he(this,"width");he(this,"height");he(this,"layers",[]);he(this,"sprites",[]);he(this,"tileSets",[]);he(this,"tints",[]);he(this,"alphas",[]);he(this,"_getTexture",t=>{const{tileSet:e,char:n}=t;return e==="ascii"?NC(n):e==="text"?UC(n):kC()});he(this,"_createSprite",t=>{const{char:e,width:n,height:s,layer:a,x:h,y:l,tileSet:c,tint:f=16777215,alpha:d=1}=t,g=this._getTexture({tileSet:c,char:e});let m=new lr(g);m.width=this.halfWidth?n/2:n,m.height=s,m.x=this.halfWidth?h*(n/2):h*n,m.y=l*s,m.tint=f,m.alpha=d,this.sprites[a][l][h]=m,this.layers[a].addChild(m)});he(this,"updateCell",t=>(Object.keys(t).forEach(e=>{const{char:n,tint:s,alpha:a,tileSet:h,x:l,y:c}=t[e];this.updateSprite({char:n,tint:s,alpha:a,tileSet:h,x:l,y:c,layer:parseInt(e)})}),this));he(this,"updateSprite",async t=>{const{char:e="",layer:n,x:s,y:a,tileSet:h="text",tint:l,alpha:c}=t,f=this.sprites[n][a][s];return f.texture=this._getTexture({tileSet:h,char:e}),l&&(f.tint=l),c&&(f.alpha=c),this});he(this,"updateRows",t=>(t.forEach((e,n)=>{e.forEach((s,a)=>{this.updateRow({...s,layer:a,y:n})})}),this));he(this,"updateRow",t=>{const{string:e="",layer:n=0,x:s,y:a,tileSet:h,tint:l,alpha:c}=t;return[...e].forEach((d,g)=>this.updateSprite({char:d,layer:n||0,x:s||0+g,y:a||0,tileSet:h||this.tileSets[n],tint:l||this.tints[n],alpha:c||this.alphas[n]})),(h||this.tileSets[n])==="tile"&&Xn.times(this.width,d=>{this.updateSprite({layer:n,x:s||0+d,y:a||0,tileSet:h||this.tileSets[n],tint:l||this.tints[n],alpha:c||this.alphas[n]})}),this});return this.width=t.width,this.height=t.height,this.tileSets=t.tileSets,this.tints=t.tints,this.alphas=t.alphas,this.halfWidth=this.tileSets.includes("text"),Xn.times(t.layers,()=>this.layers.push(new Fe)),this.layers.forEach(e=>{const n=this.halfWidth?t.x*(Kn/2):t.x*Kn,s=t.y*Kn;e.x=n,e.y=s,e.interactiveChildren=!1,Ip.stage.addChild(e)}),Xn.times(t.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),Xn.times(t.layers,e=>{Xn.times(this.height,n=>{Xn.times(this.width,async s=>{this._createSprite({char:"",width:Kn,height:Kn,layer:e,x:s,y:n,tileSet:t.tileSets[e],tint:t.tints[e],alpha:t.alphas[e]})})})}),this}}let Pp=0;const bl=new Map,wl={},Li={},Mp=()=>++Pp+Math.random().toString(36).slice(2,10),So=i=>Li[i],Ch=(i,t)=>{const e={name:i,filters:t,entities:new Set};return Li[i]=e,Li},GC=(i,t)=>{const e=Li[t].filters.all;if(e.length){const n=en(i);if(!n)throw`entity ${i} does not exist`;return Xe.exports.every(e,s=>n.components[s])}return!0},HC=(i,t)=>{const e=Li[t].filters.any;if(e.length){const n=en(i);if(!n)throw`entity ${i} does not exist`;return Xe.exports.some(e,s=>n.components[s])}return!0},WC=(i,t)=>{const e=Li[t].filters.none;if(e.length){const n=en(i);if(!n)throw`entity ${i} does not exist`;return Xe.exports.every(e,s=>!n.components[s])}return!0},XC=(i,t)=>{const e=Li[t];return GC(i,t)&&HC(i,t)&&WC(i,t)?e.entities.add(i):e.entities.delete(i),e.entities},zC=i=>{Object.keys(Li).forEach(e=>XC(i,e))},$C=i=>{const t=(i==null?void 0:i.wId)||Mp(),e=(i==null?void 0:i.eIds)||new Set,n={id:t,eIds:e};return wl[t]=n,n},Tl=({eId:i,wId:t})=>{const e=i||Mp(),n={id:e,wId:t,components:{}};return bl.set(e,n),wl[t].eIds.add(e),n},en=i=>bl.get(i),wn=(i,t)=>{const e=en(i);if(!e)throw`entity ${i} does not exist`;return Object.assign(e.components,t),zC(i),e},VC=()=>({entities:bl,worlds:wl,queries:Li,_id:Pp}),El=i=>`${i.x},${i.y},${i.z}`,YC=i=>{const t=i.split(",").map(e=>parseInt(e,10));return{x:t[0],y:t[1],z:t[2]}},hd=(i,t)=>{const{x:e,y:n,z:s,width:a,height:h,hasWalls:l}=i,c={},f=e,d=e+a,g=n,m=n+h;if(l)for(let x=g+1;x<m-1;x++)for(let A=f+1;A<d-1;A++)c[`${A},${x},${s}`]={x:A,y:x,z:s,...t};else for(let x=g;x<m;x++)for(let A=f;A<d;A++)c[`${A},${x},${s}`]={x:A,y:x,z:s,...t};const v={x:Math.round((f+d)/2),y:Math.round((g+m)/2),z:s};return{x1:f,x2:d,y1:g,y2:m,z:s,center:v,hasWalls:l,tiles:c,width:a,height:h}},jC=(i,t)=>i.x1<=t.x2&&i.x2>=t.x1&&i.y1<=t.y2&&i.y2>=t.y1;var Zn=(i=>(i.Appearance="appearance",i.IsBlocking="isBlocking",i.IsPlayer="isPlayer",i.Position="position",i.TryMove="tryMove",i))(Zn||{}),Yr=(i=>(i.HasAppearance="hasAppearance",i.IsPlayer="isPlayer",i.IsTryingToMove="isTryingToMove",i))(Yr||{});const qC=()=>{Ch("hasAppearance",{any:[],all:[Zn.Appearance,Zn.Appearance],none:[]}),Ch("isPlayer",{any:[Zn.IsPlayer],all:[],none:[]}),Ch("isTryingToMove",{any:[],all:[Zn.Position,Zn.TryMove],none:[]})},KC=()=>{const{userInput:i}=Be(),t=So(Yr.IsPlayer);if(!i)return vi(n=>{n.userInput=null});const{key:e}=i;t.entities.forEach(n=>{const s=en(n);if(s!=null&&s.components.position){vi(c=>{c.toRender.add(El(s.components.position))});const{x:a,y:h,z:l}=s.components.position;if(e==="h"||e==="ArrowLeft"){const c={x:a-1,y:h,z:l};wn(n,{tryMove:c})}if(e==="j"||e==="ArrowDown"){const c={x:a,y:h+1,z:l};wn(n,{tryMove:c})}if(e==="k"||e==="ArrowUp"){const c={x:a,y:h-1,z:l};wn(n,{tryMove:c})}if(e==="l"||e==="ArrowRight"){const c={x:a+1,y:h,z:l};wn(n,{tryMove:c})}}}),vi(n=>{n.userInput=null})},ld=()=>{const i=So(Yr.HasAppearance),t=So(Yr.IsPlayer),{map:e}=Be().views;for(const n of i.entities){const s=en(n);if(!s)return;const{char:a,tint:h}=s.components.appearance,{x:l,y:c}=s.components.position;e==null||e.updateCell({0:{char:a,tint:h,alpha:1,tileSet:"ascii",x:l,y:c}})}for(const n of t.entities){const s=en(n);if(!s)return;const{char:a,tint:h}=s.components.appearance,{x:l,y:c}=s.components.position;e==null||e.updateCell({1:{char:a,tint:h,alpha:1,tileSet:"ascii",x:l,y:c}}),Be().toRender.forEach(f=>{const d=YC(f);e==null||e.updateCell({1:{char:"",tint:0,alpha:0,tileSet:"ascii",x:d.x,y:d.y}})}),vi(f=>f.toRender=new Set)}},ZC=()=>{So(Yr.IsTryingToMove).entities.forEach(t=>{const e=en(t);if(!e)return;const{x:n,y:s,z:a}=e.components.tryMove,{width:h,height:l}=Be().views.map;n<0||s<0||n>=h||s>=l||(e.components.position.x=n,e.components.position.y=s,e.components.position.z=a)})},JC=i=>{const t=Tl({wId:i});wn(t.id,{appearance:{char:"@",tint:16711816,tileSet:"ascii"},isPlayer:{},position:{x:0,y:0,z:0}})},QC=i=>{const t=Tl({wId:i});return wn(t.id,{appearance:{char:"#",tint:8421504,tileSet:"ascii"},position:{x:0,y:0,z:0}})},tI=i=>{const t=Tl({wId:i});return wn(t.id,{appearance:{char:"•",tint:3355443,tileSet:"ascii"},position:{x:0,y:0,z:0}})};function eI(i,t){const e={},n=Math.min(i.x,t.x),s=Math.max(i.x,t.x)+1;let a=n;for(;a<s;){const h={...t,x:a};e[El(h)]={...h,sprite:"FLOOR"},a++}return e}function iI(i,t){const e={},n=Math.min(i.y,t.y),s=Math.max(i.y,t.y)+1;let a=n;for(;a<s;){const h={...i,y:a};e[El(h)]={...h,sprite:"FLOOR"},a++}return e}const nI=i=>{const{pos:t,width:e,height:n,minRoomSize:s=6,maxRoomSize:a=12,maxRoomCount:h=30}=i,{x:l,y:c,z:f}=t,d=hd({x:l,y:c,z:f,width:e,height:n,hasWalls:!1},{sprite:"WALL"}),g=[];let m={};Xe.exports.times(h,()=>{let A=Xe.exports.random(s,a),T=Xe.exports.random(s,a),R=Xe.exports.random(l,e+l-A-1),M=Xe.exports.random(c,n+c-T-1);const E=hd({x:R,y:M,z:f,width:A,height:T,hasWalls:!0},{sprite:"FLOOR"});g.some(P=>jC(P,E))||(g.push(E),m={...m,...E.tiles})});let v=null,x={};for(let A of g)v&&(x={...x,...eI(A.center,v.center),...iI(A.center,v.center)}),v=A;return d.tiles={...d.tiles,...m,...x},d},rI=()=>{const i=nI({pos:{x:0,y:0,z:0},width:74,height:39,minRoomSize:8,maxRoomSize:18,maxRoomCount:100}),t=Object.values(i.tiles);for(const e of t){let n;if(e.sprite==="WALL"&&(n=QC(Be().wId)),e.sprite==="FLOOR"&&(n=tI(Be().wId)),!n)return;n.components.position.x=e.x,n.components.position.y=e.y,n.components.position.z=e.z}};window.skulltooth=window.skulltooth||{};window.skulltooth.getEngine=()=>VC();const Al={fps:0,toRender:new Set,turn:"WORLD",userInput:null,views:{},wId:""};window.skulltooth.state=Al;const vi=i=>{i(Al)},Be=()=>Al,sI=async()=>{await LC(document.querySelector("#canvas"));const i=$C();vi(n=>{n.wId=i.id}),qC(),JC(Be().wId),rI(),new so({width:12,height:2,x:0,y:0,layers:2,tileSets:["tile","text"],tints:[16777215,16711799],alphas:[1,1]}).updateRows([[{},{string:" skulltooth"}],[{tint:16711799},{string:"forcecrusher",tint:16777215}]]);const t=new so({width:74,height:39,x:13,y:3,layers:2,tileSets:["tile","ascii","tile"],tints:[2236962,2236962,0],alphas:[1,1,0]}),e=new so({width:12,height:1,x:0,y:42,layers:1,tileSets:["text"],tints:[14540253],alphas:[1]}).updateRows([[{string:"FPS: calc..."}]]);new so({width:12,height:1,x:0,y:43,layers:1,tileSets:["text"],tints:[16777215],alphas:[1]}).updateRows([[{string:"TAG: e6441a6"}]]),vi(n=>{n.views.fps=e,n.views.map=t}),Dp(),document.addEventListener("keydown",n=>{vi(s=>{s.userInput=n})})};let Ih=0,oo=Date.now(),ao=[];function Dp(){var i;requestAnimationFrame(Dp),Be().userInput&&Be().turn==="PLAYER"&&(KC(),ZC(),ld(),vi(t=>{t.turn="WORLD"})),Be().turn==="WORLD"&&(ld(),vi(t=>{t.turn="PLAYER"})),oo||(oo=Date.now()),Date.now()-oo>1e3&&(ao.unshift(Ih),ao.length>3&&ao.pop(),isNaN(Be().fps)||(i=Be().views.fps)==null||i.updateRow({string:`FPS: ${Be().fps}     `,layer:0,x:0,y:0,tileSet:"text"}),oo=Date.now(),Ih=0),vi(t=>t.fps=Math.round(Xe.exports.mean(ao))),Ih++}sI();
