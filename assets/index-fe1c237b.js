var Yy=Object.defineProperty;var jy=(i,t,e)=>t in i?Yy(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var li=(i,t,e)=>(jy(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerpolicy&&(a.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?a.credentials="include":s.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var Wi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gh={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,t){(function(){var e,r="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,p="__lodash_placeholder__",g=1,_=2,v=4,y=1,A=2,w=1,R=2,M=4,E=8,P=16,U=32,z=64,G=128,k=256,Z=512,nt=30,V="...",J=800,X=16,O=1,dt=2,_t=3,Y=1/0,vt=9007199254740991,Ut=17976931348623157e292,H=0/0,et=4294967295,yt=et-1,Ct=et>>>1,Rt=[["ary",G],["bind",w],["bindKey",R],["curry",E],["curryRight",P],["flip",Z],["partial",U],["partialRight",z],["rearg",k]],Ft="[object Arguments]",Lt="[object Array]",Jt="[object AsyncFunction]",$t="[object Boolean]",Qt="[object Date]",ee="[object DOMException]",Pt="[object Error]",Ot="[object Function]",Vt="[object GeneratorFunction]",Yt="[object Map]",ce="[object Number]",Zi="[object Null]",si="[object Object]",hl="[object Promise]",cp="[object Proxy]",rn="[object RegExp]",Xe="[object Set]",nn="[object String]",Wn="[object Symbol]",fp="[object Undefined]",sn="[object WeakMap]",dp="[object WeakSet]",on="[object ArrayBuffer]",br="[object DataView]",Eo="[object Float32Array]",Ao="[object Float64Array]",So="[object Int8Array]",Co="[object Int16Array]",Io="[object Int32Array]",Ro="[object Uint8Array]",Po="[object Uint8ClampedArray]",Mo="[object Uint16Array]",Do="[object Uint32Array]",pp=/\b__p \+= '';/g,gp=/\b(__p \+=) '' \+/g,mp=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ll=/&(?:amp|lt|gt|quot|#39);/g,ul=/[&<>"']/g,_p=RegExp(ll.source),vp=RegExp(ul.source),xp=/<%-([\s\S]+?)%>/g,yp=/<%([\s\S]+?)%>/g,cl=/<%=([\s\S]+?)%>/g,bp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Tp=/^\w*$/,wp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Bo=/[\\^$.*+?()[\]{}|]/g,Ep=RegExp(Bo.source),Fo=/^\s+/,Ap=/\s/,Sp=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Cp=/\{\n\/\* \[wrapped with (.+)\] \*/,Ip=/,? & /,Rp=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pp=/[()=,{}\[\]\/\s]/,Mp=/\\(\\)?/g,Dp=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fl=/\w*$/,Bp=/^[-+]0x[0-9a-f]+$/i,Fp=/^0b[01]+$/i,Lp=/^\[object .+?Constructor\]$/,Op=/^0o[0-7]+$/i,Np=/^(?:0|[1-9]\d*)$/,Up=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,zn=/($^)/,kp=/['\n\r\u2028\u2029\\]/g,$n="\\ud800-\\udfff",Gp="\\u0300-\\u036f",Hp="\\ufe20-\\ufe2f",Xp="\\u20d0-\\u20ff",dl=Gp+Hp+Xp,pl="\\u2700-\\u27bf",gl="a-z\\xdf-\\xf6\\xf8-\\xff",Wp="\\xac\\xb1\\xd7\\xf7",zp="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$p="\\u2000-\\u206f",Vp=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ml="A-Z\\xc0-\\xd6\\xd8-\\xde",_l="\\ufe0e\\ufe0f",vl=Wp+zp+$p+Vp,Lo="['’]",Yp="["+$n+"]",xl="["+vl+"]",Vn="["+dl+"]",yl="\\d+",jp="["+pl+"]",bl="["+gl+"]",Tl="[^"+$n+vl+yl+pl+gl+ml+"]",Oo="\\ud83c[\\udffb-\\udfff]",qp="(?:"+Vn+"|"+Oo+")",wl="[^"+$n+"]",No="(?:\\ud83c[\\udde6-\\uddff]){2}",Uo="[\\ud800-\\udbff][\\udc00-\\udfff]",Tr="["+ml+"]",El="\\u200d",Al="(?:"+bl+"|"+Tl+")",Kp="(?:"+Tr+"|"+Tl+")",Sl="(?:"+Lo+"(?:d|ll|m|re|s|t|ve))?",Cl="(?:"+Lo+"(?:D|LL|M|RE|S|T|VE))?",Il=qp+"?",Rl="["+_l+"]?",Zp="(?:"+El+"(?:"+[wl,No,Uo].join("|")+")"+Rl+Il+")*",Jp="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Qp="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Pl=Rl+Il+Zp,tg="(?:"+[jp,No,Uo].join("|")+")"+Pl,eg="(?:"+[wl+Vn+"?",Vn,No,Uo,Yp].join("|")+")",ig=RegExp(Lo,"g"),rg=RegExp(Vn,"g"),ko=RegExp(Oo+"(?="+Oo+")|"+eg+Pl,"g"),ng=RegExp([Tr+"?"+bl+"+"+Sl+"(?="+[xl,Tr,"$"].join("|")+")",Kp+"+"+Cl+"(?="+[xl,Tr+Al,"$"].join("|")+")",Tr+"?"+Al+"+"+Sl,Tr+"+"+Cl,Qp,Jp,yl,tg].join("|"),"g"),sg=RegExp("["+El+$n+dl+_l+"]"),og=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ag=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],hg=-1,Nt={};Nt[Eo]=Nt[Ao]=Nt[So]=Nt[Co]=Nt[Io]=Nt[Ro]=Nt[Po]=Nt[Mo]=Nt[Do]=!0,Nt[Ft]=Nt[Lt]=Nt[on]=Nt[$t]=Nt[br]=Nt[Qt]=Nt[Pt]=Nt[Ot]=Nt[Yt]=Nt[ce]=Nt[si]=Nt[rn]=Nt[Xe]=Nt[nn]=Nt[sn]=!1;var Bt={};Bt[Ft]=Bt[Lt]=Bt[on]=Bt[br]=Bt[$t]=Bt[Qt]=Bt[Eo]=Bt[Ao]=Bt[So]=Bt[Co]=Bt[Io]=Bt[Yt]=Bt[ce]=Bt[si]=Bt[rn]=Bt[Xe]=Bt[nn]=Bt[Wn]=Bt[Ro]=Bt[Po]=Bt[Mo]=Bt[Do]=!0,Bt[Pt]=Bt[Ot]=Bt[sn]=!1;var lg={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ug={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},cg={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},fg={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},dg=parseFloat,pg=parseInt,Ml=typeof Wi=="object"&&Wi&&Wi.Object===Object&&Wi,gg=typeof self=="object"&&self&&self.Object===Object&&self,oe=Ml||gg||Function("return this")(),Go=t&&!t.nodeType&&t,Ji=Go&&!0&&i&&!i.nodeType&&i,Dl=Ji&&Ji.exports===Go,Ho=Dl&&Ml.process,Be=function(){try{var C=Ji&&Ji.require&&Ji.require("util").types;return C||Ho&&Ho.binding&&Ho.binding("util")}catch{}}(),Bl=Be&&Be.isArrayBuffer,Fl=Be&&Be.isDate,Ll=Be&&Be.isMap,Ol=Be&&Be.isRegExp,Nl=Be&&Be.isSet,Ul=Be&&Be.isTypedArray;function Ee(C,B,D){switch(D.length){case 0:return C.call(B);case 1:return C.call(B,D[0]);case 2:return C.call(B,D[0],D[1]);case 3:return C.call(B,D[0],D[1],D[2])}return C.apply(B,D)}function mg(C,B,D,K){for(var ut=-1,St=C==null?0:C.length;++ut<St;){var ie=C[ut];B(K,ie,D(ie),C)}return K}function Fe(C,B){for(var D=-1,K=C==null?0:C.length;++D<K&&B(C[D],D,C)!==!1;);return C}function _g(C,B){for(var D=C==null?0:C.length;D--&&B(C[D],D,C)!==!1;);return C}function kl(C,B){for(var D=-1,K=C==null?0:C.length;++D<K;)if(!B(C[D],D,C))return!1;return!0}function Bi(C,B){for(var D=-1,K=C==null?0:C.length,ut=0,St=[];++D<K;){var ie=C[D];B(ie,D,C)&&(St[ut++]=ie)}return St}function Yn(C,B){var D=C==null?0:C.length;return!!D&&wr(C,B,0)>-1}function Xo(C,B,D){for(var K=-1,ut=C==null?0:C.length;++K<ut;)if(D(B,C[K]))return!0;return!1}function kt(C,B){for(var D=-1,K=C==null?0:C.length,ut=Array(K);++D<K;)ut[D]=B(C[D],D,C);return ut}function Fi(C,B){for(var D=-1,K=B.length,ut=C.length;++D<K;)C[ut+D]=B[D];return C}function Wo(C,B,D,K){var ut=-1,St=C==null?0:C.length;for(K&&St&&(D=C[++ut]);++ut<St;)D=B(D,C[ut],ut,C);return D}function vg(C,B,D,K){var ut=C==null?0:C.length;for(K&&ut&&(D=C[--ut]);ut--;)D=B(D,C[ut],ut,C);return D}function zo(C,B){for(var D=-1,K=C==null?0:C.length;++D<K;)if(B(C[D],D,C))return!0;return!1}var xg=$o("length");function yg(C){return C.split("")}function bg(C){return C.match(Rp)||[]}function Gl(C,B,D){var K;return D(C,function(ut,St,ie){if(B(ut,St,ie))return K=St,!1}),K}function jn(C,B,D,K){for(var ut=C.length,St=D+(K?1:-1);K?St--:++St<ut;)if(B(C[St],St,C))return St;return-1}function wr(C,B,D){return B===B?Bg(C,B,D):jn(C,Hl,D)}function Tg(C,B,D,K){for(var ut=D-1,St=C.length;++ut<St;)if(K(C[ut],B))return ut;return-1}function Hl(C){return C!==C}function Xl(C,B){var D=C==null?0:C.length;return D?Yo(C,B)/D:H}function $o(C){return function(B){return B==null?e:B[C]}}function Vo(C){return function(B){return C==null?e:C[B]}}function Wl(C,B,D,K,ut){return ut(C,function(St,ie,Dt){D=K?(K=!1,St):B(D,St,ie,Dt)}),D}function wg(C,B){var D=C.length;for(C.sort(B);D--;)C[D]=C[D].value;return C}function Yo(C,B){for(var D,K=-1,ut=C.length;++K<ut;){var St=B(C[K]);St!==e&&(D=D===e?St:D+St)}return D}function jo(C,B){for(var D=-1,K=Array(C);++D<C;)K[D]=B(D);return K}function Eg(C,B){return kt(B,function(D){return[D,C[D]]})}function zl(C){return C&&C.slice(0,jl(C)+1).replace(Fo,"")}function Ae(C){return function(B){return C(B)}}function qo(C,B){return kt(B,function(D){return C[D]})}function an(C,B){return C.has(B)}function $l(C,B){for(var D=-1,K=C.length;++D<K&&wr(B,C[D],0)>-1;);return D}function Vl(C,B){for(var D=C.length;D--&&wr(B,C[D],0)>-1;);return D}function Ag(C,B){for(var D=C.length,K=0;D--;)C[D]===B&&++K;return K}var Sg=Vo(lg),Cg=Vo(ug);function Ig(C){return"\\"+fg[C]}function Rg(C,B){return C==null?e:C[B]}function Er(C){return sg.test(C)}function Pg(C){return og.test(C)}function Mg(C){for(var B,D=[];!(B=C.next()).done;)D.push(B.value);return D}function Ko(C){var B=-1,D=Array(C.size);return C.forEach(function(K,ut){D[++B]=[ut,K]}),D}function Yl(C,B){return function(D){return C(B(D))}}function Li(C,B){for(var D=-1,K=C.length,ut=0,St=[];++D<K;){var ie=C[D];(ie===B||ie===p)&&(C[D]=p,St[ut++]=D)}return St}function qn(C){var B=-1,D=Array(C.size);return C.forEach(function(K){D[++B]=K}),D}function Dg(C){var B=-1,D=Array(C.size);return C.forEach(function(K){D[++B]=[K,K]}),D}function Bg(C,B,D){for(var K=D-1,ut=C.length;++K<ut;)if(C[K]===B)return K;return-1}function Fg(C,B,D){for(var K=D+1;K--;)if(C[K]===B)return K;return K}function Ar(C){return Er(C)?Og(C):xg(C)}function We(C){return Er(C)?Ng(C):yg(C)}function jl(C){for(var B=C.length;B--&&Ap.test(C.charAt(B)););return B}var Lg=Vo(cg);function Og(C){for(var B=ko.lastIndex=0;ko.test(C);)++B;return B}function Ng(C){return C.match(ko)||[]}function Ug(C){return C.match(ng)||[]}var kg=function C(B){B=B==null?oe:Sr.defaults(oe.Object(),B,Sr.pick(oe,ag));var D=B.Array,K=B.Date,ut=B.Error,St=B.Function,ie=B.Math,Dt=B.Object,Zo=B.RegExp,Gg=B.String,Le=B.TypeError,Kn=D.prototype,Hg=St.prototype,Cr=Dt.prototype,Zn=B["__core-js_shared__"],Jn=Hg.toString,Mt=Cr.hasOwnProperty,Xg=0,ql=function(){var n=/[^.]+$/.exec(Zn&&Zn.keys&&Zn.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Qn=Cr.toString,Wg=Jn.call(Dt),zg=oe._,$g=Zo("^"+Jn.call(Mt).replace(Bo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ts=Dl?B.Buffer:e,Oi=B.Symbol,es=B.Uint8Array,Kl=ts?ts.allocUnsafe:e,is=Yl(Dt.getPrototypeOf,Dt),Zl=Dt.create,Jl=Cr.propertyIsEnumerable,rs=Kn.splice,Ql=Oi?Oi.isConcatSpreadable:e,hn=Oi?Oi.iterator:e,Qi=Oi?Oi.toStringTag:e,ns=function(){try{var n=nr(Dt,"defineProperty");return n({},"",{}),n}catch{}}(),Vg=B.clearTimeout!==oe.clearTimeout&&B.clearTimeout,Yg=K&&K.now!==oe.Date.now&&K.now,jg=B.setTimeout!==oe.setTimeout&&B.setTimeout,ss=ie.ceil,os=ie.floor,Jo=Dt.getOwnPropertySymbols,qg=ts?ts.isBuffer:e,tu=B.isFinite,Kg=Kn.join,Zg=Yl(Dt.keys,Dt),re=ie.max,fe=ie.min,Jg=K.now,Qg=B.parseInt,eu=ie.random,tm=Kn.reverse,Qo=nr(B,"DataView"),ln=nr(B,"Map"),ta=nr(B,"Promise"),Ir=nr(B,"Set"),un=nr(B,"WeakMap"),cn=nr(Dt,"create"),as=un&&new un,Rr={},em=sr(Qo),im=sr(ln),rm=sr(ta),nm=sr(Ir),sm=sr(un),hs=Oi?Oi.prototype:e,fn=hs?hs.valueOf:e,iu=hs?hs.toString:e;function x(n){if(jt(n)&&!ct(n)&&!(n instanceof bt)){if(n instanceof Oe)return n;if(Mt.call(n,"__wrapped__"))return rc(n)}return new Oe(n)}var Pr=function(){function n(){}return function(o){if(!Ht(o))return{};if(Zl)return Zl(o);n.prototype=o;var u=new n;return n.prototype=e,u}}();function ls(){}function Oe(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}x.templateSettings={escape:xp,evaluate:yp,interpolate:cl,variable:"",imports:{_:x}},x.prototype=ls.prototype,x.prototype.constructor=x,Oe.prototype=Pr(ls.prototype),Oe.prototype.constructor=Oe;function bt(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=et,this.__views__=[]}function om(){var n=new bt(this.__wrapped__);return n.__actions__=ve(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ve(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ve(this.__views__),n}function am(){if(this.__filtered__){var n=new bt(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function hm(){var n=this.__wrapped__.value(),o=this.__dir__,u=ct(n),d=o<0,m=u?n.length:0,b=y_(0,m,this.__views__),T=b.start,S=b.end,I=S-T,F=d?S:T-1,L=this.__iteratees__,N=L.length,$=0,Q=fe(I,this.__takeCount__);if(!u||!d&&m==I&&Q==I)return Su(n,this.__actions__);var at=[];t:for(;I--&&$<Q;){F+=o;for(var gt=-1,ht=n[F];++gt<N;){var xt=L[gt],wt=xt.iteratee,Ie=xt.type,me=wt(ht);if(Ie==dt)ht=me;else if(!me){if(Ie==O)continue t;break t}}at[$++]=ht}return at}bt.prototype=Pr(ls.prototype),bt.prototype.constructor=bt;function tr(n){var o=-1,u=n==null?0:n.length;for(this.clear();++o<u;){var d=n[o];this.set(d[0],d[1])}}function lm(){this.__data__=cn?cn(null):{},this.size=0}function um(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function cm(n){var o=this.__data__;if(cn){var u=o[n];return u===c?e:u}return Mt.call(o,n)?o[n]:e}function fm(n){var o=this.__data__;return cn?o[n]!==e:Mt.call(o,n)}function dm(n,o){var u=this.__data__;return this.size+=this.has(n)?0:1,u[n]=cn&&o===e?c:o,this}tr.prototype.clear=lm,tr.prototype.delete=um,tr.prototype.get=cm,tr.prototype.has=fm,tr.prototype.set=dm;function vi(n){var o=-1,u=n==null?0:n.length;for(this.clear();++o<u;){var d=n[o];this.set(d[0],d[1])}}function pm(){this.__data__=[],this.size=0}function gm(n){var o=this.__data__,u=us(o,n);if(u<0)return!1;var d=o.length-1;return u==d?o.pop():rs.call(o,u,1),--this.size,!0}function mm(n){var o=this.__data__,u=us(o,n);return u<0?e:o[u][1]}function _m(n){return us(this.__data__,n)>-1}function vm(n,o){var u=this.__data__,d=us(u,n);return d<0?(++this.size,u.push([n,o])):u[d][1]=o,this}vi.prototype.clear=pm,vi.prototype.delete=gm,vi.prototype.get=mm,vi.prototype.has=_m,vi.prototype.set=vm;function xi(n){var o=-1,u=n==null?0:n.length;for(this.clear();++o<u;){var d=n[o];this.set(d[0],d[1])}}function xm(){this.size=0,this.__data__={hash:new tr,map:new(ln||vi),string:new tr}}function ym(n){var o=Ts(this,n).delete(n);return this.size-=o?1:0,o}function bm(n){return Ts(this,n).get(n)}function Tm(n){return Ts(this,n).has(n)}function wm(n,o){var u=Ts(this,n),d=u.size;return u.set(n,o),this.size+=u.size==d?0:1,this}xi.prototype.clear=xm,xi.prototype.delete=ym,xi.prototype.get=bm,xi.prototype.has=Tm,xi.prototype.set=wm;function er(n){var o=-1,u=n==null?0:n.length;for(this.__data__=new xi;++o<u;)this.add(n[o])}function Em(n){return this.__data__.set(n,c),this}function Am(n){return this.__data__.has(n)}er.prototype.add=er.prototype.push=Em,er.prototype.has=Am;function ze(n){var o=this.__data__=new vi(n);this.size=o.size}function Sm(){this.__data__=new vi,this.size=0}function Cm(n){var o=this.__data__,u=o.delete(n);return this.size=o.size,u}function Im(n){return this.__data__.get(n)}function Rm(n){return this.__data__.has(n)}function Pm(n,o){var u=this.__data__;if(u instanceof vi){var d=u.__data__;if(!ln||d.length<s-1)return d.push([n,o]),this.size=++u.size,this;u=this.__data__=new xi(d)}return u.set(n,o),this.size=u.size,this}ze.prototype.clear=Sm,ze.prototype.delete=Cm,ze.prototype.get=Im,ze.prototype.has=Rm,ze.prototype.set=Pm;function ru(n,o){var u=ct(n),d=!u&&or(n),m=!u&&!d&&Hi(n),b=!u&&!d&&!m&&Fr(n),T=u||d||m||b,S=T?jo(n.length,Gg):[],I=S.length;for(var F in n)(o||Mt.call(n,F))&&!(T&&(F=="length"||m&&(F=="offset"||F=="parent")||b&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||wi(F,I)))&&S.push(F);return S}function nu(n){var o=n.length;return o?n[ca(0,o-1)]:e}function Mm(n,o){return ws(ve(n),ir(o,0,n.length))}function Dm(n){return ws(ve(n))}function ea(n,o,u){(u!==e&&!$e(n[o],u)||u===e&&!(o in n))&&yi(n,o,u)}function dn(n,o,u){var d=n[o];(!(Mt.call(n,o)&&$e(d,u))||u===e&&!(o in n))&&yi(n,o,u)}function us(n,o){for(var u=n.length;u--;)if($e(n[u][0],o))return u;return-1}function Bm(n,o,u,d){return Ni(n,function(m,b,T){o(d,m,u(m),T)}),d}function su(n,o){return n&&ai(o,se(o),n)}function Fm(n,o){return n&&ai(o,ye(o),n)}function yi(n,o,u){o=="__proto__"&&ns?ns(n,o,{configurable:!0,enumerable:!0,value:u,writable:!0}):n[o]=u}function ia(n,o){for(var u=-1,d=o.length,m=D(d),b=n==null;++u<d;)m[u]=b?e:Oa(n,o[u]);return m}function ir(n,o,u){return n===n&&(u!==e&&(n=n<=u?n:u),o!==e&&(n=n>=o?n:o)),n}function Ne(n,o,u,d,m,b){var T,S=o&g,I=o&_,F=o&v;if(u&&(T=m?u(n,d,m,b):u(n)),T!==e)return T;if(!Ht(n))return n;var L=ct(n);if(L){if(T=T_(n),!S)return ve(n,T)}else{var N=de(n),$=N==Ot||N==Vt;if(Hi(n))return Ru(n,S);if(N==si||N==Ft||$&&!m){if(T=I||$?{}:ju(n),!S)return I?c_(n,Fm(T,n)):u_(n,su(T,n))}else{if(!Bt[N])return m?n:{};T=w_(n,N,S)}}b||(b=new ze);var Q=b.get(n);if(Q)return Q;b.set(n,T),wc(n)?n.forEach(function(ht){T.add(Ne(ht,o,u,ht,n,b))}):bc(n)&&n.forEach(function(ht,xt){T.set(xt,Ne(ht,o,u,xt,n,b))});var at=F?I?Ta:ba:I?ye:se,gt=L?e:at(n);return Fe(gt||n,function(ht,xt){gt&&(xt=ht,ht=n[xt]),dn(T,xt,Ne(ht,o,u,xt,n,b))}),T}function Lm(n){var o=se(n);return function(u){return ou(u,n,o)}}function ou(n,o,u){var d=u.length;if(n==null)return!d;for(n=Dt(n);d--;){var m=u[d],b=o[m],T=n[m];if(T===e&&!(m in n)||!b(T))return!1}return!0}function au(n,o,u){if(typeof n!="function")throw new Le(h);return yn(function(){n.apply(e,u)},o)}function pn(n,o,u,d){var m=-1,b=Yn,T=!0,S=n.length,I=[],F=o.length;if(!S)return I;u&&(o=kt(o,Ae(u))),d?(b=Xo,T=!1):o.length>=s&&(b=an,T=!1,o=new er(o));t:for(;++m<S;){var L=n[m],N=u==null?L:u(L);if(L=d||L!==0?L:0,T&&N===N){for(var $=F;$--;)if(o[$]===N)continue t;I.push(L)}else b(o,N,d)||I.push(L)}return I}var Ni=Fu(oi),hu=Fu(na,!0);function Om(n,o){var u=!0;return Ni(n,function(d,m,b){return u=!!o(d,m,b),u}),u}function cs(n,o,u){for(var d=-1,m=n.length;++d<m;){var b=n[d],T=o(b);if(T!=null&&(S===e?T===T&&!Ce(T):u(T,S)))var S=T,I=b}return I}function Nm(n,o,u,d){var m=n.length;for(u=pt(u),u<0&&(u=-u>m?0:m+u),d=d===e||d>m?m:pt(d),d<0&&(d+=m),d=u>d?0:Ac(d);u<d;)n[u++]=o;return n}function lu(n,o){var u=[];return Ni(n,function(d,m,b){o(d,m,b)&&u.push(d)}),u}function ae(n,o,u,d,m){var b=-1,T=n.length;for(u||(u=A_),m||(m=[]);++b<T;){var S=n[b];o>0&&u(S)?o>1?ae(S,o-1,u,d,m):Fi(m,S):d||(m[m.length]=S)}return m}var ra=Lu(),uu=Lu(!0);function oi(n,o){return n&&ra(n,o,se)}function na(n,o){return n&&uu(n,o,se)}function fs(n,o){return Bi(o,function(u){return Ei(n[u])})}function rr(n,o){o=ki(o,n);for(var u=0,d=o.length;n!=null&&u<d;)n=n[hi(o[u++])];return u&&u==d?n:e}function cu(n,o,u){var d=o(n);return ct(n)?d:Fi(d,u(n))}function pe(n){return n==null?n===e?fp:Zi:Qi&&Qi in Dt(n)?x_(n):D_(n)}function sa(n,o){return n>o}function Um(n,o){return n!=null&&Mt.call(n,o)}function km(n,o){return n!=null&&o in Dt(n)}function Gm(n,o,u){return n>=fe(o,u)&&n<re(o,u)}function oa(n,o,u){for(var d=u?Xo:Yn,m=n[0].length,b=n.length,T=b,S=D(b),I=1/0,F=[];T--;){var L=n[T];T&&o&&(L=kt(L,Ae(o))),I=fe(L.length,I),S[T]=!u&&(o||m>=120&&L.length>=120)?new er(T&&L):e}L=n[0];var N=-1,$=S[0];t:for(;++N<m&&F.length<I;){var Q=L[N],at=o?o(Q):Q;if(Q=u||Q!==0?Q:0,!($?an($,at):d(F,at,u))){for(T=b;--T;){var gt=S[T];if(!(gt?an(gt,at):d(n[T],at,u)))continue t}$&&$.push(at),F.push(Q)}}return F}function Hm(n,o,u,d){return oi(n,function(m,b,T){o(d,u(m),b,T)}),d}function gn(n,o,u){o=ki(o,n),n=Ju(n,o);var d=n==null?n:n[hi(ke(o))];return d==null?e:Ee(d,n,u)}function fu(n){return jt(n)&&pe(n)==Ft}function Xm(n){return jt(n)&&pe(n)==on}function Wm(n){return jt(n)&&pe(n)==Qt}function mn(n,o,u,d,m){return n===o?!0:n==null||o==null||!jt(n)&&!jt(o)?n!==n&&o!==o:zm(n,o,u,d,mn,m)}function zm(n,o,u,d,m,b){var T=ct(n),S=ct(o),I=T?Lt:de(n),F=S?Lt:de(o);I=I==Ft?si:I,F=F==Ft?si:F;var L=I==si,N=F==si,$=I==F;if($&&Hi(n)){if(!Hi(o))return!1;T=!0,L=!1}if($&&!L)return b||(b=new ze),T||Fr(n)?$u(n,o,u,d,m,b):__(n,o,I,u,d,m,b);if(!(u&y)){var Q=L&&Mt.call(n,"__wrapped__"),at=N&&Mt.call(o,"__wrapped__");if(Q||at){var gt=Q?n.value():n,ht=at?o.value():o;return b||(b=new ze),m(gt,ht,u,d,b)}}return $?(b||(b=new ze),v_(n,o,u,d,m,b)):!1}function $m(n){return jt(n)&&de(n)==Yt}function aa(n,o,u,d){var m=u.length,b=m,T=!d;if(n==null)return!b;for(n=Dt(n);m--;){var S=u[m];if(T&&S[2]?S[1]!==n[S[0]]:!(S[0]in n))return!1}for(;++m<b;){S=u[m];var I=S[0],F=n[I],L=S[1];if(T&&S[2]){if(F===e&&!(I in n))return!1}else{var N=new ze;if(d)var $=d(F,L,I,n,o,N);if(!($===e?mn(L,F,y|A,d,N):$))return!1}}return!0}function du(n){if(!Ht(n)||C_(n))return!1;var o=Ei(n)?$g:Lp;return o.test(sr(n))}function Vm(n){return jt(n)&&pe(n)==rn}function Ym(n){return jt(n)&&de(n)==Xe}function jm(n){return jt(n)&&Rs(n.length)&&!!Nt[pe(n)]}function pu(n){return typeof n=="function"?n:n==null?be:typeof n=="object"?ct(n)?_u(n[0],n[1]):mu(n):Oc(n)}function ha(n){if(!xn(n))return Zg(n);var o=[];for(var u in Dt(n))Mt.call(n,u)&&u!="constructor"&&o.push(u);return o}function qm(n){if(!Ht(n))return M_(n);var o=xn(n),u=[];for(var d in n)d=="constructor"&&(o||!Mt.call(n,d))||u.push(d);return u}function la(n,o){return n<o}function gu(n,o){var u=-1,d=xe(n)?D(n.length):[];return Ni(n,function(m,b,T){d[++u]=o(m,b,T)}),d}function mu(n){var o=Ea(n);return o.length==1&&o[0][2]?Ku(o[0][0],o[0][1]):function(u){return u===n||aa(u,n,o)}}function _u(n,o){return Sa(n)&&qu(o)?Ku(hi(n),o):function(u){var d=Oa(u,n);return d===e&&d===o?Na(u,n):mn(o,d,y|A)}}function ds(n,o,u,d,m){n!==o&&ra(o,function(b,T){if(m||(m=new ze),Ht(b))Km(n,o,T,u,ds,d,m);else{var S=d?d(Ia(n,T),b,T+"",n,o,m):e;S===e&&(S=b),ea(n,T,S)}},ye)}function Km(n,o,u,d,m,b,T){var S=Ia(n,u),I=Ia(o,u),F=T.get(I);if(F){ea(n,u,F);return}var L=b?b(S,I,u+"",n,o,T):e,N=L===e;if(N){var $=ct(I),Q=!$&&Hi(I),at=!$&&!Q&&Fr(I);L=I,$||Q||at?ct(S)?L=S:qt(S)?L=ve(S):Q?(N=!1,L=Ru(I,!0)):at?(N=!1,L=Pu(I,!0)):L=[]:bn(I)||or(I)?(L=S,or(S)?L=Sc(S):(!Ht(S)||Ei(S))&&(L=ju(I))):N=!1}N&&(T.set(I,L),m(L,I,d,b,T),T.delete(I)),ea(n,u,L)}function vu(n,o){var u=n.length;if(u)return o+=o<0?u:0,wi(o,u)?n[o]:e}function xu(n,o,u){o.length?o=kt(o,function(b){return ct(b)?function(T){return rr(T,b.length===1?b[0]:b)}:b}):o=[be];var d=-1;o=kt(o,Ae(ot()));var m=gu(n,function(b,T,S){var I=kt(o,function(F){return F(b)});return{criteria:I,index:++d,value:b}});return wg(m,function(b,T){return l_(b,T,u)})}function Zm(n,o){return yu(n,o,function(u,d){return Na(n,d)})}function yu(n,o,u){for(var d=-1,m=o.length,b={};++d<m;){var T=o[d],S=rr(n,T);u(S,T)&&_n(b,ki(T,n),S)}return b}function Jm(n){return function(o){return rr(o,n)}}function ua(n,o,u,d){var m=d?Tg:wr,b=-1,T=o.length,S=n;for(n===o&&(o=ve(o)),u&&(S=kt(n,Ae(u)));++b<T;)for(var I=0,F=o[b],L=u?u(F):F;(I=m(S,L,I,d))>-1;)S!==n&&rs.call(S,I,1),rs.call(n,I,1);return n}function bu(n,o){for(var u=n?o.length:0,d=u-1;u--;){var m=o[u];if(u==d||m!==b){var b=m;wi(m)?rs.call(n,m,1):pa(n,m)}}return n}function ca(n,o){return n+os(eu()*(o-n+1))}function Qm(n,o,u,d){for(var m=-1,b=re(ss((o-n)/(u||1)),0),T=D(b);b--;)T[d?b:++m]=n,n+=u;return T}function fa(n,o){var u="";if(!n||o<1||o>vt)return u;do o%2&&(u+=n),o=os(o/2),o&&(n+=n);while(o);return u}function mt(n,o){return Ra(Zu(n,o,be),n+"")}function t_(n){return nu(Lr(n))}function e_(n,o){var u=Lr(n);return ws(u,ir(o,0,u.length))}function _n(n,o,u,d){if(!Ht(n))return n;o=ki(o,n);for(var m=-1,b=o.length,T=b-1,S=n;S!=null&&++m<b;){var I=hi(o[m]),F=u;if(I==="__proto__"||I==="constructor"||I==="prototype")return n;if(m!=T){var L=S[I];F=d?d(L,I,S):e,F===e&&(F=Ht(L)?L:wi(o[m+1])?[]:{})}dn(S,I,F),S=S[I]}return n}var Tu=as?function(n,o){return as.set(n,o),n}:be,i_=ns?function(n,o){return ns(n,"toString",{configurable:!0,enumerable:!1,value:ka(o),writable:!0})}:be;function r_(n){return ws(Lr(n))}function Ue(n,o,u){var d=-1,m=n.length;o<0&&(o=-o>m?0:m+o),u=u>m?m:u,u<0&&(u+=m),m=o>u?0:u-o>>>0,o>>>=0;for(var b=D(m);++d<m;)b[d]=n[d+o];return b}function n_(n,o){var u;return Ni(n,function(d,m,b){return u=o(d,m,b),!u}),!!u}function ps(n,o,u){var d=0,m=n==null?d:n.length;if(typeof o=="number"&&o===o&&m<=Ct){for(;d<m;){var b=d+m>>>1,T=n[b];T!==null&&!Ce(T)&&(u?T<=o:T<o)?d=b+1:m=b}return m}return da(n,o,be,u)}function da(n,o,u,d){var m=0,b=n==null?0:n.length;if(b===0)return 0;o=u(o);for(var T=o!==o,S=o===null,I=Ce(o),F=o===e;m<b;){var L=os((m+b)/2),N=u(n[L]),$=N!==e,Q=N===null,at=N===N,gt=Ce(N);if(T)var ht=d||at;else F?ht=at&&(d||$):S?ht=at&&$&&(d||!Q):I?ht=at&&$&&!Q&&(d||!gt):Q||gt?ht=!1:ht=d?N<=o:N<o;ht?m=L+1:b=L}return fe(b,yt)}function wu(n,o){for(var u=-1,d=n.length,m=0,b=[];++u<d;){var T=n[u],S=o?o(T):T;if(!u||!$e(S,I)){var I=S;b[m++]=T===0?0:T}}return b}function Eu(n){return typeof n=="number"?n:Ce(n)?H:+n}function Se(n){if(typeof n=="string")return n;if(ct(n))return kt(n,Se)+"";if(Ce(n))return iu?iu.call(n):"";var o=n+"";return o=="0"&&1/n==-Y?"-0":o}function Ui(n,o,u){var d=-1,m=Yn,b=n.length,T=!0,S=[],I=S;if(u)T=!1,m=Xo;else if(b>=s){var F=o?null:g_(n);if(F)return qn(F);T=!1,m=an,I=new er}else I=o?[]:S;t:for(;++d<b;){var L=n[d],N=o?o(L):L;if(L=u||L!==0?L:0,T&&N===N){for(var $=I.length;$--;)if(I[$]===N)continue t;o&&I.push(N),S.push(L)}else m(I,N,u)||(I!==S&&I.push(N),S.push(L))}return S}function pa(n,o){return o=ki(o,n),n=Ju(n,o),n==null||delete n[hi(ke(o))]}function Au(n,o,u,d){return _n(n,o,u(rr(n,o)),d)}function gs(n,o,u,d){for(var m=n.length,b=d?m:-1;(d?b--:++b<m)&&o(n[b],b,n););return u?Ue(n,d?0:b,d?b+1:m):Ue(n,d?b+1:0,d?m:b)}function Su(n,o){var u=n;return u instanceof bt&&(u=u.value()),Wo(o,function(d,m){return m.func.apply(m.thisArg,Fi([d],m.args))},u)}function ga(n,o,u){var d=n.length;if(d<2)return d?Ui(n[0]):[];for(var m=-1,b=D(d);++m<d;)for(var T=n[m],S=-1;++S<d;)S!=m&&(b[m]=pn(b[m]||T,n[S],o,u));return Ui(ae(b,1),o,u)}function Cu(n,o,u){for(var d=-1,m=n.length,b=o.length,T={};++d<m;){var S=d<b?o[d]:e;u(T,n[d],S)}return T}function ma(n){return qt(n)?n:[]}function _a(n){return typeof n=="function"?n:be}function ki(n,o){return ct(n)?n:Sa(n,o)?[n]:ic(It(n))}var s_=mt;function Gi(n,o,u){var d=n.length;return u=u===e?d:u,!o&&u>=d?n:Ue(n,o,u)}var Iu=Vg||function(n){return oe.clearTimeout(n)};function Ru(n,o){if(o)return n.slice();var u=n.length,d=Kl?Kl(u):new n.constructor(u);return n.copy(d),d}function va(n){var o=new n.constructor(n.byteLength);return new es(o).set(new es(n)),o}function o_(n,o){var u=o?va(n.buffer):n.buffer;return new n.constructor(u,n.byteOffset,n.byteLength)}function a_(n){var o=new n.constructor(n.source,fl.exec(n));return o.lastIndex=n.lastIndex,o}function h_(n){return fn?Dt(fn.call(n)):{}}function Pu(n,o){var u=o?va(n.buffer):n.buffer;return new n.constructor(u,n.byteOffset,n.length)}function Mu(n,o){if(n!==o){var u=n!==e,d=n===null,m=n===n,b=Ce(n),T=o!==e,S=o===null,I=o===o,F=Ce(o);if(!S&&!F&&!b&&n>o||b&&T&&I&&!S&&!F||d&&T&&I||!u&&I||!m)return 1;if(!d&&!b&&!F&&n<o||F&&u&&m&&!d&&!b||S&&u&&m||!T&&m||!I)return-1}return 0}function l_(n,o,u){for(var d=-1,m=n.criteria,b=o.criteria,T=m.length,S=u.length;++d<T;){var I=Mu(m[d],b[d]);if(I){if(d>=S)return I;var F=u[d];return I*(F=="desc"?-1:1)}}return n.index-o.index}function Du(n,o,u,d){for(var m=-1,b=n.length,T=u.length,S=-1,I=o.length,F=re(b-T,0),L=D(I+F),N=!d;++S<I;)L[S]=o[S];for(;++m<T;)(N||m<b)&&(L[u[m]]=n[m]);for(;F--;)L[S++]=n[m++];return L}function Bu(n,o,u,d){for(var m=-1,b=n.length,T=-1,S=u.length,I=-1,F=o.length,L=re(b-S,0),N=D(L+F),$=!d;++m<L;)N[m]=n[m];for(var Q=m;++I<F;)N[Q+I]=o[I];for(;++T<S;)($||m<b)&&(N[Q+u[T]]=n[m++]);return N}function ve(n,o){var u=-1,d=n.length;for(o||(o=D(d));++u<d;)o[u]=n[u];return o}function ai(n,o,u,d){var m=!u;u||(u={});for(var b=-1,T=o.length;++b<T;){var S=o[b],I=d?d(u[S],n[S],S,u,n):e;I===e&&(I=n[S]),m?yi(u,S,I):dn(u,S,I)}return u}function u_(n,o){return ai(n,Aa(n),o)}function c_(n,o){return ai(n,Vu(n),o)}function ms(n,o){return function(u,d){var m=ct(u)?mg:Bm,b=o?o():{};return m(u,n,ot(d,2),b)}}function Mr(n){return mt(function(o,u){var d=-1,m=u.length,b=m>1?u[m-1]:e,T=m>2?u[2]:e;for(b=n.length>3&&typeof b=="function"?(m--,b):e,T&&ge(u[0],u[1],T)&&(b=m<3?e:b,m=1),o=Dt(o);++d<m;){var S=u[d];S&&n(o,S,d,b)}return o})}function Fu(n,o){return function(u,d){if(u==null)return u;if(!xe(u))return n(u,d);for(var m=u.length,b=o?m:-1,T=Dt(u);(o?b--:++b<m)&&d(T[b],b,T)!==!1;);return u}}function Lu(n){return function(o,u,d){for(var m=-1,b=Dt(o),T=d(o),S=T.length;S--;){var I=T[n?S:++m];if(u(b[I],I,b)===!1)break}return o}}function f_(n,o,u){var d=o&w,m=vn(n);function b(){var T=this&&this!==oe&&this instanceof b?m:n;return T.apply(d?u:this,arguments)}return b}function Ou(n){return function(o){o=It(o);var u=Er(o)?We(o):e,d=u?u[0]:o.charAt(0),m=u?Gi(u,1).join(""):o.slice(1);return d[n]()+m}}function Dr(n){return function(o){return Wo(Fc(Bc(o).replace(ig,"")),n,"")}}function vn(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var u=Pr(n.prototype),d=n.apply(u,o);return Ht(d)?d:u}}function d_(n,o,u){var d=vn(n);function m(){for(var b=arguments.length,T=D(b),S=b,I=Br(m);S--;)T[S]=arguments[S];var F=b<3&&T[0]!==I&&T[b-1]!==I?[]:Li(T,I);if(b-=F.length,b<u)return Hu(n,o,_s,m.placeholder,e,T,F,e,e,u-b);var L=this&&this!==oe&&this instanceof m?d:n;return Ee(L,this,T)}return m}function Nu(n){return function(o,u,d){var m=Dt(o);if(!xe(o)){var b=ot(u,3);o=se(o),u=function(S){return b(m[S],S,m)}}var T=n(o,u,d);return T>-1?m[b?o[T]:T]:e}}function Uu(n){return Ti(function(o){var u=o.length,d=u,m=Oe.prototype.thru;for(n&&o.reverse();d--;){var b=o[d];if(typeof b!="function")throw new Le(h);if(m&&!T&&bs(b)=="wrapper")var T=new Oe([],!0)}for(d=T?d:u;++d<u;){b=o[d];var S=bs(b),I=S=="wrapper"?wa(b):e;I&&Ca(I[0])&&I[1]==(G|E|U|k)&&!I[4].length&&I[9]==1?T=T[bs(I[0])].apply(T,I[3]):T=b.length==1&&Ca(b)?T[S]():T.thru(b)}return function(){var F=arguments,L=F[0];if(T&&F.length==1&&ct(L))return T.plant(L).value();for(var N=0,$=u?o[N].apply(this,F):L;++N<u;)$=o[N].call(this,$);return $}})}function _s(n,o,u,d,m,b,T,S,I,F){var L=o&G,N=o&w,$=o&R,Q=o&(E|P),at=o&Z,gt=$?e:vn(n);function ht(){for(var xt=arguments.length,wt=D(xt),Ie=xt;Ie--;)wt[Ie]=arguments[Ie];if(Q)var me=Br(ht),Re=Ag(wt,me);if(d&&(wt=Du(wt,d,m,Q)),b&&(wt=Bu(wt,b,T,Q)),xt-=Re,Q&&xt<F){var Kt=Li(wt,me);return Hu(n,o,_s,ht.placeholder,u,wt,Kt,S,I,F-xt)}var Ve=N?u:this,Si=$?Ve[n]:n;return xt=wt.length,S?wt=B_(wt,S):at&&xt>1&&wt.reverse(),L&&I<xt&&(wt.length=I),this&&this!==oe&&this instanceof ht&&(Si=gt||vn(Si)),Si.apply(Ve,wt)}return ht}function ku(n,o){return function(u,d){return Hm(u,n,o(d),{})}}function vs(n,o){return function(u,d){var m;if(u===e&&d===e)return o;if(u!==e&&(m=u),d!==e){if(m===e)return d;typeof u=="string"||typeof d=="string"?(u=Se(u),d=Se(d)):(u=Eu(u),d=Eu(d)),m=n(u,d)}return m}}function xa(n){return Ti(function(o){return o=kt(o,Ae(ot())),mt(function(u){var d=this;return n(o,function(m){return Ee(m,d,u)})})})}function xs(n,o){o=o===e?" ":Se(o);var u=o.length;if(u<2)return u?fa(o,n):o;var d=fa(o,ss(n/Ar(o)));return Er(o)?Gi(We(d),0,n).join(""):d.slice(0,n)}function p_(n,o,u,d){var m=o&w,b=vn(n);function T(){for(var S=-1,I=arguments.length,F=-1,L=d.length,N=D(L+I),$=this&&this!==oe&&this instanceof T?b:n;++F<L;)N[F]=d[F];for(;I--;)N[F++]=arguments[++S];return Ee($,m?u:this,N)}return T}function Gu(n){return function(o,u,d){return d&&typeof d!="number"&&ge(o,u,d)&&(u=d=e),o=Ai(o),u===e?(u=o,o=0):u=Ai(u),d=d===e?o<u?1:-1:Ai(d),Qm(o,u,d,n)}}function ys(n){return function(o,u){return typeof o=="string"&&typeof u=="string"||(o=Ge(o),u=Ge(u)),n(o,u)}}function Hu(n,o,u,d,m,b,T,S,I,F){var L=o&E,N=L?T:e,$=L?e:T,Q=L?b:e,at=L?e:b;o|=L?U:z,o&=~(L?z:U),o&M||(o&=~(w|R));var gt=[n,o,m,Q,N,at,$,S,I,F],ht=u.apply(e,gt);return Ca(n)&&Qu(ht,gt),ht.placeholder=d,tc(ht,n,o)}function ya(n){var o=ie[n];return function(u,d){if(u=Ge(u),d=d==null?0:fe(pt(d),292),d&&tu(u)){var m=(It(u)+"e").split("e"),b=o(m[0]+"e"+(+m[1]+d));return m=(It(b)+"e").split("e"),+(m[0]+"e"+(+m[1]-d))}return o(u)}}var g_=Ir&&1/qn(new Ir([,-0]))[1]==Y?function(n){return new Ir(n)}:Xa;function Xu(n){return function(o){var u=de(o);return u==Yt?Ko(o):u==Xe?Dg(o):Eg(o,n(o))}}function bi(n,o,u,d,m,b,T,S){var I=o&R;if(!I&&typeof n!="function")throw new Le(h);var F=d?d.length:0;if(F||(o&=~(U|z),d=m=e),T=T===e?T:re(pt(T),0),S=S===e?S:pt(S),F-=m?m.length:0,o&z){var L=d,N=m;d=m=e}var $=I?e:wa(n),Q=[n,o,u,d,m,L,N,b,T,S];if($&&P_(Q,$),n=Q[0],o=Q[1],u=Q[2],d=Q[3],m=Q[4],S=Q[9]=Q[9]===e?I?0:n.length:re(Q[9]-F,0),!S&&o&(E|P)&&(o&=~(E|P)),!o||o==w)var at=f_(n,o,u);else o==E||o==P?at=d_(n,o,S):(o==U||o==(w|U))&&!m.length?at=p_(n,o,u,d):at=_s.apply(e,Q);var gt=$?Tu:Qu;return tc(gt(at,Q),n,o)}function Wu(n,o,u,d){return n===e||$e(n,Cr[u])&&!Mt.call(d,u)?o:n}function zu(n,o,u,d,m,b){return Ht(n)&&Ht(o)&&(b.set(o,n),ds(n,o,e,zu,b),b.delete(o)),n}function m_(n){return bn(n)?e:n}function $u(n,o,u,d,m,b){var T=u&y,S=n.length,I=o.length;if(S!=I&&!(T&&I>S))return!1;var F=b.get(n),L=b.get(o);if(F&&L)return F==o&&L==n;var N=-1,$=!0,Q=u&A?new er:e;for(b.set(n,o),b.set(o,n);++N<S;){var at=n[N],gt=o[N];if(d)var ht=T?d(gt,at,N,o,n,b):d(at,gt,N,n,o,b);if(ht!==e){if(ht)continue;$=!1;break}if(Q){if(!zo(o,function(xt,wt){if(!an(Q,wt)&&(at===xt||m(at,xt,u,d,b)))return Q.push(wt)})){$=!1;break}}else if(!(at===gt||m(at,gt,u,d,b))){$=!1;break}}return b.delete(n),b.delete(o),$}function __(n,o,u,d,m,b,T){switch(u){case br:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case on:return!(n.byteLength!=o.byteLength||!b(new es(n),new es(o)));case $t:case Qt:case ce:return $e(+n,+o);case Pt:return n.name==o.name&&n.message==o.message;case rn:case nn:return n==o+"";case Yt:var S=Ko;case Xe:var I=d&y;if(S||(S=qn),n.size!=o.size&&!I)return!1;var F=T.get(n);if(F)return F==o;d|=A,T.set(n,o);var L=$u(S(n),S(o),d,m,b,T);return T.delete(n),L;case Wn:if(fn)return fn.call(n)==fn.call(o)}return!1}function v_(n,o,u,d,m,b){var T=u&y,S=ba(n),I=S.length,F=ba(o),L=F.length;if(I!=L&&!T)return!1;for(var N=I;N--;){var $=S[N];if(!(T?$ in o:Mt.call(o,$)))return!1}var Q=b.get(n),at=b.get(o);if(Q&&at)return Q==o&&at==n;var gt=!0;b.set(n,o),b.set(o,n);for(var ht=T;++N<I;){$=S[N];var xt=n[$],wt=o[$];if(d)var Ie=T?d(wt,xt,$,o,n,b):d(xt,wt,$,n,o,b);if(!(Ie===e?xt===wt||m(xt,wt,u,d,b):Ie)){gt=!1;break}ht||(ht=$=="constructor")}if(gt&&!ht){var me=n.constructor,Re=o.constructor;me!=Re&&"constructor"in n&&"constructor"in o&&!(typeof me=="function"&&me instanceof me&&typeof Re=="function"&&Re instanceof Re)&&(gt=!1)}return b.delete(n),b.delete(o),gt}function Ti(n){return Ra(Zu(n,e,oc),n+"")}function ba(n){return cu(n,se,Aa)}function Ta(n){return cu(n,ye,Vu)}var wa=as?function(n){return as.get(n)}:Xa;function bs(n){for(var o=n.name+"",u=Rr[o],d=Mt.call(Rr,o)?u.length:0;d--;){var m=u[d],b=m.func;if(b==null||b==n)return m.name}return o}function Br(n){var o=Mt.call(x,"placeholder")?x:n;return o.placeholder}function ot(){var n=x.iteratee||Ga;return n=n===Ga?pu:n,arguments.length?n(arguments[0],arguments[1]):n}function Ts(n,o){var u=n.__data__;return S_(o)?u[typeof o=="string"?"string":"hash"]:u.map}function Ea(n){for(var o=se(n),u=o.length;u--;){var d=o[u],m=n[d];o[u]=[d,m,qu(m)]}return o}function nr(n,o){var u=Rg(n,o);return du(u)?u:e}function x_(n){var o=Mt.call(n,Qi),u=n[Qi];try{n[Qi]=e;var d=!0}catch{}var m=Qn.call(n);return d&&(o?n[Qi]=u:delete n[Qi]),m}var Aa=Jo?function(n){return n==null?[]:(n=Dt(n),Bi(Jo(n),function(o){return Jl.call(n,o)}))}:Wa,Vu=Jo?function(n){for(var o=[];n;)Fi(o,Aa(n)),n=is(n);return o}:Wa,de=pe;(Qo&&de(new Qo(new ArrayBuffer(1)))!=br||ln&&de(new ln)!=Yt||ta&&de(ta.resolve())!=hl||Ir&&de(new Ir)!=Xe||un&&de(new un)!=sn)&&(de=function(n){var o=pe(n),u=o==si?n.constructor:e,d=u?sr(u):"";if(d)switch(d){case em:return br;case im:return Yt;case rm:return hl;case nm:return Xe;case sm:return sn}return o});function y_(n,o,u){for(var d=-1,m=u.length;++d<m;){var b=u[d],T=b.size;switch(b.type){case"drop":n+=T;break;case"dropRight":o-=T;break;case"take":o=fe(o,n+T);break;case"takeRight":n=re(n,o-T);break}}return{start:n,end:o}}function b_(n){var o=n.match(Cp);return o?o[1].split(Ip):[]}function Yu(n,o,u){o=ki(o,n);for(var d=-1,m=o.length,b=!1;++d<m;){var T=hi(o[d]);if(!(b=n!=null&&u(n,T)))break;n=n[T]}return b||++d!=m?b:(m=n==null?0:n.length,!!m&&Rs(m)&&wi(T,m)&&(ct(n)||or(n)))}function T_(n){var o=n.length,u=new n.constructor(o);return o&&typeof n[0]=="string"&&Mt.call(n,"index")&&(u.index=n.index,u.input=n.input),u}function ju(n){return typeof n.constructor=="function"&&!xn(n)?Pr(is(n)):{}}function w_(n,o,u){var d=n.constructor;switch(o){case on:return va(n);case $t:case Qt:return new d(+n);case br:return o_(n,u);case Eo:case Ao:case So:case Co:case Io:case Ro:case Po:case Mo:case Do:return Pu(n,u);case Yt:return new d;case ce:case nn:return new d(n);case rn:return a_(n);case Xe:return new d;case Wn:return h_(n)}}function E_(n,o){var u=o.length;if(!u)return n;var d=u-1;return o[d]=(u>1?"& ":"")+o[d],o=o.join(u>2?", ":" "),n.replace(Sp,`{
/* [wrapped with `+o+`] */
`)}function A_(n){return ct(n)||or(n)||!!(Ql&&n&&n[Ql])}function wi(n,o){var u=typeof n;return o=o??vt,!!o&&(u=="number"||u!="symbol"&&Np.test(n))&&n>-1&&n%1==0&&n<o}function ge(n,o,u){if(!Ht(u))return!1;var d=typeof o;return(d=="number"?xe(u)&&wi(o,u.length):d=="string"&&o in u)?$e(u[o],n):!1}function Sa(n,o){if(ct(n))return!1;var u=typeof n;return u=="number"||u=="symbol"||u=="boolean"||n==null||Ce(n)?!0:Tp.test(n)||!bp.test(n)||o!=null&&n in Dt(o)}function S_(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function Ca(n){var o=bs(n),u=x[o];if(typeof u!="function"||!(o in bt.prototype))return!1;if(n===u)return!0;var d=wa(u);return!!d&&n===d[0]}function C_(n){return!!ql&&ql in n}var I_=Zn?Ei:za;function xn(n){var o=n&&n.constructor,u=typeof o=="function"&&o.prototype||Cr;return n===u}function qu(n){return n===n&&!Ht(n)}function Ku(n,o){return function(u){return u==null?!1:u[n]===o&&(o!==e||n in Dt(u))}}function R_(n){var o=Cs(n,function(d){return u.size===f&&u.clear(),d}),u=o.cache;return o}function P_(n,o){var u=n[1],d=o[1],m=u|d,b=m<(w|R|G),T=d==G&&u==E||d==G&&u==k&&n[7].length<=o[8]||d==(G|k)&&o[7].length<=o[8]&&u==E;if(!(b||T))return n;d&w&&(n[2]=o[2],m|=u&w?0:M);var S=o[3];if(S){var I=n[3];n[3]=I?Du(I,S,o[4]):S,n[4]=I?Li(n[3],p):o[4]}return S=o[5],S&&(I=n[5],n[5]=I?Bu(I,S,o[6]):S,n[6]=I?Li(n[5],p):o[6]),S=o[7],S&&(n[7]=S),d&G&&(n[8]=n[8]==null?o[8]:fe(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=m,n}function M_(n){var o=[];if(n!=null)for(var u in Dt(n))o.push(u);return o}function D_(n){return Qn.call(n)}function Zu(n,o,u){return o=re(o===e?n.length-1:o,0),function(){for(var d=arguments,m=-1,b=re(d.length-o,0),T=D(b);++m<b;)T[m]=d[o+m];m=-1;for(var S=D(o+1);++m<o;)S[m]=d[m];return S[o]=u(T),Ee(n,this,S)}}function Ju(n,o){return o.length<2?n:rr(n,Ue(o,0,-1))}function B_(n,o){for(var u=n.length,d=fe(o.length,u),m=ve(n);d--;){var b=o[d];n[d]=wi(b,u)?m[b]:e}return n}function Ia(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var Qu=ec(Tu),yn=jg||function(n,o){return oe.setTimeout(n,o)},Ra=ec(i_);function tc(n,o,u){var d=o+"";return Ra(n,E_(d,F_(b_(d),u)))}function ec(n){var o=0,u=0;return function(){var d=Jg(),m=X-(d-u);if(u=d,m>0){if(++o>=J)return arguments[0]}else o=0;return n.apply(e,arguments)}}function ws(n,o){var u=-1,d=n.length,m=d-1;for(o=o===e?d:o;++u<o;){var b=ca(u,m),T=n[b];n[b]=n[u],n[u]=T}return n.length=o,n}var ic=R_(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(wp,function(u,d,m,b){o.push(m?b.replace(Mp,"$1"):d||u)}),o});function hi(n){if(typeof n=="string"||Ce(n))return n;var o=n+"";return o=="0"&&1/n==-Y?"-0":o}function sr(n){if(n!=null){try{return Jn.call(n)}catch{}try{return n+""}catch{}}return""}function F_(n,o){return Fe(Rt,function(u){var d="_."+u[0];o&u[1]&&!Yn(n,d)&&n.push(d)}),n.sort()}function rc(n){if(n instanceof bt)return n.clone();var o=new Oe(n.__wrapped__,n.__chain__);return o.__actions__=ve(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function L_(n,o,u){(u?ge(n,o,u):o===e)?o=1:o=re(pt(o),0);var d=n==null?0:n.length;if(!d||o<1)return[];for(var m=0,b=0,T=D(ss(d/o));m<d;)T[b++]=Ue(n,m,m+=o);return T}function O_(n){for(var o=-1,u=n==null?0:n.length,d=0,m=[];++o<u;){var b=n[o];b&&(m[d++]=b)}return m}function N_(){var n=arguments.length;if(!n)return[];for(var o=D(n-1),u=arguments[0],d=n;d--;)o[d-1]=arguments[d];return Fi(ct(u)?ve(u):[u],ae(o,1))}var U_=mt(function(n,o){return qt(n)?pn(n,ae(o,1,qt,!0)):[]}),k_=mt(function(n,o){var u=ke(o);return qt(u)&&(u=e),qt(n)?pn(n,ae(o,1,qt,!0),ot(u,2)):[]}),G_=mt(function(n,o){var u=ke(o);return qt(u)&&(u=e),qt(n)?pn(n,ae(o,1,qt,!0),e,u):[]});function H_(n,o,u){var d=n==null?0:n.length;return d?(o=u||o===e?1:pt(o),Ue(n,o<0?0:o,d)):[]}function X_(n,o,u){var d=n==null?0:n.length;return d?(o=u||o===e?1:pt(o),o=d-o,Ue(n,0,o<0?0:o)):[]}function W_(n,o){return n&&n.length?gs(n,ot(o,3),!0,!0):[]}function z_(n,o){return n&&n.length?gs(n,ot(o,3),!0):[]}function $_(n,o,u,d){var m=n==null?0:n.length;return m?(u&&typeof u!="number"&&ge(n,o,u)&&(u=0,d=m),Nm(n,o,u,d)):[]}function nc(n,o,u){var d=n==null?0:n.length;if(!d)return-1;var m=u==null?0:pt(u);return m<0&&(m=re(d+m,0)),jn(n,ot(o,3),m)}function sc(n,o,u){var d=n==null?0:n.length;if(!d)return-1;var m=d-1;return u!==e&&(m=pt(u),m=u<0?re(d+m,0):fe(m,d-1)),jn(n,ot(o,3),m,!0)}function oc(n){var o=n==null?0:n.length;return o?ae(n,1):[]}function V_(n){var o=n==null?0:n.length;return o?ae(n,Y):[]}function Y_(n,o){var u=n==null?0:n.length;return u?(o=o===e?1:pt(o),ae(n,o)):[]}function j_(n){for(var o=-1,u=n==null?0:n.length,d={};++o<u;){var m=n[o];d[m[0]]=m[1]}return d}function ac(n){return n&&n.length?n[0]:e}function q_(n,o,u){var d=n==null?0:n.length;if(!d)return-1;var m=u==null?0:pt(u);return m<0&&(m=re(d+m,0)),wr(n,o,m)}function K_(n){var o=n==null?0:n.length;return o?Ue(n,0,-1):[]}var Z_=mt(function(n){var o=kt(n,ma);return o.length&&o[0]===n[0]?oa(o):[]}),J_=mt(function(n){var o=ke(n),u=kt(n,ma);return o===ke(u)?o=e:u.pop(),u.length&&u[0]===n[0]?oa(u,ot(o,2)):[]}),Q_=mt(function(n){var o=ke(n),u=kt(n,ma);return o=typeof o=="function"?o:e,o&&u.pop(),u.length&&u[0]===n[0]?oa(u,e,o):[]});function t0(n,o){return n==null?"":Kg.call(n,o)}function ke(n){var o=n==null?0:n.length;return o?n[o-1]:e}function e0(n,o,u){var d=n==null?0:n.length;if(!d)return-1;var m=d;return u!==e&&(m=pt(u),m=m<0?re(d+m,0):fe(m,d-1)),o===o?Fg(n,o,m):jn(n,Hl,m,!0)}function i0(n,o){return n&&n.length?vu(n,pt(o)):e}var r0=mt(hc);function hc(n,o){return n&&n.length&&o&&o.length?ua(n,o):n}function n0(n,o,u){return n&&n.length&&o&&o.length?ua(n,o,ot(u,2)):n}function s0(n,o,u){return n&&n.length&&o&&o.length?ua(n,o,e,u):n}var o0=Ti(function(n,o){var u=n==null?0:n.length,d=ia(n,o);return bu(n,kt(o,function(m){return wi(m,u)?+m:m}).sort(Mu)),d});function a0(n,o){var u=[];if(!(n&&n.length))return u;var d=-1,m=[],b=n.length;for(o=ot(o,3);++d<b;){var T=n[d];o(T,d,n)&&(u.push(T),m.push(d))}return bu(n,m),u}function Pa(n){return n==null?n:tm.call(n)}function h0(n,o,u){var d=n==null?0:n.length;return d?(u&&typeof u!="number"&&ge(n,o,u)?(o=0,u=d):(o=o==null?0:pt(o),u=u===e?d:pt(u)),Ue(n,o,u)):[]}function l0(n,o){return ps(n,o)}function u0(n,o,u){return da(n,o,ot(u,2))}function c0(n,o){var u=n==null?0:n.length;if(u){var d=ps(n,o);if(d<u&&$e(n[d],o))return d}return-1}function f0(n,o){return ps(n,o,!0)}function d0(n,o,u){return da(n,o,ot(u,2),!0)}function p0(n,o){var u=n==null?0:n.length;if(u){var d=ps(n,o,!0)-1;if($e(n[d],o))return d}return-1}function g0(n){return n&&n.length?wu(n):[]}function m0(n,o){return n&&n.length?wu(n,ot(o,2)):[]}function _0(n){var o=n==null?0:n.length;return o?Ue(n,1,o):[]}function v0(n,o,u){return n&&n.length?(o=u||o===e?1:pt(o),Ue(n,0,o<0?0:o)):[]}function x0(n,o,u){var d=n==null?0:n.length;return d?(o=u||o===e?1:pt(o),o=d-o,Ue(n,o<0?0:o,d)):[]}function y0(n,o){return n&&n.length?gs(n,ot(o,3),!1,!0):[]}function b0(n,o){return n&&n.length?gs(n,ot(o,3)):[]}var T0=mt(function(n){return Ui(ae(n,1,qt,!0))}),w0=mt(function(n){var o=ke(n);return qt(o)&&(o=e),Ui(ae(n,1,qt,!0),ot(o,2))}),E0=mt(function(n){var o=ke(n);return o=typeof o=="function"?o:e,Ui(ae(n,1,qt,!0),e,o)});function A0(n){return n&&n.length?Ui(n):[]}function S0(n,o){return n&&n.length?Ui(n,ot(o,2)):[]}function C0(n,o){return o=typeof o=="function"?o:e,n&&n.length?Ui(n,e,o):[]}function Ma(n){if(!(n&&n.length))return[];var o=0;return n=Bi(n,function(u){if(qt(u))return o=re(u.length,o),!0}),jo(o,function(u){return kt(n,$o(u))})}function lc(n,o){if(!(n&&n.length))return[];var u=Ma(n);return o==null?u:kt(u,function(d){return Ee(o,e,d)})}var I0=mt(function(n,o){return qt(n)?pn(n,o):[]}),R0=mt(function(n){return ga(Bi(n,qt))}),P0=mt(function(n){var o=ke(n);return qt(o)&&(o=e),ga(Bi(n,qt),ot(o,2))}),M0=mt(function(n){var o=ke(n);return o=typeof o=="function"?o:e,ga(Bi(n,qt),e,o)}),D0=mt(Ma);function B0(n,o){return Cu(n||[],o||[],dn)}function F0(n,o){return Cu(n||[],o||[],_n)}var L0=mt(function(n){var o=n.length,u=o>1?n[o-1]:e;return u=typeof u=="function"?(n.pop(),u):e,lc(n,u)});function uc(n){var o=x(n);return o.__chain__=!0,o}function O0(n,o){return o(n),n}function Es(n,o){return o(n)}var N0=Ti(function(n){var o=n.length,u=o?n[0]:0,d=this.__wrapped__,m=function(b){return ia(b,n)};return o>1||this.__actions__.length||!(d instanceof bt)||!wi(u)?this.thru(m):(d=d.slice(u,+u+(o?1:0)),d.__actions__.push({func:Es,args:[m],thisArg:e}),new Oe(d,this.__chain__).thru(function(b){return o&&!b.length&&b.push(e),b}))});function U0(){return uc(this)}function k0(){return new Oe(this.value(),this.__chain__)}function G0(){this.__values__===e&&(this.__values__=Ec(this.value()));var n=this.__index__>=this.__values__.length,o=n?e:this.__values__[this.__index__++];return{done:n,value:o}}function H0(){return this}function X0(n){for(var o,u=this;u instanceof ls;){var d=rc(u);d.__index__=0,d.__values__=e,o?m.__wrapped__=d:o=d;var m=d;u=u.__wrapped__}return m.__wrapped__=n,o}function W0(){var n=this.__wrapped__;if(n instanceof bt){var o=n;return this.__actions__.length&&(o=new bt(this)),o=o.reverse(),o.__actions__.push({func:Es,args:[Pa],thisArg:e}),new Oe(o,this.__chain__)}return this.thru(Pa)}function z0(){return Su(this.__wrapped__,this.__actions__)}var $0=ms(function(n,o,u){Mt.call(n,u)?++n[u]:yi(n,u,1)});function V0(n,o,u){var d=ct(n)?kl:Om;return u&&ge(n,o,u)&&(o=e),d(n,ot(o,3))}function Y0(n,o){var u=ct(n)?Bi:lu;return u(n,ot(o,3))}var j0=Nu(nc),q0=Nu(sc);function K0(n,o){return ae(As(n,o),1)}function Z0(n,o){return ae(As(n,o),Y)}function J0(n,o,u){return u=u===e?1:pt(u),ae(As(n,o),u)}function cc(n,o){var u=ct(n)?Fe:Ni;return u(n,ot(o,3))}function fc(n,o){var u=ct(n)?_g:hu;return u(n,ot(o,3))}var Q0=ms(function(n,o,u){Mt.call(n,u)?n[u].push(o):yi(n,u,[o])});function tv(n,o,u,d){n=xe(n)?n:Lr(n),u=u&&!d?pt(u):0;var m=n.length;return u<0&&(u=re(m+u,0)),Ps(n)?u<=m&&n.indexOf(o,u)>-1:!!m&&wr(n,o,u)>-1}var ev=mt(function(n,o,u){var d=-1,m=typeof o=="function",b=xe(n)?D(n.length):[];return Ni(n,function(T){b[++d]=m?Ee(o,T,u):gn(T,o,u)}),b}),iv=ms(function(n,o,u){yi(n,u,o)});function As(n,o){var u=ct(n)?kt:gu;return u(n,ot(o,3))}function rv(n,o,u,d){return n==null?[]:(ct(o)||(o=o==null?[]:[o]),u=d?e:u,ct(u)||(u=u==null?[]:[u]),xu(n,o,u))}var nv=ms(function(n,o,u){n[u?0:1].push(o)},function(){return[[],[]]});function sv(n,o,u){var d=ct(n)?Wo:Wl,m=arguments.length<3;return d(n,ot(o,4),u,m,Ni)}function ov(n,o,u){var d=ct(n)?vg:Wl,m=arguments.length<3;return d(n,ot(o,4),u,m,hu)}function av(n,o){var u=ct(n)?Bi:lu;return u(n,Is(ot(o,3)))}function hv(n){var o=ct(n)?nu:t_;return o(n)}function lv(n,o,u){(u?ge(n,o,u):o===e)?o=1:o=pt(o);var d=ct(n)?Mm:e_;return d(n,o)}function uv(n){var o=ct(n)?Dm:r_;return o(n)}function cv(n){if(n==null)return 0;if(xe(n))return Ps(n)?Ar(n):n.length;var o=de(n);return o==Yt||o==Xe?n.size:ha(n).length}function fv(n,o,u){var d=ct(n)?zo:n_;return u&&ge(n,o,u)&&(o=e),d(n,ot(o,3))}var dv=mt(function(n,o){if(n==null)return[];var u=o.length;return u>1&&ge(n,o[0],o[1])?o=[]:u>2&&ge(o[0],o[1],o[2])&&(o=[o[0]]),xu(n,ae(o,1),[])}),Ss=Yg||function(){return oe.Date.now()};function pv(n,o){if(typeof o!="function")throw new Le(h);return n=pt(n),function(){if(--n<1)return o.apply(this,arguments)}}function dc(n,o,u){return o=u?e:o,o=n&&o==null?n.length:o,bi(n,G,e,e,e,e,o)}function pc(n,o){var u;if(typeof o!="function")throw new Le(h);return n=pt(n),function(){return--n>0&&(u=o.apply(this,arguments)),n<=1&&(o=e),u}}var Da=mt(function(n,o,u){var d=w;if(u.length){var m=Li(u,Br(Da));d|=U}return bi(n,d,o,u,m)}),gc=mt(function(n,o,u){var d=w|R;if(u.length){var m=Li(u,Br(gc));d|=U}return bi(o,d,n,u,m)});function mc(n,o,u){o=u?e:o;var d=bi(n,E,e,e,e,e,e,o);return d.placeholder=mc.placeholder,d}function _c(n,o,u){o=u?e:o;var d=bi(n,P,e,e,e,e,e,o);return d.placeholder=_c.placeholder,d}function vc(n,o,u){var d,m,b,T,S,I,F=0,L=!1,N=!1,$=!0;if(typeof n!="function")throw new Le(h);o=Ge(o)||0,Ht(u)&&(L=!!u.leading,N="maxWait"in u,b=N?re(Ge(u.maxWait)||0,o):b,$="trailing"in u?!!u.trailing:$);function Q(Kt){var Ve=d,Si=m;return d=m=e,F=Kt,T=n.apply(Si,Ve),T}function at(Kt){return F=Kt,S=yn(xt,o),L?Q(Kt):T}function gt(Kt){var Ve=Kt-I,Si=Kt-F,Nc=o-Ve;return N?fe(Nc,b-Si):Nc}function ht(Kt){var Ve=Kt-I,Si=Kt-F;return I===e||Ve>=o||Ve<0||N&&Si>=b}function xt(){var Kt=Ss();if(ht(Kt))return wt(Kt);S=yn(xt,gt(Kt))}function wt(Kt){return S=e,$&&d?Q(Kt):(d=m=e,T)}function Ie(){S!==e&&Iu(S),F=0,d=I=m=S=e}function me(){return S===e?T:wt(Ss())}function Re(){var Kt=Ss(),Ve=ht(Kt);if(d=arguments,m=this,I=Kt,Ve){if(S===e)return at(I);if(N)return Iu(S),S=yn(xt,o),Q(I)}return S===e&&(S=yn(xt,o)),T}return Re.cancel=Ie,Re.flush=me,Re}var gv=mt(function(n,o){return au(n,1,o)}),mv=mt(function(n,o,u){return au(n,Ge(o)||0,u)});function _v(n){return bi(n,Z)}function Cs(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new Le(h);var u=function(){var d=arguments,m=o?o.apply(this,d):d[0],b=u.cache;if(b.has(m))return b.get(m);var T=n.apply(this,d);return u.cache=b.set(m,T)||b,T};return u.cache=new(Cs.Cache||xi),u}Cs.Cache=xi;function Is(n){if(typeof n!="function")throw new Le(h);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function vv(n){return pc(2,n)}var xv=s_(function(n,o){o=o.length==1&&ct(o[0])?kt(o[0],Ae(ot())):kt(ae(o,1),Ae(ot()));var u=o.length;return mt(function(d){for(var m=-1,b=fe(d.length,u);++m<b;)d[m]=o[m].call(this,d[m]);return Ee(n,this,d)})}),Ba=mt(function(n,o){var u=Li(o,Br(Ba));return bi(n,U,e,o,u)}),xc=mt(function(n,o){var u=Li(o,Br(xc));return bi(n,z,e,o,u)}),yv=Ti(function(n,o){return bi(n,k,e,e,e,o)});function bv(n,o){if(typeof n!="function")throw new Le(h);return o=o===e?o:pt(o),mt(n,o)}function Tv(n,o){if(typeof n!="function")throw new Le(h);return o=o==null?0:re(pt(o),0),mt(function(u){var d=u[o],m=Gi(u,0,o);return d&&Fi(m,d),Ee(n,this,m)})}function wv(n,o,u){var d=!0,m=!0;if(typeof n!="function")throw new Le(h);return Ht(u)&&(d="leading"in u?!!u.leading:d,m="trailing"in u?!!u.trailing:m),vc(n,o,{leading:d,maxWait:o,trailing:m})}function Ev(n){return dc(n,1)}function Av(n,o){return Ba(_a(o),n)}function Sv(){if(!arguments.length)return[];var n=arguments[0];return ct(n)?n:[n]}function Cv(n){return Ne(n,v)}function Iv(n,o){return o=typeof o=="function"?o:e,Ne(n,v,o)}function Rv(n){return Ne(n,g|v)}function Pv(n,o){return o=typeof o=="function"?o:e,Ne(n,g|v,o)}function Mv(n,o){return o==null||ou(n,o,se(o))}function $e(n,o){return n===o||n!==n&&o!==o}var Dv=ys(sa),Bv=ys(function(n,o){return n>=o}),or=fu(function(){return arguments}())?fu:function(n){return jt(n)&&Mt.call(n,"callee")&&!Jl.call(n,"callee")},ct=D.isArray,Fv=Bl?Ae(Bl):Xm;function xe(n){return n!=null&&Rs(n.length)&&!Ei(n)}function qt(n){return jt(n)&&xe(n)}function Lv(n){return n===!0||n===!1||jt(n)&&pe(n)==$t}var Hi=qg||za,Ov=Fl?Ae(Fl):Wm;function Nv(n){return jt(n)&&n.nodeType===1&&!bn(n)}function Uv(n){if(n==null)return!0;if(xe(n)&&(ct(n)||typeof n=="string"||typeof n.splice=="function"||Hi(n)||Fr(n)||or(n)))return!n.length;var o=de(n);if(o==Yt||o==Xe)return!n.size;if(xn(n))return!ha(n).length;for(var u in n)if(Mt.call(n,u))return!1;return!0}function kv(n,o){return mn(n,o)}function Gv(n,o,u){u=typeof u=="function"?u:e;var d=u?u(n,o):e;return d===e?mn(n,o,e,u):!!d}function Fa(n){if(!jt(n))return!1;var o=pe(n);return o==Pt||o==ee||typeof n.message=="string"&&typeof n.name=="string"&&!bn(n)}function Hv(n){return typeof n=="number"&&tu(n)}function Ei(n){if(!Ht(n))return!1;var o=pe(n);return o==Ot||o==Vt||o==Jt||o==cp}function yc(n){return typeof n=="number"&&n==pt(n)}function Rs(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=vt}function Ht(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function jt(n){return n!=null&&typeof n=="object"}var bc=Ll?Ae(Ll):$m;function Xv(n,o){return n===o||aa(n,o,Ea(o))}function Wv(n,o,u){return u=typeof u=="function"?u:e,aa(n,o,Ea(o),u)}function zv(n){return Tc(n)&&n!=+n}function $v(n){if(I_(n))throw new ut(a);return du(n)}function Vv(n){return n===null}function Yv(n){return n==null}function Tc(n){return typeof n=="number"||jt(n)&&pe(n)==ce}function bn(n){if(!jt(n)||pe(n)!=si)return!1;var o=is(n);if(o===null)return!0;var u=Mt.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&Jn.call(u)==Wg}var La=Ol?Ae(Ol):Vm;function jv(n){return yc(n)&&n>=-vt&&n<=vt}var wc=Nl?Ae(Nl):Ym;function Ps(n){return typeof n=="string"||!ct(n)&&jt(n)&&pe(n)==nn}function Ce(n){return typeof n=="symbol"||jt(n)&&pe(n)==Wn}var Fr=Ul?Ae(Ul):jm;function qv(n){return n===e}function Kv(n){return jt(n)&&de(n)==sn}function Zv(n){return jt(n)&&pe(n)==dp}var Jv=ys(la),Qv=ys(function(n,o){return n<=o});function Ec(n){if(!n)return[];if(xe(n))return Ps(n)?We(n):ve(n);if(hn&&n[hn])return Mg(n[hn]());var o=de(n),u=o==Yt?Ko:o==Xe?qn:Lr;return u(n)}function Ai(n){if(!n)return n===0?n:0;if(n=Ge(n),n===Y||n===-Y){var o=n<0?-1:1;return o*Ut}return n===n?n:0}function pt(n){var o=Ai(n),u=o%1;return o===o?u?o-u:o:0}function Ac(n){return n?ir(pt(n),0,et):0}function Ge(n){if(typeof n=="number")return n;if(Ce(n))return H;if(Ht(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=Ht(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=zl(n);var u=Fp.test(n);return u||Op.test(n)?pg(n.slice(2),u?2:8):Bp.test(n)?H:+n}function Sc(n){return ai(n,ye(n))}function tx(n){return n?ir(pt(n),-vt,vt):n===0?n:0}function It(n){return n==null?"":Se(n)}var ex=Mr(function(n,o){if(xn(o)||xe(o)){ai(o,se(o),n);return}for(var u in o)Mt.call(o,u)&&dn(n,u,o[u])}),Cc=Mr(function(n,o){ai(o,ye(o),n)}),Ms=Mr(function(n,o,u,d){ai(o,ye(o),n,d)}),ix=Mr(function(n,o,u,d){ai(o,se(o),n,d)}),rx=Ti(ia);function nx(n,o){var u=Pr(n);return o==null?u:su(u,o)}var sx=mt(function(n,o){n=Dt(n);var u=-1,d=o.length,m=d>2?o[2]:e;for(m&&ge(o[0],o[1],m)&&(d=1);++u<d;)for(var b=o[u],T=ye(b),S=-1,I=T.length;++S<I;){var F=T[S],L=n[F];(L===e||$e(L,Cr[F])&&!Mt.call(n,F))&&(n[F]=b[F])}return n}),ox=mt(function(n){return n.push(e,zu),Ee(Ic,e,n)});function ax(n,o){return Gl(n,ot(o,3),oi)}function hx(n,o){return Gl(n,ot(o,3),na)}function lx(n,o){return n==null?n:ra(n,ot(o,3),ye)}function ux(n,o){return n==null?n:uu(n,ot(o,3),ye)}function cx(n,o){return n&&oi(n,ot(o,3))}function fx(n,o){return n&&na(n,ot(o,3))}function dx(n){return n==null?[]:fs(n,se(n))}function px(n){return n==null?[]:fs(n,ye(n))}function Oa(n,o,u){var d=n==null?e:rr(n,o);return d===e?u:d}function gx(n,o){return n!=null&&Yu(n,o,Um)}function Na(n,o){return n!=null&&Yu(n,o,km)}var mx=ku(function(n,o,u){o!=null&&typeof o.toString!="function"&&(o=Qn.call(o)),n[o]=u},ka(be)),_x=ku(function(n,o,u){o!=null&&typeof o.toString!="function"&&(o=Qn.call(o)),Mt.call(n,o)?n[o].push(u):n[o]=[u]},ot),vx=mt(gn);function se(n){return xe(n)?ru(n):ha(n)}function ye(n){return xe(n)?ru(n,!0):qm(n)}function xx(n,o){var u={};return o=ot(o,3),oi(n,function(d,m,b){yi(u,o(d,m,b),d)}),u}function yx(n,o){var u={};return o=ot(o,3),oi(n,function(d,m,b){yi(u,m,o(d,m,b))}),u}var bx=Mr(function(n,o,u){ds(n,o,u)}),Ic=Mr(function(n,o,u,d){ds(n,o,u,d)}),Tx=Ti(function(n,o){var u={};if(n==null)return u;var d=!1;o=kt(o,function(b){return b=ki(b,n),d||(d=b.length>1),b}),ai(n,Ta(n),u),d&&(u=Ne(u,g|_|v,m_));for(var m=o.length;m--;)pa(u,o[m]);return u});function wx(n,o){return Rc(n,Is(ot(o)))}var Ex=Ti(function(n,o){return n==null?{}:Zm(n,o)});function Rc(n,o){if(n==null)return{};var u=kt(Ta(n),function(d){return[d]});return o=ot(o),yu(n,u,function(d,m){return o(d,m[0])})}function Ax(n,o,u){o=ki(o,n);var d=-1,m=o.length;for(m||(m=1,n=e);++d<m;){var b=n==null?e:n[hi(o[d])];b===e&&(d=m,b=u),n=Ei(b)?b.call(n):b}return n}function Sx(n,o,u){return n==null?n:_n(n,o,u)}function Cx(n,o,u,d){return d=typeof d=="function"?d:e,n==null?n:_n(n,o,u,d)}var Pc=Xu(se),Mc=Xu(ye);function Ix(n,o,u){var d=ct(n),m=d||Hi(n)||Fr(n);if(o=ot(o,4),u==null){var b=n&&n.constructor;m?u=d?new b:[]:Ht(n)?u=Ei(b)?Pr(is(n)):{}:u={}}return(m?Fe:oi)(n,function(T,S,I){return o(u,T,S,I)}),u}function Rx(n,o){return n==null?!0:pa(n,o)}function Px(n,o,u){return n==null?n:Au(n,o,_a(u))}function Mx(n,o,u,d){return d=typeof d=="function"?d:e,n==null?n:Au(n,o,_a(u),d)}function Lr(n){return n==null?[]:qo(n,se(n))}function Dx(n){return n==null?[]:qo(n,ye(n))}function Bx(n,o,u){return u===e&&(u=o,o=e),u!==e&&(u=Ge(u),u=u===u?u:0),o!==e&&(o=Ge(o),o=o===o?o:0),ir(Ge(n),o,u)}function Fx(n,o,u){return o=Ai(o),u===e?(u=o,o=0):u=Ai(u),n=Ge(n),Gm(n,o,u)}function Lx(n,o,u){if(u&&typeof u!="boolean"&&ge(n,o,u)&&(o=u=e),u===e&&(typeof o=="boolean"?(u=o,o=e):typeof n=="boolean"&&(u=n,n=e)),n===e&&o===e?(n=0,o=1):(n=Ai(n),o===e?(o=n,n=0):o=Ai(o)),n>o){var d=n;n=o,o=d}if(u||n%1||o%1){var m=eu();return fe(n+m*(o-n+dg("1e-"+((m+"").length-1))),o)}return ca(n,o)}var Ox=Dr(function(n,o,u){return o=o.toLowerCase(),n+(u?Dc(o):o)});function Dc(n){return Ua(It(n).toLowerCase())}function Bc(n){return n=It(n),n&&n.replace(Up,Sg).replace(rg,"")}function Nx(n,o,u){n=It(n),o=Se(o);var d=n.length;u=u===e?d:ir(pt(u),0,d);var m=u;return u-=o.length,u>=0&&n.slice(u,m)==o}function Ux(n){return n=It(n),n&&vp.test(n)?n.replace(ul,Cg):n}function kx(n){return n=It(n),n&&Ep.test(n)?n.replace(Bo,"\\$&"):n}var Gx=Dr(function(n,o,u){return n+(u?"-":"")+o.toLowerCase()}),Hx=Dr(function(n,o,u){return n+(u?" ":"")+o.toLowerCase()}),Xx=Ou("toLowerCase");function Wx(n,o,u){n=It(n),o=pt(o);var d=o?Ar(n):0;if(!o||d>=o)return n;var m=(o-d)/2;return xs(os(m),u)+n+xs(ss(m),u)}function zx(n,o,u){n=It(n),o=pt(o);var d=o?Ar(n):0;return o&&d<o?n+xs(o-d,u):n}function $x(n,o,u){n=It(n),o=pt(o);var d=o?Ar(n):0;return o&&d<o?xs(o-d,u)+n:n}function Vx(n,o,u){return u||o==null?o=0:o&&(o=+o),Qg(It(n).replace(Fo,""),o||0)}function Yx(n,o,u){return(u?ge(n,o,u):o===e)?o=1:o=pt(o),fa(It(n),o)}function jx(){var n=arguments,o=It(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var qx=Dr(function(n,o,u){return n+(u?"_":"")+o.toLowerCase()});function Kx(n,o,u){return u&&typeof u!="number"&&ge(n,o,u)&&(o=u=e),u=u===e?et:u>>>0,u?(n=It(n),n&&(typeof o=="string"||o!=null&&!La(o))&&(o=Se(o),!o&&Er(n))?Gi(We(n),0,u):n.split(o,u)):[]}var Zx=Dr(function(n,o,u){return n+(u?" ":"")+Ua(o)});function Jx(n,o,u){return n=It(n),u=u==null?0:ir(pt(u),0,n.length),o=Se(o),n.slice(u,u+o.length)==o}function Qx(n,o,u){var d=x.templateSettings;u&&ge(n,o,u)&&(o=e),n=It(n),o=Ms({},o,d,Wu);var m=Ms({},o.imports,d.imports,Wu),b=se(m),T=qo(m,b),S,I,F=0,L=o.interpolate||zn,N="__p += '",$=Zo((o.escape||zn).source+"|"+L.source+"|"+(L===cl?Dp:zn).source+"|"+(o.evaluate||zn).source+"|$","g"),Q="//# sourceURL="+(Mt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++hg+"]")+`
`;n.replace($,function(ht,xt,wt,Ie,me,Re){return wt||(wt=Ie),N+=n.slice(F,Re).replace(kp,Ig),xt&&(S=!0,N+=`' +
__e(`+xt+`) +
'`),me&&(I=!0,N+=`';
`+me+`;
__p += '`),wt&&(N+=`' +
((__t = (`+wt+`)) == null ? '' : __t) +
'`),F=Re+ht.length,ht}),N+=`';
`;var at=Mt.call(o,"variable")&&o.variable;if(!at)N=`with (obj) {
`+N+`
}
`;else if(Pp.test(at))throw new ut(l);N=(I?N.replace(pp,""):N).replace(gp,"$1").replace(mp,"$1;"),N="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(S?", __e = _.escape":"")+(I?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+N+`return __p
}`;var gt=Lc(function(){return St(b,Q+"return "+N).apply(e,T)});if(gt.source=N,Fa(gt))throw gt;return gt}function ty(n){return It(n).toLowerCase()}function ey(n){return It(n).toUpperCase()}function iy(n,o,u){if(n=It(n),n&&(u||o===e))return zl(n);if(!n||!(o=Se(o)))return n;var d=We(n),m=We(o),b=$l(d,m),T=Vl(d,m)+1;return Gi(d,b,T).join("")}function ry(n,o,u){if(n=It(n),n&&(u||o===e))return n.slice(0,jl(n)+1);if(!n||!(o=Se(o)))return n;var d=We(n),m=Vl(d,We(o))+1;return Gi(d,0,m).join("")}function ny(n,o,u){if(n=It(n),n&&(u||o===e))return n.replace(Fo,"");if(!n||!(o=Se(o)))return n;var d=We(n),m=$l(d,We(o));return Gi(d,m).join("")}function sy(n,o){var u=nt,d=V;if(Ht(o)){var m="separator"in o?o.separator:m;u="length"in o?pt(o.length):u,d="omission"in o?Se(o.omission):d}n=It(n);var b=n.length;if(Er(n)){var T=We(n);b=T.length}if(u>=b)return n;var S=u-Ar(d);if(S<1)return d;var I=T?Gi(T,0,S).join(""):n.slice(0,S);if(m===e)return I+d;if(T&&(S+=I.length-S),La(m)){if(n.slice(S).search(m)){var F,L=I;for(m.global||(m=Zo(m.source,It(fl.exec(m))+"g")),m.lastIndex=0;F=m.exec(L);)var N=F.index;I=I.slice(0,N===e?S:N)}}else if(n.indexOf(Se(m),S)!=S){var $=I.lastIndexOf(m);$>-1&&(I=I.slice(0,$))}return I+d}function oy(n){return n=It(n),n&&_p.test(n)?n.replace(ll,Lg):n}var ay=Dr(function(n,o,u){return n+(u?" ":"")+o.toUpperCase()}),Ua=Ou("toUpperCase");function Fc(n,o,u){return n=It(n),o=u?e:o,o===e?Pg(n)?Ug(n):bg(n):n.match(o)||[]}var Lc=mt(function(n,o){try{return Ee(n,e,o)}catch(u){return Fa(u)?u:new ut(u)}}),hy=Ti(function(n,o){return Fe(o,function(u){u=hi(u),yi(n,u,Da(n[u],n))}),n});function ly(n){var o=n==null?0:n.length,u=ot();return n=o?kt(n,function(d){if(typeof d[1]!="function")throw new Le(h);return[u(d[0]),d[1]]}):[],mt(function(d){for(var m=-1;++m<o;){var b=n[m];if(Ee(b[0],this,d))return Ee(b[1],this,d)}})}function uy(n){return Lm(Ne(n,g))}function ka(n){return function(){return n}}function cy(n,o){return n==null||n!==n?o:n}var fy=Uu(),dy=Uu(!0);function be(n){return n}function Ga(n){return pu(typeof n=="function"?n:Ne(n,g))}function py(n){return mu(Ne(n,g))}function gy(n,o){return _u(n,Ne(o,g))}var my=mt(function(n,o){return function(u){return gn(u,n,o)}}),_y=mt(function(n,o){return function(u){return gn(n,u,o)}});function Ha(n,o,u){var d=se(o),m=fs(o,d);u==null&&!(Ht(o)&&(m.length||!d.length))&&(u=o,o=n,n=this,m=fs(o,se(o)));var b=!(Ht(u)&&"chain"in u)||!!u.chain,T=Ei(n);return Fe(m,function(S){var I=o[S];n[S]=I,T&&(n.prototype[S]=function(){var F=this.__chain__;if(b||F){var L=n(this.__wrapped__),N=L.__actions__=ve(this.__actions__);return N.push({func:I,args:arguments,thisArg:n}),L.__chain__=F,L}return I.apply(n,Fi([this.value()],arguments))})}),n}function vy(){return oe._===this&&(oe._=zg),this}function Xa(){}function xy(n){return n=pt(n),mt(function(o){return vu(o,n)})}var yy=xa(kt),by=xa(kl),Ty=xa(zo);function Oc(n){return Sa(n)?$o(hi(n)):Jm(n)}function wy(n){return function(o){return n==null?e:rr(n,o)}}var Ey=Gu(),Ay=Gu(!0);function Wa(){return[]}function za(){return!1}function Sy(){return{}}function Cy(){return""}function Iy(){return!0}function Ry(n,o){if(n=pt(n),n<1||n>vt)return[];var u=et,d=fe(n,et);o=ot(o),n-=et;for(var m=jo(d,o);++u<n;)o(u);return m}function Py(n){return ct(n)?kt(n,hi):Ce(n)?[n]:ve(ic(It(n)))}function My(n){var o=++Xg;return It(n)+o}var Dy=vs(function(n,o){return n+o},0),By=ya("ceil"),Fy=vs(function(n,o){return n/o},1),Ly=ya("floor");function Oy(n){return n&&n.length?cs(n,be,sa):e}function Ny(n,o){return n&&n.length?cs(n,ot(o,2),sa):e}function Uy(n){return Xl(n,be)}function ky(n,o){return Xl(n,ot(o,2))}function Gy(n){return n&&n.length?cs(n,be,la):e}function Hy(n,o){return n&&n.length?cs(n,ot(o,2),la):e}var Xy=vs(function(n,o){return n*o},1),Wy=ya("round"),zy=vs(function(n,o){return n-o},0);function $y(n){return n&&n.length?Yo(n,be):0}function Vy(n,o){return n&&n.length?Yo(n,ot(o,2)):0}return x.after=pv,x.ary=dc,x.assign=ex,x.assignIn=Cc,x.assignInWith=Ms,x.assignWith=ix,x.at=rx,x.before=pc,x.bind=Da,x.bindAll=hy,x.bindKey=gc,x.castArray=Sv,x.chain=uc,x.chunk=L_,x.compact=O_,x.concat=N_,x.cond=ly,x.conforms=uy,x.constant=ka,x.countBy=$0,x.create=nx,x.curry=mc,x.curryRight=_c,x.debounce=vc,x.defaults=sx,x.defaultsDeep=ox,x.defer=gv,x.delay=mv,x.difference=U_,x.differenceBy=k_,x.differenceWith=G_,x.drop=H_,x.dropRight=X_,x.dropRightWhile=W_,x.dropWhile=z_,x.fill=$_,x.filter=Y0,x.flatMap=K0,x.flatMapDeep=Z0,x.flatMapDepth=J0,x.flatten=oc,x.flattenDeep=V_,x.flattenDepth=Y_,x.flip=_v,x.flow=fy,x.flowRight=dy,x.fromPairs=j_,x.functions=dx,x.functionsIn=px,x.groupBy=Q0,x.initial=K_,x.intersection=Z_,x.intersectionBy=J_,x.intersectionWith=Q_,x.invert=mx,x.invertBy=_x,x.invokeMap=ev,x.iteratee=Ga,x.keyBy=iv,x.keys=se,x.keysIn=ye,x.map=As,x.mapKeys=xx,x.mapValues=yx,x.matches=py,x.matchesProperty=gy,x.memoize=Cs,x.merge=bx,x.mergeWith=Ic,x.method=my,x.methodOf=_y,x.mixin=Ha,x.negate=Is,x.nthArg=xy,x.omit=Tx,x.omitBy=wx,x.once=vv,x.orderBy=rv,x.over=yy,x.overArgs=xv,x.overEvery=by,x.overSome=Ty,x.partial=Ba,x.partialRight=xc,x.partition=nv,x.pick=Ex,x.pickBy=Rc,x.property=Oc,x.propertyOf=wy,x.pull=r0,x.pullAll=hc,x.pullAllBy=n0,x.pullAllWith=s0,x.pullAt=o0,x.range=Ey,x.rangeRight=Ay,x.rearg=yv,x.reject=av,x.remove=a0,x.rest=bv,x.reverse=Pa,x.sampleSize=lv,x.set=Sx,x.setWith=Cx,x.shuffle=uv,x.slice=h0,x.sortBy=dv,x.sortedUniq=g0,x.sortedUniqBy=m0,x.split=Kx,x.spread=Tv,x.tail=_0,x.take=v0,x.takeRight=x0,x.takeRightWhile=y0,x.takeWhile=b0,x.tap=O0,x.throttle=wv,x.thru=Es,x.toArray=Ec,x.toPairs=Pc,x.toPairsIn=Mc,x.toPath=Py,x.toPlainObject=Sc,x.transform=Ix,x.unary=Ev,x.union=T0,x.unionBy=w0,x.unionWith=E0,x.uniq=A0,x.uniqBy=S0,x.uniqWith=C0,x.unset=Rx,x.unzip=Ma,x.unzipWith=lc,x.update=Px,x.updateWith=Mx,x.values=Lr,x.valuesIn=Dx,x.without=I0,x.words=Fc,x.wrap=Av,x.xor=R0,x.xorBy=P0,x.xorWith=M0,x.zip=D0,x.zipObject=B0,x.zipObjectDeep=F0,x.zipWith=L0,x.entries=Pc,x.entriesIn=Mc,x.extend=Cc,x.extendWith=Ms,Ha(x,x),x.add=Dy,x.attempt=Lc,x.camelCase=Ox,x.capitalize=Dc,x.ceil=By,x.clamp=Bx,x.clone=Cv,x.cloneDeep=Rv,x.cloneDeepWith=Pv,x.cloneWith=Iv,x.conformsTo=Mv,x.deburr=Bc,x.defaultTo=cy,x.divide=Fy,x.endsWith=Nx,x.eq=$e,x.escape=Ux,x.escapeRegExp=kx,x.every=V0,x.find=j0,x.findIndex=nc,x.findKey=ax,x.findLast=q0,x.findLastIndex=sc,x.findLastKey=hx,x.floor=Ly,x.forEach=cc,x.forEachRight=fc,x.forIn=lx,x.forInRight=ux,x.forOwn=cx,x.forOwnRight=fx,x.get=Oa,x.gt=Dv,x.gte=Bv,x.has=gx,x.hasIn=Na,x.head=ac,x.identity=be,x.includes=tv,x.indexOf=q_,x.inRange=Fx,x.invoke=vx,x.isArguments=or,x.isArray=ct,x.isArrayBuffer=Fv,x.isArrayLike=xe,x.isArrayLikeObject=qt,x.isBoolean=Lv,x.isBuffer=Hi,x.isDate=Ov,x.isElement=Nv,x.isEmpty=Uv,x.isEqual=kv,x.isEqualWith=Gv,x.isError=Fa,x.isFinite=Hv,x.isFunction=Ei,x.isInteger=yc,x.isLength=Rs,x.isMap=bc,x.isMatch=Xv,x.isMatchWith=Wv,x.isNaN=zv,x.isNative=$v,x.isNil=Yv,x.isNull=Vv,x.isNumber=Tc,x.isObject=Ht,x.isObjectLike=jt,x.isPlainObject=bn,x.isRegExp=La,x.isSafeInteger=jv,x.isSet=wc,x.isString=Ps,x.isSymbol=Ce,x.isTypedArray=Fr,x.isUndefined=qv,x.isWeakMap=Kv,x.isWeakSet=Zv,x.join=t0,x.kebabCase=Gx,x.last=ke,x.lastIndexOf=e0,x.lowerCase=Hx,x.lowerFirst=Xx,x.lt=Jv,x.lte=Qv,x.max=Oy,x.maxBy=Ny,x.mean=Uy,x.meanBy=ky,x.min=Gy,x.minBy=Hy,x.stubArray=Wa,x.stubFalse=za,x.stubObject=Sy,x.stubString=Cy,x.stubTrue=Iy,x.multiply=Xy,x.nth=i0,x.noConflict=vy,x.noop=Xa,x.now=Ss,x.pad=Wx,x.padEnd=zx,x.padStart=$x,x.parseInt=Vx,x.random=Lx,x.reduce=sv,x.reduceRight=ov,x.repeat=Yx,x.replace=jx,x.result=Ax,x.round=Wy,x.runInContext=C,x.sample=hv,x.size=cv,x.snakeCase=qx,x.some=fv,x.sortedIndex=l0,x.sortedIndexBy=u0,x.sortedIndexOf=c0,x.sortedLastIndex=f0,x.sortedLastIndexBy=d0,x.sortedLastIndexOf=p0,x.startCase=Zx,x.startsWith=Jx,x.subtract=zy,x.sum=$y,x.sumBy=Vy,x.template=Qx,x.times=Ry,x.toFinite=Ai,x.toInteger=pt,x.toLength=Ac,x.toLower=ty,x.toNumber=Ge,x.toSafeInteger=tx,x.toString=It,x.toUpper=ey,x.trim=iy,x.trimEnd=ry,x.trimStart=ny,x.truncate=sy,x.unescape=oy,x.uniqueId=My,x.upperCase=ay,x.upperFirst=Ua,x.each=cc,x.eachRight=fc,x.first=ac,Ha(x,function(){var n={};return oi(x,function(o,u){Mt.call(x.prototype,u)||(n[u]=o)}),n}(),{chain:!1}),x.VERSION=r,Fe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){x[n].placeholder=x}),Fe(["drop","take"],function(n,o){bt.prototype[n]=function(u){u=u===e?1:re(pt(u),0);var d=this.__filtered__&&!o?new bt(this):this.clone();return d.__filtered__?d.__takeCount__=fe(u,d.__takeCount__):d.__views__.push({size:fe(u,et),type:n+(d.__dir__<0?"Right":"")}),d},bt.prototype[n+"Right"]=function(u){return this.reverse()[n](u).reverse()}}),Fe(["filter","map","takeWhile"],function(n,o){var u=o+1,d=u==O||u==_t;bt.prototype[n]=function(m){var b=this.clone();return b.__iteratees__.push({iteratee:ot(m,3),type:u}),b.__filtered__=b.__filtered__||d,b}}),Fe(["head","last"],function(n,o){var u="take"+(o?"Right":"");bt.prototype[n]=function(){return this[u](1).value()[0]}}),Fe(["initial","tail"],function(n,o){var u="drop"+(o?"":"Right");bt.prototype[n]=function(){return this.__filtered__?new bt(this):this[u](1)}}),bt.prototype.compact=function(){return this.filter(be)},bt.prototype.find=function(n){return this.filter(n).head()},bt.prototype.findLast=function(n){return this.reverse().find(n)},bt.prototype.invokeMap=mt(function(n,o){return typeof n=="function"?new bt(this):this.map(function(u){return gn(u,n,o)})}),bt.prototype.reject=function(n){return this.filter(Is(ot(n)))},bt.prototype.slice=function(n,o){n=pt(n);var u=this;return u.__filtered__&&(n>0||o<0)?new bt(u):(n<0?u=u.takeRight(-n):n&&(u=u.drop(n)),o!==e&&(o=pt(o),u=o<0?u.dropRight(-o):u.take(o-n)),u)},bt.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},bt.prototype.toArray=function(){return this.take(et)},oi(bt.prototype,function(n,o){var u=/^(?:filter|find|map|reject)|While$/.test(o),d=/^(?:head|last)$/.test(o),m=x[d?"take"+(o=="last"?"Right":""):o],b=d||/^find/.test(o);m&&(x.prototype[o]=function(){var T=this.__wrapped__,S=d?[1]:arguments,I=T instanceof bt,F=S[0],L=I||ct(T),N=function(xt){var wt=m.apply(x,Fi([xt],S));return d&&$?wt[0]:wt};L&&u&&typeof F=="function"&&F.length!=1&&(I=L=!1);var $=this.__chain__,Q=!!this.__actions__.length,at=b&&!$,gt=I&&!Q;if(!b&&L){T=gt?T:new bt(this);var ht=n.apply(T,S);return ht.__actions__.push({func:Es,args:[N],thisArg:e}),new Oe(ht,$)}return at&&gt?n.apply(this,S):(ht=this.thru(N),at?d?ht.value()[0]:ht.value():ht)})}),Fe(["pop","push","shift","sort","splice","unshift"],function(n){var o=Kn[n],u=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",d=/^(?:pop|shift)$/.test(n);x.prototype[n]=function(){var m=arguments;if(d&&!this.__chain__){var b=this.value();return o.apply(ct(b)?b:[],m)}return this[u](function(T){return o.apply(ct(T)?T:[],m)})}}),oi(bt.prototype,function(n,o){var u=x[o];if(u){var d=u.name+"";Mt.call(Rr,d)||(Rr[d]=[]),Rr[d].push({name:o,func:u})}}),Rr[_s(e,R).name]=[{name:"wrapper",func:e}],bt.prototype.clone=om,bt.prototype.reverse=am,bt.prototype.value=hm,x.prototype.at=N0,x.prototype.chain=U0,x.prototype.commit=k0,x.prototype.next=G0,x.prototype.plant=X0,x.prototype.reverse=W0,x.prototype.toJSON=x.prototype.valueOf=x.prototype.value=z0,x.prototype.first=x.prototype.head,hn&&(x.prototype[hn]=H0),x},Sr=kg();Ji?((Ji.exports=Sr)._=Sr,Go._=Sr):oe._=Sr}).call(Wi)})(gh,gh.exports);const Or=gh.exports;var yr=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(yr||{}),mh=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(mh||{}),lt=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(lt||{}),di=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(di||{}),W=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(W||{}),Yr=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(Yr||{}),st=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(st||{}),_h=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(_h||{}),Ri=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Ri||{}),Vi=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(Vi||{}),mi=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(mi||{}),ni=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(ni||{}),ci=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(ci||{}),jh=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(jh||{}),He=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(He||{}),ne=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(ne||{}),te=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(te||{}),pi=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(pi||{});const qy={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},q={ADAPTER:qy,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var $a=/iPhone/i,Uc=/iPod/i,kc=/iPad/i,Gc=/\biOS-universal(?:.+)Mac\b/i,Va=/\bAndroid(?:.+)Mobile\b/i,Hc=/Android/i,Nr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ds=/Silk/i,Ci=/Windows Phone/i,Xc=/\bWindows(?:.+)ARM\b/i,Wc=/BlackBerry/i,zc=/BB10/i,$c=/Opera Mini/i,Vc=/\b(CriOS|Chrome)(?:.+)Mobile/i,Yc=/Mobile(?:.+)Firefox\b/i,jc=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function Ky(i){return function(t){return t.test(i)}}function Zy(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,r=e.split("[FBAN");typeof r[1]<"u"&&(e=r[0]),r=e.split("Twitter"),typeof r[1]<"u"&&(e=r[0]);var s=Ky(e),a={apple:{phone:s($a)&&!s(Ci),ipod:s(Uc),tablet:!s($a)&&(s(kc)||jc(t))&&!s(Ci),universal:s(Gc),device:(s($a)||s(Uc)||s(kc)||s(Gc)||jc(t))&&!s(Ci)},amazon:{phone:s(Nr),tablet:!s(Nr)&&s(Ds),device:s(Nr)||s(Ds)},android:{phone:!s(Ci)&&s(Nr)||!s(Ci)&&s(Va),tablet:!s(Ci)&&!s(Nr)&&!s(Va)&&(s(Ds)||s(Hc)),device:!s(Ci)&&(s(Nr)||s(Ds)||s(Va)||s(Hc))||s(/\bokhttp\b/i)},windows:{phone:s(Ci),tablet:s(Xc),device:s(Ci)||s(Xc)},other:{blackberry:s(Wc),blackberry10:s(zc),opera:s($c),firefox:s(Yc),chrome:s(Vc),device:s(Wc)||s(zc)||s($c)||s(Yc)||s(Vc)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}const Pi=Zy(globalThis.navigator);q.RETINA_PREFIX=/@([0-9\.]+)x/;q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var $f={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function s(c,f,p){this.fn=c,this.context=f,this.once=p||!1}function a(c,f,p,g,_){if(typeof p!="function")throw new TypeError("The listener must be a function");var v=new s(p,g||c,_),y=e?e+f:f;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],v]:c._events[y].push(v):(c._events[y]=v,c._eventsCount++),c}function h(c,f){--c._eventsCount===0?c._events=new r:delete c._events[f]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var f=[],p,g;if(this._eventsCount===0)return f;for(g in p=this._events)t.call(p,g)&&f.push(e?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(p)):f},l.prototype.listeners=function(f){var p=e?e+f:f,g=this._events[p];if(!g)return[];if(g.fn)return[g.fn];for(var _=0,v=g.length,y=new Array(v);_<v;_++)y[_]=g[_].fn;return y},l.prototype.listenerCount=function(f){var p=e?e+f:f,g=this._events[p];return g?g.fn?1:g.length:0},l.prototype.emit=function(f,p,g,_,v,y){var A=e?e+f:f;if(!this._events[A])return!1;var w=this._events[A],R=arguments.length,M,E;if(w.fn){switch(w.once&&this.removeListener(f,w.fn,void 0,!0),R){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,p),!0;case 3:return w.fn.call(w.context,p,g),!0;case 4:return w.fn.call(w.context,p,g,_),!0;case 5:return w.fn.call(w.context,p,g,_,v),!0;case 6:return w.fn.call(w.context,p,g,_,v,y),!0}for(E=1,M=new Array(R-1);E<R;E++)M[E-1]=arguments[E];w.fn.apply(w.context,M)}else{var P=w.length,U;for(E=0;E<P;E++)switch(w[E].once&&this.removeListener(f,w[E].fn,void 0,!0),R){case 1:w[E].fn.call(w[E].context);break;case 2:w[E].fn.call(w[E].context,p);break;case 3:w[E].fn.call(w[E].context,p,g);break;case 4:w[E].fn.call(w[E].context,p,g,_);break;default:if(!M)for(U=1,M=new Array(R-1);U<R;U++)M[U-1]=arguments[U];w[E].fn.apply(w[E].context,M)}}return!0},l.prototype.on=function(f,p,g){return a(this,f,p,g,!1)},l.prototype.once=function(f,p,g){return a(this,f,p,g,!0)},l.prototype.removeListener=function(f,p,g,_){var v=e?e+f:f;if(!this._events[v])return this;if(!p)return h(this,v),this;var y=this._events[v];if(y.fn)y.fn===p&&(!_||y.once)&&(!g||y.context===g)&&h(this,v);else{for(var A=0,w=[],R=y.length;A<R;A++)(y[A].fn!==p||_&&!y[A].once||g&&y[A].context!==g)&&w.push(y[A]);w.length?this._events[v]=w.length===1?w[0]:w:h(this,v)}return this},l.prototype.removeAllListeners=function(f){var p;return f?(p=e?e+f:f,this._events[p]&&h(this,p)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,i.exports=l})($f);const Gn=$f.exports;var qh={exports:{}};qh.exports=go;qh.exports.default=go;function go(i,t,e){e=e||2;var r=t&&t.length,s=r?t[0]*e:i.length,a=Vf(i,0,s,e,!0),h=[];if(!a||a.next===a.prev)return h;var l,c,f,p,g,_,v;if(r&&(a=ib(i,t,a,e)),i.length>80*e){l=f=i[0],c=p=i[1];for(var y=e;y<s;y+=e)g=i[y],_=i[y+1],g<l&&(l=g),_<c&&(c=_),g>f&&(f=g),_>p&&(p=_);v=Math.max(f-l,p-c),v=v!==0?32767/v:0}return Dn(a,h,e,l,c,v,0),h}function Vf(i,t,e,r,s){var a,h;if(s===yh(i,t,e,r)>0)for(a=t;a<e;a+=r)h=qc(a,i[a],i[a+1],h);else for(a=e-r;a>=t;a-=r)h=qc(a,i[a],i[a+1],h);return h&&mo(h,h.next)&&(Fn(h),h=h.next),h}function _r(i,t){if(!i)return i;t||(t=i);var e=i,r;do if(r=!1,!e.steiner&&(mo(e,e.next)||Wt(e.prev,e,e.next)===0)){if(Fn(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Dn(i,t,e,r,s,a,h){if(i){!h&&a&&ab(i,r,s,a);for(var l=i,c,f;i.prev!==i.next;){if(c=i.prev,f=i.next,a?Qy(i,r,s,a):Jy(i)){t.push(c.i/e|0),t.push(i.i/e|0),t.push(f.i/e|0),Fn(i),i=f.next,l=f.next;continue}if(i=f,i===l){h?h===1?(i=tb(_r(i),t,e),Dn(i,t,e,r,s,a,2)):h===2&&eb(i,t,e,r,s,a):Dn(_r(i),t,e,r,s,a,1);break}}}}function Jy(i){var t=i.prev,e=i,r=i.next;if(Wt(t,e,r)>=0)return!1;for(var s=t.x,a=e.x,h=r.x,l=t.y,c=e.y,f=r.y,p=s<a?s<h?s:h:a<h?a:h,g=l<c?l<f?l:f:c<f?c:f,_=s>a?s>h?s:h:a>h?a:h,v=l>c?l>f?l:f:c>f?c:f,y=r.next;y!==t;){if(y.x>=p&&y.x<=_&&y.y>=g&&y.y<=v&&zr(s,l,a,c,h,f,y.x,y.y)&&Wt(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function Qy(i,t,e,r){var s=i.prev,a=i,h=i.next;if(Wt(s,a,h)>=0)return!1;for(var l=s.x,c=a.x,f=h.x,p=s.y,g=a.y,_=h.y,v=l<c?l<f?l:f:c<f?c:f,y=p<g?p<_?p:_:g<_?g:_,A=l>c?l>f?l:f:c>f?c:f,w=p>g?p>_?p:_:g>_?g:_,R=vh(v,y,t,e,r),M=vh(A,w,t,e,r),E=i.prevZ,P=i.nextZ;E&&E.z>=R&&P&&P.z<=M;){if(E.x>=v&&E.x<=A&&E.y>=y&&E.y<=w&&E!==s&&E!==h&&zr(l,p,c,g,f,_,E.x,E.y)&&Wt(E.prev,E,E.next)>=0||(E=E.prevZ,P.x>=v&&P.x<=A&&P.y>=y&&P.y<=w&&P!==s&&P!==h&&zr(l,p,c,g,f,_,P.x,P.y)&&Wt(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;E&&E.z>=R;){if(E.x>=v&&E.x<=A&&E.y>=y&&E.y<=w&&E!==s&&E!==h&&zr(l,p,c,g,f,_,E.x,E.y)&&Wt(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;P&&P.z<=M;){if(P.x>=v&&P.x<=A&&P.y>=y&&P.y<=w&&P!==s&&P!==h&&zr(l,p,c,g,f,_,P.x,P.y)&&Wt(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function tb(i,t,e){var r=i;do{var s=r.prev,a=r.next.next;!mo(s,a)&&Yf(s,r,r.next,a)&&Bn(s,a)&&Bn(a,s)&&(t.push(s.i/e|0),t.push(r.i/e|0),t.push(a.i/e|0),Fn(r),Fn(r.next),r=i=a),r=r.next}while(r!==i);return _r(r)}function eb(i,t,e,r,s,a){var h=i;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&ub(h,l)){var c=jf(h,l);h=_r(h,h.next),c=_r(c,c.next),Dn(h,t,e,r,s,a,0),Dn(c,t,e,r,s,a,0);return}l=l.next}h=h.next}while(h!==i)}function ib(i,t,e,r){var s=[],a,h,l,c,f;for(a=0,h=t.length;a<h;a++)l=t[a]*r,c=a<h-1?t[a+1]*r:i.length,f=Vf(i,l,c,r,!1),f===f.next&&(f.steiner=!0),s.push(lb(f));for(s.sort(rb),a=0;a<s.length;a++)e=nb(s[a],e);return e}function rb(i,t){return i.x-t.x}function nb(i,t){var e=sb(i,t);if(!e)return t;var r=jf(e,i);return _r(r,r.next),_r(e,e.next)}function sb(i,t){var e=t,r=i.x,s=i.y,a=-1/0,h;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var l=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=r&&l>a&&(a=l,h=e.x<e.next.x?e:e.next,l===r))return h}e=e.next}while(e!==t);if(!h)return null;var c=h,f=h.x,p=h.y,g=1/0,_;e=h;do r>=e.x&&e.x>=f&&r!==e.x&&zr(s<p?r:a,s,f,p,s<p?a:r,s,e.x,e.y)&&(_=Math.abs(s-e.y)/(r-e.x),Bn(e,i)&&(_<g||_===g&&(e.x>h.x||e.x===h.x&&ob(h,e)))&&(h=e,g=_)),e=e.next;while(e!==c);return h}function ob(i,t){return Wt(i.prev,i,t.prev)<0&&Wt(t.next,i,i.next)<0}function ab(i,t,e,r){var s=i;do s.z===0&&(s.z=vh(s.x,s.y,t,e,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==i);s.prevZ.nextZ=null,s.prevZ=null,hb(s)}function hb(i){var t,e,r,s,a,h,l,c,f=1;do{for(e=i,i=null,a=null,h=0;e;){for(h++,r=e,l=0,t=0;t<f&&(l++,r=r.nextZ,!!r);t++);for(c=f;l>0||c>0&&r;)l!==0&&(c===0||!r||e.z<=r.z)?(s=e,e=e.nextZ,l--):(s=r,r=r.nextZ,c--),a?a.nextZ=s:i=s,s.prevZ=a,a=s;e=r}a.nextZ=null,f*=2}while(h>1);return i}function vh(i,t,e,r,s){return i=(i-e)*s|0,t=(t-r)*s|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function lb(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function zr(i,t,e,r,s,a,h,l){return(s-h)*(t-l)>=(i-h)*(a-l)&&(i-h)*(r-l)>=(e-h)*(t-l)&&(e-h)*(a-l)>=(s-h)*(r-l)}function ub(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!cb(i,t)&&(Bn(i,t)&&Bn(t,i)&&fb(i,t)&&(Wt(i.prev,i,t.prev)||Wt(i,t.prev,t))||mo(i,t)&&Wt(i.prev,i,i.next)>0&&Wt(t.prev,t,t.next)>0)}function Wt(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function mo(i,t){return i.x===t.x&&i.y===t.y}function Yf(i,t,e,r){var s=Fs(Wt(i,t,e)),a=Fs(Wt(i,t,r)),h=Fs(Wt(e,r,i)),l=Fs(Wt(e,r,t));return!!(s!==a&&h!==l||s===0&&Bs(i,e,t)||a===0&&Bs(i,r,t)||h===0&&Bs(e,i,r)||l===0&&Bs(e,t,r))}function Bs(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Fs(i){return i>0?1:i<0?-1:0}function cb(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&Yf(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Bn(i,t){return Wt(i.prev,i,i.next)<0?Wt(i,t,i.next)>=0&&Wt(i,i.prev,t)>=0:Wt(i,t,i.prev)<0||Wt(i,i.next,t)<0}function fb(i,t){var e=i,r=!1,s=(i.x+t.x)/2,a=(i.y+t.y)/2;do e.y>a!=e.next.y>a&&e.next.y!==e.y&&s<(e.next.x-e.x)*(a-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==i);return r}function jf(i,t){var e=new xh(i.i,i.x,i.y),r=new xh(t.i,t.x,t.y),s=i.next,a=t.prev;return i.next=t,t.prev=i,e.next=s,s.prev=e,r.next=e,e.prev=r,a.next=r,r.prev=a,r}function qc(i,t,e,r){var s=new xh(i,t,e);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function Fn(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function xh(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}go.deviation=function(i,t,e,r){var s=t&&t.length,a=s?t[0]*e:i.length,h=Math.abs(yh(i,0,a,e));if(s)for(var l=0,c=t.length;l<c;l++){var f=t[l]*e,p=l<c-1?t[l+1]*e:i.length;h-=Math.abs(yh(i,f,p,e))}var g=0;for(l=0;l<r.length;l+=3){var _=r[l]*e,v=r[l+1]*e,y=r[l+2]*e;g+=Math.abs((i[_]-i[y])*(i[v+1]-i[_+1])-(i[_]-i[v])*(i[y+1]-i[_+1]))}return h===0&&g===0?0:Math.abs((g-h)/h)};function yh(i,t,e,r){for(var s=0,a=t,h=e-r;a<e;a+=r)s+=(i[h]-i[a])*(i[a+1]+i[h+1]),h=a;return s}go.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},r=0,s=0;s<i.length;s++){for(var a=0;a<i[s].length;a++)for(var h=0;h<t;h++)e.vertices.push(i[s][a][h]);s>0&&(r+=i[s-1].length,e.holes.push(r))}return e};var bh={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(i,t){(function(e){var r=t&&!t.nodeType&&t,s=i&&!i.nodeType&&i,a=typeof Wi=="object"&&Wi;(a.global===a||a.window===a||a.self===a)&&(e=a);var h,l=2147483647,c=36,f=1,p=26,g=38,_=700,v=72,y=128,A="-",w=/^xn--/,R=/[^\x20-\x7E]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},P=c-f,U=Math.floor,z=String.fromCharCode,G;function k(H){throw RangeError(E[H])}function Z(H,et){for(var yt=H.length,Ct=[];yt--;)Ct[yt]=et(H[yt]);return Ct}function nt(H,et){var yt=H.split("@"),Ct="";yt.length>1&&(Ct=yt[0]+"@",H=yt[1]),H=H.replace(M,".");var Rt=H.split("."),Ft=Z(Rt,et).join(".");return Ct+Ft}function V(H){for(var et=[],yt=0,Ct=H.length,Rt,Ft;yt<Ct;)Rt=H.charCodeAt(yt++),Rt>=55296&&Rt<=56319&&yt<Ct?(Ft=H.charCodeAt(yt++),(Ft&64512)==56320?et.push(((Rt&1023)<<10)+(Ft&1023)+65536):(et.push(Rt),yt--)):et.push(Rt);return et}function J(H){return Z(H,function(et){var yt="";return et>65535&&(et-=65536,yt+=z(et>>>10&1023|55296),et=56320|et&1023),yt+=z(et),yt}).join("")}function X(H){return H-48<10?H-22:H-65<26?H-65:H-97<26?H-97:c}function O(H,et){return H+22+75*(H<26)-((et!=0)<<5)}function dt(H,et,yt){var Ct=0;for(H=yt?U(H/_):H>>1,H+=U(H/et);H>P*p>>1;Ct+=c)H=U(H/P);return U(Ct+(P+1)*H/(H+g))}function _t(H){var et=[],yt=H.length,Ct,Rt=0,Ft=y,Lt=v,Jt,$t,Qt,ee,Pt,Ot,Vt,Yt,ce;for(Jt=H.lastIndexOf(A),Jt<0&&(Jt=0),$t=0;$t<Jt;++$t)H.charCodeAt($t)>=128&&k("not-basic"),et.push(H.charCodeAt($t));for(Qt=Jt>0?Jt+1:0;Qt<yt;){for(ee=Rt,Pt=1,Ot=c;Qt>=yt&&k("invalid-input"),Vt=X(H.charCodeAt(Qt++)),(Vt>=c||Vt>U((l-Rt)/Pt))&&k("overflow"),Rt+=Vt*Pt,Yt=Ot<=Lt?f:Ot>=Lt+p?p:Ot-Lt,!(Vt<Yt);Ot+=c)ce=c-Yt,Pt>U(l/ce)&&k("overflow"),Pt*=ce;Ct=et.length+1,Lt=dt(Rt-ee,Ct,ee==0),U(Rt/Ct)>l-Ft&&k("overflow"),Ft+=U(Rt/Ct),Rt%=Ct,et.splice(Rt++,0,Ft)}return J(et)}function Y(H){var et,yt,Ct,Rt,Ft,Lt,Jt,$t,Qt,ee,Pt,Ot=[],Vt,Yt,ce,Zi;for(H=V(H),Vt=H.length,et=y,yt=0,Ft=v,Lt=0;Lt<Vt;++Lt)Pt=H[Lt],Pt<128&&Ot.push(z(Pt));for(Ct=Rt=Ot.length,Rt&&Ot.push(A);Ct<Vt;){for(Jt=l,Lt=0;Lt<Vt;++Lt)Pt=H[Lt],Pt>=et&&Pt<Jt&&(Jt=Pt);for(Yt=Ct+1,Jt-et>U((l-yt)/Yt)&&k("overflow"),yt+=(Jt-et)*Yt,et=Jt,Lt=0;Lt<Vt;++Lt)if(Pt=H[Lt],Pt<et&&++yt>l&&k("overflow"),Pt==et){for($t=yt,Qt=c;ee=Qt<=Ft?f:Qt>=Ft+p?p:Qt-Ft,!($t<ee);Qt+=c)Zi=$t-ee,ce=c-ee,Ot.push(z(O(ee+Zi%ce,0))),$t=U(Zi/ce);Ot.push(z(O($t,0))),Ft=dt(yt,Yt,Ct==Rt),yt=0,++Ct}++yt,++et}return Ot.join("")}function vt(H){return nt(H,function(et){return w.test(et)?_t(et.slice(4).toLowerCase()):et})}function Ut(H){return nt(H,function(et){return R.test(et)?"xn--"+Y(et):et})}if(h={version:"1.3.2",ucs2:{decode:V,encode:J},decode:_t,encode:Y,toASCII:Ut,toUnicode:vt},r&&s)if(i.exports==r)s.exports=h;else for(G in h)h.hasOwnProperty(G)&&(r[G]=h[G]);else e.punycode=h})(Wi)})(bh,bh.exports);var db={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},Ln={};function pb(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var gb=function(i,t,e,r){t=t||"&",e=e||"=";var s={};if(typeof i!="string"||i.length===0)return s;var a=/\+/g;i=i.split(t);var h=1e3;r&&typeof r.maxKeys=="number"&&(h=r.maxKeys);var l=i.length;h>0&&l>h&&(l=h);for(var c=0;c<l;++c){var f=i[c].replace(a,"%20"),p=f.indexOf(e),g,_,v,y;p>=0?(g=f.substr(0,p),_=f.substr(p+1)):(g=f,_=""),v=decodeURIComponent(g),y=decodeURIComponent(_),pb(s,v)?Array.isArray(s[v])?s[v].push(y):s[v]=[s[v],y]:s[v]=y}return s},Tn=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},mb=function(i,t,e,r){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(s){var a=encodeURIComponent(Tn(s))+e;return Array.isArray(i[s])?i[s].map(function(h){return a+encodeURIComponent(Tn(h))}).join(t):a+encodeURIComponent(Tn(i[s]))}).join(t):r?encodeURIComponent(Tn(r))+e+encodeURIComponent(Tn(i)):""};Ln.decode=Ln.parse=gb;Ln.encode=Ln.stringify=mb;var _b=bh.exports,fi=db,vb=_o,xb=Pb,yb=Rb;function ei(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var bb=/^([a-z0-9.+-]+:)/i,Tb=/:[0-9]*$/,wb=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Eb=["<",">",'"',"`"," ","\r",`
`,"	"],Ab=["{","}","|","\\","^","`"].concat(Eb),Th=["'"].concat(Ab),Kc=["%","/","?",";","#"].concat(Th),Zc=["/","?","#"],Sb=255,Jc=/^[+a-z0-9A-Z_-]{0,63}$/,Cb=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ib={javascript:!0,"javascript:":!0},wh={javascript:!0,"javascript:":!0},jr={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Eh=Ln;function _o(i,t,e){if(i&&fi.isObject(i)&&i instanceof ei)return i;var r=new ei;return r.parse(i,t,e),r}ei.prototype.parse=function(i,t,e){if(!fi.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var r=i.indexOf("?"),s=r!==-1&&r<i.indexOf("#")?"?":"#",a=i.split(s),h=/\\/g;a[0]=a[0].replace(h,"/"),i=a.join(s);var l=i;if(l=l.trim(),!e&&i.split("#").length===1){var c=wb.exec(l);if(c)return this.path=l,this.href=l,this.pathname=c[1],c[2]?(this.search=c[2],t?this.query=Eh.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=bb.exec(l);if(f){f=f[0];var p=f.toLowerCase();this.protocol=p,l=l.substr(f.length)}if(e||f||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var g=l.substr(0,2)==="//";g&&!(f&&wh[f])&&(l=l.substr(2),this.slashes=!0)}if(!wh[f]&&(g||f&&!jr[f])){for(var _=-1,v=0;v<Zc.length;v++){var y=l.indexOf(Zc[v]);y!==-1&&(_===-1||y<_)&&(_=y)}var A,w;_===-1?w=l.lastIndexOf("@"):w=l.lastIndexOf("@",_),w!==-1&&(A=l.slice(0,w),l=l.slice(w+1),this.auth=decodeURIComponent(A)),_=-1;for(var v=0;v<Kc.length;v++){var y=l.indexOf(Kc[v]);y!==-1&&(_===-1||y<_)&&(_=y)}_===-1&&(_=l.length),this.host=l.slice(0,_),l=l.slice(_),this.parseHost(),this.hostname=this.hostname||"";var R=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!R)for(var M=this.hostname.split(/\./),v=0,E=M.length;v<E;v++){var P=M[v];if(P&&!P.match(Jc)){for(var U="",z=0,G=P.length;z<G;z++)P.charCodeAt(z)>127?U+="x":U+=P[z];if(!U.match(Jc)){var k=M.slice(0,v),Z=M.slice(v+1),nt=P.match(Cb);nt&&(k.push(nt[1]),Z.unshift(nt[2])),Z.length&&(l="/"+Z.join(".")+l),this.hostname=k.join(".");break}}}this.hostname.length>Sb?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=_b.toASCII(this.hostname));var V=this.port?":"+this.port:"",J=this.hostname||"";this.host=J+V,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!Ib[p])for(var v=0,E=Th.length;v<E;v++){var X=Th[v];if(l.indexOf(X)!==-1){var O=encodeURIComponent(X);O===X&&(O=escape(X)),l=l.split(X).join(O)}}var dt=l.indexOf("#");dt!==-1&&(this.hash=l.substr(dt),l=l.slice(0,dt));var _t=l.indexOf("?");if(_t!==-1?(this.search=l.substr(_t),this.query=l.substr(_t+1),t&&(this.query=Eh.parse(this.query)),l=l.slice(0,_t)):t&&(this.search="",this.query={}),l&&(this.pathname=l),jr[p]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var V=this.pathname||"",Y=this.search||"";this.path=V+Y}return this.href=this.format(),this};function Rb(i){return fi.isString(i)&&(i=_o(i)),i instanceof ei?i.format():ei.prototype.format.call(i)}ei.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",r=this.hash||"",s=!1,a="";this.host?s=i+this.host:this.hostname&&(s=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&fi.isObject(this.query)&&Object.keys(this.query).length&&(a=Eh.stringify(this.query));var h=this.search||a&&"?"+a||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||jr[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),r&&r.charAt(0)!=="#"&&(r="#"+r),h&&h.charAt(0)!=="?"&&(h="?"+h),e=e.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),h=h.replace("#","%23"),t+s+e+h+r};function Pb(i,t){return _o(i,!1,!0).resolve(t)}ei.prototype.resolve=function(i){return this.resolveObject(_o(i,!1,!0)).format()};ei.prototype.resolveObject=function(i){if(fi.isString(i)){var t=new ei;t.parse(i,!1,!0),i=t}for(var e=new ei,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];e[a]=this[a]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var h=Object.keys(i),l=0;l<h.length;l++){var c=h[l];c!=="protocol"&&(e[c]=i[c])}return jr[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!jr[i.protocol]){for(var f=Object.keys(i),p=0;p<f.length;p++){var g=f[p];e[g]=i[g]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!wh[i.protocol]){for(var E=(i.pathname||"").split("/");E.length&&!(i.host=E.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),E[0]!==""&&E.unshift(""),E.length<2&&E.unshift(""),e.pathname=E.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var _=e.pathname||"",v=e.search||"";e.path=_+v}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var y=e.pathname&&e.pathname.charAt(0)==="/",A=i.host||i.pathname&&i.pathname.charAt(0)==="/",w=A||y||e.host&&i.pathname,R=w,M=e.pathname&&e.pathname.split("/")||[],E=i.pathname&&i.pathname.split("/")||[],P=e.protocol&&!jr[e.protocol];if(P&&(e.hostname="",e.port=null,e.host&&(M[0]===""?M[0]=e.host:M.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(E[0]===""?E[0]=i.host:E.unshift(i.host)),i.host=null),w=w&&(E[0]===""||M[0]==="")),A)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,M=E;else if(E.length)M||(M=[]),M.pop(),M=M.concat(E),e.search=i.search,e.query=i.query;else if(!fi.isNullOrUndefined(i.search)){if(P){e.hostname=e.host=M.shift();var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.host=e.hostname=U.shift())}return e.search=i.search,e.query=i.query,(!fi.isNull(e.pathname)||!fi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!M.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var z=M.slice(-1)[0],G=(e.host||i.host||M.length>1)&&(z==="."||z==="..")||z==="",k=0,Z=M.length;Z>=0;Z--)z=M[Z],z==="."?M.splice(Z,1):z===".."?(M.splice(Z,1),k++):k&&(M.splice(Z,1),k--);if(!w&&!R)for(;k--;k)M.unshift("..");w&&M[0]!==""&&(!M[0]||M[0].charAt(0)!=="/")&&M.unshift(""),G&&M.join("/").substr(-1)!=="/"&&M.push("");var nt=M[0]===""||M[0]&&M[0].charAt(0)==="/";if(P){e.hostname=e.host=nt?"":M.length?M.shift():"";var U=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;U&&(e.auth=U.shift(),e.host=e.hostname=U.shift())}return w=w||e.host&&M.length,w&&!nt&&M.unshift(""),M.length?e.pathname=M.join("/"):(e.pathname=null,e.path=null),(!fi.isNull(e.pathname)||!fi.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};ei.prototype.parseHost=function(){var i=this.host,t=Tb.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const Mb={parse:vb,format:yb,resolve:xb};function Ye(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function wn(i){return i.split("?")[0].split("#")[0]}function Db(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Bb(i,t,e){return i.replace(new RegExp(Db(t),"g"),e)}function Fb(i,t){let e="",r=0,s=-1,a=0,h=-1;for(let l=0;l<=i.length;++l){if(l<i.length)h=i.charCodeAt(l);else{if(h===47)break;h=47}if(h===47){if(!(s===l-1||a===1))if(s!==l-1&&a===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",r=0):(e=e.slice(0,c),r=e.length-1-e.lastIndexOf("/")),s=l,a=0;continue}}else if(e.length===2||e.length===1){e="",r=0,s=l,a=0;continue}}t&&(e.length>0?e+="/..":e="..",r=2)}else e.length>0?e+=`/${i.slice(s+1,l)}`:e=i.slice(s+1,l),r=l-s-1;s=l,a=0}else h===46&&a!==-1?++a:a=-1}return e}const ue={toPosix(i){return Bb(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){Ye(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),r=/^[^/:]+:\/\//.exec(i),s=/^[^/:]+:\//.exec(i);if(e||r||s){const a=(e==null?void 0:e[0])||(r==null?void 0:r[0])||(s==null?void 0:s[0]);t=a,i=i.slice(a.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const r=wn(this.toPosix(t??q.ADAPTER.getBaseUrl())),s=wn(this.toPosix(e??this.rootname(r)));return Ye(i),i=this.toPosix(i),i.startsWith("/")?ue.join(s,i.slice(1)):this.isAbsolute(i)?i:this.join(r,i)},normalize(i){if(i=this.toPosix(i),Ye(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const r=i.endsWith("/");return i=Fb(i,!1),i.length>0&&r&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return Ye(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const r=i[e];if(Ye(r),r.length>0)if(t===void 0)t=r;else{const s=i[e-1]??"";this.extname(s)?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(Ye(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let r=-1,s=!0;const a=this.getProtocol(i),h=i;i=i.slice(a.length);for(let l=i.length-1;l>=1;--l)if(t=i.charCodeAt(l),t===47){if(!s){r=l;break}}else s=!1;return r===-1?e?"/":this.isUrl(h)?a+i:a:e&&r===1?"//":a+i.slice(0,r)},rootname(i){Ye(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){Ye(i),t&&Ye(t),i=wn(this.toPosix(i));let e=0,r=-1,s=!0,a;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let h=t.length-1,l=-1;for(a=i.length-1;a>=0;--a){const c=i.charCodeAt(a);if(c===47){if(!s){e=a+1;break}}else l===-1&&(s=!1,l=a+1),h>=0&&(c===t.charCodeAt(h)?--h===-1&&(r=a):(h=-1,r=l))}return e===r?r=l:r===-1&&(r=i.length),i.slice(e,r)}for(a=i.length-1;a>=0;--a)if(i.charCodeAt(a)===47){if(!s){e=a+1;break}}else r===-1&&(s=!1,r=a+1);return r===-1?"":i.slice(e,r)},extname(i){Ye(i),i=wn(this.toPosix(i));let t=-1,e=0,r=-1,s=!0,a=0;for(let h=i.length-1;h>=0;--h){const l=i.charCodeAt(h);if(l===47){if(!s){e=h+1;break}continue}r===-1&&(s=!1,r=h+1),l===46?t===-1?t=h:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||r===-1||a===0||a===1&&t===r-1&&t===e+1?"":i.slice(t,r)},parse(i){Ye(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=wn(this.toPosix(i));let e=i.charCodeAt(0);const r=this.isAbsolute(i);let s;t.root=this.rootname(i),r||this.hasProtocol(i)?s=1:s=0;let a=-1,h=0,l=-1,c=!0,f=i.length-1,p=0;for(;f>=s;--f){if(e=i.charCodeAt(f),e===47){if(!c){h=f+1;break}continue}l===-1&&(c=!1,l=f+1),e===46?a===-1?a=f:p!==1&&(p=1):a!==-1&&(p=-1)}return a===-1||l===-1||p===0||p===1&&a===l-1&&a===h+1?l!==-1&&(h===0&&r?t.base=t.name=i.slice(1,l):t.base=t.name=i.slice(h,l)):(h===0&&r?(t.name=i.slice(1,a),t.base=i.slice(1,l)):(t.name=i.slice(h,a),t.base=i.slice(h,l)),t.ext=i.slice(a,l)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},Qc={};function At(i,t,e=3){if(Qc[t])return;let r=new Error().stack;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(r=r.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(r))),Qc[t]=!0}let Ya;function Lb(){return typeof Ya>"u"&&(Ya=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:q.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!q.ADAPTER.getWebGLRenderingContext())return!1;const r=q.ADAPTER.createCanvas();let s=r.getContext("webgl",t)||r.getContext("experimental-webgl",t);const a=!!((e=s==null?void 0:s.getContextAttributes())!=null&&e.stencil);if(s){const h=s.getExtension("WEBGL_lose_context");h&&h.loseContext()}return s=null,a}catch{return!1}}()),Ya}var Ob="#f0f8ff",Nb="#faebd7",Ub="#00ffff",kb="#7fffd4",Gb="#f0ffff",Hb="#f5f5dc",Xb="#ffe4c4",Wb="#000000",zb="#ffebcd",$b="#0000ff",Vb="#8a2be2",Yb="#a52a2a",jb="#deb887",qb="#5f9ea0",Kb="#7fff00",Zb="#d2691e",Jb="#ff7f50",Qb="#6495ed",t1="#fff8dc",e1="#dc143c",i1="#00ffff",r1="#00008b",n1="#008b8b",s1="#b8860b",o1="#a9a9a9",a1="#006400",h1="#a9a9a9",l1="#bdb76b",u1="#8b008b",c1="#556b2f",f1="#ff8c00",d1="#9932cc",p1="#8b0000",g1="#e9967a",m1="#8fbc8f",_1="#483d8b",v1="#2f4f4f",x1="#2f4f4f",y1="#00ced1",b1="#9400d3",T1="#ff1493",w1="#00bfff",E1="#696969",A1="#696969",S1="#1e90ff",C1="#b22222",I1="#fffaf0",R1="#228b22",P1="#ff00ff",M1="#dcdcdc",D1="#f8f8ff",B1="#daa520",F1="#ffd700",L1="#808080",O1="#008000",N1="#adff2f",U1="#808080",k1="#f0fff0",G1="#ff69b4",H1="#cd5c5c",X1="#4b0082",W1="#fffff0",z1="#f0e68c",$1="#fff0f5",V1="#e6e6fa",Y1="#7cfc00",j1="#fffacd",q1="#add8e6",K1="#f08080",Z1="#e0ffff",J1="#fafad2",Q1="#d3d3d3",tT="#90ee90",eT="#d3d3d3",iT="#ffb6c1",rT="#ffa07a",nT="#20b2aa",sT="#87cefa",oT="#778899",aT="#778899",hT="#b0c4de",lT="#ffffe0",uT="#00ff00",cT="#32cd32",fT="#faf0e6",dT="#ff00ff",pT="#800000",gT="#66cdaa",mT="#0000cd",_T="#ba55d3",vT="#9370db",xT="#3cb371",yT="#7b68ee",bT="#00fa9a",TT="#48d1cc",wT="#c71585",ET="#191970",AT="#f5fffa",ST="#ffe4e1",CT="#ffe4b5",IT="#ffdead",RT="#000080",PT="#fdf5e6",MT="#808000",DT="#6b8e23",BT="#ffa500",FT="#ff4500",LT="#da70d6",OT="#eee8aa",NT="#98fb98",UT="#afeeee",kT="#db7093",GT="#ffefd5",HT="#ffdab9",XT="#cd853f",WT="#ffc0cb",zT="#dda0dd",$T="#b0e0e6",VT="#800080",YT="#663399",jT="#ff0000",qT="#bc8f8f",KT="#4169e1",ZT="#8b4513",JT="#fa8072",QT="#f4a460",tw="#2e8b57",ew="#fff5ee",iw="#a0522d",rw="#c0c0c0",nw="#87ceeb",sw="#6a5acd",ow="#708090",aw="#708090",hw="#fffafa",lw="#00ff7f",uw="#4682b4",cw="#d2b48c",fw="#008080",dw="#d8bfd8",pw="#ff6347",gw="#40e0d0",mw="#ee82ee",_w="#f5deb3",vw="#ffffff",xw="#f5f5f5",yw="#ffff00",bw="#9acd32",Tw={aliceblue:Ob,antiquewhite:Nb,aqua:Ub,aquamarine:kb,azure:Gb,beige:Hb,bisque:Xb,black:Wb,blanchedalmond:zb,blue:$b,blueviolet:Vb,brown:Yb,burlywood:jb,cadetblue:qb,chartreuse:Kb,chocolate:Zb,coral:Jb,cornflowerblue:Qb,cornsilk:t1,crimson:e1,cyan:i1,darkblue:r1,darkcyan:n1,darkgoldenrod:s1,darkgray:o1,darkgreen:a1,darkgrey:h1,darkkhaki:l1,darkmagenta:u1,darkolivegreen:c1,darkorange:f1,darkorchid:d1,darkred:p1,darksalmon:g1,darkseagreen:m1,darkslateblue:_1,darkslategray:v1,darkslategrey:x1,darkturquoise:y1,darkviolet:b1,deeppink:T1,deepskyblue:w1,dimgray:E1,dimgrey:A1,dodgerblue:S1,firebrick:C1,floralwhite:I1,forestgreen:R1,fuchsia:P1,gainsboro:M1,ghostwhite:D1,goldenrod:B1,gold:F1,gray:L1,green:O1,greenyellow:N1,grey:U1,honeydew:k1,hotpink:G1,indianred:H1,indigo:X1,ivory:W1,khaki:z1,lavenderblush:$1,lavender:V1,lawngreen:Y1,lemonchiffon:j1,lightblue:q1,lightcoral:K1,lightcyan:Z1,lightgoldenrodyellow:J1,lightgray:Q1,lightgreen:tT,lightgrey:eT,lightpink:iT,lightsalmon:rT,lightseagreen:nT,lightskyblue:sT,lightslategray:oT,lightslategrey:aT,lightsteelblue:hT,lightyellow:lT,lime:uT,limegreen:cT,linen:fT,magenta:dT,maroon:pT,mediumaquamarine:gT,mediumblue:mT,mediumorchid:_T,mediumpurple:vT,mediumseagreen:xT,mediumslateblue:yT,mediumspringgreen:bT,mediumturquoise:TT,mediumvioletred:wT,midnightblue:ET,mintcream:AT,mistyrose:ST,moccasin:CT,navajowhite:IT,navy:RT,oldlace:PT,olive:MT,olivedrab:DT,orange:BT,orangered:FT,orchid:LT,palegoldenrod:OT,palegreen:NT,paleturquoise:UT,palevioletred:kT,papayawhip:GT,peachpuff:HT,peru:XT,pink:WT,plum:zT,powderblue:$T,purple:VT,rebeccapurple:YT,red:jT,rosybrown:qT,royalblue:KT,saddlebrown:ZT,salmon:JT,sandybrown:QT,seagreen:tw,seashell:ew,sienna:iw,silver:rw,skyblue:nw,slateblue:sw,slategray:ow,slategrey:aw,snow:hw,springgreen:lw,steelblue:uw,tan:cw,teal:fw,thistle:dw,tomato:pw,turquoise:gw,violet:mw,wheat:_w,white:vw,whitesmoke:xw,yellow:yw,yellowgreen:bw};function On(i,t=[]){return t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,t}function qf(i){let t=i.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function Kh(i){if(typeof i=="string"&&(i=Tw[i.toLowerCase()]||i,i[0]==="#"&&(i=i.slice(1)),i.length===3)){const[t,e,r]=i;i=t+t+e+e+r+r}return parseInt(i,16)}function ww(){const i=[],t=[];for(let r=0;r<32;r++)i[r]=r,t[r]=r;i[lt.NORMAL_NPM]=lt.NORMAL,i[lt.ADD_NPM]=lt.ADD,i[lt.SCREEN_NPM]=lt.SCREEN,t[lt.NORMAL]=lt.NORMAL_NPM,t[lt.ADD]=lt.ADD_NPM,t[lt.SCREEN]=lt.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const Kf=ww();function Zf(i,t){return Kf[t?1:0][i]}function Ew(i,t,e,r){return e=e||new Float32Array(4),r||r===void 0?(e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t):(e[0]=i[0],e[1]=i[1],e[2]=i[2]),e[3]=t,e}function Zh(i,t){if(t===1)return(t*255<<24)+i;if(t===0)return 0;let e=i>>16&255,r=i>>8&255,s=i&255;return e=e*t+.5|0,r=r*t+.5|0,s=s*t+.5|0,(t*255<<24)+(e<<16)+(r<<8)+s}function Jf(i,t,e,r){return e=e||new Float32Array(4),e[0]=(i>>16&255)/255,e[1]=(i>>8&255)/255,e[2]=(i&255)/255,(r||r===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function Aw(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let r=0,s=0;r<e;r+=6,s+=4)t[r+0]=s+0,t[r+1]=s+1,t[r+2]=s+2,t[r+3]=s+0,t[r+4]=s+2,t[r+5]=s+3;return t}function Qf(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function ro(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function tf(i){return!(i&i-1)&&!!i}function ef(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function qr(i,t,e){const r=i.length;let s;if(t>=r||e===0)return;e=t+e>r?r-t:e;const a=r-e;for(s=t;s<a;++s)i[s]=i[s+e];i.length=a}function $r(i){return i===0?0:i<0?-1:1}let Sw=0;function vr(){return++Sw}const td=class{constructor(i,t,e,r){this.left=i,this.top=t,this.right=e,this.bottom=r}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Ah=td;Ah.EMPTY=new td(0,0,0,0);const rf={},ui=Object.create(null),Xi=Object.create(null);class nf{constructor(t,e,r){this._canvas=q.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||q.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function sf(i,t,e){for(let r=0,s=4*e*t;r<t;++r,s+=4)if(i[s+3]!==0)return!1;return!0}function of(i,t,e,r,s){const a=4*t;for(let h=r,l=r*a+4*e;h<=s;++h,l+=a)if(i[l+3]!==0)return!1;return!0}function Cw(i){const{width:t,height:e}=i,r=i.getContext("2d",{willReadFrequently:!0});if(r===null)throw new TypeError("Failed to get canvas 2D context");const a=r.getImageData(0,0,t,e).data;let h=0,l=0,c=t-1,f=e-1;for(;l<e&&sf(a,t,l);)++l;if(l===e)return Ah.EMPTY;for(;sf(a,t,f);)--f;for(;of(a,t,h,l,f);)++h;for(;of(a,t,c,l,f);)--c;return++c,++f,new Ah(h,l,c,f)}function Iw(i){const t=Cw(i),{width:e,height:r}=t;let s=null;if(!t.isEmpty()){const a=i.getContext("2d");if(a===null)throw new TypeError("Failed to get canvas 2D context");s=a.getImageData(t.left,t.top,e,r)}return{width:e,height:r,data:s}}let Ls;function Rw(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,Ls||(Ls=document.createElement("a")),Ls.href=i;const e=Mb.parse(Ls.href),r=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!r||e.protocol!==t.protocol?"anonymous":""}function Yi(i,t=1){var r;const e=(r=q.RETINA_PREFIX)==null?void 0:r.exec(i);return e?parseFloat(e[1]):t}var j=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(j||{});const Sh=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},af=(i,t)=>Sh(i).priority??t,rt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Sh).forEach(t=>{t.type.forEach(e=>{var r,s;return(s=(r=this._removeHandlers)[e])==null?void 0:s.call(r,t)})}),this},add(...i){return i.map(Sh).forEach(t=>{t.type.forEach(e=>{const r=this._addHandlers,s=this._queue;r[e]?r[e](t):(s[e]=s[e]||[],s[e].push(t))})}),this},handle(i,t,e){const r=this._addHandlers,s=this._removeHandlers;if(r[i]||s[i])throw new Error(`Extension type ${i} already has a handler`);r[i]=t,s[i]=e;const a=this._queue;return a[i]&&(a[i].forEach(h=>t(h)),delete a[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((s,a)=>af(a,e)-af(s,e)))},r=>{const s=t.indexOf(r.ref);s!==-1&&t.splice(s,1)})}};class Ch{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const Pw=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Mw(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function Dw(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const r=Pw.replace(/%forloop%/gi,Mw(i));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const ja=0,qa=1,Ka=2,Za=3,Ja=4,Qa=5;class Di{constructor(){this.data=0,this.blendMode=lt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ja)}set blend(t){!!(this.data&1<<ja)!==t&&(this.data^=1<<ja)}get offsets(){return!!(this.data&1<<qa)}set offsets(t){!!(this.data&1<<qa)!==t&&(this.data^=1<<qa)}get culling(){return!!(this.data&1<<Ka)}set culling(t){!!(this.data&1<<Ka)!==t&&(this.data^=1<<Ka)}get depthTest(){return!!(this.data&1<<Za)}set depthTest(t){!!(this.data&1<<Za)!==t&&(this.data^=1<<Za)}get depthMask(){return!!(this.data&1<<Qa)}set depthMask(t){!!(this.data&1<<Qa)!==t&&(this.data^=1<<Qa)}get clockwiseFrontFace(){return!!(this.data&1<<Ja)}set clockwiseFrontFace(t){!!(this.data&1<<Ja)!==t&&(this.data^=1<<Ja)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==lt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Di;return t.depthTest=!1,t.blend=!0,t}}const Ih=[];function ed(i,t){if(!i)return null;let e="";if(typeof i=="string"){const r=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);r&&(e=r[1].toLowerCase())}for(let r=Ih.length-1;r>=0;--r){const s=Ih[r];if(s.test&&s.test(i,e))return new s(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class ii{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,r,s,a,h,l,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:f,items:p}=this;this._aliasCount++;for(let g=0,_=p.length;g<_;g++)p[g][f](t,e,r,s,a,h,l,c);return p===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(ii.prototype,{dispatch:{value:ii.prototype.emit},run:{value:ii.prototype.emit}});class Nn{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ii("setRealSize"),this.onUpdate=new ii("update"),this.onError=new ii("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class Hn extends Nn{constructor(t,e){const{width:r,height:s}=e||{};if(!r||!s)throw new Error("BufferResource width or height invalid");super(r,s),this.data=t}upload(t,e,r){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK);const a=e.realWidth,h=e.realHeight;return r.width===a&&r.height===h?s.texSubImage2D(e.target,0,0,0,a,h,e.format,r.type,this.data):(r.width=a,r.height=h,s.texImage2D(e.target,0,r.internalFormat,a,h,0,e.format,r.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const Bw={scaleMode:Ri.NEAREST,format:W.RGBA,alphaMode:ni.NPM},Gr=class extends Gn{constructor(i=null,t=null){super(),t=Object.assign({},Gr.defaultOptions,t);const{alphaMode:e,mipmap:r,anisotropicLevel:s,scaleMode:a,width:h,height:l,wrapMode:c,format:f,type:p,target:g,resolution:_,resourceOptions:v}=t;i&&!(i instanceof Nn)&&(i=ed(i,v),i.internal=!0),this.resolution=_||q.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=r,this.anisotropicLevel=s,this._wrapMode=c,this._scaleMode=a,this.format=f,this.type=p,this.target=g,this.alphaMode=e,this.uid=vr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=tf(this.realWidth)&&tf(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Xi[this.cacheId],delete ui[this.cacheId],this.cacheId=null),this.dispose(),Gr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=q.STRICT_TEXTURE_CACHE){const r=typeof i=="string";let s=null;if(r)s=i;else{if(!i._pixiId){const h=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${h}_${vr()}`}s=i._pixiId}let a=Xi[s];if(r&&e&&!a)throw new Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return a||(a=new Gr(i,t),a.cacheId=s,Gr.addToCache(a,s)),a}static fromBuffer(i,t,e,r){i=i||new Float32Array(t*e*4);const s=new Hn(i,{width:t,height:e}),a=i instanceof Float32Array?st.FLOAT:st.UNSIGNED_BYTE;return new Gr(s,Object.assign({},Bw,r||{width:t,height:e,type:a}))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),Xi[t]&&Xi[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),Xi[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=Xi[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete Xi[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete Xi[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let ft=Gr;ft.defaultOptions={mipmap:mi.POW2,anisotropicLevel:0,scaleMode:Ri.LINEAR,wrapMode:Vi.CLAMP,alphaMode:ni.UNPACK,target:Yr.TEXTURE_2D,format:W.RGBA,type:st.UNSIGNED_BYTE};ft._globalBatch=0;class Rh{constructor(){this.texArray=null,this.blend=0,this.type=di.TRIANGLES,this.start=0,this.size=0,this.data=null}}let Fw=0;class Zt{constructor(t,e=!0,r=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=e,this.id=Fw++,this.disposeRunner=new ii("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?pi.ELEMENT_ARRAY_BUFFER:pi.ARRAY_BUFFER}get index(){return this.type===pi.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Zt(t)}}class no{constructor(t,e=0,r=!1,s=st.FLOAT,a,h,l,c=1){this.buffer=t,this.size=e,this.normalized=r,this.type=s,this.stride=a,this.start=h,this.instance=l,this.divisor=c}destroy(){this.buffer=null}static from(t,e,r,s,a){return new no(t,e,r,s,a)}}const Lw={Float32Array,Uint32Array,Int32Array,Uint8Array};function Ow(i,t){let e=0,r=0;const s={};for(let c=0;c<i.length;c++)r+=t[c],e+=i[c].length;const a=new ArrayBuffer(e*4);let h=null,l=0;for(let c=0;c<i.length;c++){const f=t[c],p=i[c],g=Qf(p);s[g]||(s[g]=new Lw[g](a)),h=s[g];for(let _=0;_<p.length;_++){const v=(_/f|0)*r+l,y=_%f;h[v+y]=p[_]}l+=f}return new Float32Array(a)}const hf={5126:4,5123:2,5121:1};let Nw=0;const Uw={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class ji{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Nw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ii("disposeGeometry"),this.refCount=0}addAttribute(t,e,r=0,s=!1,a,h,l,c=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Zt||(e instanceof Array&&(e=new Float32Array(e)),e=new Zt(e));const f=t.split("|");if(f.length>1){for(let g=0;g<f.length;g++)this.addAttribute(f[g],e,r,s,a);return this}let p=this.buffers.indexOf(e);return p===-1&&(this.buffers.push(e),p=this.buffers.length-1),this.attributes[t]=new no(p,r,s,a,h,l,c),this.instanced=this.instanced||c,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Zt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Zt(t)),t.type=pi.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],r=new Zt;let s;for(s in this.attributes){const a=this.attributes[s],h=this.buffers[a.buffer];t.push(h.data),e.push(a.size*hf[a.type]/4),a.buffer=0}for(r.data=Ow(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new ji;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Zt(this.buffers[e].data.slice(0));for(const e in this.attributes){const r=this.attributes[e];t.attributes[e]=new no(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=pi.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new ji,r=[],s=[],a=[];let h;for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)s[c]=s[c]||0,s[c]+=h.buffers[c].data.length,a[c]=0}for(let l=0;l<h.buffers.length;l++)r[l]=new Uw[Qf(h.buffers[l].data)](s[l]),e.buffers[l]=new Zt(r[l]);for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)r[c].set(h.buffers[c].data,a[c]),a[c]+=h.buffers[c].data.length}if(e.attributes=h.attributes,h.indexBuffer){e.indexBuffer=e.buffers[h.buffers.indexOf(h.indexBuffer)],e.indexBuffer.type=pi.ELEMENT_ARRAY_BUFFER;let l=0,c=0,f=0,p=0;for(let g=0;g<h.buffers.length;g++)if(h.buffers[g]!==h.indexBuffer){p=g;break}for(const g in h.attributes){const _=h.attributes[g];(_.buffer|0)===p&&(c+=_.size*hf[_.type]/4)}for(let g=0;g<t.length;g++){const _=t[g].indexBuffer.data;for(let v=0;v<_.length;v++)e.indexBuffer.data[v+f]+=l;l+=t[g].buffers[p].data.length/c,f+=_.length}}return e}}class id extends ji{constructor(t=!1){super(),this._buffer=new Zt(null,t,!1),this._indexBuffer=new Zt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,st.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,st.FLOAT).addAttribute("aColor",this._buffer,4,!0,st.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,st.FLOAT).addIndex(this._indexBuffer)}}const so=Math.PI*2,kw=180/Math.PI,Gw=Math.PI/180;var le=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(le||{});class Et{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Et(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Os=[new Et,new Et,new Et,new Et];class Tt{constructor(t=0,e=0,r=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(s),this.type=le.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Tt(0,0,0,0)}clone(){return new Tt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const k=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=k)return!1;const nt=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>nt}const r=this.left,s=this.right,a=this.top,h=this.bottom;if(s<=r||h<=a)return!1;const l=Os[0].set(t.left,t.top),c=Os[1].set(t.left,t.bottom),f=Os[2].set(t.right,t.top),p=Os[3].set(t.right,t.bottom);if(f.x<=l.x||c.y<=l.y)return!1;const g=Math.sign(e.a*e.d-e.b*e.c);if(g===0||(e.apply(l,l),e.apply(c,c),e.apply(f,f),e.apply(p,p),Math.max(l.x,c.x,f.x,p.x)<=r||Math.min(l.x,c.x,f.x,p.x)>=s||Math.max(l.y,c.y,f.y,p.y)<=a||Math.min(l.y,c.y,f.y,p.y)>=h))return!1;const _=g*(c.y-l.y),v=g*(l.x-c.x),y=_*r+v*a,A=_*s+v*a,w=_*r+v*h,R=_*s+v*h;if(Math.max(y,A,w,R)<=_*l.x+v*l.y||Math.min(y,A,w,R)>=_*p.x+v*p.y)return!1;const M=g*(l.y-f.y),E=g*(f.x-l.x),P=M*r+E*a,U=M*s+E*a,z=M*r+E*h,G=M*s+E*h;return!(Math.max(P,U,z,G)<=M*l.x+E*l.y||Math.min(P,U,z,G)>=M*p.x+E*p.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),a=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=s,this.height=Math.max(a-s,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),a=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=s,this.height=a-s,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Jh{constructor(t=0,e=0,r=0){this.x=t,this.y=e,this.radius=r,this.type=le.CIRC}clone(){return new Jh(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let s=this.x-t,a=this.y-e;return s*=s,a*=a,s+a<=r}getBounds(){return new Tt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Qh{constructor(t=0,e=0,r=0,s=0){this.x=t,this.y=e,this.width=r,this.height=s,this.type=le.ELIP}clone(){return new Qh(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let r=(t-this.x)/this.width,s=(e-this.y)/this.height;return r*=r,s*=s,r+s<=1}getBounds(){return new Tt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Kr{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let s=0,a=e.length;s<a;s++)r.push(e[s].x,e[s].y);e=r}this.points=e,this.type=le.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new Kr(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let r=!1;const s=this.points.length/2;for(let a=0,h=s-1;a<s;h=a++){const l=this.points[a*2],c=this.points[a*2+1],f=this.points[h*2],p=this.points[h*2+1];c>e!=p>e&&t<(f-l)*((e-c)/(p-c))+l&&(r=!r)}return r}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class tl{constructor(t=0,e=0,r=0,s=0,a=20){this.x=t,this.y=e,this.width=r,this.height=s,this.radius=a,this.type=le.RREC}clone(){return new tl(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let s=t-(this.x+r),a=e-(this.y+r);const h=r*r;if(s*s+a*a<=h||(s=t-(this.x+this.width-r),s*s+a*a<=h)||(a=e-(this.y+this.height-r),s*s+a*a<=h)||(s=t-(this.x+r),s*s+a*a<=h))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Gt{constructor(t=1,e=0,r=0,s=1,a=0,h=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=s,this.tx=a,this.ty=h}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,s,a,h){return this.a=t,this.b=e,this.c=r,this.d=s,this.tx=a,this.ty=h,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new Et;const r=t.x,s=t.y;return e.x=this.a*r+this.c*s+this.tx,e.y=this.b*r+this.d*s+this.ty,e}applyInverse(t,e){e=e||new Et;const r=1/(this.a*this.d+this.c*-this.b),s=t.x,a=t.y;return e.x=this.d*r*s+-this.c*r*a+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*a+-this.b*r*s+(-this.ty*this.a+this.tx*this.b)*r,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),s=this.a,a=this.c,h=this.tx;return this.a=s*e-this.b*r,this.b=s*r+this.b*e,this.c=a*e-this.d*r,this.d=a*r+this.d*e,this.tx=h*e-this.ty*r,this.ty=h*r+this.ty*e,this}append(t){const e=this.a,r=this.b,s=this.c,a=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*r+t.b*a,this.c=t.c*e+t.d*s,this.d=t.c*r+t.d*a,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*r+t.ty*a+this.ty,this}setTransform(t,e,r,s,a,h,l,c,f){return this.a=Math.cos(l+f)*a,this.b=Math.sin(l+f)*a,this.c=-Math.sin(l-c)*h,this.d=Math.cos(l-c)*h,this.tx=t-(r*this.a+s*this.c),this.ty=e-(r*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,s=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,s=this.c,a=this.d,h=t.pivot,l=-Math.atan2(-s,a),c=Math.atan2(r,e),f=Math.abs(l+c);return f<1e-5||Math.abs(so-f)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=c),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(s*s+a*a),t.position.x=this.tx+(h.x*e+h.y*s),t.position.y=this.ty+(h.x*r+h.y*a),t}invert(){const t=this.a,e=this.b,r=this.c,s=this.d,a=this.tx,h=t*s-e*r;return this.a=s/h,this.b=-e/h,this.c=-r/h,this.d=t/h,this.tx=(r*this.ty-s*a)/h,this.ty=-(t*this.ty-e*a)/h,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Gt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Gt}static get TEMP_MATRIX(){return new Gt}}const lr=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ur=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],cr=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],fr=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ph=[],rd=[],Ns=Math.sign;function Hw(){for(let i=0;i<16;i++){const t=[];Ph.push(t);for(let e=0;e<16;e++){const r=Ns(lr[i]*lr[e]+cr[i]*ur[e]),s=Ns(ur[i]*lr[e]+fr[i]*ur[e]),a=Ns(lr[i]*cr[e]+cr[i]*fr[e]),h=Ns(ur[i]*cr[e]+fr[i]*fr[e]);for(let l=0;l<16;l++)if(lr[l]===r&&ur[l]===s&&cr[l]===a&&fr[l]===h){t.push(l);break}}}for(let i=0;i<16;i++){const t=new Gt;t.set(lr[i],ur[i],cr[i],fr[i],0,0),rd.push(t)}}Hw();const Xt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>lr[i],uY:i=>ur[i],vX:i=>cr[i],vY:i=>fr[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Ph[i][t],sub:(i,t)=>Ph[i][Xt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?Xt.S:Xt.N:Math.abs(t)*2<=Math.abs(i)?i>0?Xt.E:Xt.W:t>0?i>0?Xt.SE:Xt.SW:i>0?Xt.NE:Xt.NW,matrixAppendRotationInv:(i,t,e=0,r=0)=>{const s=rd[Xt.inv(t)];s.tx=e,s.ty=r,i.append(s)}};class $i{constructor(t,e,r=0,s=0){this._x=r,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new $i(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const nd=class{constructor(){this.worldTransform=new Gt,this.localTransform=new Gt,this.position=new $i(this.onChange,this,0,0),this.scale=new $i(this.onChange,this,1,1),this.pivot=new $i(this.onChange,this,0,0),this.skew=new $i(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,r=this.worldTransform;r.a=t.a*e.a+t.b*e.c,r.b=t.a*e.b+t.b*e.d,r.c=t.c*e.a+t.d*e.c,r.d=t.c*e.b+t.d*e.d,r.tx=t.tx*e.a+t.ty*e.c+e.tx,r.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let el=nd;el.IDENTITY=new nd;var Xw=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,Ww=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function lf(i,t,e){const r=i.createShader(t);return i.shaderSource(r,e),i.compileShader(r),r}function th(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function sd(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return th(2*t);case"bvec3":return th(3*t);case"bvec4":return th(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Zr=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],zw={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},$w={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Vw(i,t){var r;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in i.uniforms){const a=t[s];if(!a){(r=i.uniforms[s])!=null&&r.group&&(i.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const h=i.uniforms[s];let l=!1;for(let c=0;c<Zr.length;c++)if(Zr[c].test(a,h)){e.push(Zr[c].code(s,h)),l=!0;break}if(!l){const f=(a.size===1&&!a.isArray?zw:$w)[a.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const od={};let Ur=od;function Yw(){if(Ur===od||Ur!=null&&Ur.isContextLost()){const i=q.ADAPTER.createCanvas();let t;q.PREFER_ENV>=yr.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Ur=t}return Ur}let Us;function jw(){if(!Us){Us=He.MEDIUM;const i=Yw();i&&i.getShaderPrecisionFormat&&(Us=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?He.HIGH:He.MEDIUM)}return Us}function uf(i,t){const e=i.getShaderSource(t).split(`
`).map((f,p)=>`${p}: ${f}`),r=i.getShaderInfoLog(t),s=r.split(`
`),a={},h=s.map(f=>parseFloat(f.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(f=>f&&!a[f]?(a[f]=!0,!0):!1),l=[""];h.forEach(f=>{e[f-1]=`%c${e[f-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=e.join(`
`);l[0]=c,console.error(r),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function qw(i,t,e,r){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||uf(i,e),i.getShaderParameter(r,i.COMPILE_STATUS)||uf(i,r),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const Kw={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function ad(i){return Kw[i]}let ks=null;const cf={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function hd(i,t){if(!ks){const e=Object.keys(cf);ks={};for(let r=0;r<e.length;++r){const s=e[r];ks[i[s]]=cf[s]}}return ks[t]}function ff(i,t,e){if(i.substring(0,9)!=="precision"){let r=t;return t===He.HIGH&&e!==He.HIGH&&(r=He.MEDIUM),`precision ${r} float;
${i}`}else if(e!==He.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let En;function Zw(){if(typeof En=="boolean")return En;try{En=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{En=!1}return En}let Jw=0;const Gs={},Hr=class{constructor(i,t,e="pixi-shader",r={}){this.extra={},this.id=Jw++,this.vertexSrc=i||Hr.defaultVertexSrc,this.fragmentSrc=t||Hr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=r,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),Gs[e]?(Gs[e]++,e+=`-${Gs[e]}`):Gs[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=ff(this.vertexSrc,Hr.defaultVertexPrecision,He.HIGH),this.fragmentSrc=ff(this.fragmentSrc,Hr.defaultFragmentPrecision,jw())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return Ww}static get defaultFragmentSrc(){return Xw}static from(i,t,e){const r=i+t;let s=rf[r];return s||(rf[r]=s=new Hr(i,t,e)),s}};let ti=Hr;ti.defaultVertexPrecision=He.HIGH;ti.defaultFragmentPrecision=Pi.apple.device?He.HIGH:He.MEDIUM;let Qw=0;class ri{constructor(t,e,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Qw++,this.static=!!e,this.ubo=!!r,t instanceof Zt?(this.buffer=t,this.buffer.type=pi.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Zt(new Float32Array(1)),this.buffer.type=pi.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,r){if(!this.ubo)this.uniforms[t]=new ri(e,r);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,r){return new ri(t,e,r)}static uboFrom(t,e){return new ri(t,e??!0,!0)}}class gi{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof ri?this.uniformGroup=e:this.uniformGroup=new ri(e):this.uniformGroup=new ri({}),this.disposeRunner=new ii("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const r in e.uniforms){const s=e.uniforms[r];if(s.group&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,r){const s=ti.from(t,e);return new gi(s,r)}}class tE{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const r=new Int32Array(t);for(let a=0;a<t;a++)r[a]=a;this.defaultGroupCache[t]=ri.from({uSamplers:r},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ti(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Gt,default:this.defaultGroupCache[t]};return new gi(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let r=0;r<t;r++)r>0&&(e+=`
else `),r<t-1&&(e+=`if(vTextureId < ${r}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${r}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Mh{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function eE(){return!Pi.apple.device}function iE(i){let t=!0;const e=q.ADAPTER.getNavigator();if(Pi.tablet||Pi.phone){if(Pi.apple.device){const r=e.userAgent.match(/OS (\d+)_(\d+)?/);r&&parseInt(r[1],10)<11&&(t=!1)}if(Pi.android.device){const r=e.userAgent.match(/Android\s([0-9.]*)/);r&&parseInt(r[1],10)<7&&(t=!1)}}return t?i:4}class vo{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var rE=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,nE=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const qe=class extends vo{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=id,this.vertexSize=6,this.state=Di.for2d(),this.size=qe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??iE(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??eE(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return At("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return nE}static get defaultFragmentTemplate(){return rE}setShaderGenerator({vertex:i=qe.defaultVertexSrc,fragment:t=qe.defaultFragmentTemplate}={}){this.shaderGenerator=new tE(i,t)}contextChange(){const i=this.renderer.gl;q.PREFER_ENV===yr.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),qe.defaultMaxTextures),this.maxTextures=Dw(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=qe,e=this.size/4,r=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new Rh);for(;t.length<r;)t.push(new Mh);for(let s=0;s<this.maxTextures;s++)this._tempBoundTextures[s]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=qe._textureArrayPool,r=this.renderer.batch,s=this._tempBoundTextures,a=this.renderer.textureGC.count;let h=++ft._globalBatch,l=0,c=e[0],f=0;r.copyBoundTextures(s,t);for(let p=0;p<this._bufferSize;++p){const g=i[p];i[p]=null,g._batchEnabled!==h&&(c.count>=t&&(r.boundArray(c,s,h,t),this.buildDrawCalls(c,f,p),f=p,c=e[++l],++h),g._batchEnabled=h,g.touched=a,c.elements[c.count++]=g)}c.count>0&&(r.boundArray(c,s,h,t),this.buildDrawCalls(c,f,this._bufferSize),++l,++h);for(let p=0;p<s.length;p++)s[p]=null;ft._globalBatch=h}buildDrawCalls(i,t,e){const{_bufferedElements:r,_attributeBuffer:s,_indexBuffer:a,vertexSize:h}=this,l=qe._drawCallPool;let c=this._dcIndex,f=this._aIndex,p=this._iIndex,g=l[c];g.start=this._iIndex,g.texArray=i;for(let _=t;_<e;++_){const v=r[_],y=v._texture.baseTexture,A=Kf[y.alphaMode?1:0][v.blendMode];r[_]=null,t<_&&g.blend!==A&&(g.size=p-g.start,t=_,g=l[++c],g.texArray=i,g.start=p),this.packInterleavedGeometry(v,s,a,f,p),f+=v.vertexData.length/2*h,p+=v.indices.length,g.blend=A}t<e&&(g.size=p-g.start,++c),this._dcIndex=c,this._aIndex=f,this._iIndex=p}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;qe.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,r=qe._drawCallPool;let s=null;for(let a=0;a<i;a++){const{texArray:h,type:l,size:c,start:f,blend:p}=r[a];s!==h&&(s=h,this.bindAndClearTexArray(h)),this.state.blendMode=p,e.set(this.state),t.drawElements(l,c,t.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),qe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=ro(Math.ceil(i/8)),e=ef(t),r=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let s=this._aBuffers[r];return s||(this._aBuffers[r]=s=new Ch(r*this.vertexSize*4)),s}getIndexBuffer(i){const t=ro(Math.ceil(i/12)),e=ef(t),r=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let s=this._iBuffers[e];return s||(this._iBuffers[e]=s=new Uint16Array(r)),s}packInterleavedGeometry(i,t,e,r,s){const{uint32View:a,float32View:h}=t,l=r/this.vertexSize,c=i.uvs,f=i.indices,p=i.vertexData,g=i._texture.baseTexture._batchLocation,_=Math.min(i.worldAlpha,1),v=_<1&&i._texture.baseTexture.alphaMode?Zh(i._tintRGB,_):i._tintRGB+(_*255<<24);for(let y=0;y<p.length;y+=2)h[r++]=p[y],h[r++]=p[y+1],h[r++]=c[y],h[r++]=c[y+1],a[r++]=v,h[r++]=g;for(let y=0;y<f.length;y++)e[s++]=l+f[y]}};let Je=qe;Je.defaultBatchSize=4096;Je.extension={name:"batch",type:j.RendererPlugin};Je._drawCallPool=[];Je._textureArrayPool=[];rt.add(Je);var sE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,oE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const In=class extends gi{constructor(i,t,e){const r=ti.from(i||In.defaultVertexSrc,t||In.defaultFragmentSrc);super(r,e),this.padding=0,this.resolution=In.defaultResolution,this.multisample=In.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Di}apply(i,t,e,r,s){i.applyFilter(this,t,e,r)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return oE}static get defaultFragmentSrc(){return sE}};let _e=In;_e.defaultResolution=1;_e.defaultMultisample=te.NONE;class ld{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?Kh(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=qf(t),On(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}ld.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"background"};rt.add(ld);class ud{constructor(t){this.renderer=t,this.emptyRenderer=new vo(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:r}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=r[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,r,s){const{elements:a,ids:h,count:l}=t;let c=0;for(let f=0;f<l;f++){const p=a[f],g=p._batchLocation;if(g>=0&&g<s&&e[g]===p){h[f]=g;continue}for(;c<s;){const _=e[c];if(_&&_._batchEnabled===r&&_._batchLocation===c){c++;continue}h[f]=c,p._batchLocation=c,e[c]=p;break}}}destroy(){this.renderer=null}}ud.extension={type:j.RendererSystem,name:"batch"};rt.add(ud);let df=0;class cd{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=df++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,r=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:r,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=df++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let r;if(q.PREFER_ENV>=yr.WEBGL2&&(r=t.getContext("webgl2",e)),r)this.webGLVersion=2;else if(this.webGLVersion=1,r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!r)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=r||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}cd.extension={type:j.RendererSystem,name:"context"};rt.add(cd);class aE extends Hn{upload(t,e,r){const s=t.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK);const a=e.realWidth,h=e.realHeight;return r.width===a&&r.height===h?s.texSubImage2D(e.target,0,0,0,a,h,e.format,r.type,this.data):(r.width=a,r.height=h,s.texImage2D(e.target,0,r.internalFormat,a,h,0,e.format,r.type,this.data)),!0}}class Dh{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ii("disposeFramebuffer"),this.multisample=te.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new ft(null,{scaleMode:Ri.NEAREST,resolution:1,mipmap:mi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ft(new aE(null,{width:this.width,height:this.height}),{scaleMode:Ri.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:mi.OFF,format:W.DEPTH_COMPONENT,type:st.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){const s=this.colorTextures[r],a=s.resolution;s.setSize(t/a,e/a)}if(this.depthTexture){const r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class fd extends ft{constructor(t={}){if(typeof t=="number"){const e=arguments[0],r=arguments[1],s=arguments[2],a=arguments[3];t={width:e,height:r,scaleMode:s,resolution:a}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=te.NONE),super(null,t),this.mipmap=mi.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Dh(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class qi extends Nn{constructor(t){const e=t,r=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;super(r,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,r){r===void 0&&!e.startsWith("data:")?t.crossOrigin=Rw(e):r!==!1&&(t.crossOrigin=typeof r=="string"?r:"anonymous")}upload(t,e,r,s){const a=t.gl,h=e.realWidth,l=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1&&s.buffered.length===0)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===ni.UNPACK),!this.noSubImage&&e.target===a.TEXTURE_2D&&r.width===h&&r.height===l?a.texSubImage2D(a.TEXTURE_2D,0,0,0,e.format,r.type,s):(r.width=h,r.height=l,a.texImage2D(e.target,0,r.internalFormat,e.format,r.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,r=t.naturalHeight||t.videoHeight||t.height;this.resize(e,r),super.update()}dispose(){this.source=null}}class dd extends qi{constructor(t,e){if(e=e||{},typeof t=="string"){const r=new Image;qi.crossOrigin(r,t,e.crossorigin),r.src=t,t=r}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??q.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,r)=>{const s=this.source;this.url=s.src;const a=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.resize(s.width,s.height),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?a():(s.onload=a,s.onerror=h=>{r(h),this.onError.emit(h)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,r=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:r?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ni.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,r){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,r,this.bitmap),!this.preserveBitmap){let s=!0;const a=e._glTextures;for(const h in a){const l=a[h];if(l!==r&&l.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class pd{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,r){const s=e.width,a=e.height;if(r){const h=t.width/2/s,l=t.height/2/a,c=t.x/s+h,f=t.y/a+l;r=Xt.add(r,Xt.NW),this.x0=c+h*Xt.uX(r),this.y0=f+l*Xt.uY(r),r=Xt.add(r,2),this.x1=c+h*Xt.uX(r),this.y1=f+l*Xt.uY(r),r=Xt.add(r,2),this.x2=c+h*Xt.uX(r),this.y2=f+l*Xt.uY(r),r=Xt.add(r,2),this.x3=c+h*Xt.uX(r),this.y3=f+l*Xt.uY(r)}else this.x0=t.x/s,this.y0=t.y/a,this.x1=(t.x+t.width)/s,this.y1=t.y/a,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/a,this.x3=t.x/s,this.y3=(t.y+t.height)/a;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const pf=new pd;function Hs(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class it extends Gn{constructor(t,e,r,s,a,h){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Tt(0,0,1,1)),t instanceof it&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this._uvs=pf,this.uvMatrix=null,this.orig=r||e,this._rotate=Number(a||0),a===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=h?new Et(h.x,h.y):new Et(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&ui[e.url]&&it.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,it.removeFromCache(this),this.textureCacheIds=null}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),r=new it(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(r._frame=t),r}updateUvs(){this._uvs===pf&&(this._uvs=new pd),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},r=q.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let a=null;if(s)a=t;else if(t instanceof ft){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${vr()}`,ft.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${vr()}`}a=t._pixiId}let h=ui[a];if(s&&r&&!h)throw new Error(`The cacheId "${a}" does not exist in TextureCache.`);return!h&&!(t instanceof ft)?(e.resolution||(e.resolution=Yi(t)),h=new it(new ft(t,e)),h.baseTexture.cacheId=a,ft.addToCache(h.baseTexture,a),it.addToCache(h,a)):!h&&t instanceof ft&&(h=new it(t),it.addToCache(h,a)),h}static fromURL(t,e){const r=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=it.from(t,Object.assign({resourceOptions:r},e),!1),a=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):a.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,r,s){return new it(ft.fromBuffer(t,e,r,s))}static fromLoader(t,e,r,s){const a=new ft(t,Object.assign({scaleMode:q.SCALE_MODE,resolution:Yi(e)},s)),{resource:h}=a;h instanceof dd&&(h.url=e);const l=new it(a);return r||(r=e),ft.addToCache(l.baseTexture,r),it.addToCache(l,r),r!==e&&(ft.addToCache(l.baseTexture,e),it.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(c=>{l.baseTexture.once("loaded",()=>c(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ui[e]&&ui[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),ui[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=ui[t];if(e){const r=e.textureCacheIds.indexOf(t);return r>-1&&e.textureCacheIds.splice(r,1),delete ui[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)ui[t.textureCacheIds[e]]===t&&delete ui[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:r,width:s,height:a}=t,h=e+s>this.baseTexture.width,l=r+a>this.baseTexture.height;if(h||l){const c=h&&l?"and":"or",f=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,p=`Y: ${r} + ${a} = ${r+a} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${f} ${c} ${p}`)}this.valid=s&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return it._EMPTY||(it._EMPTY=new it(new ft),Hs(it._EMPTY),Hs(it._EMPTY.baseTexture)),it._EMPTY}static get WHITE(){if(!it._WHITE){const t=q.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),it._WHITE=new it(ft.from(t)),Hs(it._WHITE),Hs(it._WHITE.baseTexture)}return it._WHITE}}class Ki extends it{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,r=!0){const s=this.baseTexture.resolution,a=Math.round(t*s)/s,h=Math.round(e*s)/s;this.valid=a>0&&h>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=h,r&&this.baseTexture.resize(a,h),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Ki(new fd(t))}}class gd{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,r=te.NONE){const s=new fd(Object.assign({width:t,height:e,resolution:1,multisample:r},this.textureOptions));return new Ki(s)}getOptimalTexture(t,e,r=1,s=te.NONE){let a;t=Math.ceil(t*r-1e-6),e=Math.ceil(e*r-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=ro(t),e=ro(e),a=((t&65535)<<16|e&65535)>>>0,s>1&&(a+=s*4294967296)):a=s>1?-s:-1,this.texturePool[a]||(this.texturePool[a]=[]);let h=this.texturePool[a].pop();return h||(h=this.createTexture(t,e,s)),h.filterPoolKey=a,h.setResolution(r),h}getFilterTexture(t,e,r){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,r||te.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const r=this.texturePool[e];if(r)for(let s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}gd.SCREEN_KEY=-1;class hE extends ji{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class md extends ji{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Zt(this.vertices),this.uvBuffer=new Zt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let r=0,s=0;return this.uvs[0]=r,this.uvs[1]=s,this.uvs[2]=r+e.width/t.width,this.uvs[3]=s,this.uvs[4]=r+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=r,this.uvs[7]=s+e.height/t.height,r=e.x,s=e.y,this.vertices[0]=r,this.vertices[1]=s,this.vertices[2]=r+e.width,this.vertices[3]=s,this.vertices[4]=r+e.width,this.vertices[5]=s+e.height,this.vertices[6]=r,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class lE{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=te.NONE,this.sourceFrame=new Tt,this.destinationFrame=new Tt,this.bindingSourceFrame=new Tt,this.bindingDestinationFrame=new Tt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Xs=[new Et,new Et,new Et,new Et],eh=new Gt;class _d{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new gd,this.statePool=[],this.quad=new hE,this.quadUv=new md,this.tempRect=new Tt,this.activeState={},this.globalUniforms=new ri({outputFrame:new Tt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const r=this.renderer,s=this.defaultFilterStack,a=this.statePool.pop()||new lE,h=this.renderer.renderTexture;let l=e[0].resolution,c=e[0].multisample,f=e[0].padding,p=e[0].autoFit,g=e[0].legacy??!0;for(let y=1;y<e.length;y++){const A=e[y];l=Math.min(l,A.resolution),c=Math.min(c,A.multisample),f=this.useMaxPadding?Math.max(f,A.padding):f+A.padding,p=p&&A.autoFit,g=g||(A.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),s.push(a),a.resolution=l,a.multisample=c,a.legacy=g,a.target=t,a.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),a.sourceFrame.pad(f);const _=this.tempRect.copyFrom(h.sourceFrame);r.projection.transform&&this.transformAABB(eh.copyFrom(r.projection.transform).invert(),_),p?(a.sourceFrame.fit(_),(a.sourceFrame.width<=0||a.sourceFrame.height<=0)&&(a.sourceFrame.width=0,a.sourceFrame.height=0)):a.sourceFrame.intersects(_)||(a.sourceFrame.width=0,a.sourceFrame.height=0),this.roundFrame(a.sourceFrame,h.current?h.current.resolution:r.resolution,h.sourceFrame,h.destinationFrame,r.projection.transform),a.renderTexture=this.getOptimalFilterTexture(a.sourceFrame.width,a.sourceFrame.height,l,c),a.filters=e,a.destinationFrame.width=a.renderTexture.width,a.destinationFrame.height=a.renderTexture.height;const v=this.tempRect;v.x=0,v.y=0,v.width=a.sourceFrame.width,v.height=a.sourceFrame.height,a.renderTexture.filterFrame=a.sourceFrame,a.bindingSourceFrame.copyFrom(h.sourceFrame),a.bindingDestinationFrame.copyFrom(h.destinationFrame),a.transform=r.projection.transform,r.projection.transform=null,h.bind(a.renderTexture,a.sourceFrame,v),r.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),r=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const a=s.inputSize,h=s.inputPixel,l=s.inputClamp;if(a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=1/a[0],a[3]=1/a[1],h[0]=Math.round(a[0]*e.resolution),h[1]=Math.round(a[1]*e.resolution),h[2]=1/h[0],h[3]=1/h[1],l[0]=.5*h[2],l[1]=.5*h[3],l[2]=e.sourceFrame.width*a[2]-.5*h[2],l[3]=e.sourceFrame.height*a[3]-.5*h[3],e.legacy){const f=s.filterArea;f[0]=e.destinationFrame.width,f[1]=e.destinationFrame.height,f[2]=e.sourceFrame.x,f[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const c=t[t.length-1];if(this.renderer.framebuffer.blit(),r.length===1)r[0].apply(this,e.renderTexture,c.renderTexture,ci.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let f=e.renderTexture,p=this.getOptimalFilterTexture(f.width,f.height,e.resolution);p.filterFrame=f.filterFrame;let g=0;for(g=0;g<r.length-1;++g){g===1&&e.multisample>1&&(p=this.getOptimalFilterTexture(f.width,f.height,e.resolution),p.filterFrame=f.filterFrame),r[g].apply(this,f,p,ci.CLEAR,e);const _=f;f=p,p=_}r[g].apply(this,f,c.renderTexture,ci.BLEND,e),g>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(f),this.returnFilterTexture(p)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=ci.CLEAR){const{renderTexture:r,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const h=this.tempRect;h.x=0,h.y=0,h.width=t.filterFrame.width,h.height=t.filterFrame.height,r.bind(t,t.filterFrame,h)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const a=s.stateId&1||this.forceClear;(e===ci.CLEAR||e===ci.BLIT&&a)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,r,s){const a=this.renderer;a.state.set(t.state),this.bindAndClear(r,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,a.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),a.geometry.bind(this.quadUv),a.geometry.draw(di.TRIANGLES)):(a.geometry.bind(this.quad),a.geometry.draw(di.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:r,destinationFrame:s}=this.activeState,{orig:a}=e._texture,h=t.set(s.width,0,0,s.height,r.x,r.y),l=e.worldTransform.copyTo(Gt.TEMP_MATRIX);return l.invert(),h.prepend(l),h.scale(1/a.width,1/a.height),h.translate(e.anchor.x,e.anchor.y),h}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,r=1,s=te.NONE){return this.texturePool.getOptimalTexture(t,e,r,s)}getFilterTexture(t,e,r){if(typeof t=="number"){const a=t;t=e,e=a}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,r||te.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const r=Xs[0],s=Xs[1],a=Xs[2],h=Xs[3];r.set(e.left,e.top),s.set(e.left,e.bottom),a.set(e.right,e.top),h.set(e.right,e.bottom),t.apply(r,r),t.apply(s,s),t.apply(a,a),t.apply(h,h);const l=Math.min(r.x,s.x,a.x,h.x),c=Math.min(r.y,s.y,a.y,h.y),f=Math.max(r.x,s.x,a.x,h.x),p=Math.max(r.y,s.y,a.y,h.y);e.x=l,e.y=c,e.width=f-l,e.height=p-c}roundFrame(t,e,r,s,a){if(!(t.width<=0||t.height<=0||r.width<=0||r.height<=0)){if(a){const{a:h,b:l,c,d:f}=a;if((Math.abs(l)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(h)>1e-4||Math.abs(f)>1e-4))return}a=a?eh.copyFrom(a):eh.identity(),a.translate(-r.x,-r.y).scale(s.width/r.width,s.height/r.height).translate(s.x,s.y),this.transformAABB(a,t),t.ceil(e),this.transformAABB(a.invert(),t)}}}_d.extension={type:j.RendererSystem,name:"filter"};rt.add(_d);class uE{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=te.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const cE=new Tt;class vd{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Dh(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Tt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;q.PREFER_ENV===yr.WEBGL_LEGACY&&(e=null,r=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,r=0){const{gl:s}=this;if(t){const a=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,a.framebuffer)),a.mipLevel!==r&&(t.dirtyId++,t.dirtyFormat++,a.mipLevel=r),a.dirtyId!==t.dirtyId&&(a.dirtyId=t.dirtyId,a.dirtyFormat!==t.dirtyFormat?(a.dirtyFormat=t.dirtyFormat,a.dirtySize=t.dirtySize,this.updateFramebuffer(t,r)):a.dirtySize!==t.dirtySize&&(a.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let h=0;h<t.colorTextures.length;h++){const l=t.colorTextures[h];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const h=e.width>>r,l=e.height>>r,c=h/e.width;this.setViewport(e.x*c,e.y*c,h,l)}else{const h=t.width>>r,l=t.height>>r;this.setViewport(0,0,h,l)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,r,s){const a=this.viewport;t=Math.round(t),e=Math.round(e),r=Math.round(r),s=Math.round(s),(a.width!==r||a.height!==s||a.x!==t||a.y!==e)&&(a.x=t,a.y=e,a.width=r,a.height=s,this.gl.viewport(t,e,r,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,r,s,a=mh.COLOR|mh.DEPTH){const{gl:h}=this;h.clearColor(t,e,r,s),h.clear(a)}initFramebuffer(t){const{gl:e}=this,r=new uE(e.createFramebuffer());return r.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(t),t.disposeRunner.add(this),r}resizeFramebuffer(t){const{gl:e}=this,r=t.glFramebuffers[this.CONTEXT_UID];r.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,r.stencil),r.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const s=t.colorTextures;let a=s.length;e.drawBuffers||(a=Math.min(a,1));for(let h=0;h<a;h++){const l=s[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&r.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,r.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:r}=this,s=t.glFramebuffers[this.CONTEXT_UID],a=t.colorTextures;let h=a.length;r.drawBuffers||(h=Math.min(h,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||r.createRenderbuffer():s.msaaBuffer&&(r.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const l=[];for(let c=0;c<h;c++){const f=a[c],p=f.parentTextureArray||f;this.renderer.texture.bind(p,0),c===0&&s.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,s.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,p._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,s.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+c,f.target,p._glTextures[this.CONTEXT_UID].texture,e),l.push(r.COLOR_ATTACHMENT0+c))}if(l.length>1&&r.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const f=t.depthTexture;this.renderer.texture.bind(f,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(s.stencil=s.stencil||r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,s.stencil),s.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,s.multisample,r.DEPTH24_STENCIL8,t.width,t.height):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t.width,t.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,s.stencil)):s.stencil&&(r.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let r=te.NONE;if(t<=1||e===null)return r;for(let s=0;s<e.length;s++)if(e[s]<=t){r=e[s];break}return r===1&&(r=te.NONE),r}blit(t,e,r){const{current:s,renderer:a,gl:h,CONTEXT_UID:l}=this;if(a.context.webGLVersion!==2||!s)return;const c=s.glFramebuffers[l];if(!c)return;if(!t){if(!c.msaaBuffer)return;const p=s.colorTextures[0];if(!p)return;c.blitFramebuffer||(c.blitFramebuffer=new Dh(s.width,s.height),c.blitFramebuffer.addColorTexture(0,p)),t=c.blitFramebuffer,t.colorTextures[0]!==p&&(t.colorTextures[0]=p,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=cE,e.width=s.width,e.height=s.height),r||(r=e);const f=e.width===r.width&&e.height===r.height;this.bind(t),h.bindFramebuffer(h.READ_FRAMEBUFFER,c.framebuffer),h.blitFramebuffer(e.left,e.top,e.right,e.bottom,r.left,r.top,r.right,r.bottom,h.COLOR_BUFFER_BIT,f?h.NEAREST:h.LINEAR)}disposeFramebuffer(t,e){const r=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!r)return;delete t.glFramebuffers[this.CONTEXT_UID];const a=this.managedFramebuffers.indexOf(t);a>=0&&this.managedFramebuffers.splice(a,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&s.deleteRenderbuffer(r.msaaBuffer),r.stencil&&s.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&r.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<e.length;r++)this.disposeFramebuffer(e[r],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const r=t.width,s=t.height,a=this.gl,h=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,h),e.msaaBuffer?a.renderbufferStorageMultisample(a.RENDERBUFFER,e.multisample,a.DEPTH24_STENCIL8,r,s):a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,r,s),e.stencil=h,a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,h)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Tt}destroy(){this.renderer=null}}vd.extension={type:j.RendererSystem,name:"framebuffer"};rt.add(vd);const ih={5126:4,5123:2,5121:1};class xd{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let r=this.renderer.context.extensions.vertexArrayObject;q.PREFER_ENV===yr.WEBGL_LEGACY&&(r=null),r?(t.createVertexArray=()=>r.createVertexArrayOES(),t.bindVertexArray=s=>r.bindVertexArrayOES(s),t.deleteVertexArray=s=>r.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=(s,a)=>r.vertexAttribDivisorANGLE(s,a),t.drawElementsInstanced=(s,a,h,l,c)=>r.drawElementsInstancedANGLE(s,a,h,l,c),t.drawArraysInstanced=(s,a,h,l)=>r.drawArraysInstancedANGLE(s,a,h,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:r}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],a=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},a=!0);const h=s[e.program.id]||this.initGeometryVao(t,e,a);this._activeGeometry=t,this._activeVao!==h&&(this._activeVao=h,this.hasVao?r.bindVertexArray(h):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let r=0;r<t.buffers.length;r++){const s=t.buffers[r];e.update(s)}}checkCompatibility(t,e){const r=t.attributes,s=e.attributeData;for(const a in s)if(!r[a])throw new Error(`shader and geometry incompatible, geometry missing the "${a}" attribute`)}getSignature(t,e){const r=t.attributes,s=e.attributeData,a=["g",t.id];for(const h in r)s[h]&&a.push(h,s[h].location);return a.join("-")}initGeometryVao(t,e,r=!0){const s=this.gl,a=this.CONTEXT_UID,h=this.renderer.buffer,l=e.program;l.glPrograms[a]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const c=this.getSignature(t,l),f=t.glVertexArrayObjects[this.CONTEXT_UID];let p=f[c];if(p)return f[l.id]=p,p;const g=t.buffers,_=t.attributes,v={},y={};for(const A in g)v[A]=0,y[A]=0;for(const A in _)!_[A].size&&l.attributeData[A]?_[A].size=l.attributeData[A].size:_[A].size||console.warn(`PIXI Geometry attribute '${A}' size cannot be determined (likely the bound shader does not have the attribute)`),v[_[A].buffer]+=_[A].size*ih[_[A].type];for(const A in _){const w=_[A],R=w.size;w.stride===void 0&&(v[w.buffer]===R*ih[w.type]?w.stride=0:w.stride=v[w.buffer]),w.start===void 0&&(w.start=y[w.buffer],y[w.buffer]+=R*ih[w.type])}p=s.createVertexArray(),s.bindVertexArray(p);for(let A=0;A<g.length;A++){const w=g[A];h.bind(w),r&&w._glBuffers[a].refCount++}return this.activateVao(t,l),f[l.id]=p,f[c]=p,s.bindVertexArray(null),h.unbind(pi.ARRAY_BUFFER),p}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const r=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,a=t.buffers,h=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!r){if(h)for(let c=0;c<a.length;c++){const f=a[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!e&&h.dispose(a[c],e))}if(!e){for(const c in r)if(c[0]==="g"){const f=r[c];this._activeVao===f&&this.unbind(),s.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let r=0;r<e.length;r++)this.disposeGeometry(this.managedGeometries[e[r]],t)}activateVao(t,e){const r=this.gl,s=this.CONTEXT_UID,a=this.renderer.buffer,h=t.buffers,l=t.attributes;t.indexBuffer&&a.bind(t.indexBuffer);let c=null;for(const f in l){const p=l[f],g=h[p.buffer],_=g._glBuffers[s];if(e.attributeData[f]){c!==_&&(a.bind(g),c=_);const v=e.attributeData[f].location;if(r.enableVertexAttribArray(v),r.vertexAttribPointer(v,p.size,p.type||r.FLOAT,p.normalized,p.stride,p.start),p.instance)if(this.hasInstance)r.vertexAttribDivisor(v,p.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,r,s){const{gl:a}=this,h=this._activeGeometry;if(h.indexBuffer){const l=h.indexBuffer.data.BYTES_PER_ELEMENT,c=l===2?a.UNSIGNED_SHORT:a.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?h.instanced?a.drawElementsInstanced(t,e||h.indexBuffer.data.length,c,(r||0)*l,s||1):a.drawElements(t,e||h.indexBuffer.data.length,c,(r||0)*l):console.warn("unsupported index buffer type: uint32")}else h.instanced?a.drawArraysInstanced(t,r,e||h.getSize(),s||1):a.drawArrays(t,r,e||h.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}xd.extension={type:j.RendererSystem,name:"geometry"};rt.add(xd);const gf=new Gt;class yd{constructor(t,e){this._texture=t,this.mapCoord=new Gt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let s=0;s<t.length;s+=2){const a=t[s],h=t[s+1];e[s]=a*r.a+h*r.c+r.tx,e[s+1]=a*r.b+h*r.d+r.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const r=e._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);const s=e.orig,a=e.trim;a&&(gf.set(s.width/a.width,0,0,s.height/a.height,-a.x/a.width,-a.y/a.height),this.mapCoord.append(gf));const h=e.baseTexture,l=this.uClampFrame,c=this.clampMargin/h.resolution,f=this.clampOffset;return l[0]=(e._frame.x+c+f)/h.width,l[1]=(e._frame.y+c+f)/h.height,l[2]=(e._frame.x+e._frame.width-c+f)/h.width,l[3]=(e._frame.y+e._frame.height-c+f)/h.height,this.uClampOffset[0]=f/h.realWidth,this.uClampOffset[1]=f/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0}}var fE=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,dE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class pE extends _e{constructor(t,e,r){let s=null;typeof t!="string"&&e===void 0&&r===void 0&&(s=t,t=void 0,e=void 0,r=void 0),super(t||dE,e||fE,r),this.maskSprite=s,this.maskMatrix=new Gt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,r,s){const a=this._maskSprite,h=a._texture;h.valid&&(h.uvMatrix||(h.uvMatrix=new yd(h,0)),h.uvMatrix.update(),this.uniforms.npmAlpha=h.baseTexture.alphaMode?0:1,this.uniforms.mask=h,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,a).prepend(h.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=h.uvMatrix.uClampFrame,t.applyFilter(this,e,r,s))}}class gE{constructor(t=null){this.type=ne.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=q.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=ne.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class bd{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let r=e;if(!r.isMaskData){const a=this.maskDataPool.pop()||new gE;a.pooled=!0,a.maskObject=e,r=a}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(s),r._colorMask=s?s._colorMask:15,r.autoDetect&&this.detect(r),r._target=t,r.type!==ne.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case ne.SCISSOR:this.renderer.scissor.push(r);break;case ne.STENCIL:this.renderer.stencil.push(r);break;case ne.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case ne.COLOR:this.pushColorMask(r);break}r.type===ne.SPRITE&&this.maskStack.push(r)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case ne.SCISSOR:this.renderer.scissor.pop(e);break;case ne.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case ne.SPRITE:this.popSpriteMask(e);break;case ne.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const r=this.maskStack[this.maskStack.length-1];r.type===ne.SPRITE&&r._filters&&(r._filters[0].maskSprite=r.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=ne.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=ne.SCISSOR:t.type=ne.STENCIL:t.type=ne.COLOR}pushSpriteMask(t){const{maskObject:e}=t,r=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new pE]));const a=this.renderer,h=a.renderTexture;let l,c;if(h.current){const p=h.current;l=t.resolution||p.resolution,c=t.multisample??p.multisample}else l=t.resolution||a.resolution,c=t.multisample??a.multisample;s[0].resolution=l,s[0].multisample=c,s[0].maskSprite=e;const f=r.filterArea;r.filterArea=e.getBounds(!0),a.filter.push(r,s),r.filterArea=f,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,r=t._colorMask=e&t.colorMask;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}popColorMask(t){const e=t._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==e&&this.renderer.gl.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)}destroy(){this.renderer=null}}bd.extension={type:j.RendererSystem,name:"mask"};rt.add(bd);class Td{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,r=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==r&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const mf=new Gt,_f=[],Zs=class extends Td{constructor(i){super(i),this.glConst=q.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:r}=this,s=r.renderTexture,a=e.getBounds(!0,_f.pop()??new Tt);this.roundFrameToPixels(a,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),t&&a.fit(t),i._scissorRectLocal=a}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:r,d:s}=i;return(Math.abs(e)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(s)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||Zs.isMatrixRotated(t.worldTransform)||Zs.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,r,s){Zs.isMatrixRotated(s)||(s=s?mf.copyFrom(s):mf.identity(),s.translate(-e.x,-e.y).scale(r.width/e.width,r.height/e.height).translate(r.x,r.y),this.renderer.filter.transformAABB(s,i),i.fit(r),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&_f.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let wd=Zs;wd.extension={type:j.RendererSystem,name:"scissor"};rt.add(wd);class Ed extends Td{constructor(t){super(t),this.glConst=q.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:r}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),t._stencilCounter++;const a=t._colorMask;a!==0&&(t._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,s,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,a!==0&&(t._colorMask=a,r.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=r?r._colorMask:15;s!==0&&(r._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(r._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Ed.extension={type:j.RendererSystem,name:"stencil"};rt.add(Ed);class Ad{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return At("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Ad.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_plugin"};rt.add(Ad);class Sd{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Gt,this.transform=null}update(t,e,r,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,s),this.transform&&this.projectionMatrix.append(this.transform);const a=this.renderer;a.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,a.globalUniforms.update(),a.shader.shader&&a.shader.syncUniformGroup(a.shader.shader.uniforms.globals)}calculateProjection(t,e,r,s){const a=this.projectionMatrix,h=s?-1:1;a.identity(),a.a=1/e.width*2,a.d=h*(1/e.height*2),a.tx=-1-e.x*a.a,a.ty=-h-e.y*a.d}setTransform(t){}destroy(){this.renderer=null}}Sd.extension={type:j.RendererSystem,name:"projection"};rt.add(Sd);const mE=new el;class Cd{constructor(t){this.renderer=t,this._tempMatrix=new Gt}generateTexture(t,e){const{region:r,...s}=e||{},a=r||t.getLocalBounds(null,!0);a.width===0&&(a.width=1),a.height===0&&(a.height=1);const h=Ki.create({width:a.width,height:a.height,...s});this._tempMatrix.tx=-a.x,this._tempMatrix.ty=-a.y;const l=t.transform;return t.transform=mE,this.renderer.render(t,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,h}destroy(){}}Cd.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"textureGenerator"};rt.add(Cd);const ar=new Tt,An=new Tt;class Id{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Tt,this.destinationFrame=new Tt,this.viewportFrame=new Tt}bind(t=null,e,r){const s=this.renderer;this.current=t;let a,h,l;t?(a=t.baseTexture,l=a.resolution,e||(ar.width=t.frame.width,ar.height=t.frame.height,e=ar),r||(An.x=t.frame.x,An.y=t.frame.y,An.width=e.width,An.height=e.height,r=An),h=a.framebuffer):(l=s.resolution,e||(ar.width=s._view.screen.width,ar.height=s._view.screen.height,e=ar),r||(r=ar,r.width=e.width,r.height=e.height));const c=this.viewportFrame;c.x=r.x*l,c.y=r.y*l,c.width=r.width*l,c.height=r.height*l,t||(c.y=s.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(h,c),this.renderer.projection.update(r,e,l,!h),t?this.renderer.mask.setMaskStack(a.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(r)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const r=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,a=r.width!==s.width||r.height!==s.height;if(a){let{x:h,y:l,width:c,height:f}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,f)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Id.extension={type:j.RendererSystem,name:"renderTexture"};rt.add(Id);class _E{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function vE(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s++){const a=t.getActiveAttrib(i,s);if(a.name.startsWith("gl_"))continue;const h=hd(t,a.type),l={type:h,name:a.name,size:ad(h),location:t.getAttribLocation(i,a.name)};e[a.name]=l}return e}function xE(i,t){const e={},r=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let s=0;s<r;s++){const a=t.getActiveUniform(i,s),h=a.name.replace(/\[.*?\]$/,""),l=!!a.name.match(/\[.*?\]$/),c=hd(t,a.type);e[h]={name:h,index:s,type:c,size:a.size,isArray:l,value:sd(c,a.size)}}return e}function yE(i,t){var c;const e=lf(i,i.VERTEX_SHADER,t.vertexSrc),r=lf(i,i.FRAGMENT_SHADER,t.fragmentSrc),s=i.createProgram();i.attachShader(s,e),i.attachShader(s,r);const a=(c=t.extra)==null?void 0:c.transformFeedbackVaryings;if(a&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(s,a.names,a.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(s),i.getProgramParameter(s,i.LINK_STATUS)||qw(i,s,e,r),t.attributeData=vE(s,i),t.uniformData=xE(s,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const f=Object.keys(t.attributeData);f.sort((p,g)=>p>g?1:-1);for(let p=0;p<f.length;p++)t.attributeData[f[p]].location=p,i.bindAttribLocation(s,p,f[p]);i.linkProgram(s)}i.deleteShader(e),i.deleteShader(r);const h={};for(const f in t.uniformData){const p=t.uniformData[f];h[f]={location:i.getUniformLocation(s,f),value:sd(p.type,p.size)}}return new _E(s,h)}function bE(i,t,e,r,s){e.buffer.update(s)}const TE={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Rd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function wE(i){const t=i.map(a=>({data:a,offset:0,dataLen:0,dirty:0}));let e=0,r=0,s=0;for(let a=0;a<t.length;a++){const h=t[a];if(e=Rd[h.data.type],h.data.size>1&&(e=Math.max(e,16)*h.data.size),h.dataLen=e,r%e!==0&&r<16){const l=r%e%16;r+=l,s+=l}r+e>16?(s=Math.ceil(s/16)*16,h.offset=s,s+=e,r=e):(h.offset=s,r+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function EE(i,t){const e=[];for(const r in i)t[r]&&e.push(t[r]);return e.sort((r,s)=>r.index-s.index),e}function AE(i,t){if(!i.autoManage)return{size:0,syncFunc:bE};const e=EE(i.uniforms,t),{uboElements:r,size:s}=wE(e),a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let h=0;h<r.length;h++){const l=r[h],c=i.uniforms[l.data.name],f=l.data.name;let p=!1;for(let g=0;g<Zr.length;g++){const _=Zr[g];if(_.codeUbo&&_.test(l.data,c)){a.push(`offset = ${l.offset/4};`,Zr[g].codeUbo(l.data.name,c)),p=!0;break}}if(!p)if(l.data.size>1){const g=ad(l.data.type),_=Math.max(Rd[l.data.type]/16,1),v=g/_,y=(4-v%4)%4;a.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*_}; i++)
                {
                    for(var j = 0; j < ${v}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${y};
                }

                `)}else{const g=TE[l.data.type];a.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};
                ${g};
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}let SE=0;const Ws={textureCount:0,uboCount:0};class Pd{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=SE++}systemCheck(){if(!Zw())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const r=t.program,s=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==r&&(this.program=r,this.gl.useProgram(s.program)),e||(Ws.textureCount=0,Ws.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ws)),s}setUniforms(t){const e=this.shader.program,r=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(r.uniformData,t,this.renderer)}syncUniformGroup(t,e){const r=this.getGlProgram();(!t.static||t.dirtyId!==r.uniformDirtyGroups[t.id])&&(r.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,r,e))}syncUniforms(t,e,r){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,r)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=Vw(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const r=this.getGlProgram();if(!t.static||t.dirtyId!==0||!r.uniformGroups[t.id]){t.dirtyId=0;const s=r.uniformGroups[t.id]||this.createSyncBufferGroup(t,r,e);t.buffer.update(),s(r.uniformData,t.uniforms,this.renderer,Ws,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,r.uniformBufferBindings[e])}createSyncBufferGroup(t,e,r){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const a=this.gl.getUniformBlockIndex(e.program,r);e.uniformBufferBindings[r]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,a,this.shader.uniformBindCount),this.shader.uniformBindCount++;const h=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[h];if(l||(l=this._uboCache[h]=AE(t,this.shader.program.uniformData)),t.autoManage){const c=new Float32Array(l.size/4);t.buffer.update(c)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,r){const s=t.uniforms,a=[`${r}-`];for(const h in s)a.push(h),e[h]&&a.push(e[h].type);return a.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,r=t.program,s=yE(e,r);return r.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Pd.extension={type:j.RendererSystem,name:"shader"};rt.add(Pd);class Md{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}Md.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"startup"};rt.add(Md);function CE(i,t=[]){return t[lt.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD]=[i.ONE,i.ONE],t[lt.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.NONE]=[0,0],t[lt.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[lt.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[lt.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[lt.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[lt.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[lt.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[lt.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const IE=0,RE=1,PE=2,ME=3,DE=4,BE=5,Bh=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=lt.NONE,this._blendEq=!1,this.map=[],this.map[IE]=this.setBlend,this.map[RE]=this.setOffset,this.map[PE]=this.setCullFace,this.map[ME]=this.setDepthTest,this.map[DE]=this.setFrontFace,this.map[BE]=this.setDepthMask,this.checks=[],this.defaultState=new Di,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=CE(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(Bh.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(Bh.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Dd=Bh;Dd.extension={type:j.RendererSystem,name:"state"};rt.add(Dd);class FE extends Gn{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),r=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of r)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new ii(e)})}addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const s in this.runners)this.runners[s].add(r);return this}emitWithCustomOptions(t,e){const r=Object.keys(this._systemsHash);t.items.forEach(s=>{const a=r.find(h=>this._systemsHash[h]===s);s[t.name](e[a])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Js=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=Js.defaultMaxIdle,this.checkCountMax=Js.defaultCheckCountMax,this.mode=Js.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==jh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let r=0;r<t.length;r++){const s=t[r];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(i.destroyTexture(s,!0),t[r]=null,e=!0)}if(e){let r=0;for(let s=0;s<t.length;s++)t[s]!==null&&(t[r++]=t[s]);t.length=r}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let r=i.children.length-1;r>=0;r--)this.unload(i.children[r])}destroy(){this.renderer=null}};let Qe=Js;Qe.defaultMode=jh.AUTO;Qe.defaultMaxIdle=60*60;Qe.defaultCheckCountMax=60*10;Qe.extension={type:j.RendererSystem,name:"textureGC"};rt.add(Qe);class rh{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=st.UNSIGNED_BYTE,this.internalFormat=W.RGBA,this.samplerType=0}}function LE(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[st.UNSIGNED_BYTE]:{[W.RGBA]:i.RGBA8,[W.RGB]:i.RGB8,[W.RG]:i.RG8,[W.RED]:i.R8,[W.RGBA_INTEGER]:i.RGBA8UI,[W.RGB_INTEGER]:i.RGB8UI,[W.RG_INTEGER]:i.RG8UI,[W.RED_INTEGER]:i.R8UI,[W.ALPHA]:i.ALPHA,[W.LUMINANCE]:i.LUMINANCE,[W.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.BYTE]:{[W.RGBA]:i.RGBA8_SNORM,[W.RGB]:i.RGB8_SNORM,[W.RG]:i.RG8_SNORM,[W.RED]:i.R8_SNORM,[W.RGBA_INTEGER]:i.RGBA8I,[W.RGB_INTEGER]:i.RGB8I,[W.RG_INTEGER]:i.RG8I,[W.RED_INTEGER]:i.R8I},[st.UNSIGNED_SHORT]:{[W.RGBA_INTEGER]:i.RGBA16UI,[W.RGB_INTEGER]:i.RGB16UI,[W.RG_INTEGER]:i.RG16UI,[W.RED_INTEGER]:i.R16UI,[W.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[st.SHORT]:{[W.RGBA_INTEGER]:i.RGBA16I,[W.RGB_INTEGER]:i.RGB16I,[W.RG_INTEGER]:i.RG16I,[W.RED_INTEGER]:i.R16I},[st.UNSIGNED_INT]:{[W.RGBA_INTEGER]:i.RGBA32UI,[W.RGB_INTEGER]:i.RGB32UI,[W.RG_INTEGER]:i.RG32UI,[W.RED_INTEGER]:i.R32UI,[W.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[st.INT]:{[W.RGBA_INTEGER]:i.RGBA32I,[W.RGB_INTEGER]:i.RGB32I,[W.RG_INTEGER]:i.RG32I,[W.RED_INTEGER]:i.R32I},[st.FLOAT]:{[W.RGBA]:i.RGBA32F,[W.RGB]:i.RGB32F,[W.RG]:i.RG32F,[W.RED]:i.R32F,[W.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[st.HALF_FLOAT]:{[W.RGBA]:i.RGBA16F,[W.RGB]:i.RGB16F,[W.RG]:i.RG16F,[W.RED]:i.R16F},[st.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:i.RGB565},[st.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:i.RGBA4},[st.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:i.RGB5_A1},[st.UNSIGNED_INT_2_10_10_10_REV]:{[W.RGBA]:i.RGB10_A2,[W.RGBA_INTEGER]:i.RGB10_A2UI},[st.UNSIGNED_INT_10F_11F_11F_REV]:{[W.RGB]:i.R11F_G11F_B10F},[st.UNSIGNED_INT_5_9_9_9_REV]:{[W.RGB]:i.RGB9_E5},[st.UNSIGNED_INT_24_8]:{[W.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[st.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[W.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[st.UNSIGNED_BYTE]:{[W.RGBA]:i.RGBA,[W.RGB]:i.RGB,[W.ALPHA]:i.ALPHA,[W.LUMINANCE]:i.LUMINANCE,[W.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.UNSIGNED_SHORT_5_6_5]:{[W.RGB]:i.RGB},[st.UNSIGNED_SHORT_4_4_4_4]:{[W.RGBA]:i.RGBA},[st.UNSIGNED_SHORT_5_5_5_1]:{[W.RGBA]:i.RGBA}},t}class Bd{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ft,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=LE(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const r=new rh(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new rh(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:r}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,r.activeTexture(r.TEXTURE0+e)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<r.length;s++)r[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<r.length;s++)r[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),r[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:r,CONTEXT_UID:s}=this;if(r)for(let a=t-1;a>=0;--a){const h=e[a];h&&h._glTextures[s].samplerType!==_h.FLOAT&&this.renderer.texture.unbind(h)}}initTexture(t){const e=new rh(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var r;e.internalFormat=((r=this.internalFormats[t.type])==null?void 0:r[t.format])??t.format,this.webGLVersion===2&&t.type===st.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const r=this.renderer;if(this.initTextureType(t,e),(s=t.resource)!=null&&s.upload(r,t,e))e.samplerType!==_h.FLOAT&&(this.hasIntegerTextures=!0);else{const a=t.realWidth,h=t.realHeight,l=r.gl;(e.width!==a||e.height!==h||e.dirtyId<0)&&(e.width=a,e.height=h,l.texImage2D(t.target,0,e.internalFormat,a,h,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:r}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),r.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&qr(this.managedTextures,s,1)}}updateTextureStyle(t){var r;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===mi.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=Vi.CLAMP:e.wrapMode=t.wrapMode,(r=t.resource)!=null&&r.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const r=this.gl;if(e.mipmap&&t.mipmap!==mi.ON_MANUAL&&r.generateMipmap(t.target),r.texParameteri(t.target,r.TEXTURE_WRAP_S,e.wrapMode),r.texParameteri(t.target,r.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Ri.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===Ri.LINEAR){const a=Math.min(t.anisotropicLevel,r.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,a)}}else r.texParameteri(t.target,r.TEXTURE_MIN_FILTER,t.scaleMode===Ri.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(t.target,r.TEXTURE_MAG_FILTER,t.scaleMode===Ri.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}Bd.extension={type:j.RendererSystem,name:"texture"};rt.add(Bd);class Fd{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glTransformFeedbacks[r]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:r,renderer:s}=this;e&&s.shader.bind(e),r.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:r,CONTEXT_UID:s}=this,a=e.createTransformFeedback();t._glTransformFeedbacks[s]=a,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,a);for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];l&&(r.buffer.update(l),l._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,h,l._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),a}disposeTransformFeedback(t,e){const r=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const a=this.renderer.buffer;if(a)for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];if(!l)continue;const c=l._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!e&&a.dispose(l,e))}r&&(e||s.deleteTransformFeedback(r),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Fd.extension={type:j.RendererSystem,name:"transformFeedback"};rt.add(Fd);class Ld{constructor(t){this.renderer=t}init(t){this.screen=new Tt(0,0,t.width,t.height),this.element=t.view||q.ADAPTER.createCanvas(),this.resolution=t.resolution||q.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const r=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=r,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",r,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Ld.extension={type:[j.RendererSystem,j.CanvasRendererSystem],name:"_view"};rt.add(Ld);q.PREFER_ENV=yr.WEBGL2;q.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(q,{WRAP_MODE:{get(){return ft.defaultOptions.wrapMode},set(i){At("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),ft.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return ft.defaultOptions.scaleMode},set(i){At("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),ft.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return ft.defaultOptions.mipmap},set(i){At("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),ft.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return ft.defaultOptions.anisotropicLevel},set(i){At("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),ft.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return At("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),_e.defaultResolution},set(i){_e.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return At("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),_e.defaultMultisample},set(i){_e.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return Je.defaultMaxTextures},set(i){At("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Je.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return Je.defaultBatchSize},set(i){At("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Je.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return Je.canUploadSameBuffer},set(i){At("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Je.canUploadSameBuffer=i}},GC_MODE:{get(){return Qe.defaultMode},set(i){At("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Qe.defaultMode=i}},GC_MAX_IDLE:{get(){return Qe.defaultMaxIdle},set(i){At("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Qe.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return Qe.defaultCheckCountMax},set(i){At("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Qe.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return ti.defaultVertexPrecision},set(i){At("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ti.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return ti.defaultFragmentPrecision},set(i){At("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ti.defaultFragmentPrecision=i}}});var Jr=(i=>(i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(Jr||{});class nh{constructor(t,e=null,r=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=r,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Pe=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new nh(null,null,1/0),this.deltaMS=1/Pe.targetFPMS,this.elapsedMS=1/Pe.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=Jr.NORMAL){return this._addListener(new nh(i,t,e))}addOnce(i,t,e=Jr.NORMAL){return this._addListener(new nh(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const s=i-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=i-s%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Pe.targetFPMS;const e=this._head;let r=e.next;for(;r;)r=r.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,Pe.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Pe._shared){const i=Pe._shared=new Pe;i.autoStart=!0,i._protected=!0}return Pe._shared}static get system(){if(!Pe._system){const i=Pe._system=new Pe;i.autoStart=!0,i._protected=!0}return Pe._system}};let we=Pe;we.targetFPMS=.06;Object.defineProperties(q,{TARGET_FPMS:{get(){return we.targetFPMS},set(i){At("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),we.targetFPMS=i}}});class Od{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Jr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?we.shared:new we,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Od.extension=j.Application;rt.add(Od);const Nd=[];rt.handleByList(j.Renderer,Nd);function OE(i){for(const t of Nd)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var NE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,UE=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const kE=NE,Ud=UE;class kd{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const r=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,r)}else{const r=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,r)}e>=te.HIGH?this.multisample=te.HIGH:e>=te.MEDIUM?this.multisample=te.MEDIUM:e>=te.LOW?this.multisample=te.LOW:this.multisample=te.NONE}destroy(){}}kd.extension={type:j.RendererSystem,name:"_multisample"};rt.add(kd);class GE{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Gd{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:r,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const a=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,r.bindBufferBase(r.UNIFORM_BUFFER,e,a.buffer)}}bindBufferRange(t,e,r){const{gl:s,CONTEXT_UID:a}=this;r=r||0;const h=t._glBuffers[a]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,h.buffer,r*256,256)}update(t){const{gl:e,CONTEXT_UID:r}=this,s=t._glBuffers[r]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const a=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,a)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const r=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),r&&(e||s.deleteBuffer(r.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let r=0;r<e.length;r++)this.dispose(this.managedBuffers[e[r]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:r}=this;return t._glBuffers[e]=new GE(r.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Gd.extension={type:j.RendererSystem,name:"buffer"};rt.add(Gd);class Hd{constructor(t){this.renderer=t}render(t,e){const r=this.renderer;let s,a,h,l;if(e&&(s=e.renderTexture,a=e.clear,h=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!s,r.runners.prerender.emit(),r.emit("prerender"),r.projection.transform=h,!r.context.isLost){if(s||(this.lastObjectRendered=t),!l){const c=t.enableTempParent();t.updateTransform(),t.disableTempParent(c)}r.renderTexture.bind(s),r.batch.currentRenderer.start(),(a??r.background.clearBeforeRender)&&r.renderTexture.clear(),t.render(r),r.batch.currentRenderer.flush(),s&&(e.blit&&r.framebuffer.blit(),s.baseTexture.update()),r.runners.postrender.emit(),r.projection.transform=null,r.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Hd.extension={type:j.RendererSystem,name:"objectRenderer"};rt.add(Hd);const Fh=class extends FE{constructor(i){super(),i=Object.assign({},q.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new ri({projectionMatrix:new Gt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Fh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&(At("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha);const e={hello:i.hello,_plugin:Fh.__plugins,background:{alpha:i.backgroundAlpha,color:i.background??i.backgroundColor,clearBeforeRender:i.clearBeforeRender},_view:{height:i.height,width:i.width,autoDensity:i.autoDensity,resolution:i.resolution,view:i.view},context:{antialias:i.antialias,context:i.context,powerPreference:i.powerPreference,premultipliedAlpha:i.premultipliedAlpha,preserveDrawingBuffer:i.preserveDrawingBuffer}};this.startup.run(e),this.options=i}static test(i){return i!=null&&i.forceCanvas?!1:Lb()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return At("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return At("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return At("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return At("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){At("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return At("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(i){At("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return At("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let tn=Fh;tn.extension={type:j.Renderer,priority:1};tn.__plugins={};tn.__systems={};rt.handleByMap(j.RendererPlugin,tn.__plugins);rt.handleByMap(j.RendererSystem,tn.__systems);rt.add(tn);class Xd extends Nn{constructor(t,e){const{width:r,height:s}=e||{};super(r,s),this.items=[],this.itemDirtyIds=[];for(let a=0;a<t;a++){const h=new ft;this.items.push(h),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let r=0;r<this.length;r++)t[r]&&(t[r].castToBaseTexture?this.addBaseTextureAt(t[r].castToBaseTexture(),r):t[r]instanceof Nn?this.addResourceAt(t[r],r):this.addResourceAt(ed(t[r],e),r))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(r=>r.resource).filter(r=>r).map(r=>r.load());return this._load=Promise.all(e).then(()=>{const{realWidth:r,realHeight:s}=this.items[0];return this.resize(r,s),Promise.resolve(this)}),this._load}}class HE extends Xd{constructor(t,e){const{width:r,height:s}=e||{};let a,h;Array.isArray(t)?(a=t,h=t.length):h=t,super(h,{width:r,height:s}),a&&this.initFromArray(a,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=Yr.TEXTURE_2D_ARRAY}upload(t,e,r){const{length:s,itemDirtyIds:a,items:h}=this,{gl:l}=t;r.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,s,0,e.format,r.type,null);for(let c=0;c<s;c++){const f=h[c];a[c]<f.dirtyId&&(a[c]=f.dirtyId,f.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,c,f.resource.width,f.resource.height,1,e.format,r.type,f.resource.source))}return!0}}class XE extends qi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Rn=class extends Xd{constructor(i,t){const{width:e,height:r,autoLoad:s,linkBaseTexture:a}=t||{};if(i&&i.length!==Rn.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:r});for(let h=0;h<Rn.SIDES;h++)this.items[h].target=Yr.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=a!==!1,i&&this.initFromArray(i,t),s!==!1&&this.load()}bind(i){super.bind(i),i.target=Yr.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=Yr.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const r=this.itemDirtyIds;for(let s=0;s<Rn.SIDES;s++){const a=this.items[s];(r[s]<a.dirtyId||e.dirtyId<t.dirtyId)&&(a.valid&&a.resource?(a.resource.upload(i,a,e),r[s]=a.dirtyId):r[s]<-1&&(i.gl.texImage2D(a.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),r[s]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===Rn.SIDES}};let Wd=Rn;Wd.SIDES=6;class Vr extends qi{constructor(t,e){var r=(...s)=>{super(...s)};e=e||{},typeof t=="string"?(r(Vr.EMPTY),this.url=t):(r(t),this.url=null),this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const r=await q.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await r.blob();if(this.destroyed)return;const a=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===ni.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=a,this.update(),t(this)}catch(r){if(this.destroyed)return;e(r),this.onError.emit(r)}}),this._load)}upload(t,e,r){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,r)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Vr._EMPTY=Vr._EMPTY??q.ADAPTER.createCanvas(0,0),Vr._EMPTY}}const Qs=class extends qi{constructor(i,t){t=t||{},super(q.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},Qs.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;qi.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let r=t*this.scale,s=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(r=this._overrideWidth||this._overrideHeight/e*t,s=this._overrideHeight||this._overrideWidth/t*e),r=Math.round(r),s=Math.round(s);const a=this.source;a.width=r,a.height=s,a._pixiId=`canvas_${vr()}`,a.getContext("2d").drawImage(i,0,0,t,e,0,0,r,s),this._resolve(),this._resolve=null}}static getSize(i){const t=Qs.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&Qs.SVG_XML.test(i)}};let Un=Qs;Un.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;Un.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Lh=class extends qi{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const r=i[0].src||i[0];qi.crossOrigin(e,r,t.crossorigin);for(let s=0;s<i.length;++s){const a=document.createElement("source");let{src:h,mime:l}=i[s];h=h||i[s];const c=h.split("?").shift().toLowerCase(),f=c.slice(c.lastIndexOf(".")+1);l=l||Lh.MIME_TYPES[f]||`video/${f}`,a.src=h,a.type=l,e.appendChild(a)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=we.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(we.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(we.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(we.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(we.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(we.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||Lh.TYPES.includes(t)}};let il=Lh;il.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];il.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Ih.push(Vr,dd,XE,il,Un,Hn,Wd,HE);class oo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?Tt.EMPTY:(t=t||new Tt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:r,b:s,c:a,d:h,tx:l,ty:c}=t,f=r*e.x+a*e.y+l,p=s*e.x+h*e.y+c;this.minX=Math.min(this.minX,f),this.maxX=Math.max(this.maxX,f),this.minY=Math.min(this.minY,p),this.maxY=Math.max(this.maxY,p)}addQuad(t){let e=this.minX,r=this.minY,s=this.maxX,a=this.maxY,h=t[0],l=t[1];e=h<e?h:e,r=l<r?l:r,s=h>s?h:s,a=l>a?l:a,h=t[2],l=t[3],e=h<e?h:e,r=l<r?l:r,s=h>s?h:s,a=l>a?l:a,h=t[4],l=t[5],e=h<e?h:e,r=l<r?l:r,s=h>s?h:s,a=l>a?l:a,h=t[6],l=t[7],e=h<e?h:e,r=l<r?l:r,s=h>s?h:s,a=l>a?l:a,this.minX=e,this.minY=r,this.maxX=s,this.maxY=a}addFrame(t,e,r,s,a){this.addFrameMatrix(t.worldTransform,e,r,s,a)}addFrameMatrix(t,e,r,s,a){const h=t.a,l=t.b,c=t.c,f=t.d,p=t.tx,g=t.ty;let _=this.minX,v=this.minY,y=this.maxX,A=this.maxY,w=h*e+c*r+p,R=l*e+f*r+g;_=w<_?w:_,v=R<v?R:v,y=w>y?w:y,A=R>A?R:A,w=h*s+c*r+p,R=l*s+f*r+g,_=w<_?w:_,v=R<v?R:v,y=w>y?w:y,A=R>A?R:A,w=h*e+c*a+p,R=l*e+f*a+g,_=w<_?w:_,v=R<v?R:v,y=w>y?w:y,A=R>A?R:A,w=h*s+c*a+p,R=l*s+f*a+g,_=w<_?w:_,v=R<v?R:v,y=w>y?w:y,A=R>A?R:A,this.minX=_,this.minY=v,this.maxX=y,this.maxY=A}addVertexData(t,e,r){let s=this.minX,a=this.minY,h=this.maxX,l=this.maxY;for(let c=e;c<r;c+=2){const f=t[c],p=t[c+1];s=f<s?f:s,a=p<a?p:a,h=f>h?f:h,l=p>l?p:l}this.minX=s,this.minY=a,this.maxX=h,this.maxY=l}addVertices(t,e,r,s){this.addVerticesMatrix(t.worldTransform,e,r,s)}addVerticesMatrix(t,e,r,s,a=0,h=a){const l=t.a,c=t.b,f=t.c,p=t.d,g=t.tx,_=t.ty;let v=this.minX,y=this.minY,A=this.maxX,w=this.maxY;for(let R=r;R<s;R+=2){const M=e[R],E=e[R+1],P=l*M+f*E+g,U=p*E+c*M+_;v=Math.min(v,P-a),A=Math.max(A,P+a),y=Math.min(y,U-h),w=Math.max(w,U+h)}this.minX=v,this.minY=y,this.maxX=A,this.maxY=w}addBounds(t){const e=this.minX,r=this.minY,s=this.maxX,a=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<r?t.minY:r,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>a?t.maxY:a}addBoundsMask(t,e){const r=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,a=t.maxX<e.maxX?t.maxX:e.maxX,h=t.maxY<e.maxY?t.maxY:e.maxY;if(r<=a&&s<=h){const l=this.minX,c=this.minY,f=this.maxX,p=this.maxY;this.minX=r<l?r:l,this.minY=s<c?s:c,this.maxX=a>f?a:f,this.maxY=h>p?h:p}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const r=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,a=t.maxX<e.x+e.width?t.maxX:e.x+e.width,h=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(r<=a&&s<=h){const l=this.minX,c=this.minY,f=this.maxX,p=this.maxY;this.minX=r<l?r:l,this.minY=s<c?s:c,this.maxX=a>f?a:f,this.maxY=h>p?h:p}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,r,s,a,h){t-=a,e-=h,r+=a,s+=h,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class zt extends Gn{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new el,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new oo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let r=0;r<e.length;++r){const s=e[r];Object.defineProperty(zt.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Tt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new Tt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new oo);const e=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,a=this._boundsID;this._bounds=this._localBounds;const h=this.getBounds(!1,t);return this.parent=r,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-a,h}toGlobal(t,e,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,r,s){return e&&(t=e.toGlobal(t,r,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,r)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,r=1,s=1,a=0,h=0,l=0,c=0,f=0){return this.position.x=t,this.position.y=e,this.scale.x=r||1,this.scale.y=s||1,this.rotation=a,this.skew.x=h,this.skew.y=l,this.pivot.x=c,this.pivot.y=f,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new WE),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*kw}set angle(t){this.transform.rotation=t*Gw}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class WE extends zt{constructor(){super(...arguments),this.sortDirty=null}}zt.prototype.displayObjectUpdateTransform=zt.prototype.updateTransform;const zE=new Gt;function $E(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const Oh=class extends zt{constructor(){super(),this.children=[],this.sortableChildren=Oh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.addChild(i[t]);else{const t=i[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return i[0]}addChildAt(i,t){if(t<0||t>this.children.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(t,0,i),this._boundsID++,this.onChildrenChange(t),i.emit("added",this),this.emit("childAdded",i,this,t),i}swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),r=this.getChildIndex(t);this.children[e]=t,this.children[r]=i,this.onChildrenChange(e<r?e:r)}getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(i);qr(this.children,e,1),this.children.splice(t,0,i),this.onChildrenChange(t)}getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.removeChild(i[t]);else{const t=i[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,qr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return i[0]}removeChildAt(i){const t=this.getChildAt(i);return t.parent=null,t.transform._parentID=-1,qr(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i),t}removeChildren(i=0,t=this.children.length){const e=i,r=t,s=r-e;let a;if(s>0&&s<=r){a=this.children.splice(e,s);for(let h=0;h<a.length;++h)a[h].parent=null,a[h].transform&&(a[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let h=0;h<a.length;++h)a[h].emit("removed",this),this.emit("childRemoved",a[h],this,h);return a}else if(s===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let t=0,e=this.children.length;t<e;++t){const r=this.children[t];r._lastSortedIndex=t,!i&&r.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort($E),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,t=this.children.length;i<t;++i){const e=this.children[i];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){const t=this.children[i];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(i,t=!1){const e=super.getLocalBounds(i);if(!t)for(let r=0,s=this.children.length;r<s;++r){const a=this.children[r];a.visible&&a.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(i){const t=i.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,r;this.cullArea?(e=this.cullArea,r=this.worldTransform):this._render!==Oh.prototype._render&&(e=this.getBounds(!0));const s=i.projection.transform;if(s&&(r?(r=zE.copyFrom(r),r.prepend(s)):r=s),e&&t.intersects(e,r))this._render(i);else if(this.cullArea)return;for(let a=0,h=this.children.length;a<h;++a){const l=this.children[a],c=l.cullable;l.cullable=c||!this.cullArea,l.render(i),l.cullable=c}}render(i){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let e=0,r=this.children.length;e<r;++e)this.children[e].render(i)}}renderAdvanced(i){var s,a,h;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const r=t&&((s=this._enabledFilters)==null?void 0:s.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==ne.NONE));if(r&&i.batch.flush(),t&&((a=this._enabledFilters)!=null&&a.length)&&i.filter.push(this,this._enabledFilters),e&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let l=0,c=this.children.length;l<c;++l)this.children[l].render(i)}r&&i.batch.flush(),e&&i.mask.pop(this),t&&((h=this._enabledFilters)!=null&&h.length)&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;const t=typeof i=="boolean"?i:i==null?void 0:i.children,e=this.removeChildren(0,this.children.length);if(t)for(let r=0;r<e.length;++r)e[r].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){const t=this.getLocalBounds().width;t!==0?this.scale.x=i/t:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){const t=this.getLocalBounds().height;t!==0?this.scale.y=i/t:this.scale.y=1,this._height=i}};let De=Oh;De.defaultSortableChildren=!1;De.prototype.containerUpdateTransform=De.prototype.updateTransform;Object.defineProperties(q,{SORTABLE_CHILDREN:{get(){return De.defaultSortableChildren},set(i){At("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),De.defaultSortableChildren=i}}});const Sn=new Et,VE=new Uint16Array([0,1,2,0,2,3]);class en extends De{constructor(t){super(),this._anchor=new $i(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=lt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||it.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=VE,this.pluginName="batch",this.isSprite=!0,this._roundPixels=q.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=$r(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=$r(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,r=e.a,s=e.b,a=e.c,h=e.d,l=e.tx,c=e.ty,f=this.vertexData,p=t.trim,g=t.orig,_=this._anchor;let v=0,y=0,A=0,w=0;if(p?(y=p.x-_._x*g.width,v=y+p.width,w=p.y-_._y*g.height,A=w+p.height):(y=-_._x*g.width,v=y+g.width,w=-_._y*g.height,A=w+g.height),f[0]=r*y+a*w+l,f[1]=h*w+s*y+c,f[2]=r*v+a*w+l,f[3]=h*w+s*v+c,f[4]=r*v+a*A+l,f[5]=h*A+s*v+c,f[6]=r*y+a*A+l,f[7]=h*A+s*y+c,this._roundPixels){const R=q.RESOLUTION;for(let M=0;M<f.length;++M)f[M]=Math.round(f[M]*R)/R}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,r=t.orig,s=this._anchor,a=this.transform.worldTransform,h=a.a,l=a.b,c=a.c,f=a.d,p=a.tx,g=a.ty,_=-s._x*r.width,v=_+r.width,y=-s._y*r.height,A=y+r.height;e[0]=h*_+c*y+p,e[1]=f*y+l*_+g,e[2]=h*v+c*y+p,e[3]=f*y+l*v+g,e[4]=h*v+c*A+p,e[5]=f*A+l*v+g,e[6]=h*_+c*A+p,e[7]=f*A+l*_+g}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new oo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new Tt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Sn);const e=this._texture.orig.width,r=this._texture.orig.height,s=-e*this.anchor.x;let a=0;return Sn.x>=s&&Sn.x<s+e&&(a=-r*this.anchor.y,Sn.y>=a&&Sn.y<a+r)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!r)}this._texture=null}static from(t,e){const r=t instanceof it?t:it.from(t,e);return new en(r)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=$r(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=$r(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||it.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const zd=new Gt;zt.prototype._cacheAsBitmap=!1;zt.prototype._cacheData=null;zt.prototype._cacheAsBitmapResolution=null;zt.prototype._cacheAsBitmapMultisample=null;class YE{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(zt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new YE),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});zt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};zt.prototype._initCachedDisplayObject=function(t){var _,v;if((_=this._cacheData)!=null&&_.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const r=this.getLocalBounds(null,!0).clone();if((v=this.filters)!=null&&v.length){const y=this.filters[0].padding;r.pad(y)}r.ceil(q.RESOLUTION);const s=t.renderTexture.current,a=t.renderTexture.sourceFrame.clone(),h=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,c=Ki.create({width:r.width,height:r.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),f=`cacheAsBitmap_${vr()}`;this._cacheData.textureCacheId=f,ft.addToCache(c.baseTexture,f),it.addToCache(c,f);const p=this.transform.localTransform.copyTo(zd).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:p,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(s,a,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const g=new en(c);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(r.x/r.width),g.anchor.y=-(r.y/r.height),g.alpha=e,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=g.containsPoint.bind(g)};zt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};zt.prototype._initCachedDisplayObjectCanvas=function(t){var p;if((p=this._cacheData)!=null&&p.sprite)return;const e=this.getLocalBounds(null,!0),r=this.alpha;this.alpha=1;const s=t.canvasContext.activeContext,a=t._projTransform;e.ceil(q.RESOLUTION);const h=Ki.create({width:e.width,height:e.height}),l=`cacheAsBitmap_${vr()}`;this._cacheData.textureCacheId=l,ft.addToCache(h.baseTexture,l),it.addToCache(h,l);const c=zd;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=s,t._projTransform=a,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;const f=new en(h);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(e.x/e.width),f.anchor.y=-(e.y/e.height),f.alpha=r,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)};zt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};zt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};zt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ft.removeFromCache(this._cacheData.textureCacheId),it.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};zt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};zt.prototype.name=null;De.prototype.getChildByName=function(t,e){for(let r=0,s=this.children.length;r<s;r++)if(this.children[r].name===t)return this.children[r];if(e)for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r];if(!a.getChildByName)continue;const h=a.getChildByName(t,!0);if(h)return h}return null};zt.prototype.getGlobalPosition=function(t=new Et,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var jE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class qE extends _e{constructor(t=1){super(kE,jE,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const KE={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},ZE=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function JE(i){const t=KE[i],e=t.length;let r=ZE,s="";const a="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let h;for(let l=0;l<i;l++){let c=a.replace("%index%",l.toString());h=l,l>=e&&(h=i-l-1),c=c.replace("%value%",t[h].toString()),s+=c,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}const QE=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function tA(i,t){const e=Math.ceil(i/2);let r=QE,s="",a;t?a="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":a="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let h=0;h<i;h++){let l=a.replace("%index%",h.toString());l=l.replace("%sampleIndex%",`${h-(e-1)}.0`),s+=l,s+=`
`}return r=r.replace("%blur%",s),r=r.replace("%size%",i.toString()),r}class Nh extends _e{constructor(t,e=8,r=4,s=q.FILTER_RESOLUTION,a=5){const h=tA(a,t),l=JE(a);super(h,l),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=r,this.blur=e}apply(t,e,r,s){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,r,s);else{const a=t.getFilterTexture(),h=t.renderer;let l=e,c=a;this.state.blend=!1,t.applyFilter(this,l,c,ci.CLEAR);for(let f=1;f<this.passes-1;f++){t.bindAndClear(l,ci.BLIT),this.uniforms.uSampler=c;const p=c;c=l,l=p,h.shader.bind(this),h.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,r,s),t.returnFilterTexture(a)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class eA extends _e{constructor(t=8,e=4,r=_e.defaultResolution,s=5){super(),this.blurXFilter=new Nh(!0,t,e,r,s),this.blurYFilter=new Nh(!1,t,e,r,s),this.resolution=r,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,r,s){const a=Math.abs(this.blurXFilter.strength),h=Math.abs(this.blurYFilter.strength);if(a&&h){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,ci.CLEAR),this.blurYFilter.apply(t,l,r,s),t.returnFilterTexture(l)}else h?this.blurYFilter.apply(t,e,r,s):this.blurXFilter.apply(t,e,r,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var iA=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Uh extends _e{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Ud,iA,t),this.alpha=1}_loadMatrix(t,e=!1){let r=t;e&&(this._multiply(r,this.uniforms.m,t),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(t,e,r){return t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15],t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16],t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17],t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18],t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4],t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15],t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16],t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17],t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18],t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9],t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15],t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16],t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17],t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18],t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14],t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15],t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16],t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17],t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18],t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}tint(t,e){const r=t>>16&255,s=t>>8&255,a=t&255,h=[r/255,0,0,0,0,0,s/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(h,e)}greyscale(t,e){const r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(r,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const r=Math.cos(t),s=Math.sin(t),a=Math.sqrt,h=1/3,l=a(h),c=r+(1-r)*h,f=h*(1-r)-l*s,p=h*(1-r)+l*s,g=h*(1-r)+l*s,_=r+h*(1-r),v=h*(1-r)-l*s,y=h*(1-r)-l*s,A=h*(1-r)+l*s,w=r+h*(1-r),R=[c,f,p,0,0,g,_,v,0,0,y,A,w,0,0,0,0,0,1,0];this._loadMatrix(R,e)}contrast(t,e){const r=(t||0)+1,s=-.5*(r-1),a=[r,0,0,0,s,0,r,0,0,s,0,0,r,0,s,0,0,0,1,0];this._loadMatrix(a,e)}saturate(t=0,e){const r=t*2/3+1,s=(r-1)*-.5,a=[r,s,s,0,0,s,r,s,0,0,s,s,r,0,0,0,0,0,1,0];this._loadMatrix(a,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,r,s,a){t=t||.2,e=e||.15,r=r||16770432,s=s||3375104;const h=(r>>16&255)/255,l=(r>>8&255)/255,c=(r&255)/255,f=(s>>16&255)/255,p=(s>>8&255)/255,g=(s&255)/255,_=[.3,.59,.11,0,0,h,l,c,t,0,f,p,g,e,0,h-f,l-p,c-g,0,0];this._loadMatrix(_,a)}night(t,e){t=t||.1;const r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(r,e)}predator(t,e){const r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(r,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Uh.prototype.grayscale=Uh.prototype.greyscale;var rA=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,nA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class sA extends _e{constructor(t,e){const r=new Gt;t.renderable=!1,super(nA,rA,{mapSampler:t._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=r,e==null&&(e=20),this.scale=new Et(e,e)}apply(t,e,r,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const a=this.maskSprite.worldTransform,h=Math.sqrt(a.a*a.a+a.b*a.b),l=Math.sqrt(a.c*a.c+a.d*a.d);h!==0&&l!==0&&(this.uniforms.rotation[0]=a.a/h,this.uniforms.rotation[1]=a.b/h,this.uniforms.rotation[2]=a.c/l,this.uniforms.rotation[3]=a.d/l),t.applyFilter(this,e,r,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var oA=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,aA=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class hA extends _e{constructor(){super(aA,oA)}}var lA=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class uA extends _e{constructor(t=.5,e=Math.random()){super(Ud,lA,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const vf={AlphaFilter:qE,BlurFilter:eA,BlurFilterPass:Nh,ColorMatrixFilter:Uh,DisplacementFilter:sA,FXAAFilter:hA,NoiseFilter:uA};Object.entries(vf).forEach(([i,t])=>{Object.defineProperty(vf,i,{get(){return At("7.1.0",`filters.${i} has moved to ${i}`),t}})});class Xn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=Xn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Et,this.page=new Et,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,r){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,r,s,a){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class ao extends Xn{constructor(){super(...arguments),this.client=new Et,this.movement=new Et,this.offset=new Et,this.global=new Et,this.screen=new Et}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,r,s,a,h,l,c,f,p,g,_,v,y,A){throw new Error("Method not implemented.")}}class Ke extends ao{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class kh extends ao{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const cA=2048,fA=new Et,sh=new Et;class dA{constructor(t){this.dispatch=new Gn,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((r,s)=>r.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let r=0,s=e.length;r<s;r++)e[r].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const r=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,fA.set(t,e),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(t,e){if(!t.target)return;const r=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,a=r.length-1;s<a;s++)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=r.length-2;s>=0;s--)if(t.currentTarget=r[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,r=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const s=r.children;if(s)for(let a=0;a<s.length;a++)this.all(t,e,s[a]);t.currentTarget=r,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let r=0;r<cA&&t!==this.rootTarget;r++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,r,s,a){if(!t||!t.visible||a(t,r))return null;if(t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const c=h[l],f=this.hitTestRecursive(c,e||c.interactive,r,s,a);if(f){if(f.length>0&&!f[f.length-1].parent)continue;return(f.length>0||t.interactive)&&f.push(t),f}}}return e&&s(t,r)?t.interactive?[t]:[]:null}hitPruneFn(t,e){var r;if(t.hitArea&&(t.worldTransform.applyInverse(e,sh),!t.hitArea.contains(sh.x,sh.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((r=s.containsPoint)!=null&&r.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var a,h;e=e??t.type;const r=`on${e}`;(h=(a=t.currentTarget)[r])==null||h.call(a,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const r=this.trackingData(t.pointerId);r.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var l;if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t),r=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.overTargets);if(s.overTargets&&a!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(t,c,a);if(this.dispatchEvent(f,"pointerout"),r&&this.dispatchEvent(f,"mouseout"),!e.composedPath().includes(a)){const p=this.createPointerEvent(t,"pointerleave",a);for(p.eventPhase=p.AT_TARGET;p.target&&!e.composedPath().includes(p.target);)p.currentTarget=p.target,this.notifyTarget(p),r&&this.notifyTarget(p,"mouseleave"),p.target=p.target.parent;this.freeEvent(p)}this.freeEvent(f)}if(a!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(e,c);this.dispatchEvent(f,"pointerover"),r&&this.dispatchEvent(f,"mouseover");let p=a==null?void 0:a.parent;for(;p&&p!==this.rootTarget.parent&&p!==e.target;)p=p.parent;if(!p||p===this.rootTarget.parent){const _=this.clonePointerEvent(e,"pointerenter");for(_.eventPhase=_.AT_TARGET;_.target&&_.target!==a&&_.target!==this.rootTarget.parent;)_.currentTarget=_.target,this.notifyTarget(_),r&&this.notifyTarget(_,"mouseenter"),_.target=_.target.parent;this.freeEvent(_)}this.freeEvent(f)}const h=this.moveOnAll?"all":"dispatchEvent";this[h](e,"pointermove"),e.pointerType==="touch"&&this[h](e,"touchmove"),r&&(this[h](e,"mousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var h;if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.createPointerEvent(t),s=r.pointerType==="mouse"||r.pointerType==="pen";this.dispatchEvent(r,"pointerover"),s&&this.dispatchEvent(r,"mouseover"),r.pointerType==="mouse"&&(this.cursor=(h=r.target)==null?void 0:h.cursor);const a=this.clonePointerEvent(r,"pointerenter");for(a.eventPhase=a.AT_TARGET;a.target&&a.target!==this.rootTarget.parent;)a.currentTarget=a.target,this.notifyTarget(a),s&&this.notifyTarget(a,"mouseenter"),a.target=a.target.parent;e.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(a)}mapPointerOut(t){if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const r=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),a=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(a),r&&this.dispatchEvent(a,"mouseout");const h=this.createPointerEvent(t,"pointerleave",s);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),r&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;e.overTargets=null,this.freeEvent(a),this.freeEvent(h)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),r=this.createPointerEvent(t);if(this.dispatchEvent(r,"pointerup"),r.pointerType==="touch")this.dispatchEvent(r,"touchend");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const l=r.button===2;this.dispatchEvent(r,l?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),a=this.findMountedTarget(s.pressTargetsByButton[t.button]);let h=a;if(a&&!r.composedPath().includes(a)){let l=a;for(;l&&!r.composedPath().includes(l);){if(r.currentTarget=l,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch")this.notifyTarget(r,"touchendoutside");else if(r.pointerType==="mouse"||r.pointerType==="pen"){const c=r.button===2;this.notifyTarget(r,c?"rightupoutside":"mouseupoutside")}l=l.parent}delete s.pressTargetsByButton[t.button],h=l}if(h){const l=this.clonePointerEvent(r,"click");l.target=h,l.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const c=s.clicksByButton[t.button];c.target===l.target&&e-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=e,l.detail=c.clickCount,l.pointerType==="mouse"?this.dispatchEvent(l,"click"):l.pointerType==="touch"&&this.dispatchEvent(l,"tap"),this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(r)}mapPointerUpOutside(t){if(!(t instanceof Ke)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),r=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(r){let a=r;for(;a;)s.currentTarget=a,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),a=a.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof kh)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let r=1;r<t.length&&t[r].parent===e;r++)e=t[r];return e}createPointerEvent(t,e,r){const s=this.allocateEvent(Ke);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=r??this.hitTest(s.global.x,s.global.y),typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(kh);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const r=this.allocateEvent(Ke);return r.nativeEvent=t.nativeEvent,r.originalEvent=t.originalEvent,this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.target=t.target,r.path=t.composedPath().slice(),r.type=e??r.type,r}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Ke&&e instanceof Ke&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof ao&&e instanceof ao&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const r=t.currentTarget._events[e];if(r)if("fn"in r)r.fn.call(r.context,t);else for(let s=0,a=r.length;s<a&&!t.propagationImmediatelyStopped;s++)r[s].fn.call(r[s].context,t)}}const pA=1,gA={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class $d{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new dA(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Ke(null),this.rootWheelEvent=new kh(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const r=this.cursorStyles[t];if(r)switch(typeof r){case"string":e&&(this.domElement.style.cursor=r);break;case"function":r(t);break;case"object":e&&Object.assign(this.domElement.style,r);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let r=0,s=e.length;r<s;r++){const a=e[r],h=this.bootstrapEvent(this.rootPointerEvent,a);this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const a=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const r=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let a=0,h=s.length;a<h;a++){const l=this.bootstrapEvent(this.rootPointerEvent,s[a]);l.type+=r,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let r=0,s=e.length;r<s;r++){const a=this.bootstrapEvent(this.rootPointerEvent,e[r]);this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,r){let s;this.domElement.parentElement?s=this.domElement.getBoundingClientRect():s={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const a=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*a,t.y=(r-s.top)*(this.domElement.height/s.height)*a}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let r=0,s=t.changedTouches.length;r<s;r++){const a=t.changedTouches[r];typeof a.button>"u"&&(a.button=0),typeof a.buttons>"u"&&(a.buttons=1),typeof a.isPrimary>"u"&&(a.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,a.type=t.type,e.push(a)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const r=t;typeof r.isPrimary>"u"&&(r.isPrimary=!0),typeof r.width>"u"&&(r.width=1),typeof r.height>"u"&&(r.height=1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="mouse"),typeof r.pointerId>"u"&&(r.pointerId=pA),typeof r.pressure>"u"&&(r.pressure=.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=gA[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}$d.extension={name:"events",type:[j.RendererSystem,j.CanvasRendererSystem]};rt.add($d);const mA={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=r?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.on(i,t,s)},removeEventListener(i,t,e){const r=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;i=r?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,s)},dispatchEvent(i){if(!(i instanceof Xn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};zt.mixin(mA);const _A={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};zt.mixin(_A);const vA=9,zs=100,xA=0,yA=0,xf=2,yf=1,bA=-1e3,TA=-1e3,wA=2;class Vd{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(Pi.tablet||Pi.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${zs}px`,e.style.height=`${zs}px`,e.style.position="absolute",e.style.top=`${xA}px`,e.style.left=`${yA}px`,e.style.zIndex=xf.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${yf}px`,t.style.height=`${yf}px`,t.style.position="absolute",t.style.top=`${bA}px`,t.style.left=`${TA}px`,t.style.zIndex=wA.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let r=0;r<e.length;r++)this.updateAccessibleObjects(e[r])}update(){const t=performance.now();if(Pi.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:r,width:s,height:a}=this.renderer.view.getBoundingClientRect(),{width:h,height:l,resolution:c}=this.renderer,f=s/h*c,p=a/l*c;let g=this.div;g.style.left=`${e}px`,g.style.top=`${r}px`,g.style.width=`${h}px`,g.style.height=`${l}px`;for(let _=0;_<this.children.length;_++){const v=this.children[_];if(v.renderId!==this.renderId)v._accessibleActive=!1,qr(this.children,_,1),this.div.removeChild(v._accessibleDiv),this.pool.push(v._accessibleDiv),v._accessibleDiv=null,_--;else{g=v._accessibleDiv;let y=v.hitArea;const A=v.worldTransform;v.hitArea?(g.style.left=`${(A.tx+y.x*A.a)*f}px`,g.style.top=`${(A.ty+y.y*A.d)*p}px`,g.style.width=`${y.width*A.a*f}px`,g.style.height=`${y.height*A.d*p}px`):(y=v.getBounds(),this.capHitArea(y),g.style.left=`${y.x*f}px`,g.style.top=`${y.y*p}px`,g.style.width=`${y.width*f}px`,g.style.height=`${y.height*p}px`,g.title!==v.accessibleTitle&&v.accessibleTitle!==null&&(g.title=v.accessibleTitle),g.getAttribute("aria-label")!==v.accessibleHint&&v.accessibleHint!==null&&g.setAttribute("aria-label",v.accessibleHint)),(v.accessibleTitle!==g.title||v.tabIndex!==g.tabIndex)&&(g.title=v.accessibleTitle,g.tabIndex=v.tabIndex,this.debug&&this.updateDebugHTML(g))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:r}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>r&&(t.height=r-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${zs}px`,e.style.height=`${zs}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=xf.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:r}=t.target,s=this.renderer.events.rootBoundary,a=Object.assign(new Xn(s),{target:r});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(h=>s.dispatchEvent(a,h))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===vA&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}Vd.extension={name:"accessibility",type:[j.RendererPlugin,j.CanvasRendererPlugin]};rt.add(Vd);const Gh=class{constructor(i){this.stage=new De,i=Object.assign({forceCanvas:!1},i),this.renderer=OE(i),Gh._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(i,t){const e=Gh._plugins.slice(0);e.reverse(),e.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(i),this.renderer=null}};let rl=Gh;rl._plugins=[];rt.handleByList(j.Application,rl._plugins);class Yd{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,r;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:a}=this._resizeTo;e=s,r=a}this.renderer.resize(e,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Yd.extension=j.Application;rt.add(Yd);const bf={loader:j.LoadParser,resolver:j.ResolveParser,cache:j.CacheParser,detection:j.DetectionParser};rt.handle(j.Asset,i=>{const t=i.ref;Object.entries(bf).filter(([e])=>!!t[e]).forEach(([e,r])=>rt.add(Object.assign(t[e],{extension:t[e].extension??r})))},i=>{const t=i.ref;Object.keys(bf).filter(e=>!!t[e]).forEach(e=>rt.remove(t[e]))});class EA{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function jd(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function xo(i,t){const e=i.split("?")[0],r=ue.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const Mi=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);function qd(i,t,e,r,s){const a=t[e];for(let h=0;h<a.length;h++){const l=a[h];e<t.length-1?qd(i.replace(r[e],l),t,e+1,r,s):s.push(i.replace(r[e],l))}}function AA(i){const t=/\{(.*?)\}/g,e=i.match(t),r=[];if(e){const s=[];e.forEach(a=>{const h=a.substring(1,a.length-1).split(",");s.push(h)}),qd(i,s,0,e,r)}else r.push(i);return r}const ho=i=>!Array.isArray(i);class SA{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Mi(t);let s;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(e)){s=c.getCacheableAssets(r,e);break}}s||(s={},r.forEach(l=>{s[l]=e}));const a=Object.keys(s),h={cacheKeys:a,keys:r};if(r.forEach(l=>{this._cacheMap.set(l,h)}),a.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,s[l])}),e instanceof it){const l=e;r.forEach(c=>{l.baseTexture!==it.EMPTY.baseTexture&&ft.addToCache(l.baseTexture,c),it.addToCache(l,c)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(s=>{this._cache.delete(s)}),e.keys.forEach(s=>{this._cacheMap.delete(s)})}get parsers(){return this._parsers}}const Cn=new SA;class CA{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var a,h;let s=null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((a=c.test)!=null&&a.call(c,t,e,this))){s=await c.load(t,e,this),r.parser=c;break}}if(!r.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((h=c.testParse)==null?void 0:h.call(c,s,e,this))&&(s=await c.parse(s,e,this)||s,r.parser=c)}return s})(),r}async load(t,e){let r=0;const s={},a=ho(t),h=Mi(t,f=>({src:f})),l=h.length,c=h.map(async f=>{const p=ue.toAbsolute(f.src);if(!s[f.src])try{this.promiseCache[p]||(this.promiseCache[p]=this._getLoadPromiseAndParser(p,f)),s[f.src]=await this.promiseCache[p].promise,e&&e(++r/l)}catch(g){throw delete this.promiseCache[p],delete s[f.src],new Error(`[Loader.load] Failed to load ${p}.
${g}`)}});return await Promise.all(c),a?s[h[0].src]:s}async unload(t){const r=Mi(t,s=>({src:s})).map(async s=>{var l,c;const a=ue.toAbsolute(s.src),h=this.promiseCache[a];if(h){const f=await h.promise;(c=(l=h.parser)==null?void 0:l.unload)==null||c.call(l,f,s,this),delete this.promiseCache[a]}});await Promise.all(r)}get parsers(){return this._parsers}}var _i=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(_i||{});const IA={extension:{type:j.LoadParser,priority:_i.Low},test(i){return ue.extname(i).toLowerCase()===".json"},async load(i){return await(await q.ADAPTER.fetch(i)).json()}};rt.add(IA);const RA={extension:{type:j.LoadParser,priority:_i.Low},test(i){return ue.extname(i).toLowerCase()===".txt"},async load(i){return await(await q.ADAPTER.fetch(i)).text()}};rt.add(RA);const PA=["normal","bold","100","200","300","400","500","600","700","800","900"],MA=[".ttf",".otf",".woff",".woff2"],DA=["font/ttf","font/otf","font/woff","font/woff2"];function BA(i){const t=ue.extname(i);return ue.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" ")}const FA={extension:{type:j.LoadParser,priority:_i.Low},test(i){return jd(i,DA)||xo(i,MA)},async load(i,t){var r,s,a;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const e=q.ADAPTER.getFontFaceSet();if(e){const h=[],l=((r=t.data)==null?void 0:r.family)??BA(i),c=((a=(s=t.data)==null?void 0:s.weights)==null?void 0:a.filter(p=>PA.includes(p)))??["normal"],f=t.data??{};for(let p=0;p<c.length;p++){const g=c[p],_=new FontFace(l,`url(${encodeURI(i)})`,{...f,weight:g});await _.load(),e.add(_),h.push(_)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>q.ADAPTER.getFontFaceSet().delete(t))}};rt.add(FA);let Tf=0,oh;const LA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",OA={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${LA}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},NA={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let ah;class UA{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([OA.code],{type:"application/javascript"})),r=new Worker(e);r.addEventListener("message",s=>{r.terminate(),URL.revokeObjectURL(e),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){oh===void 0&&(oh=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<oh&&(ah||(ah=URL.createObjectURL(new Blob([NA.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(ah),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const r=new Promise((s,a)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:a})});return this.next(),r}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),r=e.id;this.resolveHash[Tf]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Tf++,id:r})}}const wf=new UA;function yo(i,t,e){const r=new it(i);return r.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),r}const kA=[".jpeg",".jpg",".png",".webp",".avif"],GA=["image/jpeg","image/png","image/webp","image/avif"];async function HA(i){const t=await q.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const kn={extension:{type:j.LoadParser,priority:_i.High},config:{preferWorkers:!0},test(i){return jd(i,GA)||xo(i,kA)},async load(i,t,e){let r=null;globalThis.createImageBitmap?this.config.preferWorkers&&await wf.isImageBitmapSupported()?r=await wf.loadImageBitmap(i):r=await HA(i):r=await new Promise(a=>{r=new Image,r.crossOrigin="anonymous",r.src=i,r.complete?a(r):r.onload=()=>{a(r)}});const s=new ft(r,{resolution:Yi(i),...t.data});return s.resource.src=i,yo(s,e,i)},unload(i){i.destroy(!0)}};rt.add(kn);const XA={extension:{type:j.LoadParser,priority:_i.High},test(i){return ue.extname(i).toLowerCase()===".svg"},async testParse(i){return Un.test(i)},async parse(i,t,e){var h,l,c;const r=new Un(i,(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions),s=new ft(r,{resolution:Yi(i),...t==null?void 0:t.data});s.resource.src=i;const a=yo(s,e,i);return(c=(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions)!=null&&c.autoLoad||await r.load(),a},async load(i,t){return(await q.ADAPTER.fetch(i)).text()},unload:kn.unload};rt.add(XA);class WA{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,e)=>`${t}${this._bundleIdConnector}${e}`,this._extractAssetIdFromBundle=(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];Array.isArray(e)?e.forEach(s=>{if(typeof s.name=="string"){const a=this._createBundleAssetId(t,s.name);r.push(a),this.add([s.name,a],s.srcs)}else{const a=s.name.map(h=>this._createBundleAssetId(t,h));a.forEach(h=>{r.push(h)}),this.add([...s.name,...a],s.srcs)}}):Object.keys(e).forEach(s=>{r.push(this._createBundleAssetId(t,s)),this.add([s,this._createBundleAssetId(t,s)],e[s])}),this._bundles[t]=r}add(t,e,r){const s=Mi(t);s.forEach(h=>{this._assetMap[h]&&console.warn(`[Resolver] already has key: ${h} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=AA(e):e=[e]);const a=e.map(h=>{let l=h;if(typeof h=="string"){let c=!1;for(let f=0;f<this._parsers.length;f++){const p=this._parsers[f];if(p.test(h)){l=p.parse(h),c=!0;break}}c||(l={src:h})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=s),(this._basePath||this._rootPath)&&(l.src=ue.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??r,l});s.forEach(h=>{this._assetMap[h]=a})}resolveBundle(t){const e=ho(t);t=Mi(t);const r={};return t.forEach(s=>{const a=this._bundles[s];if(a){const h=this.resolve(a),l={};for(const c in h){const f=h[c];l[this._extractAssetIdFromBundle(s,c)]=f}r[s]=l}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const s in e)r[s]=e[s].src;return r}return e.src}resolve(t){const e=ho(t);t=Mi(t);const r={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let a=this._assetMap[s];const h=this._getPreferredOrder(a),l=a[0];h==null||h.priority.forEach(c=>{h.params[c].forEach(f=>{const p=a.filter(g=>g[c]?g[c]===f:!1);p.length&&(a=p)})}),this._resolverHash[s]=a[0]??l}else{let a=s;(this._basePath||this._rootPath)&&(a=ue.toAbsolute(a,this._basePath,this._rootPath)),a=this._appendDefaultSearchParams(a),this._resolverHash[s]={src:a}}r[s]=this._resolverHash[s]}),e?r[t[0]]:r}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[0],s=this._preferredOrder.find(a=>a.params.format.includes(r.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class zA{constructor(){this._detections=[],this._initialized=!1,this.resolver=new WA,this.loader=new CA,this.cache=Cn,this._backgroundLoader=new EA(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var a,h,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let c=t.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const e=((a=t.texturePreference)==null?void 0:a.resolution)??1,r=typeof e=="number"?[e]:e;let s=[];if((h=t.texturePreference)!=null&&h.format){const c=(l=t.texturePreference)==null?void 0:l.format;s=typeof c=="string"?[c]:c;for(const f of this._detections)await f.test()||(s=await f.remove(s))}else for(const c of this._detections)await c.test()&&(s=await c.add(s));this.resolver.prefer({params:{format:s,resolution:r}})}add(t,e,r){this.resolver.add(t,e,r)}async load(t,e){this._initialized||await this.init();const r=ho(t),s=Mi(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):l),a=this.resolver.resolve(s),h=await this._mapLoadToResolve(a,e);return r?h[s[0]]:h}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const s=this.resolver.resolveBundle(t),a={},h=Object.keys(s);let l=0,c=0;const f=()=>{e==null||e(++l/c)},p=h.map(g=>{const _=s[g];return c+=Object.keys(_).length,this._mapLoadToResolve(_,f).then(v=>{a[g]=v})});return await Promise.all(p),r?a[t[0]]:a}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Cn.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=Cn.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const a=await this.loader.load(r,e);this._backgroundLoader.active=!0;const h={};return r.forEach((l,c)=>{const f=a[l.src],p=[l.src];l.alias&&p.push(...l.alias),h[s[c]]=f,Cn.set(p,f)}),h}async unload(t){this._initialized||await this.init();const e=Mi(t).map(s=>typeof s!="string"?s.src:s),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Mi(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{Cn.remove(r.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return kn.config.preferWorkers}set preferWorkers(t){kn.config.preferWorkers=t}}const dr=new zA;rt.handleByList(j.LoadParser,dr.loader.parsers).handleByList(j.ResolveParser,dr.resolver.parsers).handleByList(j.CacheParser,dr.cache.parsers).handleByList(j.DetectionParser,dr.detections);const $A={extension:j.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof it),getCacheableAssets:(i,t)=>{const e={};return i.forEach(r=>{t.forEach((s,a)=>{e[r+(a===0?"":a+1)]=s})}),e}};rt.add($A);const VA={extension:{type:j.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await q.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};rt.add(VA);const YA={extension:{type:j.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await q.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};rt.add(YA);const Ef=["png","jpg","jpeg"],jA={extension:{type:j.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Ef],remove:async i=>i.filter(t=>!Ef.includes(t))};rt.add(jA);const qA={extension:j.ResolveParser,test:kn.test,parse:i=>{var t;return{resolution:parseFloat(((t=q.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};rt.add(qA);var Me=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i))(Me||{});const lo={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let Ii,Xr;function Af(){Xr={s3tc:Ii.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Ii.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Ii.getExtension("WEBGL_compressed_texture_etc"),etc1:Ii.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Ii.getExtension("WEBGL_compressed_texture_pvrtc")||Ii.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Ii.getExtension("WEBGL_compressed_texture_atc"),astc:Ii.getExtension("WEBGL_compressed_texture_astc")}}const KA={extension:{type:j.DetectionParser,priority:2},test:async()=>{const t=q.ADAPTER.createCanvas().getContext("webgl");return t?(Ii=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{Xr||Af();const t=[];for(const e in Xr)Xr[e]&&t.push(e);return[...t,...i]},remove:async i=>(Xr||Af(),i.filter(t=>!(t in Xr)))};rt.add(KA);class ZA extends Hn{constructor(t,e={width:1,height:1,autoLoad:!0}){let r,s;typeof t=="string"?(r=t,s=new Uint8Array):(r=null,s=t),super(s,e),this.origin=r,this.buffer=s?new Ch(s):null,this.origin&&e.autoLoad!==!1&&this.load(),s!=null&&s.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const r=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(r),this.buffer=new Ch(r),this.loaded=!0,this.onBlobLoaded(r),this.update(),this}}class mr extends ZA{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=mr._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||mr._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,r){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let h=0,l=this.levels;h<l;h++){const{levelID:c,levelWidth:f,levelHeight:p,levelBuffer:g}=this._levelBuffers[h];s.compressedTexImage2D(s.TEXTURE_2D,c,this.format,f,p,0,g)}return!0}onBlobLoaded(){this._levelBuffers=mr._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,r,s,a,h,l){const c=new Array(r);let f=t.byteOffset,p=h,g=l,_=p+s-1&~(s-1),v=g+a-1&~(a-1),y=_*v*lo[e];for(let A=0;A<r;A++)c[A]={levelID:A,levelWidth:r>1?p:_,levelHeight:r>1?g:v,levelBuffer:new Uint8Array(t.buffer,f,y)},f+=y,p=p>>1||1,g=g>>1||1,_=p+s-1&~(s-1),v=g+a-1&~(a-1),y=_*v*lo[e];return c}}const hh=4,$s=124,JA=32,Sf=20,QA=542327876,Vs={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},tS={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},Ys={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},eS=1,iS=2,rS=4,nS=64,sS=512,oS=131072,aS=827611204,hS=861165636,lS=894720068,uS=808540228,cS=4,fS={[aS]:Me.COMPRESSED_RGBA_S3TC_DXT1_EXT,[hS]:Me.COMPRESSED_RGBA_S3TC_DXT3_EXT,[lS]:Me.COMPRESSED_RGBA_S3TC_DXT5_EXT},dS={[70]:Me.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:Me.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:Me.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:Me.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:Me.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:Me.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:Me.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:Me.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:Me.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function pS(i){const t=new Uint32Array(i);if(t[0]!==QA)throw new Error("Invalid DDS file magic word");const r=new Uint32Array(i,0,$s/Uint32Array.BYTES_PER_ELEMENT),s=r[Vs.HEIGHT],a=r[Vs.WIDTH],h=r[Vs.MIPMAP_COUNT],l=new Uint32Array(i,Vs.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,JA/Uint32Array.BYTES_PER_ELEMENT),c=l[eS];if(c&rS){const f=l[tS.FOURCC];if(f!==uS){const E=fS[f],P=hh+$s,U=new Uint8Array(i,P);return[new mr(U,{format:E,width:a,height:s,levels:h})]}const p=hh+$s,g=new Uint32Array(t.buffer,p,Sf/Uint32Array.BYTES_PER_ELEMENT),_=g[Ys.DXGI_FORMAT],v=g[Ys.RESOURCE_DIMENSION],y=g[Ys.MISC_FLAG],A=g[Ys.ARRAY_SIZE],w=dS[_];if(w===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${_}`);if(y===cS)throw new Error("DDSParser does not support cubemap textures");if(v===6)throw new Error("DDSParser does not supported 3D texture data");const R=new Array,M=hh+$s+Sf;if(A===1)R.push(new Uint8Array(i,M));else{const E=lo[w];let P=0,U=a,z=s;for(let k=0;k<h;k++){const Z=Math.max(1,U+3&-4),nt=Math.max(1,z+3&-4),V=Z*nt*E;P+=V,U=U>>>1,z=z>>>1}let G=M;for(let k=0;k<A;k++)R.push(new Uint8Array(i,G,P)),G+=P}return R.map(E=>new mr(E,{format:w,width:a,height:s,levels:h}))}throw c&nS?new Error("DDSParser does not support uncompressed texture data."):c&sS?new Error("DDSParser does not supported YUV uncompressed texture data."):c&oS?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&iS?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Cf=[171,75,84,88,32,49,49,187,13,10,26,10],gS=67305985,je={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Hh=64,If={[st.UNSIGNED_BYTE]:1,[st.UNSIGNED_SHORT]:2,[st.INT]:4,[st.UNSIGNED_INT]:4,[st.FLOAT]:4,[st.HALF_FLOAT]:8},mS={[W.RGBA]:4,[W.RGB]:3,[W.RG]:2,[W.RED]:1,[W.LUMINANCE]:1,[W.LUMINANCE_ALPHA]:2,[W.ALPHA]:1},_S={[st.UNSIGNED_SHORT_4_4_4_4]:2,[st.UNSIGNED_SHORT_5_5_5_1]:2,[st.UNSIGNED_SHORT_5_6_5]:2};function vS(i,t,e=!1){const r=new DataView(t);if(!xS(i,r))return null;const s=r.getUint32(je.ENDIANNESS,!0)===gS,a=r.getUint32(je.GL_TYPE,s),h=r.getUint32(je.GL_FORMAT,s),l=r.getUint32(je.GL_INTERNAL_FORMAT,s),c=r.getUint32(je.PIXEL_WIDTH,s),f=r.getUint32(je.PIXEL_HEIGHT,s)||1,p=r.getUint32(je.PIXEL_DEPTH,s)||1,g=r.getUint32(je.NUMBER_OF_ARRAY_ELEMENTS,s)||1,_=r.getUint32(je.NUMBER_OF_FACES,s),v=r.getUint32(je.NUMBER_OF_MIPMAP_LEVELS,s),y=r.getUint32(je.BYTES_OF_KEY_VALUE_DATA,s);if(f===0||p!==1)throw new Error("Only 2D textures are supported");if(_!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(g!==1)throw new Error("WebGL does not support array textures");const A=4,w=4,R=c+3&-4,M=f+3&-4,E=new Array(g);let P=c*f;a===0&&(P=R*M);let U;if(a!==0?If[a]?U=If[a]*mS[h]:U=_S[a]:U=lo[l],U===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const z=e?bS(r,y,s):null;let k=P*U,Z=c,nt=f,V=R,J=M,X=Hh+y;for(let O=0;O<v;O++){const dt=r.getUint32(X,s);let _t=X+4;for(let Y=0;Y<g;Y++){let vt=E[Y];vt||(vt=E[Y]=new Array(v)),vt[O]={levelID:O,levelWidth:v>1||a!==0?Z:V,levelHeight:v>1||a!==0?nt:J,levelBuffer:new Uint8Array(t,_t,k)},_t+=k}X+=dt+4,X=X%4!==0?X+4-X%4:X,Z=Z>>1||1,nt=nt>>1||1,V=Z+A-1&~(A-1),J=nt+w-1&~(w-1),k=V*J*U}return a!==0?{uncompressed:E.map(O=>{let dt=O[0].levelBuffer,_t=!1;return a===st.FLOAT?dt=new Float32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4):a===st.UNSIGNED_INT?(_t=!0,dt=new Uint32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4)):a===st.INT&&(_t=!0,dt=new Int32Array(O[0].levelBuffer.buffer,O[0].levelBuffer.byteOffset,O[0].levelBuffer.byteLength/4)),{resource:new Hn(dt,{width:O[0].levelWidth,height:O[0].levelHeight}),type:a,format:_t?yS(h):h}}),kvData:z}:{compressed:E.map(O=>new mr(null,{format:l,width:c,height:f,levels:v,levelBuffers:O})),kvData:z}}function xS(i,t){for(let e=0;e<Cf.length;e++)if(t.getUint8(e)!==Cf[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function yS(i){switch(i){case W.RGBA:return W.RGBA_INTEGER;case W.RGB:return W.RGB_INTEGER;case W.RG:return W.RG_INTEGER;case W.RED:return W.RED_INTEGER;default:return i}}function bS(i,t,e){const r=new Map;let s=0;for(;s<t;){const a=i.getUint32(Hh+s,e),h=Hh+s+4,l=3-(a+3)%4;if(a===0||a>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<a&&i.getUint8(h+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const f=new TextDecoder().decode(new Uint8Array(i.buffer,h,c)),p=new DataView(i.buffer,h+c+1,a-c-1);r.set(f,p),s+=4+a+l}return r}const TS={extension:{type:j.LoadParser,priority:_i.High},test(i){return xo(i,".dds")},async load(i,t,e){const s=await(await q.ADAPTER.fetch(i)).arrayBuffer(),h=pS(s).map(l=>{const c=new ft(l,{mipmap:mi.OFF,alphaMode:ni.NO_PREMULTIPLIED_ALPHA,resolution:Yi(i),...t.data});return yo(c,e,i)});return h.length===1?h[0]:h},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};rt.add(TS);const wS={extension:{type:j.LoadParser,priority:_i.High},test(i){return xo(i,".ktx")},async load(i,t,e){const s=await(await q.ADAPTER.fetch(i)).arrayBuffer(),{compressed:a,uncompressed:h,kvData:l}=vS(i,s),c=a??h,f={mipmap:mi.OFF,alphaMode:ni.NO_PREMULTIPLIED_ALPHA,resolution:Yi(i),...t.data},p=c.map(g=>{c===h&&Object.assign(f,{type:g.type,format:g.format});const _=new ft(g,f);return _.ktxKeyValueData=l,yo(_,e,i)});return p.length===1?p[0]:p},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};rt.add(wS);const ES={extension:j.ResolveParser,test:i=>{const e=i.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:i=>{var r,s;if(i.split("?")[0].split(".").pop()==="ktx"){const a=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(a.some(h=>i.endsWith(h)))return{resolution:parseFloat(((r=q.RETINA_PREFIX.exec(i))==null?void 0:r[1])??"1"),format:a.find(h=>i.endsWith(h)),src:i}}return{resolution:parseFloat(((s=q.RETINA_PREFIX.exec(i))==null?void 0:s[1])??"1"),format:i.split(".").pop(),src:i}}};rt.add(ES);const Rf=new Tt,Pf=4,Xh=class{constructor(i){this.renderer=i}async image(i,t,e){const r=new Image;return r.src=await this.base64(i,t,e),r}async base64(i,t,e){const r=this.canvas(i);if(r.toDataURL!==void 0)return r.toDataURL(t,e);if(r.convertToBlob!==void 0){const s=await r.convertToBlob({type:t,quality:e});return await new Promise(a=>{const h=new FileReader;h.onload=()=>a(h.result),h.readAsDataURL(s)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(i,t){const e=this.renderer;let r,s=!1,a,h=!1;i&&(i instanceof Ki?a=i:(a=this.renderer.generateTexture(i),h=!0)),a?(r=a.baseTexture.resolution,t=t??a.frame,s=!1,e.renderTexture.bind(a)):(r=e.resolution,t||(t=Rf,t.width=e.width,t.height=e.height),s=!0,e.renderTexture.bind(null));const l=Math.round(t.width*r),c=Math.round(t.height*r);let f=new nf(l,c,1);const p=new Uint8Array(Pf*l*c),g=e.gl;g.readPixels(Math.round(t.x*r),Math.round(t.y*r),l,c,g.RGBA,g.UNSIGNED_BYTE,p);const _=f.context.getImageData(0,0,l,c);if(Xh.arrayPostDivide(p,_.data),f.context.putImageData(_,0,0),s){const v=new nf(f.width,f.height,1);v.context.scale(1,-1),v.context.drawImage(f.canvas,0,-c),f.destroy(),f=v}return h&&a.destroy(!0),f.canvas}pixels(i,t){const e=this.renderer;let r,s,a=!1;i&&(i instanceof Ki?s=i:(s=this.renderer.generateTexture(i),a=!0)),s?(r=s.baseTexture.resolution,t=t??s.frame,e.renderTexture.bind(s)):(r=e.resolution,t||(t=Rf,t.width=e.width,t.height=e.height),e.renderTexture.bind(null));const h=Math.round(t.width*r),l=Math.round(t.height*r),c=new Uint8Array(Pf*h*l),f=e.gl;return f.readPixels(Math.round(t.x*r),Math.round(t.y*r),h,l,f.RGBA,f.UNSIGNED_BYTE,c),a&&s.destroy(!0),Xh.arrayPostDivide(c,c),c}destroy(){this.renderer=null}static arrayPostDivide(i,t){for(let e=0;e<i.length;e+=4){const r=t[e+3]=i[e+3];r!==0?(t[e]=Math.round(Math.min(i[e]*255/r,255)),t[e+1]=Math.round(Math.min(i[e+1]*255/r,255)),t[e+2]=Math.round(Math.min(i[e+2]*255/r,255))):(t[e]=i[e],t[e+1]=i[e+1],t[e+2]=i[e+2])}}};let Kd=Xh;Kd.extension={name:"extract",type:j.RendererSystem};rt.add(Kd);const uo={build(i){const t=i.points;let e,r,s,a,h,l;if(i.type===le.CIRC){const y=i.shape;e=y.x,r=y.y,h=l=y.radius,s=a=0}else if(i.type===le.ELIP){const y=i.shape;e=y.x,r=y.y,h=y.width,l=y.height,s=a=0}else{const y=i.shape,A=y.width/2,w=y.height/2;e=y.x+A,r=y.y+w,h=l=Math.max(0,Math.min(y.radius,Math.min(A,w))),s=A-h,a=w-l}if(!(h>=0&&l>=0&&s>=0&&a>=0)){t.length=0;return}const c=Math.ceil(2.3*Math.sqrt(h+l)),f=c*8+(s?4:0)+(a?4:0);if(t.length=f,f===0)return;if(c===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=r+a,t[2]=t[4]=e-s,t[5]=t[7]=r-a;return}let p=0,g=c*4+(s?2:0)+2,_=g,v=f;{const y=s+h,A=a,w=e+y,R=e-y,M=r+A;if(t[p++]=w,t[p++]=M,t[--g]=M,t[--g]=R,a){const E=r-A;t[_++]=R,t[_++]=E,t[--v]=E,t[--v]=w}}for(let y=1;y<c;y++){const A=Math.PI/2*(y/c),w=s+Math.cos(A)*h,R=a+Math.sin(A)*l,M=e+w,E=e-w,P=r+R,U=r-R;t[p++]=M,t[p++]=P,t[--g]=P,t[--g]=E,t[_++]=E,t[_++]=U,t[--v]=U,t[--v]=M}{const y=s,A=a+l,w=e+y,R=e-y,M=r+A,E=r-A;t[p++]=w,t[p++]=M,t[--v]=E,t[--v]=w,s&&(t[p++]=R,t[p++]=M,t[--v]=E,t[--v]=R)}},triangulate(i,t){const e=i.points,r=t.points,s=t.indices;if(e.length===0)return;let a=r.length/2;const h=a;let l,c;if(i.type!==le.RREC){const p=i.shape;l=p.x,c=p.y}else{const p=i.shape;l=p.x+p.width/2,c=p.y+p.height/2}const f=i.matrix;r.push(i.matrix?f.a*l+f.c*c+f.tx:l,i.matrix?f.b*l+f.d*c+f.ty:c),a++,r.push(e[0],e[1]);for(let p=2;p<e.length;p+=2)r.push(e[p],e[p+1]),s.push(a++,h,a);s.push(h+1,h,a)}};function Mf(i,t=!1){const e=i.length;if(e<6)return;let r=0;for(let s=0,a=i[e-2],h=i[e-1];s<e;s+=2){const l=i[s],c=i[s+1];r+=(l-a)*(c+h),a=l,h=c}if(!t&&r>0||t&&r<=0){const s=e/2;for(let a=s+s%2;a<e;a+=2){const h=e-a-2,l=e-a-1,c=a,f=a+1;[i[h],i[c]]=[i[c],i[h]],[i[l],i[f]]=[i[f],i[l]]}}}const Zd={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const r=i.holes,s=t.points,a=t.indices;if(e.length>=6){Mf(e,!1);const h=[];for(let f=0;f<r.length;f++){const p=r[f];Mf(p.points,!0),h.push(e.length/2),e=e.concat(p.points)}const l=qh.exports(e,h,2);if(!l)return;const c=s.length/2;for(let f=0;f<l.length;f+=3)a.push(l[f]+c),a.push(l[f+1]+c),a.push(l[f+2]+c);for(let f=0;f<e.length;f++)s.push(e[f])}}},AS={build(i){const t=i.shape,e=t.x,r=t.y,s=t.width,a=t.height,h=i.points;h.length=0,s>=0&&a>=0&&h.push(e,r,e+s,r,e+s,r+a,e,r+a)},triangulate(i,t){const e=i.points,r=t.points;if(e.length===0)return;const s=r.length/2;r.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},SS={build(i){uo.build(i)},triangulate(i,t){uo.triangulate(i,t)}};var zi=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(zi||{}),pr=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(pr||{});const Qr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Df{static curveTo(t,e,r,s,a,h){const l=h[h.length-2],f=h[h.length-1]-e,p=l-t,g=s-e,_=r-t,v=Math.abs(f*_-p*g);if(v<1e-8||a===0)return(h[h.length-2]!==t||h[h.length-1]!==e)&&h.push(t,e),null;const y=f*f+p*p,A=g*g+_*_,w=f*g+p*_,R=a*Math.sqrt(y)/v,M=a*Math.sqrt(A)/v,E=R*w/y,P=M*w/A,U=R*_+M*p,z=R*g+M*f,G=p*(M+E),k=f*(M+E),Z=_*(R+P),nt=g*(R+P),V=Math.atan2(k-z,G-U),J=Math.atan2(nt-z,Z-U);return{cx:U+t,cy:z+e,radius:a,startAngle:V,endAngle:J,anticlockwise:p*g>_*f}}static arc(t,e,r,s,a,h,l,c,f){const p=l-h,g=Qr._segmentsCount(Math.abs(p)*a,Math.ceil(Math.abs(p)/so)*40),_=p/(g*2),v=_*2,y=Math.cos(_),A=Math.sin(_),w=g-1,R=w%1/w;for(let M=0;M<=w;++M){const E=M+R*M,P=_+h+v*E,U=Math.cos(P),z=-Math.sin(P);f.push((y*U+A*z)*a+r,(y*-z+A*U)*a+s)}}}class CS{constructor(){this.reset()}begin(t,e,r){this.reset(),this.style=t,this.start=e,this.attribStart=r}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class nl{static curveLength(t,e,r,s,a,h,l,c){let p=0,g=0,_=0,v=0,y=0,A=0,w=0,R=0,M=0,E=0,P=0,U=t,z=e;for(let G=1;G<=10;++G)g=G/10,_=g*g,v=_*g,y=1-g,A=y*y,w=A*y,R=w*t+3*A*g*r+3*y*_*a+v*l,M=w*e+3*A*g*s+3*y*_*h+v*c,E=U-R,P=z-M,U=R,z=M,p+=Math.sqrt(E*E+P*P);return p}static curveTo(t,e,r,s,a,h,l){const c=l[l.length-2],f=l[l.length-1];l.length-=2;const p=Qr._segmentsCount(nl.curveLength(c,f,t,e,r,s,a,h));let g=0,_=0,v=0,y=0,A=0;l.push(c,f);for(let w=1,R=0;w<=p;++w)R=w/p,g=1-R,_=g*g,v=_*g,y=R*R,A=y*R,l.push(v*c+3*_*R*t+3*g*y*r+A*a,v*f+3*_*R*e+3*g*y*s+A*h)}}function Bf(i,t,e,r,s,a,h,l){const c=i-e*s,f=t-r*s,p=i+e*a,g=t+r*a;let _,v;h?(_=r,v=-e):(_=-r,v=e);const y=c+_,A=f+v,w=p+_,R=g+v;return l.push(y,A),l.push(w,R),2}function hr(i,t,e,r,s,a,h,l){const c=e-i,f=r-t;let p=Math.atan2(c,f),g=Math.atan2(s-i,a-t);l&&p<g?p+=Math.PI*2:!l&&p>g&&(g+=Math.PI*2);let _=p;const v=g-p,y=Math.abs(v),A=Math.sqrt(c*c+f*f),w=(15*y*Math.sqrt(A)/Math.PI>>0)+1,R=v/w;if(_+=R,l){h.push(i,t),h.push(e,r);for(let M=1,E=_;M<w;M++,E+=R)h.push(i,t),h.push(i+Math.sin(E)*A,t+Math.cos(E)*A);h.push(i,t),h.push(s,a)}else{h.push(e,r),h.push(i,t);for(let M=1,E=_;M<w;M++,E+=R)h.push(i+Math.sin(E)*A,t+Math.cos(E)*A),h.push(i,t);h.push(s,a),h.push(i,t)}return w*2}function IS(i,t){const e=i.shape;let r=i.points||e.points.slice();const s=t.closePointEps;if(r.length===0)return;const a=i.lineStyle,h=new Et(r[0],r[1]),l=new Et(r[r.length-2],r[r.length-1]),c=e.type!==le.POLY||e.closeStroke,f=Math.abs(h.x-l.x)<s&&Math.abs(h.y-l.y)<s;if(c){r=r.slice(),f&&(r.pop(),r.pop(),l.set(r[r.length-2],r[r.length-1]));const Y=(h.x+l.x)*.5,vt=(l.y+h.y)*.5;r.unshift(Y,vt),r.push(Y,vt)}const p=t.points,g=r.length/2;let _=r.length;const v=p.length/2,y=a.width/2,A=y*y,w=a.miterLimit*a.miterLimit;let R=r[0],M=r[1],E=r[2],P=r[3],U=0,z=0,G=-(M-P),k=R-E,Z=0,nt=0,V=Math.sqrt(G*G+k*k);G/=V,k/=V,G*=y,k*=y;const J=a.alignment,X=(1-J)*2,O=J*2;c||(a.cap===pr.ROUND?_+=hr(R-G*(X-O)*.5,M-k*(X-O)*.5,R-G*X,M-k*X,R+G*O,M+k*O,p,!0)+2:a.cap===pr.SQUARE&&(_+=Bf(R,M,G,k,X,O,!0,p))),p.push(R-G*X,M-k*X),p.push(R+G*O,M+k*O);for(let Y=1;Y<g-1;++Y){R=r[(Y-1)*2],M=r[(Y-1)*2+1],E=r[Y*2],P=r[Y*2+1],U=r[(Y+1)*2],z=r[(Y+1)*2+1],G=-(M-P),k=R-E,V=Math.sqrt(G*G+k*k),G/=V,k/=V,G*=y,k*=y,Z=-(P-z),nt=E-U,V=Math.sqrt(Z*Z+nt*nt),Z/=V,nt/=V,Z*=y,nt*=y;const vt=E-R,Ut=M-P,H=E-U,et=z-P,yt=vt*H+Ut*et,Ct=Ut*H-et*vt,Rt=Ct<0;if(Math.abs(Ct)<.001*Math.abs(yt)){p.push(E-G*X,P-k*X),p.push(E+G*O,P+k*O),yt>=0&&(a.join===zi.ROUND?_+=hr(E,P,E-G*X,P-k*X,E-Z*X,P-nt*X,p,!1)+4:_+=2,p.push(E-Z*O,P-nt*O),p.push(E+Z*X,P+nt*X));continue}const Ft=(-G+R)*(-k+P)-(-G+E)*(-k+M),Lt=(-Z+U)*(-nt+P)-(-Z+E)*(-nt+z),Jt=(vt*Lt-H*Ft)/Ct,$t=(et*Ft-Ut*Lt)/Ct,Qt=(Jt-E)*(Jt-E)+($t-P)*($t-P),ee=E+(Jt-E)*X,Pt=P+($t-P)*X,Ot=E-(Jt-E)*O,Vt=P-($t-P)*O,Yt=Math.min(vt*vt+Ut*Ut,H*H+et*et),ce=Rt?X:O,Zi=Yt+ce*ce*A;Qt<=Zi?a.join===zi.BEVEL||Qt/A>w?(Rt?(p.push(ee,Pt),p.push(E+G*O,P+k*O),p.push(ee,Pt),p.push(E+Z*O,P+nt*O)):(p.push(E-G*X,P-k*X),p.push(Ot,Vt),p.push(E-Z*X,P-nt*X),p.push(Ot,Vt)),_+=2):a.join===zi.ROUND?Rt?(p.push(ee,Pt),p.push(E+G*O,P+k*O),_+=hr(E,P,E+G*O,P+k*O,E+Z*O,P+nt*O,p,!0)+4,p.push(ee,Pt),p.push(E+Z*O,P+nt*O)):(p.push(E-G*X,P-k*X),p.push(Ot,Vt),_+=hr(E,P,E-G*X,P-k*X,E-Z*X,P-nt*X,p,!1)+4,p.push(E-Z*X,P-nt*X),p.push(Ot,Vt)):(p.push(ee,Pt),p.push(Ot,Vt)):(p.push(E-G*X,P-k*X),p.push(E+G*O,P+k*O),a.join===zi.ROUND?Rt?_+=hr(E,P,E+G*O,P+k*O,E+Z*O,P+nt*O,p,!0)+2:_+=hr(E,P,E-G*X,P-k*X,E-Z*X,P-nt*X,p,!1)+2:a.join===zi.MITER&&Qt/A<=w&&(Rt?(p.push(Ot,Vt),p.push(Ot,Vt)):(p.push(ee,Pt),p.push(ee,Pt)),_+=2),p.push(E-Z*X,P-nt*X),p.push(E+Z*O,P+nt*O),_+=2)}R=r[(g-2)*2],M=r[(g-2)*2+1],E=r[(g-1)*2],P=r[(g-1)*2+1],G=-(M-P),k=R-E,V=Math.sqrt(G*G+k*k),G/=V,k/=V,G*=y,k*=y,p.push(E-G*X,P-k*X),p.push(E+G*O,P+k*O),c||(a.cap===pr.ROUND?_+=hr(E-G*(X-O)*.5,P-k*(X-O)*.5,E-G*X,P-k*X,E+G*O,P+k*O,p,!1)+2:a.cap===pr.SQUARE&&(_+=Bf(E,P,G,k,X,O,!1,p)));const dt=t.indices,_t=Qr.epsilon*Qr.epsilon;for(let Y=v;Y<_+v-2;++Y)R=p[Y*2],M=p[Y*2+1],E=p[(Y+1)*2],P=p[(Y+1)*2+1],U=p[(Y+2)*2],z=p[(Y+2)*2+1],!(Math.abs(R*(P-z)+E*(z-M)+U*(M-P))<_t)&&dt.push(Y,Y+1,Y+2)}function RS(i,t){let e=0;const r=i.shape,s=i.points||r.points,a=r.type!==le.POLY||r.closeStroke;if(s.length===0)return;const h=t.points,l=t.indices,c=s.length/2,f=h.length/2;let p=f;for(h.push(s[0],s[1]),e=1;e<c;e++)h.push(s[e*2],s[e*2+1]),l.push(p,p+1),p++;a&&l.push(p,f)}function Ff(i,t){i.lineStyle.native?RS(i,t):IS(i,t)}class sl{static curveLength(t,e,r,s,a,h){const l=t-2*r+a,c=e-2*s+h,f=2*r-2*t,p=2*s-2*e,g=4*(l*l+c*c),_=4*(l*f+c*p),v=f*f+p*p,y=2*Math.sqrt(g+_+v),A=Math.sqrt(g),w=2*g*A,R=2*Math.sqrt(v),M=_/A;return(w*y+A*_*(y-R)+(4*v*g-_*_)*Math.log((2*A+M+y)/(M+R)))/(4*w)}static curveTo(t,e,r,s,a){const h=a[a.length-2],l=a[a.length-1],c=Qr._segmentsCount(sl.curveLength(h,l,t,e,r,s));let f=0,p=0;for(let g=1;g<=c;++g){const _=g/c;f=h+(t-h)*_,p=l+(e-l)*_,a.push(f+(t+(r-t)*_-f)*_,p+(e+(s-e)*_-p)*_)}}}const lh={[le.POLY]:Zd,[le.CIRC]:uo,[le.ELIP]:uo,[le.RECT]:AS,[le.RREC]:SS},Lf=[],js=[];class co{constructor(t,e=null,r=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=r,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new co(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const kr=new Et,Jd=class extends id{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new oo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),js.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t.reset(),Lf.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,t=null,e=null,r=null){const s=new co(i,t,e,r);return this.graphicsData.push(s),this.dirty++,this}drawHole(i,t=null){if(!this.graphicsData.length)return null;const e=new co(i,null,null,t),r=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=r.lineStyle,r.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){const t=this.graphicsData;for(let e=0;e<t.length;++e){const r=t[e];if(r.fillStyle.visible&&r.shape&&(r.matrix?r.matrix.applyInverse(i,kr):kr.copyFrom(i),r.shape.contains(kr.x,kr.y))){let s=!1;if(r.holes){for(let a=0;a<r.holes.length;a++)if(r.holes[a].shape.contains(kr.x,kr.y)){s=!0;break}}if(!s)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const i=this.uvs,t=this.graphicsData;let e=null,r=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],r=e.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const c=t[l],f=c.fillStyle,p=c.lineStyle;lh[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(f.visible||p.visible)&&this.processHoles(c.holes);for(let _=0;_<2;_++){const v=_===0?f:p;if(!v.visible)continue;const y=v.texture.baseTexture,A=this.indices.length,w=this.points.length/2;y.wrapMode=Vi.REPEAT,_===0?this.processFill(c):this.processLine(c);const R=this.points.length/2-w;R!==0&&(e&&!this._compareStyles(r,v)&&(e.end(A,w),e=null),e||(e=Lf.pop()||new CS,e.begin(v,A,w),this.batches.push(e),r=v),this.addUvs(this.points,i,v.texture,w,R,v.matrix))}}const s=this.indices.length,a=this.points.length/2;if(e&&e.end(s,a),this.batches.length===0){this.batchable=!0;return}const h=a>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,t){return!(!i||!t||i.texture.baseTexture!==t.texture.baseTexture||i.color+i.alpha!==t.color+t.alpha||!!i.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,t=this.graphicsData.length;i<t;i++){const e=this.graphicsData[i],r=e.fillStyle,s=e.lineStyle;if(r&&!r.texture.baseTexture.valid||s&&!s.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const i=this.batches;for(let t=0,e=i.length;t<e;t++){const r=i[t];for(let s=0;s<r.size;s++){const a=r.start+s;this.indicesUint16[a]=this.indicesUint16[a]-r.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const i=this.batches;for(let t=0;t<i.length;t++)if(i[t].style.native)return!1;return this.points.length<Jd.BATCHABLE_SIZE*2}buildDrawCalls(){let i=++ft._globalBatch;for(let p=0;p<this.drawCalls.length;p++)this.drawCalls[p].texArray.clear(),js.push(this.drawCalls[p]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let r=js.pop();r||(r=new Rh,r.texArray=new Mh),r.texArray.count=0,r.start=0,r.size=0,r.type=di.TRIANGLES;let s=0,a=null,h=0,l=!1,c=di.TRIANGLES,f=0;this.drawCalls.push(r);for(let p=0;p<this.batches.length;p++){const g=this.batches[p],_=8,v=g.style,y=v.texture.baseTexture;l!==!!v.native&&(l=!!v.native,c=l?di.LINES:di.TRIANGLES,a=null,s=_,i++),a!==y&&(a=y,y._batchEnabled!==i&&(s===_&&(i++,s=0,r.size>0&&(r=js.pop(),r||(r=new Rh,r.texArray=new Mh),this.drawCalls.push(r)),r.start=f,r.size=0,r.texArray.count=0,r.type=c),y.touched=1,y._batchEnabled=i,y._batchLocation=s,y.wrapMode=Vi.REPEAT,r.texArray.elements[r.texArray.count++]=y,s++)),r.size+=g.size,f+=g.size,h=y._batchLocation,this.addColors(t,v.color,v.alpha,g.attribSize,g.attribStart),this.addTextureIds(e,h,g.attribSize,g.attribStart)}ft._globalBatch=i,this.packAttributes()}packAttributes(){const i=this.points,t=this.uvs,e=this.colors,r=this.textureIds,s=new ArrayBuffer(i.length*3*4),a=new Float32Array(s),h=new Uint32Array(s);let l=0;for(let c=0;c<i.length/2;c++)a[l++]=i[c*2],a[l++]=i[c*2+1],a[l++]=t[c*2],a[l++]=t[c*2+1],h[l++]=e[c],a[l++]=r[c];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?Zd.triangulate(i,this):lh[i.type].triangulate(i,this)}processLine(i){Ff(i,this);for(let t=0;t<i.holes.length;t++)Ff(i.holes[t],this)}processHoles(i){for(let t=0;t<i.length;t++){const e=i[t];lh[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,t){for(let e=0;e<i.length/2;e++){const r=i[e*2],s=i[e*2+1];i[e*2]=t.a*r+t.c*s+t.tx,i[e*2+1]=t.b*r+t.d*s+t.ty}}addColors(i,t,e,r,s=0){const a=(t>>16)+(t&65280)+((t&255)<<16),h=Zh(a,e);i.length=Math.max(i.length,s+r);for(let l=0;l<r;l++)i[s+l]=h}addTextureIds(i,t,e,r=0){i.length=Math.max(i.length,r+e);for(let s=0;s<e;s++)i[r+s]=t}addUvs(i,t,e,r,s,a=null){let h=0;const l=t.length,c=e.frame;for(;h<s;){let p=i[(r+h)*2],g=i[(r+h)*2+1];if(a){const _=a.a*p+a.c*g+a.tx;g=a.b*p+a.d*g+a.ty,p=_}h++,t.push(p/c.width,g/c.height)}const f=e.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(t,e,l,s)}adjustUvs(i,t,e,r){const s=t.baseTexture,a=1e-6,h=e+r*2,l=t.frame,c=l.width/s.width,f=l.height/s.height;let p=l.x/l.width,g=l.y/l.height,_=Math.floor(i[e]+a),v=Math.floor(i[e+1]+a);for(let y=e+2;y<h;y+=2)_=Math.min(_,Math.floor(i[y]+a)),v=Math.min(v,Math.floor(i[y+1]+a));p-=_,g-=v;for(let y=e;y<h;y+=2)i[y]=(i[y]+p)*c,i[y+1]=(i[y+1]+g)*f}};let Qd=Jd;Qd.BATCHABLE_SIZE=100;class bo{constructor(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new bo;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=it.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ol extends bo{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=pr.BUTT,this.join=zi.MITER,this.miterLimit=10}clone(){const t=new ol;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const PS=new Float32Array(3),uh={},to=class extends De{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new bo,this._lineStyle=new ol,this._matrix=null,this._holeMode=!1,this.state=Di.for2d(),this._geometry=i||new Qd,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=lt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new to(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(i){this._tint=i}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,t=0,e=1,r=.5,s=!1){return typeof i=="number"&&(i={width:i,color:t,alpha:e,alignment:r,native:s}),this.lineTextureStyle(i)}lineTextureStyle(i){i=Object.assign({width:0,texture:it.WHITE,color:i!=null&&i.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:pr.BUTT,join:zi.MITER,miterLimit:10},i),this.currentPath&&this.startPoly();const t=i.width>0&&i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:t},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const i=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new Kr,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[t-2],i[t-1]))}else this.currentPath=new Kr,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,t){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=t,this}lineTo(i,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,r=e[e.length-2],s=e[e.length-1];return(r!==i||s!==t)&&e.push(i,t),this}_initCurve(i=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[i,t]):this.moveTo(i,t)}quadraticCurveTo(i,t,e,r){this._initCurve();const s=this.currentPath.points;return s.length===0&&this.moveTo(0,0),sl.curveTo(i,t,e,r,s),this}bezierCurveTo(i,t,e,r,s,a){return this._initCurve(),nl.curveTo(i,t,e,r,s,a,this.currentPath.points),this}arcTo(i,t,e,r,s){this._initCurve(i,t);const a=this.currentPath.points,h=Df.curveTo(i,t,e,r,s,a);if(h){const{cx:l,cy:c,radius:f,startAngle:p,endAngle:g,anticlockwise:_}=h;this.arc(l,c,f,p,g,_)}return this}arc(i,t,e,r,s,a=!1){if(r===s)return this;if(!a&&s<=r?s+=so:a&&r<=s&&(r+=so),s-r===0)return this;const l=i+Math.cos(r)*e,c=t+Math.sin(r)*e,f=this._geometry.closePointEps;let p=this.currentPath?this.currentPath.points:null;if(p){const g=Math.abs(p[p.length-2]-l),_=Math.abs(p[p.length-1]-c);g<f&&_<f||p.push(l,c)}else this.moveTo(l,c),p=this.currentPath.points;return Df.arc(l,c,i,t,e,r,s,a,p),this}beginFill(i=0,t=1){return this.beginTextureFill({texture:it.WHITE,color:i,alpha:t})}beginTextureFill(i){i=Object.assign({texture:it.WHITE,color:16777215,alpha:1,matrix:null},i),this.currentPath&&this.startPoly();const t=i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:t},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,t,e,r){return this.drawShape(new Tt(i,t,e,r))}drawRoundedRect(i,t,e,r,s){return this.drawShape(new tl(i,t,e,r,s))}drawCircle(i,t,e){return this.drawShape(new Jh(i,t,e))}drawEllipse(i,t,e,r){return this.drawShape(new Qh(i,t,e,r))}drawPolygon(...i){let t,e=!0;const r=i[0];r.points?(e=r.closeStroke,t=r.points):Array.isArray(i[0])?t=i[0]:t=i;const s=new Kr(t);return s.closeStroke=e,this.drawShape(s),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const i=this._geometry.graphicsData;return i.length===1&&i[0].shape.type===le.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){const i=this._geometry,t=this.blendMode,e=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(i.points);for(let r=0;r<e;r++){const s=i.batches[r],a=s.style.color,h=new Float32Array(this.vertexData.buffer,s.attribStart*4*2,s.attribSize*2),l=new Float32Array(i.uvsFloat32.buffer,s.attribStart*4*2,s.attribSize*2),c=new Uint16Array(i.indicesUint16.buffer,s.start*2,s.size),f={vertexData:h,blendMode:t,indices:c,uvs:l,_batchRGB:On(a),_tintRGB:a,_texture:s.style.texture,alpha:s.style.alpha,worldAlpha:1};this.batches[r]=f}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,i.plugins[this.pluginName].render(r)}}}_renderDirect(i){const t=this._resolveDirectShader(i),e=this._geometry,r=this.tint,s=this.worldAlpha,a=t.uniforms,h=e.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(r>>16&255)/255*s,a.tint[1]=(r>>8&255)/255*s,a.tint[2]=(r&255)/255*s,a.tint[3]=s,i.shader.bind(t),i.geometry.bind(e,t),i.state.set(this.state);for(let l=0,c=h.length;l<c;l++)this._renderDrawCallDirect(i,e.drawCalls[l])}_renderDrawCallDirect(i,t){const{texArray:e,type:r,size:s,start:a}=t,h=e.count;for(let l=0;l<h;l++)i.texture.bind(e.elements[l],l);i.geometry.draw(r,s,a)}_resolveDirectShader(i){let t=this.shader;const e=this.pluginName;if(!t){if(!uh[e]){const{maxTextures:r}=i.plugins[e],s=new Int32Array(r);for(let l=0;l<r;l++)s[l]=l;const a={tint:new Float32Array([1,1,1,1]),translationMatrix:new Gt,default:ri.from({uSamplers:s},!0)},h=i.plugins[e]._shader.program;uh[e]=new gi(h,a)}t=uh[e]}return t}_calculateBounds(){this.finishPoly();const i=this._geometry;if(!i.graphicsData.length)return;const{minX:t,minY:e,maxX:r,maxY:s}=i.bounds;this._bounds.addFrame(this.transform,t,e,r,s)}containsPoint(i){return this.worldTransform.applyInverse(i,to._TEMP_POINT),this._geometry.containsPoint(to._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const i=On(this.tint,PS);for(let t=0;t<this.batches.length;t++){const e=this.batches[t],r=e._batchRGB,s=i[0]*r[0]*255,a=i[1]*r[1]*255,h=i[2]*r[2]*255,l=(s<<16)+(a<<8)+(h|0);e._tintRGB=(l>>16)+(l&65280)+((l&255)<<16)}}}calculateVertices(){const i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;const t=this.transform.worldTransform,e=t.a,r=t.b,s=t.c,a=t.d,h=t.tx,l=t.ty,c=this._geometry.points,f=this.vertexData;let p=0;for(let g=0;g<c.length;g+=2){const _=c[g],v=c[g+1];f[p++]=e*_+s*v+h,f[p++]=a*v+r*_+l}}closePath(){const i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};let To=to;To.curves=Qr;To._TEMP_POINT=new Et;class MS{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const ch=new Et,Of=new Kr,tp=class extends De{constructor(i,t,e,r=di.TRIANGLES){super(),this.geometry=i,this.shader=t,this.state=e||Di.for2d(),this.drawMode=r,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=q.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(i){this._geometry!==i&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=i,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(i){this.shader=i}get material(){return this.shader}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(i){this.shader.tint=i}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(i){this.shader.texture=i}_render(i){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===di.TRIANGLES&&t.length<tp.BATCHABLE_SIZE*2?this._renderToBatch(i):this._renderDefault(i)}_renderDefault(i){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),i.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),i.shader.bind(t),i.state.set(this.state),i.geometry.bind(this.geometry,t),i.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(i){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const r=this.material.pluginName;i.batch.setObjectRenderer(i.plugins[r]),i.plugins[r].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,r=t._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,a=s.a,h=s.b,l=s.c,c=s.d,f=s.tx,p=s.ty,g=this.vertexData;for(let _=0;_<g.length/2;_++){const v=e[_*2],y=e[_*2+1];g[_*2]=a*v+l*y+f,g[_*2+1]=h*v+c*y+p}if(this._roundPixels){const _=q.RESOLUTION;for(let v=0;v<g.length;++v)g[v]=Math.round(g[v]*_)/_}this.vertexDirty=r}calculateUvs(){const i=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=i.data:(this.batchUvs||(this.batchUvs=new MS(i,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(i){if(!this.getBounds().contains(i.x,i.y))return!1;this.worldTransform.applyInverse(i,ch);const t=this.geometry.getBuffer("aVertexPosition").data,e=Of.points,r=this.geometry.getIndex().data,s=r.length,a=this.drawMode===4?3:1;for(let h=0;h+2<s;h+=a){const l=r[h]*2,c=r[h+1]*2,f=r[h+2]*2;if(e[0]=t[l],e[1]=t[l+1],e[2]=t[c],e[3]=t[c+1],e[4]=t[f],e[5]=t[f+1],Of.contains(ch.x,ch.y))return!0}return!1}destroy(i){super.destroy(i),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Wh=tp;Wh.BATCHABLE_SIZE=100;class DS extends ji{constructor(t,e,r){super();const s=new Zt(t),a=new Zt(e,!0),h=new Zt(r,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,st.FLOAT).addAttribute("aTextureCoord",a,2,!1,st.FLOAT).addIndex(h),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var BS=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,FS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class Nf extends gi{constructor(t,e){const r={uSampler:t,alpha:1,uTextureMatrix:Gt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(r,e.uniforms),super(e.program||ti.from(FS,BS),r),this._colorDirty=!1,this.uvMatrix=new yd(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;Jf(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class Uf{constructor(t,e,r){this.geometry=new ji,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let a=t[s];a={attributeName:a.attributeName,size:a.size,uploadFunction:a.uploadFunction,type:a.type||st.FLOAT,offset:a.offset},e[s]?this.dynamicProperties.push(a):this.staticProperties.push(a)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Zt(Aw(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const r=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new Zt(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];l.offset=s,s+=l.size,this.staticStride+=l.size}const a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new Zt(this.staticData,!0,!1);for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,r){for(let s=0;s<this.dynamicProperties.length;s++){const a=this.dynamicProperties[s];a.uploadFunction(t,e,r,a.type===st.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,r){for(let s=0;s<this.staticProperties.length;s++){const a=this.staticProperties[s];a.uploadFunction(t,e,r,a.type===st.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var LS=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,OS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ep extends vo{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Gt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:st.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=gi.from(OS,LS,{}),this.state=Di.for2d()}render(t){const e=t.children,r=t._maxSize,s=t._batchSize,a=this.renderer;let h=e.length;if(h===0)return;h>r&&!t.autoResize&&(h=r);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const c=e[0]._texture.baseTexture,f=c.alphaMode>0;this.state.blendMode=Zf(t.blendMode,f),a.state.set(this.state);const p=a.gl,g=t.worldTransform.copyTo(this.tempMatrix);g.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=g.toArray(!0),this.shader.uniforms.uColor=Ew(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let _=!1;for(let v=0,y=0;v<h;v+=s,y+=1){let A=h-v;A>s&&(A=s),y>=l.length&&l.push(this._generateOneMoreBuffer(t));const w=l[y];w.uploadDynamic(e,v,A);const R=t._bufferUpdateIDs[y]||0;_=_||w._updateID<R,_&&(w._updateID=t._updateID,w.uploadStatic(e,v,A)),a.geometry.bind(w.geometry),p.drawElements(p.TRIANGLES,A*6,p.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],r=t._maxSize,s=t._batchSize,a=t._properties;for(let h=0;h<r;h+=s)e.push(new Uf(this.properties,a,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,r=t._properties;return new Uf(this.properties,r,e)}uploadVertices(t,e,r,s,a,h){let l=0,c=0,f=0,p=0;for(let g=0;g<r;++g){const _=t[e+g],v=_._texture,y=_.scale.x,A=_.scale.y,w=v.trim,R=v.orig;w?(c=w.x-_.anchor.x*R.width,l=c+w.width,p=w.y-_.anchor.y*R.height,f=p+w.height):(l=R.width*(1-_.anchor.x),c=R.width*-_.anchor.x,f=R.height*(1-_.anchor.y),p=R.height*-_.anchor.y),s[h]=c*y,s[h+1]=p*A,s[h+a]=l*y,s[h+a+1]=p*A,s[h+a*2]=l*y,s[h+a*2+1]=f*A,s[h+a*3]=c*y,s[h+a*3+1]=f*A,h+=a*4}}uploadPosition(t,e,r,s,a,h){for(let l=0;l<r;l++){const c=t[e+l].position;s[h]=c.x,s[h+1]=c.y,s[h+a]=c.x,s[h+a+1]=c.y,s[h+a*2]=c.x,s[h+a*2+1]=c.y,s[h+a*3]=c.x,s[h+a*3+1]=c.y,h+=a*4}}uploadRotation(t,e,r,s,a,h){for(let l=0;l<r;l++){const c=t[e+l].rotation;s[h]=c,s[h+a]=c,s[h+a*2]=c,s[h+a*3]=c,h+=a*4}}uploadUvs(t,e,r,s,a,h){for(let l=0;l<r;++l){const c=t[e+l]._texture._uvs;c?(s[h]=c.x0,s[h+1]=c.y0,s[h+a]=c.x1,s[h+a+1]=c.y1,s[h+a*2]=c.x2,s[h+a*2+1]=c.y2,s[h+a*3]=c.x3,s[h+a*3+1]=c.y3,h+=a*4):(s[h]=0,s[h+1]=0,s[h+a]=0,s[h+a+1]=0,s[h+a*2]=0,s[h+a*2+1]=0,s[h+a*3]=0,s[h+a*3+1]=0,h+=a*4)}}uploadTint(t,e,r,s,a,h){for(let l=0;l<r;++l){const c=t[e+l],f=c._texture.baseTexture.alphaMode>0,p=c.alpha,g=p<1&&f?Zh(c._tintRGB,p):c._tintRGB+(p*255<<24);s[h]=g,s[h+a]=g,s[h+a*2]=g,s[h+a*3]=g,h+=a*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ep.extension={name:"particle",type:j.RendererPlugin};rt.add(ep);var wo=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(wo||{});const qs={willReadFrequently:!0},tt=class{static get experimentalLetterSpacingSupported(){let i=tt._experimentalLetterSpacingSupported;if(i!==void 0){const t=q.ADAPTER.getCanvasRenderingContext2D().prototype;i=tt._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,r,s,a,h,l,c){this.text=i,this.style=t,this.width=e,this.height=r,this.lines=s,this.lineWidths=a,this.lineHeight=h,this.maxLineWidth=l,this.fontProperties=c}static measureText(i,t,e,r=tt._canvas){e=e??t.wordWrap;const s=t.toFontString(),a=tt.measureFont(s);a.fontSize===0&&(a.fontSize=t.fontSize,a.ascent=t.fontSize);const h=r.getContext("2d",qs);h.font=s;const c=(e?tt.wordWrap(i,t,r):i).split(/(?:\r\n|\r|\n)/),f=new Array(c.length);let p=0;for(let y=0;y<c.length;y++){const A=tt._measureText(c[y],t.letterSpacing,h);f[y]=A,p=Math.max(p,A)}let g=p+t.strokeThickness;t.dropShadow&&(g+=t.dropShadowDistance);const _=t.lineHeight||a.fontSize+t.strokeThickness;let v=Math.max(_,a.fontSize+t.strokeThickness*2)+(c.length-1)*(_+t.leading);return t.dropShadow&&(v+=t.dropShadowDistance),new tt(i,t,g,v,c,f,_+t.leading,p,a)}static _measureText(i,t,e){let r=!1;tt.experimentalLetterSpacingSupported&&(tt.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,r=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let s=e.measureText(i).width;return s>0&&(r?s-=t:s+=(tt.graphemeSegmenter(i).length-1)*t),s}static wordWrap(i,t,e=tt._canvas){const r=e.getContext("2d",qs);let s=0,a="",h="";const l=Object.create(null),{letterSpacing:c,whiteSpace:f}=t,p=tt.collapseSpaces(f),g=tt.collapseNewlines(f);let _=!p;const v=t.wordWrapWidth+c,y=tt.tokenize(i);for(let A=0;A<y.length;A++){let w=y[A];if(tt.isNewline(w)){if(!g){h+=tt.addLine(a),_=!p,a="",s=0;continue}w=" "}if(p){const M=tt.isBreakingSpace(w),E=tt.isBreakingSpace(a[a.length-1]);if(M&&E)continue}const R=tt.getFromCache(w,c,l,r);if(R>v)if(a!==""&&(h+=tt.addLine(a),a="",s=0),tt.canBreakWords(w,t.breakWords)){const M=tt.wordWrapSplit(w);for(let E=0;E<M.length;E++){let P=M[E],U=P,z=1;for(;M[E+z];){const k=M[E+z];if(!tt.canBreakChars(U,k,w,E,t.breakWords))P+=k;else break;U=k,z++}E+=z-1;const G=tt.getFromCache(P,c,l,r);G+s>v&&(h+=tt.addLine(a),_=!1,a="",s=0),a+=P,s+=G}}else{a.length>0&&(h+=tt.addLine(a),a="",s=0);const M=A===y.length-1;h+=tt.addLine(w,!M),_=!1,a="",s=0}else R+s>v&&(_=!1,h+=tt.addLine(a),a="",s=0),(a.length>0||!tt.isBreakingSpace(w)||_)&&(a+=w,s+=R)}return h+=tt.addLine(a,!1),h}static addLine(i,t=!0){return i=tt.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,r){let s=e[i];return typeof s!="number"&&(s=tt._measureText(i,t,r)+t,e[i]=s),s}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!tt.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:tt._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:tt._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let r=0;r<i.length;r++){const s=i[r],a=i[r+1];if(tt.isBreakingSpace(s,a)||tt.isNewline(s)){e!==""&&(t.push(e),e=""),t.push(s);continue}e+=s}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,r,s){return!0}static wordWrapSplit(i){return tt.graphemeSegmenter(i)}static measureFont(i){if(tt._fonts[i])return tt._fonts[i];const t={ascent:0,descent:0,fontSize:0},e=tt._canvas,r=tt._context;r.font=i;const s=tt.METRICS_STRING+tt.BASELINE_SYMBOL,a=Math.ceil(r.measureText(s).width);let h=Math.ceil(r.measureText(tt.BASELINE_SYMBOL).width);const l=Math.ceil(tt.HEIGHT_MULTIPLIER*h);if(h=h*tt.BASELINE_MULTIPLIER|0,a===0||l===0)return tt._fonts[i]=t,t;e.width=a,e.height=l,r.fillStyle="#f00",r.fillRect(0,0,a,l),r.font=i,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(s,0,h);const c=r.getImageData(0,0,a,l).data,f=c.length,p=a*4;let g=0,_=0,v=!1;for(g=0;g<h;++g){for(let y=0;y<p;y+=4)if(c[_+y]!==255){v=!0;break}if(!v)_+=p;else break}for(t.ascent=h-g,_=f-p,v=!1,g=l;g>h;--g){for(let y=0;y<p;y+=4)if(c[_+y]!==255){v=!0;break}if(!v)_-=p;else break}return t.descent=g-h,t.fontSize=t.ascent+t.descent,tt._fonts[i]=t,t}static clearMetrics(i=""){i?delete tt._fonts[i]:tt._fonts={}}static get _canvas(){if(!tt.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",qs);if(e!=null&&e.measureText)return tt.__canvas=t,t;i=q.ADAPTER.createCanvas()}catch{i=q.ADAPTER.createCanvas()}i.width=i.height=10,tt.__canvas=i}return tt.__canvas}static get _context(){return tt.__context||(tt.__context=tt._canvas.getContext("2d",qs)),tt.__context}};let he=tt;he.METRICS_STRING="|ÉqÅ";he.BASELINE_SYMBOL="M";he.BASELINE_MULTIPLIER=1.4;he.HEIGHT_MULTIPLIER=2;he.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();he.experimentalLetterSpacing=!1;he._fonts={};he._newlines=[10,13];he._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const NS=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],Pn=class{constructor(i){this.styleID=0,this.reset(),dh(this,i,i)}clone(){const i={};return dh(i,this,Pn.defaultStyle),new Pn(i)}reset(){dh(this,Pn.defaultStyle,Pn.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){const t=fh(i);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){const t=fh(i);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){US(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){const t=fh(i);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){const i=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let r=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!NS.includes(r)&&(r=`"${r}"`),t[e]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${t.join(",")}`}};let xr=Pn;xr.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:wo.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function kf(i){return typeof i=="number"?qf(i):(typeof i=="string"&&i.startsWith("0x")&&(i=i.replace("0x","#")),i)}function fh(i){if(Array.isArray(i)){for(let t=0;t<i.length;++t)i[t]=kf(i[t]);return i}else return kf(i)}function US(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function dh(i,t,e){for(const r in e)Array.isArray(t[r])?i[r]=t[r].slice():i[r]=t[r]}const kS={texture:!0,children:!1,baseTexture:!0},zh=class extends en{constructor(i,t,e){let r=!1;e||(e=q.ADAPTER.createCanvas(),r=!0),e.width=3,e.height=3;const s=it.from(e);s.orig=new Tt,s.trim=new Tt,super(s),this._ownCanvas=r,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=zh.defaultResolution??q.RESOLUTION,this._autoResolution=zh.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return he.experimentalLetterSpacing}static set experimentalLetterSpacing(i){At("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),he.experimentalLetterSpacing=i}updateText(i){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();const e=this.context,r=he.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=r.width,a=r.height,h=r.lines,l=r.lineHeight,c=r.lineWidths,f=r.maxLineWidth,p=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let g,_;const v=t.dropShadow?2:1;for(let y=0;y<v;++y){const A=t.dropShadow&&y===0,w=A?Math.ceil(Math.max(1,a)+t.padding*2):0,R=w*this._resolution;if(A){e.fillStyle="black",e.strokeStyle="black";const E=t.dropShadowColor,P=On(typeof E=="number"?E:Kh(E)),U=t.dropShadowBlur*this._resolution,z=t.dropShadowDistance*this._resolution;e.shadowColor=`rgba(${P[0]*255},${P[1]*255},${P[2]*255},${t.dropShadowAlpha})`,e.shadowBlur=U,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*z,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*z+R}else e.fillStyle=this._generateFillStyle(t,h,r),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let M=(l-p.fontSize)/2;l-p.fontSize<0&&(M=0);for(let E=0;E<h.length;E++)g=t.strokeThickness/2,_=t.strokeThickness/2+E*l+p.ascent+M,t.align==="right"?g+=f-c[E]:t.align==="center"&&(g+=(f-c[E])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(h[E],g+t.padding,_+t.padding-w,!0),t.fill&&this.drawLetterSpacing(h[E],g+t.padding,_+t.padding-w)}this.updateTexture()}drawLetterSpacing(i,t,e,r=!1){const a=this._style.letterSpacing;let h=!1;if(he.experimentalLetterSpacingSupported&&(he.experimentalLetterSpacing?(this.context.letterSpacing=`${a}px`,this.context.textLetterSpacing=`${a}px`,h=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),a===0||h){r?this.context.strokeText(i,t,e):this.context.fillText(i,t,e);return}let l=t;const c=he.graphemeSegmenter(i);let f=this.context.measureText(i).width,p=0;for(let g=0;g<c.length;++g){const _=c[g];r?this.context.strokeText(_,l,e):this.context.fillText(_,l,e);let v="";for(let y=g+1;y<c.length;++y)v+=c[y];p=this.context.measureText(v).width,l+=f-p+a,f=p}}updateTexture(){const i=this.canvas;if(this._style.trim){const a=Iw(i);a.data&&(i.width=a.width,i.height=a.height,this.context.putImageData(a.data,0,0))}const t=this._texture,e=this._style,r=e.trim?0:e.padding,s=t.baseTexture;t.trim.width=t._frame.width=i.width/this._resolution,t.trim.height=t._frame.height=i.height/this._resolution,t.trim.x=-r,t.trim.y=-r,t.orig.width=t._frame.width-r*2,t.orig.height=t._frame.height-r*2,this._onTextureUpdate(),s.setRealSize(i.width,i.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,t){return this.updateText(!0),this._textureID===-1&&(i=!1),super.getBounds(i,t)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,t,e){const r=i.fill;if(Array.isArray(r)){if(r.length===1)return r[0]}else return r;let s;const a=i.dropShadow?i.dropShadowDistance:0,h=i.padding||0,l=this.canvas.width/this._resolution-a-h*2,c=this.canvas.height/this._resolution-a-h*2,f=r.slice(),p=i.fillGradientStops.slice();if(!p.length){const g=f.length+1;for(let _=1;_<g;++_)p.push(_/g)}if(f.unshift(r[0]),p.unshift(0),f.push(r[r.length-1]),p.push(1),i.fillGradientType===wo.LINEAR_VERTICAL){s=this.context.createLinearGradient(l/2,h,l/2,c+h);const g=e.fontProperties.fontSize+i.strokeThickness;for(let _=0;_<t.length;_++){const v=e.lineHeight*(_-1)+g,y=e.lineHeight*_;let A=y;_>0&&v>y&&(A=(y+v)/2);const w=y+g,R=e.lineHeight*(_+1);let M=w;_+1<t.length&&R<w&&(M=(w+R)/2);const E=(M-A)/c;for(let P=0;P<f.length;P++){let U=0;typeof p[P]=="number"?U=p[P]:U=P/f.length;let z=Math.min(1,Math.max(0,A/c+U*E));z=Number(z.toFixed(5)),s.addColorStop(z,f[P])}}}else{s=this.context.createLinearGradient(h,c/2,l+h,c/2);const g=f.length+1;let _=1;for(let v=0;v<f.length;v++){let y;typeof p[v]=="number"?y=p[v]:y=_/g,s.addColorStop(y,f[v]),_++}}return s}destroy(i){typeof i=="boolean"&&(i={children:i}),i=Object.assign({},kS,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);const t=$r(this.scale.x)||1;this.scale.x=t*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);const t=$r(this.scale.y)||1;this.scale.y=t*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){i=i||{},i instanceof xr?this._style=i:this._style=new xr(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};let al=zh;al.defaultAutoResolution=!0;class GS{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function HS(i,t){var r;let e=!1;if((r=i==null?void 0:i._textures)!=null&&r.length){for(let s=0;s<i._textures.length;s++)if(i._textures[s]instanceof it){const a=i._textures[s].baseTexture;t.includes(a)||(t.push(a),e=!0)}}return e}function XS(i,t){if(i.baseTexture instanceof ft){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function WS(i,t){if(i._texture&&i._texture instanceof it){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function zS(i,t){return t instanceof al?(t.updateText(!0),!0):!1}function $S(i,t){if(t instanceof xr){const e=t.toFontString();return he.measureFont(e),!0}return!1}function VS(i,t){if(i instanceof al){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function YS(i,t){return i instanceof xr?(t.includes(i)||t.push(i),!0):!1}const ip=class{constructor(i){this.limiter=new GS(ip.uploadsPerFrame),this.renderer=i,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(VS),this.registerFindHook(YS),this.registerFindHook(HS),this.registerFindHook(XS),this.registerFindHook(WS),this.registerUploadHook(zS),this.registerUploadHook($S)}upload(i){return new Promise(t=>{i&&this.add(i),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,we.system.addOnce(this.tick,this,Jr.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const i=this.queue[0];let t=!1;if(i&&!i._destroyed){for(let e=0,r=this.uploadHooks.length;e<r;e++)if(this.uploadHooks[e](this.uploadHookHelper,i)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)we.system.addOnce(this.tick,this,Jr.UTILITY);else{this.ticking=!1;const i=this.completes.slice(0);this.completes.length=0;for(let t=0,e=i.length;t<e;t++)i[t]()}}registerFindHook(i){return i&&this.addHooks.push(i),this}registerUploadHook(i){return i&&this.uploadHooks.push(i),this}add(i){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](i,this.queue);t++);if(i instanceof De)for(let t=i.children.length-1;t>=0;t--)this.add(i.children[t]);return this}destroy(){this.ticking&&we.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let fo=ip;fo.uploadsPerFrame=4;Object.defineProperties(q,{UPLOADS_PER_FRAME:{get(){return fo.uploadsPerFrame},set(i){At("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),fo.uploadsPerFrame=i}}});function rp(i,t){return t instanceof ft?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function jS(i,t){if(!(t instanceof To))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:r}=e;for(let s=0;s<r.length;s++){const{texture:a}=r[s].style;a&&rp(i,a.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function qS(i,t){return i instanceof To?(t.push(i),!0):!1}class np extends fo{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(qS),this.registerUploadHook(rp),this.registerUploadHook(jS)}}np.extension={name:"prepare",type:j.RendererSystem};rt.add(np);new Et;var KS=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,ZS=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,JS=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Gf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,QS=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Ks=new Gt;class sp extends vo{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new md,this.state=Di.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=gi.from(Gf,QS,e),this.shader=t.context.webGLVersion>1?gi.from(ZS,KS,e):gi.from(Gf,JS,e)}render(t){const e=this.renderer,r=this.quad;let s=r.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const a=t.uvRespectAnchor?t.anchor.x:0,h=t.uvRespectAnchor?t.anchor.y:0;s=r.uvs,s[0]=s[6]=-a,s[1]=s[3]=-h,s[2]=s[4]=1-a,s[5]=s[7]=1-h,r.invalidate();const l=t._texture,c=l.baseTexture,f=c.alphaMode>0,p=t.tileTransform.localTransform,g=t.uvMatrix;let _=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;_&&(c._glTextures[e.CONTEXT_UID]?_=c.wrapMode!==Vi.CLAMP:c.wrapMode===Vi.CLAMP&&(c.wrapMode=Vi.REPEAT));const v=_?this.simpleShader:this.shader,y=l.width,A=l.height,w=t._width,R=t._height;Ks.set(p.a*y/w,p.b*y/R,p.c*A/w,p.d*A/R,p.tx/w,p.ty/R),Ks.invert(),_?Ks.prepend(g.mapCoord):(v.uniforms.uMapCoord=g.mapCoord.toArray(!0),v.uniforms.uClampFrame=g.uClampFrame,v.uniforms.uClampOffset=g.uClampOffset),v.uniforms.uTransform=Ks.toArray(!0),v.uniforms.uColor=Jf(t.tint,t.worldAlpha,v.uniforms.uColor,f),v.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),v.uniforms.uSampler=l,e.shader.bind(v),e.geometry.bind(r),this.state.blendMode=Zf(t.blendMode,f),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}sp.extension={name:"tilingSprite",type:j.RendererPlugin};rt.add(sp);const Mn=class{constructor(i,t,e=null){this.linkedSheets=[],this._texture=i instanceof it?i:null,this.baseTexture=i instanceof ft?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const r=this.baseTexture.resource;this.resolution=this._updateResolution(e||(r?r.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(i=null){const{scale:t}=this.data.meta;let e=Yi(i,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(i=>{this._callback=i,this._batchIndex=0,this._frameKeys.length<=Mn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(i){let t=i;const e=Mn.BATCH_SIZE;for(;t-i<e&&t<this._frameKeys.length;){const r=this._frameKeys[t],s=this._frames[r],a=s.frame;if(a){let h=null,l=null;const c=s.trimmed!==!1&&s.sourceSize?s.sourceSize:s.frame,f=new Tt(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);s.rotated?h=new Tt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):h=new Tt(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),s.trimmed!==!1&&s.spriteSourceSize&&(l=new Tt(Math.floor(s.spriteSourceSize.x)/this.resolution,Math.floor(s.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[r]=new it(this.baseTexture,h,f,l,s.rotated?2:0,s.anchor),it.addToCache(this.textures[r],r)}t++}}_processAnimations(){const i=this.data.animations||{};for(const t in i){this.animations[t]=[];for(let e=0;e<i[t].length;e++){const r=i[t][e];this.animations[t].push(this.textures[r])}}}_parseComplete(){const i=this._callback;this._callback=null,this._batchIndex=0,i.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Mn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Mn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(i=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,i&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let $h=Mn;$h.BATCH_SIZE=1e3;const tC=["jpg","png","jpeg","avif","webp"];function op(i,t,e){const r={};if(i.forEach(s=>{r[s]=t}),Object.keys(t.textures).forEach(s=>{r[s]=t.textures[s]}),!e){const s=ue.dirname(i[0]);t.linkedSheets.forEach((a,h)=>{const l=op([`${s}/${t.data.meta.related_multi_packs[h]}`],a,!0);Object.assign(r,l)})}return r}const eC={extension:j.Asset,cache:{test:i=>i instanceof $h,getCacheableAssets:(i,t)=>op(i,t,!1)},resolver:{test:i=>{const e=i.split("?")[0].split("."),r=e.pop(),s=e.pop();return r==="json"&&tC.includes(s)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=q.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{extension:{type:j.LoadParser,priority:_i.Normal},async testParse(i,t){return ue.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var f,p;let r=ue.dirname(t.src);r&&r.lastIndexOf("/")!==r.length-1&&(r+="/");const s=r+i.meta.image,h=(await e.load([s]))[s],l=new $h(h.baseTexture,i,t.src);await l.parse();const c=(f=i==null?void 0:i.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(c)){const g=[];for(const v of c){if(typeof v!="string")continue;const y=r+v;(p=t.data)!=null&&p.ignoreMultiPack||g.push(e.load({src:y,data:{ignoreMultiPack:!0}}))}const _=await Promise.all(g);l.linkedSheets=_,_.forEach(v=>{v.linkedSheets=[l].concat(l.linkedSheets.filter(y=>y!==v))})}return l},unload(i){i.destroy(!0)}}};rt.add(eC);class po{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class eo{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const a in e){const h=e[a].match(/^[a-z]+/gm)[0],l=e[a].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const f in l){const p=l[f].split("="),g=p[0],_=p[1].replace(/"/gm,""),v=parseFloat(_),y=isNaN(v)?_:v;c[g]=y}r[h].push(c)}const s=new po;return r.info.forEach(a=>s.info.push({face:a.face,size:parseInt(a.size,10)})),r.common.forEach(a=>s.common.push({lineHeight:parseInt(a.lineHeight,10)})),r.page.forEach(a=>s.page.push({id:parseInt(a.id,10),file:a.file})),r.char.forEach(a=>s.char.push({id:parseInt(a.id,10),page:parseInt(a.page,10),x:parseInt(a.x,10),y:parseInt(a.y,10),width:parseInt(a.width,10),height:parseInt(a.height,10),xoffset:parseInt(a.xoffset,10),yoffset:parseInt(a.yoffset,10),xadvance:parseInt(a.xadvance,10)})),r.kerning.forEach(a=>s.kerning.push({first:parseInt(a.first,10),second:parseInt(a.second,10),amount:parseInt(a.amount,10)})),r.distanceField.forEach(a=>s.distanceField.push({distanceRange:parseInt(a.distanceRange,10),fieldType:a.fieldType})),s}}class Vh{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new po,r=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),a=t.getElementsByTagName("page"),h=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),c=t.getElementsByTagName("distanceField");for(let f=0;f<r.length;f++)e.info.push({face:r[f].getAttribute("face"),size:parseInt(r[f].getAttribute("size"),10)});for(let f=0;f<s.length;f++)e.common.push({lineHeight:parseInt(s[f].getAttribute("lineHeight"),10)});for(let f=0;f<a.length;f++)e.page.push({id:parseInt(a[f].getAttribute("id"),10)||0,file:a[f].getAttribute("file")});for(let f=0;f<h.length;f++){const p=h[f];e.char.push({id:parseInt(p.getAttribute("id"),10),page:parseInt(p.getAttribute("page"),10)||0,x:parseInt(p.getAttribute("x"),10),y:parseInt(p.getAttribute("y"),10),width:parseInt(p.getAttribute("width"),10),height:parseInt(p.getAttribute("height"),10),xoffset:parseInt(p.getAttribute("xoffset"),10),yoffset:parseInt(p.getAttribute("yoffset"),10),xadvance:parseInt(p.getAttribute("xadvance"),10)})}for(let f=0;f<l.length;f++)e.kerning.push({first:parseInt(l[f].getAttribute("first"),10),second:parseInt(l[f].getAttribute("second"),10),amount:parseInt(l[f].getAttribute("amount"),10)});for(let f=0;f<c.length;f++)e.distanceField.push({fieldType:c[f].getAttribute("fieldType"),distanceRange:parseInt(c[f].getAttribute("distanceRange"),10)});return e}}class Yh{static test(t){return typeof t=="string"&&t.includes("<font>")?Vh.test(q.ADAPTER.parseXML(t)):!1}static parse(t){return Vh.parse(q.ADAPTER.parseXML(t))}}const ph=[eo,Vh,Yh];function iC(i){for(let t=0;t<ph.length;t++)if(ph[t].test(i))return ph[t];return null}function rC(i,t,e,r,s,a){const h=e.fill;if(Array.isArray(h)){if(h.length===1)return h[0]}else return h;let l;const c=e.dropShadow?e.dropShadowDistance:0,f=e.padding||0,p=i.width/r-c-f*2,g=i.height/r-c-f*2,_=h.slice(),v=e.fillGradientStops.slice();if(!v.length){const y=_.length+1;for(let A=1;A<y;++A)v.push(A/y)}if(_.unshift(h[0]),v.unshift(0),_.push(h[h.length-1]),v.push(1),e.fillGradientType===wo.LINEAR_VERTICAL){l=t.createLinearGradient(p/2,f,p/2,g+f);let y=0;const w=(a.fontProperties.fontSize+e.strokeThickness)/g;for(let R=0;R<s.length;R++){const M=a.lineHeight*R;for(let E=0;E<_.length;E++){let P=0;typeof v[E]=="number"?P=v[E]:P=E/_.length;const U=M/g+P*w;let z=Math.max(y,U);z=Math.min(z,1),l.addColorStop(z,_[E]),y=z}}}else{l=t.createLinearGradient(f,g/2,p+f,g/2);const y=_.length+1;let A=1;for(let w=0;w<_.length;w++){let R;typeof v[w]=="number"?R=v[w]:R=A/y,l.addColorStop(R,_[w]),A++}}return l}function nC(i,t,e,r,s,a,h){const l=e.text,c=e.fontProperties;t.translate(r,s),t.scale(a,a);const f=h.strokeThickness/2,p=-(h.strokeThickness/2);if(t.font=h.toFontString(),t.lineWidth=h.strokeThickness,t.textBaseline=h.textBaseline,t.lineJoin=h.lineJoin,t.miterLimit=h.miterLimit,t.fillStyle=rC(i,t,h,a,[l],e),t.strokeStyle=h.stroke,h.dropShadow){const g=h.dropShadowColor,_=On(typeof g=="number"?g:Kh(g)),v=h.dropShadowBlur*a,y=h.dropShadowDistance*a;t.shadowColor=`rgba(${_[0]*255},${_[1]*255},${_[2]*255},${h.dropShadowAlpha})`,t.shadowBlur=v,t.shadowOffsetX=Math.cos(h.dropShadowAngle)*y,t.shadowOffsetY=Math.sin(h.dropShadowAngle)*y}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;h.stroke&&h.strokeThickness&&t.strokeText(l,f,p+e.lineHeight-c.descent),h.fill&&t.fillText(l,f,p+e.lineHeight-c.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function io(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function ap(i){return Array.from?Array.from(i):i.split("")}function sC(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,r=i.length;e<r;e++){const s=i[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const a=s[0].charCodeAt(0),h=s[1].charCodeAt(0);if(h<a)throw new Error("[BitmapFont]: Invalid character range.");for(let l=a,c=h;l<=c;l++)t.push(String.fromCharCode(l))}else t.push(...ap(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Ze=class{constructor(i,t,e){var f;const[r]=i.info,[s]=i.common,[a]=i.page,[h]=i.distanceField,l=Yi(a.file),c={};this._ownsTextures=e,this.font=r.face,this.size=r.size,this.lineHeight=s.lineHeight/l,this.chars={},this.pageTextures=c;for(let p=0;p<i.page.length;p++){const{id:g,file:_}=i.page[p];c[g]=t instanceof Array?t[p]:t[_],h!=null&&h.fieldType&&h.fieldType!=="none"&&(c[g].baseTexture.alphaMode=ni.NO_PREMULTIPLIED_ALPHA,c[g].baseTexture.mipmap=mi.OFF)}for(let p=0;p<i.char.length;p++){const{id:g,page:_}=i.char[p];let{x:v,y,width:A,height:w,xoffset:R,yoffset:M,xadvance:E}=i.char[p];v/=l,y/=l,A/=l,w/=l,R/=l,M/=l,E/=l;const P=new Tt(v+c[_].frame.x/l,y+c[_].frame.y/l,A,w);this.chars[g]={xOffset:R,yOffset:M,xAdvance:E,kerning:{},texture:new it(c[_].baseTexture,P),page:_}}for(let p=0;p<i.kerning.length;p++){let{first:g,second:_,amount:v}=i.kerning[p];g/=l,_/=l,v/=l,this.chars[_]&&(this.chars[_].kerning[g]=v)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((f=h==null?void 0:h.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const i in this.chars)this.chars[i].texture.destroy(),this.chars[i].texture=null;for(const i in this.pageTextures)this._ownsTextures&&this.pageTextures[i].destroy(!0),this.pageTextures[i]=null;this.chars=null,this.pageTextures=null}static install(i,t,e){let r;if(i instanceof po)r=i;else{const a=iC(i);if(!a)throw new Error("Unrecognized data format for font.");r=a.parse(i)}t instanceof it&&(t=[t]);const s=new Ze(r,t,e);return Ze.available[s.font]=s,s}static uninstall(i){const t=Ze.available[i];if(!t)throw new Error(`No font found named '${i}'`);t.destroy(),delete Ze.available[i]}static from(i,t,e){if(!i)throw new Error("[BitmapFont] Property `name` is required.");const{chars:r,padding:s,resolution:a,textureWidth:h,textureHeight:l,...c}=Object.assign({},Ze.defaultOptions,e),f=sC(r),p=t instanceof xr?t:new xr(t),g=h,_=new po;_.info[0]={face:p.fontFamily,size:p.fontSize},_.common[0]={lineHeight:p.fontSize};let v=0,y=0,A,w,R,M=0;const E=[];for(let U=0;U<f.length;U++){A||(A=q.ADAPTER.createCanvas(),A.width=h,A.height=l,w=A.getContext("2d"),R=new ft(A,{resolution:a,...c}),E.push(new it(R)),_.page.push({id:E.length-1,file:""}));const z=f[U],G=he.measureText(z,p,!1,A),k=G.width,Z=Math.ceil(G.height),nt=Math.ceil((p.fontStyle==="italic"?2:1)*k);if(y>=l-Z*a){if(y===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${z}')`);--U,A=null,w=null,R=null,y=0,v=0,M=0;continue}if(M=Math.max(Z+G.fontProperties.descent,M),nt*a+v>=g){if(v===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${p.fontFamily}', fontSize: ${p.fontSize}px, char: '${z}')`);--U,y+=M*a,y=Math.ceil(y),v=0,M=0;continue}nC(A,w,G,v,y,a,p);const V=io(G.text);_.char.push({id:V,page:E.length-1,x:v/a,y:y/a,width:nt,height:Z,xoffset:0,yoffset:0,xadvance:Math.ceil(k-(p.dropShadow?p.dropShadowDistance:0)-(p.stroke?p.strokeThickness:0))}),v+=(nt+2*s)*a,v=Math.ceil(v)}for(let U=0,z=f.length;U<z;U++){const G=f[U];for(let k=0;k<z;k++){const Z=f[k],nt=w.measureText(G).width,V=w.measureText(Z).width,X=w.measureText(G+Z).width-(nt+V);X&&_.kerning.push({first:io(G),second:io(Z),amount:X})}}const P=new Ze(_,E,!0);return Ze.available[i]!==void 0&&Ze.uninstall(i),Ze.available[i]=P,P}};let Te=Ze;Te.ALPHA=[["a","z"],["A","Z"]," "];Te.NUMERIC=[["0","9"]];Te.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Te.ASCII=[[" ","~"]];Te.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Ze.ALPHANUMERIC};Te.available={};var oC=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,aC=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const Hf=[],Xf=[],Wf=[],hp=class extends De{constructor(i,t={}){super(),this._tint=16777215;const{align:e,tint:r,maxWidth:s,letterSpacing:a,fontName:h,fontSize:l}=Object.assign({},hp.styleDefaults,t);if(!Te.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tint=r,this._font=void 0,this._fontName=h,this._fontSize=l,this.text=i,this._maxWidth=s,this._maxLineHeight=0,this._letterSpacing=a,this._anchor=new $i(()=>{this.dirty=!0},this,0,0),this._roundPixels=q.ROUND_PIXELS,this.dirty=!0,this._resolution=q.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var nt;const i=Te.available[this._fontName],t=this.fontSize,e=t/i.size,r=new Et,s=[],a=[],h=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=ap(l),f=this._maxWidth*i.size/t,p=i.distanceFieldType==="none"?Hf:Xf;let g=null,_=0,v=0,y=0,A=-1,w=0,R=0,M=0,E=0;for(let V=0;V<c.length;V++){const J=c[V],X=io(J);if(/(?:\s)/.test(J)&&(A=V,w=_,E++),J==="\r"||J===`
`){a.push(_),h.push(-1),v=Math.max(v,_),++y,++R,r.x=0,r.y+=i.lineHeight,g=null,E=0;continue}const O=i.chars[X];if(!O)continue;g&&O.kerning[g]&&(r.x+=O.kerning[g]);const dt=Wf.pop()||{texture:it.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Et};dt.texture=O.texture,dt.line=y,dt.charCode=X,dt.position.x=r.x+O.xOffset+this._letterSpacing/2,dt.position.y=r.y+O.yOffset,dt.prevSpaces=E,s.push(dt),_=dt.position.x+Math.max(O.xAdvance-O.xOffset,O.texture.orig.width),r.x+=O.xAdvance+this._letterSpacing,M=Math.max(M,O.yOffset+O.texture.height),g=X,A!==-1&&f>0&&r.x>f&&(++R,qr(s,1+A-R,1+V-A),V=A,A=-1,a.push(w),h.push(s.length>0?s[s.length-1].prevSpaces:0),v=Math.max(v,w),y++,r.x=0,r.y+=i.lineHeight,g=null,E=0)}const P=c[c.length-1];P!=="\r"&&P!==`
`&&(/(?:\s)/.test(P)&&(_=w),a.push(_),v=Math.max(v,_),h.push(-1));const U=[];for(let V=0;V<=y;V++){let J=0;this._align==="right"?J=v-a[V]:this._align==="center"?J=(v-a[V])/2:this._align==="justify"&&(J=h[V]<0?0:(v-a[V])/h[V]),U.push(J)}const z=s.length,G={},k=[],Z=this._activePagesMeshData;p.push(...Z);for(let V=0;V<z;V++){const J=s[V].texture,X=J.baseTexture.uid;if(!G[X]){let O=p.pop();if(!O){const _t=new DS;let Y,vt;i.distanceFieldType==="none"?(Y=new Nf(it.EMPTY),vt=lt.NORMAL):(Y=new Nf(it.EMPTY,{program:ti.from(aC,oC),uniforms:{uFWidth:0}}),vt=lt.NORMAL_NPM);const Ut=new Wh(_t,Y);Ut.blendMode=vt,O={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Ut,vertices:null,uvs:null,indices:null}}O.index=0,O.indexCount=0,O.vertexCount=0,O.uvsCount=0,O.total=0;const{_textureCache:dt}=this;dt[X]=dt[X]||new it(J.baseTexture),O.mesh.texture=dt[X],O.mesh.tint=this._tint,k.push(O),G[X]=O}G[X].total++}for(let V=0;V<Z.length;V++)k.includes(Z[V])||this.removeChild(Z[V].mesh);for(let V=0;V<k.length;V++)k[V].mesh.parent!==this&&this.addChild(k[V].mesh);this._activePagesMeshData=k;for(const V in G){const J=G[V],X=J.total;if(!(((nt=J.indices)==null?void 0:nt.length)>6*X)||J.vertices.length<Wh.BATCHABLE_SIZE*2)J.vertices=new Float32Array(4*2*X),J.uvs=new Float32Array(4*2*X),J.indices=new Uint16Array(6*X);else{const O=J.total,dt=J.vertices;for(let _t=O*4*2;_t<dt.length;_t++)dt[_t]=0}J.mesh.size=6*X}for(let V=0;V<z;V++){const J=s[V];let X=J.position.x+U[J.line]*(this._align==="justify"?J.prevSpaces:1);this._roundPixels&&(X=Math.round(X));const O=X*e,dt=J.position.y*e,_t=J.texture,Y=G[_t.baseTexture.uid],vt=_t.frame,Ut=_t._uvs,H=Y.index++;Y.indices[H*6+0]=0+H*4,Y.indices[H*6+1]=1+H*4,Y.indices[H*6+2]=2+H*4,Y.indices[H*6+3]=0+H*4,Y.indices[H*6+4]=2+H*4,Y.indices[H*6+5]=3+H*4,Y.vertices[H*8+0]=O,Y.vertices[H*8+1]=dt,Y.vertices[H*8+2]=O+vt.width*e,Y.vertices[H*8+3]=dt,Y.vertices[H*8+4]=O+vt.width*e,Y.vertices[H*8+5]=dt+vt.height*e,Y.vertices[H*8+6]=O,Y.vertices[H*8+7]=dt+vt.height*e,Y.uvs[H*8+0]=Ut.x0,Y.uvs[H*8+1]=Ut.y0,Y.uvs[H*8+2]=Ut.x1,Y.uvs[H*8+3]=Ut.y1,Y.uvs[H*8+4]=Ut.x2,Y.uvs[H*8+5]=Ut.y2,Y.uvs[H*8+6]=Ut.x3,Y.uvs[H*8+7]=Ut.y3}this._textWidth=v*e,this._textHeight=(r.y+i.lineHeight)*e;for(const V in G){const J=G[V];if(this.anchor.x!==0||this.anchor.y!==0){let _t=0;const Y=this._textWidth*this.anchor.x,vt=this._textHeight*this.anchor.y;for(let Ut=0;Ut<J.total;Ut++)J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt,J.vertices[_t++]-=Y,J.vertices[_t++]-=vt}this._maxLineHeight=M*e;const X=J.mesh.geometry.getBuffer("aVertexPosition"),O=J.mesh.geometry.getBuffer("aTextureCoord"),dt=J.mesh.geometry.getIndex();X.data=J.vertices,O.data=J.uvs,dt.data=J.indices,X.update(),O.update(),dt.update()}for(let V=0;V<s.length;V++)Wf.push(s[V]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:r}=Te.available[this._fontName];if(e!=="none"){const{a:s,b:a,c:h,d:l}=this.worldTransform,c=Math.sqrt(s*s+a*a),f=Math.sqrt(h*h+l*l),p=(Math.abs(c)+Math.abs(f))/2,g=this.fontSize/r,_=i._view.resolution;for(const v of this._activePagesMeshData)v.mesh.shader.uniforms.uFWidth=p*t*g*_}super._render(i)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const i=Te.available[this._fontName];if(!i)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==i&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(i){if(this._tint!==i){this._tint=i;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=i}}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.dirty=!0)}get fontName(){return this._fontName}set fontName(i){if(!Te.available[i])throw new Error(`Missing BitmapFont "${i}"`);this._fontName!==i&&(this._fontName=i,this.dirty=!0)}get fontSize(){return this._fontSize??Te.available[this._fontName].size}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.dirty=!0)}get anchor(){return this._anchor}set anchor(i){typeof i=="number"?this._anchor.set(i):this._anchor.copyFrom(i)}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(i){this._maxWidth!==i&&(this._maxWidth=i,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(i){i!==this._roundPixels&&(this._roundPixels=i,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}destroy(i){const{_textureCache:t}=this,r=Te.available[this._fontName].distanceFieldType==="none"?Hf:Xf;r.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],r.filter(s=>t[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=it.EMPTY});for(const s in t)t[s].destroy(),delete t[s];this._font=null,this._textureCache=null,super.destroy(i)}};let hC=hp;hC.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const lC=[".xml",".fnt"],uC={extension:{type:j.LoadParser,priority:_i.Normal},test(i){return lC.includes(ue.extname(i).toLowerCase())},async testParse(i){return eo.test(i)||Yh.test(i)},async parse(i,t,e){const r=eo.test(i)?eo.parse(i):Yh.parse(i),{src:s}=t,{page:a}=r,h=[];for(let f=0;f<a.length;++f){const p=a[f].file,g=ue.join(ue.dirname(s),p);h.push(g)}const l=await e.load(h),c=h.map(f=>l[f]);return Te.install(r,c,!0)},async load(i,t){return(await q.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};rt.add(uC);const cC={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},fC={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"};let lp;const up={width:100,height:44},Wr=window.innerWidth/up.width,gr={};async function dC(i){lp=new rl({view:i,width:window.innerWidth,height:Wr*up.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await pC()}const pC=async()=>(gr.ascii=await dr.load("/skulltooth/fonts/menlo-bold.json"),gr.text=await dr.load("/skulltooth/fonts/menlo-bold-half.json"),gr.tile=await dr.load("/skulltooth/tile.png"),gr),gC=i=>gr.ascii.textures[cC[i]],mC=i=>gr.text.textures[fC[i]],_C=()=>gr.tile;class zf{constructor(t){li(this,"width");li(this,"height");li(this,"layers",[]);li(this,"sprites",[]);li(this,"_getTexture",t=>{const{tileSet:e,char:r}=t;return e==="ascii"?gC(r):e==="text"?mC(r):_C()});li(this,"_createSprite",t=>{const{char:e,width:r,height:s,halfWidth:a,layer:h,x:l,y:c,tileSet:f,tint:p=16777215,alpha:g=1}=t,_=this._getTexture({tileSet:f,char:e});let v=new en(_);v.width=a?r/2:r,v.height=s,v.x=a?l*(r/2):l*r,v.y=c*s,v.tint=p,v.alpha=g,this.sprites[h][c][l]=v,this.layers[h].addChild(v)});li(this,"updateCell",t=>{Object.keys(t).forEach(e=>{const{char:r,tint:s,alpha:a,tileSet:h,x:l,y:c}=t[e];this.updateSprite({char:r,tint:s,alpha:a,tileSet:h,x:l,y:c,layer:parseInt(e)})})});li(this,"updateSprite",async t=>{const{char:e="",layer:r,x:s,y:a,tileSet:h="text",tint:l,alpha:c}=t,f=this.sprites[r][a][s];f.texture=this._getTexture({tileSet:h,char:e}),l&&(f.tint=l),c&&(f.alpha=c)});li(this,"updateRow",t=>{const{string:e,layer:r,x:s,y:a,tileSet:h,tint:l,alpha:c}=t;return e&&[...e].forEach((f,p)=>this.updateSprite({char:f,layer:r,x:s+p,y:a,tileSet:h,tint:l,alpha:c})),h==="tile"&&Or.times(this.width,f=>{this.updateSprite({layer:r,x:s+f,y:a,tileSet:h,tint:l,alpha:c})}),this});return this.width=t.width,this.height=t.height,Or.times(t.layers,()=>this.layers.push(new De)),this.layers.forEach(e=>{const r=t.halfWidth?t.x*(Wr/2):t.x*Wr,s=t.y*Wr;e.x=r,e.y=s,e.interactiveChildren=!1,lp.stage.addChild(e)}),Or.times(t.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),Or.times(t.layers,e=>{Or.times(this.height,r=>{Or.times(this.width,async s=>{this._createSprite({char:t.char,width:Wr,height:Wr,halfWidth:t.halfWidth,layer:e,x:s,y:r,tileSet:t.tileSet,tint:t.tint,alpha:t.alpha})})})}),this}}const vC=async()=>{await dC(document.querySelector("#canvas"));const i=new zf({width:13,height:3,x:0,y:0,halfWidth:!1,char:" ",layers:4,tileSet:"ascii",tint:16775039,alpha:1});i.updateRow({string:"SkulltoothFC",layer:0,x:0,y:0,tileSet:"tile",tint:16777215,alpha:1}),i.updateRow({string:" Skulltooth",layer:1,x:0,y:0,tileSet:"ascii",tint:16711799,alpha:1}),i.updateRow({string:"Force Crusher",layer:0,x:0,y:1,tileSet:"tile",tint:16711799,alpha:1}),i.updateRow({string:"Force Crusher",layer:1,x:0,y:1,tileSet:"ascii",tint:16777215,alpha:1}),i.updateCell({0:{char:"?",tint:921102,alpha:1,tileSet:"tile",x:0,y:0},1:{char:"?",tint:12648430,alpha:1,tileSet:"ascii",x:0,y:0},2:{char:"!",tint:12648430,alpha:1,tileSet:"ascii",x:0,y:0},3:{char:"!",tint:12648430,alpha:.5,tileSet:"tile",x:0,y:0}}),new zf({width:13,height:1,x:0,y:43,halfWidth:!0,char:" ",layers:1,tileSet:"text",tint:16775039,alpha:1}).updateRow({string:"TAG: 7276b20",layer:0,x:0,y:0,tileSet:"text",tint:16777215,alpha:1})};vC();
