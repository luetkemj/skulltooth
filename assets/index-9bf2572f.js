var Fb=Object.defineProperty;var Lb=(i,t,e)=>t in i?Fb(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var Jt=(i,t,e)=>(Lb(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();var Hi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ob(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var be={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,t){(function(){var e,n="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",l="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,d="__lodash_placeholder__",g=1,m=2,_=4,v=1,w=2,y=1,T=2,S=4,A=8,I=16,D=32,N=64,L=128,F=256,V=512,J=30,z="...",Q=800,X=16,G=1,dt=2,_t=3,j=1/0,vt=9007199254740991,Wt=17976931348623157e292,H=0/0,it=4294967295,yt=it-1,Rt=it>>>1,Mt=[["ary",L],["bind",y],["bindKey",T],["curry",A],["curryRight",I],["flip",V],["partial",D],["partialRight",N],["rearg",F]],Ot="[object Arguments]",Nt="[object Array]",ie="[object AsyncFunction]",jt="[object Boolean]",ne="[object Date]",se="[object DOMException]",Dt="[object Error]",kt="[object Function]",qt="[object GeneratorFunction]",Kt="[object Map]",ve="[object Number]",mn="[object Null]",mi="[object Object]",gu="[object Promise]",Jg="[object Proxy]",Mr="[object RegExp]",Je="[object Set]",Dr="[object String]",xs="[object Symbol]",Qg="[object Undefined]",Br="[object WeakMap]",tm="[object WeakSet]",Fr="[object ArrayBuffer]",Xn="[object DataView]",ma="[object Float32Array]",_a="[object Float64Array]",va="[object Int8Array]",xa="[object Int16Array]",ya="[object Int32Array]",ba="[object Uint8Array]",wa="[object Uint8ClampedArray]",Ea="[object Uint16Array]",Ta="[object Uint32Array]",em=/\b__p \+= '';/g,im=/\b(__p \+=) '' \+/g,nm=/(__e\(.*?\)|\b__t\)) \+\n'';/g,mu=/&(?:amp|lt|gt|quot|#39);/g,_u=/[&<>"']/g,rm=RegExp(mu.source),sm=RegExp(_u.source),om=/<%-([\s\S]+?)%>/g,am=/<%([\s\S]+?)%>/g,vu=/<%=([\s\S]+?)%>/g,hm=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,lm=/^\w*$/,um=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Aa=/[\\^$.*+?()[\]{}|]/g,cm=RegExp(Aa.source),Sa=/^\s+/,fm=/\s/,dm=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,pm=/\{\n\/\* \[wrapped with (.+)\] \*/,gm=/,? & /,mm=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,_m=/[()=,{}\[\]\/\s]/,vm=/\\(\\)?/g,xm=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xu=/\w*$/,ym=/^[-+]0x[0-9a-f]+$/i,bm=/^0b[01]+$/i,wm=/^\[object .+?Constructor\]$/,Em=/^0o[0-7]+$/i,Tm=/^(?:0|[1-9]\d*)$/,Am=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ys=/($^)/,Sm=/['\n\r\u2028\u2029\\]/g,bs="\\ud800-\\udfff",Cm="\\u0300-\\u036f",Im="\\ufe20-\\ufe2f",Rm="\\u20d0-\\u20ff",yu=Cm+Im+Rm,bu="\\u2700-\\u27bf",wu="a-z\\xdf-\\xf6\\xf8-\\xff",Pm="\\xac\\xb1\\xd7\\xf7",Mm="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Dm="\\u2000-\\u206f",Bm=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Eu="A-Z\\xc0-\\xd6\\xd8-\\xde",Tu="\\ufe0e\\ufe0f",Au=Pm+Mm+Dm+Bm,Ca="['’]",Fm="["+bs+"]",Su="["+Au+"]",ws="["+yu+"]",Cu="\\d+",Lm="["+bu+"]",Iu="["+wu+"]",Ru="[^"+bs+Au+Cu+bu+wu+Eu+"]",Ia="\\ud83c[\\udffb-\\udfff]",Om="(?:"+ws+"|"+Ia+")",Pu="[^"+bs+"]",Ra="(?:\\ud83c[\\udde6-\\uddff]){2}",Pa="[\\ud800-\\udbff][\\udc00-\\udfff]",$n="["+Eu+"]",Mu="\\u200d",Du="(?:"+Iu+"|"+Ru+")",Nm="(?:"+$n+"|"+Ru+")",Bu="(?:"+Ca+"(?:d|ll|m|re|s|t|ve))?",Fu="(?:"+Ca+"(?:D|LL|M|RE|S|T|VE))?",Lu=Om+"?",Ou="["+Tu+"]?",km="(?:"+Mu+"(?:"+[Pu,Ra,Pa].join("|")+")"+Ou+Lu+")*",Um="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Gm="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Nu=Ou+Lu+km,Wm="(?:"+[Lm,Ra,Pa].join("|")+")"+Nu,Hm="(?:"+[Pu+ws+"?",ws,Ra,Pa,Fm].join("|")+")",Xm=RegExp(Ca,"g"),$m=RegExp(ws,"g"),Ma=RegExp(Ia+"(?="+Ia+")|"+Hm+Nu,"g"),zm=RegExp([$n+"?"+Iu+"+"+Bu+"(?="+[Su,$n,"$"].join("|")+")",Nm+"+"+Fu+"(?="+[Su,$n+Du,"$"].join("|")+")",$n+"?"+Du+"+"+Bu,$n+"+"+Fu,Gm,Um,Cu,Wm].join("|"),"g"),Vm=RegExp("["+Mu+bs+yu+Tu+"]"),Ym=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,jm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qm=-1,Ut={};Ut[ma]=Ut[_a]=Ut[va]=Ut[xa]=Ut[ya]=Ut[ba]=Ut[wa]=Ut[Ea]=Ut[Ta]=!0,Ut[Ot]=Ut[Nt]=Ut[Fr]=Ut[jt]=Ut[Xn]=Ut[ne]=Ut[Dt]=Ut[kt]=Ut[Kt]=Ut[ve]=Ut[mi]=Ut[Mr]=Ut[Je]=Ut[Dr]=Ut[Br]=!1;var Lt={};Lt[Ot]=Lt[Nt]=Lt[Fr]=Lt[Xn]=Lt[jt]=Lt[ne]=Lt[ma]=Lt[_a]=Lt[va]=Lt[xa]=Lt[ya]=Lt[Kt]=Lt[ve]=Lt[mi]=Lt[Mr]=Lt[Je]=Lt[Dr]=Lt[xs]=Lt[ba]=Lt[wa]=Lt[Ea]=Lt[Ta]=!0,Lt[Dt]=Lt[kt]=Lt[Br]=!1;var Km={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},Zm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Jm={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qm={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},t_=parseFloat,e_=parseInt,ku=typeof Hi=="object"&&Hi&&Hi.Object===Object&&Hi,i_=typeof self=="object"&&self&&self.Object===Object&&self,ce=ku||i_||Function("return this")(),Da=t&&!t.nodeType&&t,_n=Da&&!0&&i&&!i.nodeType&&i,Uu=_n&&_n.exports===Da,Ba=Uu&&ku.process,He=function(){try{var P=_n&&_n.require&&_n.require("util").types;return P||Ba&&Ba.binding&&Ba.binding("util")}catch{}}(),Gu=He&&He.isArrayBuffer,Wu=He&&He.isDate,Hu=He&&He.isMap,Xu=He&&He.isRegExp,$u=He&&He.isSet,zu=He&&He.isTypedArray;function De(P,O,B){switch(B.length){case 0:return P.call(O);case 1:return P.call(O,B[0]);case 2:return P.call(O,B[0],B[1]);case 3:return P.call(O,B[0],B[1],B[2])}return P.apply(O,B)}function n_(P,O,B,Z){for(var ut=-1,It=P==null?0:P.length;++ut<It;){var oe=P[ut];O(Z,oe,B(oe),P)}return Z}function Xe(P,O){for(var B=-1,Z=P==null?0:P.length;++B<Z&&O(P[B],B,P)!==!1;);return P}function r_(P,O){for(var B=P==null?0:P.length;B--&&O(P[B],B,P)!==!1;);return P}function Vu(P,O){for(var B=-1,Z=P==null?0:P.length;++B<Z;)if(!O(P[B],B,P))return!1;return!0}function Ki(P,O){for(var B=-1,Z=P==null?0:P.length,ut=0,It=[];++B<Z;){var oe=P[B];O(oe,B,P)&&(It[ut++]=oe)}return It}function Es(P,O){var B=P==null?0:P.length;return!!B&&zn(P,O,0)>-1}function Fa(P,O,B){for(var Z=-1,ut=P==null?0:P.length;++Z<ut;)if(B(O,P[Z]))return!0;return!1}function Ht(P,O){for(var B=-1,Z=P==null?0:P.length,ut=Array(Z);++B<Z;)ut[B]=O(P[B],B,P);return ut}function Zi(P,O){for(var B=-1,Z=O.length,ut=P.length;++B<Z;)P[ut+B]=O[B];return P}function La(P,O,B,Z){var ut=-1,It=P==null?0:P.length;for(Z&&It&&(B=P[++ut]);++ut<It;)B=O(B,P[ut],ut,P);return B}function s_(P,O,B,Z){var ut=P==null?0:P.length;for(Z&&ut&&(B=P[--ut]);ut--;)B=O(B,P[ut],ut,P);return B}function Oa(P,O){for(var B=-1,Z=P==null?0:P.length;++B<Z;)if(O(P[B],B,P))return!0;return!1}var o_=Na("length");function a_(P){return P.split("")}function h_(P){return P.match(mm)||[]}function Yu(P,O,B){var Z;return B(P,function(ut,It,oe){if(O(ut,It,oe))return Z=It,!1}),Z}function Ts(P,O,B,Z){for(var ut=P.length,It=B+(Z?1:-1);Z?It--:++It<ut;)if(O(P[It],It,P))return It;return-1}function zn(P,O,B){return O===O?y_(P,O,B):Ts(P,ju,B)}function l_(P,O,B,Z){for(var ut=B-1,It=P.length;++ut<It;)if(Z(P[ut],O))return ut;return-1}function ju(P){return P!==P}function qu(P,O){var B=P==null?0:P.length;return B?Ua(P,O)/B:H}function Na(P){return function(O){return O==null?e:O[P]}}function ka(P){return function(O){return P==null?e:P[O]}}function Ku(P,O,B,Z,ut){return ut(P,function(It,oe,Ft){B=Z?(Z=!1,It):O(B,It,oe,Ft)}),B}function u_(P,O){var B=P.length;for(P.sort(O);B--;)P[B]=P[B].value;return P}function Ua(P,O){for(var B,Z=-1,ut=P.length;++Z<ut;){var It=O(P[Z]);It!==e&&(B=B===e?It:B+It)}return B}function Ga(P,O){for(var B=-1,Z=Array(P);++B<P;)Z[B]=O(B);return Z}function c_(P,O){return Ht(O,function(B){return[B,P[B]]})}function Zu(P){return P&&P.slice(0,ec(P)+1).replace(Sa,"")}function Be(P){return function(O){return P(O)}}function Wa(P,O){return Ht(O,function(B){return P[B]})}function Lr(P,O){return P.has(O)}function Ju(P,O){for(var B=-1,Z=P.length;++B<Z&&zn(O,P[B],0)>-1;);return B}function Qu(P,O){for(var B=P.length;B--&&zn(O,P[B],0)>-1;);return B}function f_(P,O){for(var B=P.length,Z=0;B--;)P[B]===O&&++Z;return Z}var d_=ka(Km),p_=ka(Zm);function g_(P){return"\\"+Qm[P]}function m_(P,O){return P==null?e:P[O]}function Vn(P){return Vm.test(P)}function __(P){return Ym.test(P)}function v_(P){for(var O,B=[];!(O=P.next()).done;)B.push(O.value);return B}function Ha(P){var O=-1,B=Array(P.size);return P.forEach(function(Z,ut){B[++O]=[ut,Z]}),B}function tc(P,O){return function(B){return P(O(B))}}function Ji(P,O){for(var B=-1,Z=P.length,ut=0,It=[];++B<Z;){var oe=P[B];(oe===O||oe===d)&&(P[B]=d,It[ut++]=B)}return It}function As(P){var O=-1,B=Array(P.size);return P.forEach(function(Z){B[++O]=Z}),B}function x_(P){var O=-1,B=Array(P.size);return P.forEach(function(Z){B[++O]=[Z,Z]}),B}function y_(P,O,B){for(var Z=B-1,ut=P.length;++Z<ut;)if(P[Z]===O)return Z;return-1}function b_(P,O,B){for(var Z=B+1;Z--;)if(P[Z]===O)return Z;return Z}function Yn(P){return Vn(P)?E_(P):o_(P)}function Qe(P){return Vn(P)?T_(P):a_(P)}function ec(P){for(var O=P.length;O--&&fm.test(P.charAt(O)););return O}var w_=ka(Jm);function E_(P){for(var O=Ma.lastIndex=0;Ma.test(P);)++O;return O}function T_(P){return P.match(Ma)||[]}function A_(P){return P.match(zm)||[]}var S_=function P(O){O=O==null?ce:jn.defaults(ce.Object(),O,jn.pick(ce,jm));var B=O.Array,Z=O.Date,ut=O.Error,It=O.Function,oe=O.Math,Ft=O.Object,Xa=O.RegExp,C_=O.String,$e=O.TypeError,Ss=B.prototype,I_=It.prototype,qn=Ft.prototype,Cs=O["__core-js_shared__"],Is=I_.toString,Bt=qn.hasOwnProperty,R_=0,ic=function(){var s=/[^.]+$/.exec(Cs&&Cs.keys&&Cs.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),Rs=qn.toString,P_=Is.call(Ft),M_=ce._,D_=Xa("^"+Is.call(Bt).replace(Aa,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ps=Uu?O.Buffer:e,Qi=O.Symbol,Ms=O.Uint8Array,nc=Ps?Ps.allocUnsafe:e,Ds=tc(Ft.getPrototypeOf,Ft),rc=Ft.create,sc=qn.propertyIsEnumerable,Bs=Ss.splice,oc=Qi?Qi.isConcatSpreadable:e,Or=Qi?Qi.iterator:e,vn=Qi?Qi.toStringTag:e,Fs=function(){try{var s=En(Ft,"defineProperty");return s({},"",{}),s}catch{}}(),B_=O.clearTimeout!==ce.clearTimeout&&O.clearTimeout,F_=Z&&Z.now!==ce.Date.now&&Z.now,L_=O.setTimeout!==ce.setTimeout&&O.setTimeout,Ls=oe.ceil,Os=oe.floor,$a=Ft.getOwnPropertySymbols,O_=Ps?Ps.isBuffer:e,ac=O.isFinite,N_=Ss.join,k_=tc(Ft.keys,Ft),ae=oe.max,xe=oe.min,U_=Z.now,G_=O.parseInt,hc=oe.random,W_=Ss.reverse,za=En(O,"DataView"),Nr=En(O,"Map"),Va=En(O,"Promise"),Kn=En(O,"Set"),kr=En(O,"WeakMap"),Ur=En(Ft,"create"),Ns=kr&&new kr,Zn={},H_=Tn(za),X_=Tn(Nr),$_=Tn(Va),z_=Tn(Kn),V_=Tn(kr),ks=Qi?Qi.prototype:e,Gr=ks?ks.valueOf:e,lc=ks?ks.toString:e;function b(s){if(Zt(s)&&!ct(s)&&!(s instanceof bt)){if(s instanceof ze)return s;if(Bt.call(s,"__wrapped__"))return cf(s)}return new ze(s)}var Jn=function(){function s(){}return function(a){if(!$t(a))return{};if(rc)return rc(a);s.prototype=a;var u=new s;return s.prototype=e,u}}();function Us(){}function ze(s,a){this.__wrapped__=s,this.__actions__=[],this.__chain__=!!a,this.__index__=0,this.__values__=e}b.templateSettings={escape:om,evaluate:am,interpolate:vu,variable:"",imports:{_:b}},b.prototype=Us.prototype,b.prototype.constructor=b,ze.prototype=Jn(Us.prototype),ze.prototype.constructor=ze;function bt(s){this.__wrapped__=s,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=it,this.__views__=[]}function Y_(){var s=new bt(this.__wrapped__);return s.__actions__=Se(this.__actions__),s.__dir__=this.__dir__,s.__filtered__=this.__filtered__,s.__iteratees__=Se(this.__iteratees__),s.__takeCount__=this.__takeCount__,s.__views__=Se(this.__views__),s}function j_(){if(this.__filtered__){var s=new bt(this);s.__dir__=-1,s.__filtered__=!0}else s=this.clone(),s.__dir__*=-1;return s}function q_(){var s=this.__wrapped__.value(),a=this.__dir__,u=ct(s),p=a<0,x=u?s.length:0,E=av(0,x,this.__views__),C=E.start,R=E.end,M=R-C,k=p?R:C-1,U=this.__iteratees__,W=U.length,Y=0,tt=xe(M,this.__takeCount__);if(!u||!p&&x==M&&tt==M)return Bc(s,this.__actions__);var at=[];t:for(;M--&&Y<tt;){k+=a;for(var gt=-1,ht=s[k];++gt<W;){var xt=U[gt],Et=xt.iteratee,Oe=xt.type,Te=Et(ht);if(Oe==dt)ht=Te;else if(!Te){if(Oe==G)continue t;break t}}at[Y++]=ht}return at}bt.prototype=Jn(Us.prototype),bt.prototype.constructor=bt;function xn(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function K_(){this.__data__=Ur?Ur(null):{},this.size=0}function Z_(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}function J_(s){var a=this.__data__;if(Ur){var u=a[s];return u===c?e:u}return Bt.call(a,s)?a[s]:e}function Q_(s){var a=this.__data__;return Ur?a[s]!==e:Bt.call(a,s)}function t0(s,a){var u=this.__data__;return this.size+=this.has(s)?0:1,u[s]=Ur&&a===e?c:a,this}xn.prototype.clear=K_,xn.prototype.delete=Z_,xn.prototype.get=J_,xn.prototype.has=Q_,xn.prototype.set=t0;function Pi(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function e0(){this.__data__=[],this.size=0}function i0(s){var a=this.__data__,u=Gs(a,s);if(u<0)return!1;var p=a.length-1;return u==p?a.pop():Bs.call(a,u,1),--this.size,!0}function n0(s){var a=this.__data__,u=Gs(a,s);return u<0?e:a[u][1]}function r0(s){return Gs(this.__data__,s)>-1}function s0(s,a){var u=this.__data__,p=Gs(u,s);return p<0?(++this.size,u.push([s,a])):u[p][1]=a,this}Pi.prototype.clear=e0,Pi.prototype.delete=i0,Pi.prototype.get=n0,Pi.prototype.has=r0,Pi.prototype.set=s0;function Mi(s){var a=-1,u=s==null?0:s.length;for(this.clear();++a<u;){var p=s[a];this.set(p[0],p[1])}}function o0(){this.size=0,this.__data__={hash:new xn,map:new(Nr||Pi),string:new xn}}function a0(s){var a=Js(this,s).delete(s);return this.size-=a?1:0,a}function h0(s){return Js(this,s).get(s)}function l0(s){return Js(this,s).has(s)}function u0(s,a){var u=Js(this,s),p=u.size;return u.set(s,a),this.size+=u.size==p?0:1,this}Mi.prototype.clear=o0,Mi.prototype.delete=a0,Mi.prototype.get=h0,Mi.prototype.has=l0,Mi.prototype.set=u0;function yn(s){var a=-1,u=s==null?0:s.length;for(this.__data__=new Mi;++a<u;)this.add(s[a])}function c0(s){return this.__data__.set(s,c),this}function f0(s){return this.__data__.has(s)}yn.prototype.add=yn.prototype.push=c0,yn.prototype.has=f0;function ti(s){var a=this.__data__=new Pi(s);this.size=a.size}function d0(){this.__data__=new Pi,this.size=0}function p0(s){var a=this.__data__,u=a.delete(s);return this.size=a.size,u}function g0(s){return this.__data__.get(s)}function m0(s){return this.__data__.has(s)}function _0(s,a){var u=this.__data__;if(u instanceof Pi){var p=u.__data__;if(!Nr||p.length<r-1)return p.push([s,a]),this.size=++u.size,this;u=this.__data__=new Mi(p)}return u.set(s,a),this.size=u.size,this}ti.prototype.clear=d0,ti.prototype.delete=p0,ti.prototype.get=g0,ti.prototype.has=m0,ti.prototype.set=_0;function uc(s,a){var u=ct(s),p=!u&&An(s),x=!u&&!p&&sn(s),E=!u&&!p&&!x&&ir(s),C=u||p||x||E,R=C?Ga(s.length,C_):[],M=R.length;for(var k in s)(a||Bt.call(s,k))&&!(C&&(k=="length"||x&&(k=="offset"||k=="parent")||E&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||Li(k,M)))&&R.push(k);return R}function cc(s){var a=s.length;return a?s[nh(0,a-1)]:e}function v0(s,a){return Qs(Se(s),bn(a,0,s.length))}function x0(s){return Qs(Se(s))}function Ya(s,a,u){(u!==e&&!ei(s[a],u)||u===e&&!(a in s))&&Di(s,a,u)}function Wr(s,a,u){var p=s[a];(!(Bt.call(s,a)&&ei(p,u))||u===e&&!(a in s))&&Di(s,a,u)}function Gs(s,a){for(var u=s.length;u--;)if(ei(s[u][0],a))return u;return-1}function y0(s,a,u,p){return tn(s,function(x,E,C){a(p,x,u(x),C)}),p}function fc(s,a){return s&&vi(a,le(a),s)}function b0(s,a){return s&&vi(a,Ie(a),s)}function Di(s,a,u){a=="__proto__"&&Fs?Fs(s,a,{configurable:!0,enumerable:!0,value:u,writable:!0}):s[a]=u}function ja(s,a){for(var u=-1,p=a.length,x=B(p),E=s==null;++u<p;)x[u]=E?e:Ih(s,a[u]);return x}function bn(s,a,u){return s===s&&(u!==e&&(s=s<=u?s:u),a!==e&&(s=s>=a?s:a)),s}function Ve(s,a,u,p,x,E){var C,R=a&g,M=a&m,k=a&_;if(u&&(C=x?u(s,p,x,E):u(s)),C!==e)return C;if(!$t(s))return s;var U=ct(s);if(U){if(C=lv(s),!R)return Se(s,C)}else{var W=ye(s),Y=W==kt||W==qt;if(sn(s))return Oc(s,R);if(W==mi||W==Ot||Y&&!x){if(C=M||Y?{}:ef(s),!R)return M?J0(s,b0(C,s)):Z0(s,fc(C,s))}else{if(!Lt[W])return x?s:{};C=uv(s,W,R)}}E||(E=new ti);var tt=E.get(s);if(tt)return tt;E.set(s,C),Mf(s)?s.forEach(function(ht){C.add(Ve(ht,a,u,ht,s,E))}):Rf(s)&&s.forEach(function(ht,xt){C.set(xt,Ve(ht,a,u,xt,s,E))});var at=k?M?ph:dh:M?Ie:le,gt=U?e:at(s);return Xe(gt||s,function(ht,xt){gt&&(xt=ht,ht=s[xt]),Wr(C,xt,Ve(ht,a,u,xt,s,E))}),C}function w0(s){var a=le(s);return function(u){return dc(u,s,a)}}function dc(s,a,u){var p=u.length;if(s==null)return!p;for(s=Ft(s);p--;){var x=u[p],E=a[x],C=s[x];if(C===e&&!(x in s)||!E(C))return!1}return!0}function pc(s,a,u){if(typeof s!="function")throw new $e(h);return jr(function(){s.apply(e,u)},a)}function Hr(s,a,u,p){var x=-1,E=Es,C=!0,R=s.length,M=[],k=a.length;if(!R)return M;u&&(a=Ht(a,Be(u))),p?(E=Fa,C=!1):a.length>=r&&(E=Lr,C=!1,a=new yn(a));t:for(;++x<R;){var U=s[x],W=u==null?U:u(U);if(U=p||U!==0?U:0,C&&W===W){for(var Y=k;Y--;)if(a[Y]===W)continue t;M.push(U)}else E(a,W,p)||M.push(U)}return M}var tn=Wc(_i),gc=Wc(Ka,!0);function E0(s,a){var u=!0;return tn(s,function(p,x,E){return u=!!a(p,x,E),u}),u}function Ws(s,a,u){for(var p=-1,x=s.length;++p<x;){var E=s[p],C=a(E);if(C!=null&&(R===e?C===C&&!Le(C):u(C,R)))var R=C,M=E}return M}function T0(s,a,u,p){var x=s.length;for(u=pt(u),u<0&&(u=-u>x?0:x+u),p=p===e||p>x?x:pt(p),p<0&&(p+=x),p=u>p?0:Bf(p);u<p;)s[u++]=a;return s}function mc(s,a){var u=[];return tn(s,function(p,x,E){a(p,x,E)&&u.push(p)}),u}function fe(s,a,u,p,x){var E=-1,C=s.length;for(u||(u=fv),x||(x=[]);++E<C;){var R=s[E];a>0&&u(R)?a>1?fe(R,a-1,u,p,x):Zi(x,R):p||(x[x.length]=R)}return x}var qa=Hc(),_c=Hc(!0);function _i(s,a){return s&&qa(s,a,le)}function Ka(s,a){return s&&_c(s,a,le)}function Hs(s,a){return Ki(a,function(u){return Oi(s[u])})}function wn(s,a){a=nn(a,s);for(var u=0,p=a.length;s!=null&&u<p;)s=s[xi(a[u++])];return u&&u==p?s:e}function vc(s,a,u){var p=a(s);return ct(s)?p:Zi(p,u(s))}function we(s){return s==null?s===e?Qg:mn:vn&&vn in Ft(s)?ov(s):xv(s)}function Za(s,a){return s>a}function A0(s,a){return s!=null&&Bt.call(s,a)}function S0(s,a){return s!=null&&a in Ft(s)}function C0(s,a,u){return s>=xe(a,u)&&s<ae(a,u)}function Ja(s,a,u){for(var p=u?Fa:Es,x=s[0].length,E=s.length,C=E,R=B(E),M=1/0,k=[];C--;){var U=s[C];C&&a&&(U=Ht(U,Be(a))),M=xe(U.length,M),R[C]=!u&&(a||x>=120&&U.length>=120)?new yn(C&&U):e}U=s[0];var W=-1,Y=R[0];t:for(;++W<x&&k.length<M;){var tt=U[W],at=a?a(tt):tt;if(tt=u||tt!==0?tt:0,!(Y?Lr(Y,at):p(k,at,u))){for(C=E;--C;){var gt=R[C];if(!(gt?Lr(gt,at):p(s[C],at,u)))continue t}Y&&Y.push(at),k.push(tt)}}return k}function I0(s,a,u,p){return _i(s,function(x,E,C){a(p,u(x),E,C)}),p}function Xr(s,a,u){a=nn(a,s),s=of(s,a);var p=s==null?s:s[xi(je(a))];return p==null?e:De(p,s,u)}function xc(s){return Zt(s)&&we(s)==Ot}function R0(s){return Zt(s)&&we(s)==Fr}function P0(s){return Zt(s)&&we(s)==ne}function $r(s,a,u,p,x){return s===a?!0:s==null||a==null||!Zt(s)&&!Zt(a)?s!==s&&a!==a:M0(s,a,u,p,$r,x)}function M0(s,a,u,p,x,E){var C=ct(s),R=ct(a),M=C?Nt:ye(s),k=R?Nt:ye(a);M=M==Ot?mi:M,k=k==Ot?mi:k;var U=M==mi,W=k==mi,Y=M==k;if(Y&&sn(s)){if(!sn(a))return!1;C=!0,U=!1}if(Y&&!U)return E||(E=new ti),C||ir(s)?Jc(s,a,u,p,x,E):rv(s,a,M,u,p,x,E);if(!(u&v)){var tt=U&&Bt.call(s,"__wrapped__"),at=W&&Bt.call(a,"__wrapped__");if(tt||at){var gt=tt?s.value():s,ht=at?a.value():a;return E||(E=new ti),x(gt,ht,u,p,E)}}return Y?(E||(E=new ti),sv(s,a,u,p,x,E)):!1}function D0(s){return Zt(s)&&ye(s)==Kt}function Qa(s,a,u,p){var x=u.length,E=x,C=!p;if(s==null)return!E;for(s=Ft(s);x--;){var R=u[x];if(C&&R[2]?R[1]!==s[R[0]]:!(R[0]in s))return!1}for(;++x<E;){R=u[x];var M=R[0],k=s[M],U=R[1];if(C&&R[2]){if(k===e&&!(M in s))return!1}else{var W=new ti;if(p)var Y=p(k,U,M,s,a,W);if(!(Y===e?$r(U,k,v|w,p,W):Y))return!1}}return!0}function yc(s){if(!$t(s)||pv(s))return!1;var a=Oi(s)?D_:wm;return a.test(Tn(s))}function B0(s){return Zt(s)&&we(s)==Mr}function F0(s){return Zt(s)&&ye(s)==Je}function L0(s){return Zt(s)&&so(s.length)&&!!Ut[we(s)]}function bc(s){return typeof s=="function"?s:s==null?Re:typeof s=="object"?ct(s)?Tc(s[0],s[1]):Ec(s):$f(s)}function th(s){if(!Yr(s))return k_(s);var a=[];for(var u in Ft(s))Bt.call(s,u)&&u!="constructor"&&a.push(u);return a}function O0(s){if(!$t(s))return vv(s);var a=Yr(s),u=[];for(var p in s)p=="constructor"&&(a||!Bt.call(s,p))||u.push(p);return u}function eh(s,a){return s<a}function wc(s,a){var u=-1,p=Ce(s)?B(s.length):[];return tn(s,function(x,E,C){p[++u]=a(x,E,C)}),p}function Ec(s){var a=mh(s);return a.length==1&&a[0][2]?rf(a[0][0],a[0][1]):function(u){return u===s||Qa(u,s,a)}}function Tc(s,a){return vh(s)&&nf(a)?rf(xi(s),a):function(u){var p=Ih(u,s);return p===e&&p===a?Rh(u,s):$r(a,p,v|w)}}function Xs(s,a,u,p,x){s!==a&&qa(a,function(E,C){if(x||(x=new ti),$t(E))N0(s,a,C,u,Xs,p,x);else{var R=p?p(yh(s,C),E,C+"",s,a,x):e;R===e&&(R=E),Ya(s,C,R)}},Ie)}function N0(s,a,u,p,x,E,C){var R=yh(s,u),M=yh(a,u),k=C.get(M);if(k){Ya(s,u,k);return}var U=E?E(R,M,u+"",s,a,C):e,W=U===e;if(W){var Y=ct(M),tt=!Y&&sn(M),at=!Y&&!tt&&ir(M);U=M,Y||tt||at?ct(R)?U=R:Qt(R)?U=Se(R):tt?(W=!1,U=Oc(M,!0)):at?(W=!1,U=Nc(M,!0)):U=[]:qr(M)||An(M)?(U=R,An(R)?U=Ff(R):(!$t(R)||Oi(R))&&(U=ef(M))):W=!1}W&&(C.set(M,U),x(U,M,p,E,C),C.delete(M)),Ya(s,u,U)}function Ac(s,a){var u=s.length;if(u)return a+=a<0?u:0,Li(a,u)?s[a]:e}function Sc(s,a,u){a.length?a=Ht(a,function(E){return ct(E)?function(C){return wn(C,E.length===1?E[0]:E)}:E}):a=[Re];var p=-1;a=Ht(a,Be(ot()));var x=wc(s,function(E,C,R){var M=Ht(a,function(k){return k(E)});return{criteria:M,index:++p,value:E}});return u_(x,function(E,C){return K0(E,C,u)})}function k0(s,a){return Cc(s,a,function(u,p){return Rh(s,p)})}function Cc(s,a,u){for(var p=-1,x=a.length,E={};++p<x;){var C=a[p],R=wn(s,C);u(R,C)&&zr(E,nn(C,s),R)}return E}function U0(s){return function(a){return wn(a,s)}}function ih(s,a,u,p){var x=p?l_:zn,E=-1,C=a.length,R=s;for(s===a&&(a=Se(a)),u&&(R=Ht(s,Be(u)));++E<C;)for(var M=0,k=a[E],U=u?u(k):k;(M=x(R,U,M,p))>-1;)R!==s&&Bs.call(R,M,1),Bs.call(s,M,1);return s}function Ic(s,a){for(var u=s?a.length:0,p=u-1;u--;){var x=a[u];if(u==p||x!==E){var E=x;Li(x)?Bs.call(s,x,1):oh(s,x)}}return s}function nh(s,a){return s+Os(hc()*(a-s+1))}function G0(s,a,u,p){for(var x=-1,E=ae(Ls((a-s)/(u||1)),0),C=B(E);E--;)C[p?E:++x]=s,s+=u;return C}function rh(s,a){var u="";if(!s||a<1||a>vt)return u;do a%2&&(u+=s),a=Os(a/2),a&&(s+=s);while(a);return u}function mt(s,a){return bh(sf(s,a,Re),s+"")}function W0(s){return cc(nr(s))}function H0(s,a){var u=nr(s);return Qs(u,bn(a,0,u.length))}function zr(s,a,u,p){if(!$t(s))return s;a=nn(a,s);for(var x=-1,E=a.length,C=E-1,R=s;R!=null&&++x<E;){var M=xi(a[x]),k=u;if(M==="__proto__"||M==="constructor"||M==="prototype")return s;if(x!=C){var U=R[M];k=p?p(U,M,R):e,k===e&&(k=$t(U)?U:Li(a[x+1])?[]:{})}Wr(R,M,k),R=R[M]}return s}var Rc=Ns?function(s,a){return Ns.set(s,a),s}:Re,X0=Fs?function(s,a){return Fs(s,"toString",{configurable:!0,enumerable:!1,value:Mh(a),writable:!0})}:Re;function $0(s){return Qs(nr(s))}function Ye(s,a,u){var p=-1,x=s.length;a<0&&(a=-a>x?0:x+a),u=u>x?x:u,u<0&&(u+=x),x=a>u?0:u-a>>>0,a>>>=0;for(var E=B(x);++p<x;)E[p]=s[p+a];return E}function z0(s,a){var u;return tn(s,function(p,x,E){return u=a(p,x,E),!u}),!!u}function $s(s,a,u){var p=0,x=s==null?p:s.length;if(typeof a=="number"&&a===a&&x<=Rt){for(;p<x;){var E=p+x>>>1,C=s[E];C!==null&&!Le(C)&&(u?C<=a:C<a)?p=E+1:x=E}return x}return sh(s,a,Re,u)}function sh(s,a,u,p){var x=0,E=s==null?0:s.length;if(E===0)return 0;a=u(a);for(var C=a!==a,R=a===null,M=Le(a),k=a===e;x<E;){var U=Os((x+E)/2),W=u(s[U]),Y=W!==e,tt=W===null,at=W===W,gt=Le(W);if(C)var ht=p||at;else k?ht=at&&(p||Y):R?ht=at&&Y&&(p||!tt):M?ht=at&&Y&&!tt&&(p||!gt):tt||gt?ht=!1:ht=p?W<=a:W<a;ht?x=U+1:E=U}return xe(E,yt)}function Pc(s,a){for(var u=-1,p=s.length,x=0,E=[];++u<p;){var C=s[u],R=a?a(C):C;if(!u||!ei(R,M)){var M=R;E[x++]=C===0?0:C}}return E}function Mc(s){return typeof s=="number"?s:Le(s)?H:+s}function Fe(s){if(typeof s=="string")return s;if(ct(s))return Ht(s,Fe)+"";if(Le(s))return lc?lc.call(s):"";var a=s+"";return a=="0"&&1/s==-j?"-0":a}function en(s,a,u){var p=-1,x=Es,E=s.length,C=!0,R=[],M=R;if(u)C=!1,x=Fa;else if(E>=r){var k=a?null:iv(s);if(k)return As(k);C=!1,x=Lr,M=new yn}else M=a?[]:R;t:for(;++p<E;){var U=s[p],W=a?a(U):U;if(U=u||U!==0?U:0,C&&W===W){for(var Y=M.length;Y--;)if(M[Y]===W)continue t;a&&M.push(W),R.push(U)}else x(M,W,u)||(M!==R&&M.push(W),R.push(U))}return R}function oh(s,a){return a=nn(a,s),s=of(s,a),s==null||delete s[xi(je(a))]}function Dc(s,a,u,p){return zr(s,a,u(wn(s,a)),p)}function zs(s,a,u,p){for(var x=s.length,E=p?x:-1;(p?E--:++E<x)&&a(s[E],E,s););return u?Ye(s,p?0:E,p?E+1:x):Ye(s,p?E+1:0,p?x:E)}function Bc(s,a){var u=s;return u instanceof bt&&(u=u.value()),La(a,function(p,x){return x.func.apply(x.thisArg,Zi([p],x.args))},u)}function ah(s,a,u){var p=s.length;if(p<2)return p?en(s[0]):[];for(var x=-1,E=B(p);++x<p;)for(var C=s[x],R=-1;++R<p;)R!=x&&(E[x]=Hr(E[x]||C,s[R],a,u));return en(fe(E,1),a,u)}function Fc(s,a,u){for(var p=-1,x=s.length,E=a.length,C={};++p<x;){var R=p<E?a[p]:e;u(C,s[p],R)}return C}function hh(s){return Qt(s)?s:[]}function lh(s){return typeof s=="function"?s:Re}function nn(s,a){return ct(s)?s:vh(s,a)?[s]:uf(Pt(s))}var V0=mt;function rn(s,a,u){var p=s.length;return u=u===e?p:u,!a&&u>=p?s:Ye(s,a,u)}var Lc=B_||function(s){return ce.clearTimeout(s)};function Oc(s,a){if(a)return s.slice();var u=s.length,p=nc?nc(u):new s.constructor(u);return s.copy(p),p}function uh(s){var a=new s.constructor(s.byteLength);return new Ms(a).set(new Ms(s)),a}function Y0(s,a){var u=a?uh(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.byteLength)}function j0(s){var a=new s.constructor(s.source,xu.exec(s));return a.lastIndex=s.lastIndex,a}function q0(s){return Gr?Ft(Gr.call(s)):{}}function Nc(s,a){var u=a?uh(s.buffer):s.buffer;return new s.constructor(u,s.byteOffset,s.length)}function kc(s,a){if(s!==a){var u=s!==e,p=s===null,x=s===s,E=Le(s),C=a!==e,R=a===null,M=a===a,k=Le(a);if(!R&&!k&&!E&&s>a||E&&C&&M&&!R&&!k||p&&C&&M||!u&&M||!x)return 1;if(!p&&!E&&!k&&s<a||k&&u&&x&&!p&&!E||R&&u&&x||!C&&x||!M)return-1}return 0}function K0(s,a,u){for(var p=-1,x=s.criteria,E=a.criteria,C=x.length,R=u.length;++p<C;){var M=kc(x[p],E[p]);if(M){if(p>=R)return M;var k=u[p];return M*(k=="desc"?-1:1)}}return s.index-a.index}function Uc(s,a,u,p){for(var x=-1,E=s.length,C=u.length,R=-1,M=a.length,k=ae(E-C,0),U=B(M+k),W=!p;++R<M;)U[R]=a[R];for(;++x<C;)(W||x<E)&&(U[u[x]]=s[x]);for(;k--;)U[R++]=s[x++];return U}function Gc(s,a,u,p){for(var x=-1,E=s.length,C=-1,R=u.length,M=-1,k=a.length,U=ae(E-R,0),W=B(U+k),Y=!p;++x<U;)W[x]=s[x];for(var tt=x;++M<k;)W[tt+M]=a[M];for(;++C<R;)(Y||x<E)&&(W[tt+u[C]]=s[x++]);return W}function Se(s,a){var u=-1,p=s.length;for(a||(a=B(p));++u<p;)a[u]=s[u];return a}function vi(s,a,u,p){var x=!u;u||(u={});for(var E=-1,C=a.length;++E<C;){var R=a[E],M=p?p(u[R],s[R],R,u,s):e;M===e&&(M=s[R]),x?Di(u,R,M):Wr(u,R,M)}return u}function Z0(s,a){return vi(s,_h(s),a)}function J0(s,a){return vi(s,Qc(s),a)}function Vs(s,a){return function(u,p){var x=ct(u)?n_:y0,E=a?a():{};return x(u,s,ot(p,2),E)}}function Qn(s){return mt(function(a,u){var p=-1,x=u.length,E=x>1?u[x-1]:e,C=x>2?u[2]:e;for(E=s.length>3&&typeof E=="function"?(x--,E):e,C&&Ee(u[0],u[1],C)&&(E=x<3?e:E,x=1),a=Ft(a);++p<x;){var R=u[p];R&&s(a,R,p,E)}return a})}function Wc(s,a){return function(u,p){if(u==null)return u;if(!Ce(u))return s(u,p);for(var x=u.length,E=a?x:-1,C=Ft(u);(a?E--:++E<x)&&p(C[E],E,C)!==!1;);return u}}function Hc(s){return function(a,u,p){for(var x=-1,E=Ft(a),C=p(a),R=C.length;R--;){var M=C[s?R:++x];if(u(E[M],M,E)===!1)break}return a}}function Q0(s,a,u){var p=a&y,x=Vr(s);function E(){var C=this&&this!==ce&&this instanceof E?x:s;return C.apply(p?u:this,arguments)}return E}function Xc(s){return function(a){a=Pt(a);var u=Vn(a)?Qe(a):e,p=u?u[0]:a.charAt(0),x=u?rn(u,1).join(""):a.slice(1);return p[s]()+x}}function tr(s){return function(a){return La(Hf(Wf(a).replace(Xm,"")),s,"")}}function Vr(s){return function(){var a=arguments;switch(a.length){case 0:return new s;case 1:return new s(a[0]);case 2:return new s(a[0],a[1]);case 3:return new s(a[0],a[1],a[2]);case 4:return new s(a[0],a[1],a[2],a[3]);case 5:return new s(a[0],a[1],a[2],a[3],a[4]);case 6:return new s(a[0],a[1],a[2],a[3],a[4],a[5]);case 7:return new s(a[0],a[1],a[2],a[3],a[4],a[5],a[6])}var u=Jn(s.prototype),p=s.apply(u,a);return $t(p)?p:u}}function tv(s,a,u){var p=Vr(s);function x(){for(var E=arguments.length,C=B(E),R=E,M=er(x);R--;)C[R]=arguments[R];var k=E<3&&C[0]!==M&&C[E-1]!==M?[]:Ji(C,M);if(E-=k.length,E<u)return jc(s,a,Ys,x.placeholder,e,C,k,e,e,u-E);var U=this&&this!==ce&&this instanceof x?p:s;return De(U,this,C)}return x}function $c(s){return function(a,u,p){var x=Ft(a);if(!Ce(a)){var E=ot(u,3);a=le(a),u=function(R){return E(x[R],R,x)}}var C=s(a,u,p);return C>-1?x[E?a[C]:C]:e}}function zc(s){return Fi(function(a){var u=a.length,p=u,x=ze.prototype.thru;for(s&&a.reverse();p--;){var E=a[p];if(typeof E!="function")throw new $e(h);if(x&&!C&&Zs(E)=="wrapper")var C=new ze([],!0)}for(p=C?p:u;++p<u;){E=a[p];var R=Zs(E),M=R=="wrapper"?gh(E):e;M&&xh(M[0])&&M[1]==(L|A|D|F)&&!M[4].length&&M[9]==1?C=C[Zs(M[0])].apply(C,M[3]):C=E.length==1&&xh(E)?C[R]():C.thru(E)}return function(){var k=arguments,U=k[0];if(C&&k.length==1&&ct(U))return C.plant(U).value();for(var W=0,Y=u?a[W].apply(this,k):U;++W<u;)Y=a[W].call(this,Y);return Y}})}function Ys(s,a,u,p,x,E,C,R,M,k){var U=a&L,W=a&y,Y=a&T,tt=a&(A|I),at=a&V,gt=Y?e:Vr(s);function ht(){for(var xt=arguments.length,Et=B(xt),Oe=xt;Oe--;)Et[Oe]=arguments[Oe];if(tt)var Te=er(ht),Ne=f_(Et,Te);if(p&&(Et=Uc(Et,p,x,tt)),E&&(Et=Gc(Et,E,C,tt)),xt-=Ne,tt&&xt<k){var te=Ji(Et,Te);return jc(s,a,Ys,ht.placeholder,u,Et,te,R,M,k-xt)}var ii=W?u:this,ki=Y?ii[s]:s;return xt=Et.length,R?Et=yv(Et,R):at&&xt>1&&Et.reverse(),U&&M<xt&&(Et.length=M),this&&this!==ce&&this instanceof ht&&(ki=gt||Vr(ki)),ki.apply(ii,Et)}return ht}function Vc(s,a){return function(u,p){return I0(u,s,a(p),{})}}function js(s,a){return function(u,p){var x;if(u===e&&p===e)return a;if(u!==e&&(x=u),p!==e){if(x===e)return p;typeof u=="string"||typeof p=="string"?(u=Fe(u),p=Fe(p)):(u=Mc(u),p=Mc(p)),x=s(u,p)}return x}}function ch(s){return Fi(function(a){return a=Ht(a,Be(ot())),mt(function(u){var p=this;return s(a,function(x){return De(x,p,u)})})})}function qs(s,a){a=a===e?" ":Fe(a);var u=a.length;if(u<2)return u?rh(a,s):a;var p=rh(a,Ls(s/Yn(a)));return Vn(a)?rn(Qe(p),0,s).join(""):p.slice(0,s)}function ev(s,a,u,p){var x=a&y,E=Vr(s);function C(){for(var R=-1,M=arguments.length,k=-1,U=p.length,W=B(U+M),Y=this&&this!==ce&&this instanceof C?E:s;++k<U;)W[k]=p[k];for(;M--;)W[k++]=arguments[++R];return De(Y,x?u:this,W)}return C}function Yc(s){return function(a,u,p){return p&&typeof p!="number"&&Ee(a,u,p)&&(u=p=e),a=Ni(a),u===e?(u=a,a=0):u=Ni(u),p=p===e?a<u?1:-1:Ni(p),G0(a,u,p,s)}}function Ks(s){return function(a,u){return typeof a=="string"&&typeof u=="string"||(a=qe(a),u=qe(u)),s(a,u)}}function jc(s,a,u,p,x,E,C,R,M,k){var U=a&A,W=U?C:e,Y=U?e:C,tt=U?E:e,at=U?e:E;a|=U?D:N,a&=~(U?N:D),a&S||(a&=~(y|T));var gt=[s,a,x,tt,W,at,Y,R,M,k],ht=u.apply(e,gt);return xh(s)&&af(ht,gt),ht.placeholder=p,hf(ht,s,a)}function fh(s){var a=oe[s];return function(u,p){if(u=qe(u),p=p==null?0:xe(pt(p),292),p&&ac(u)){var x=(Pt(u)+"e").split("e"),E=a(x[0]+"e"+(+x[1]+p));return x=(Pt(E)+"e").split("e"),+(x[0]+"e"+(+x[1]-p))}return a(u)}}var iv=Kn&&1/As(new Kn([,-0]))[1]==j?function(s){return new Kn(s)}:Fh;function qc(s){return function(a){var u=ye(a);return u==Kt?Ha(a):u==Je?x_(a):c_(a,s(a))}}function Bi(s,a,u,p,x,E,C,R){var M=a&T;if(!M&&typeof s!="function")throw new $e(h);var k=p?p.length:0;if(k||(a&=~(D|N),p=x=e),C=C===e?C:ae(pt(C),0),R=R===e?R:pt(R),k-=x?x.length:0,a&N){var U=p,W=x;p=x=e}var Y=M?e:gh(s),tt=[s,a,u,p,x,U,W,E,C,R];if(Y&&_v(tt,Y),s=tt[0],a=tt[1],u=tt[2],p=tt[3],x=tt[4],R=tt[9]=tt[9]===e?M?0:s.length:ae(tt[9]-k,0),!R&&a&(A|I)&&(a&=~(A|I)),!a||a==y)var at=Q0(s,a,u);else a==A||a==I?at=tv(s,a,R):(a==D||a==(y|D))&&!x.length?at=ev(s,a,u,p):at=Ys.apply(e,tt);var gt=Y?Rc:af;return hf(gt(at,tt),s,a)}function Kc(s,a,u,p){return s===e||ei(s,qn[u])&&!Bt.call(p,u)?a:s}function Zc(s,a,u,p,x,E){return $t(s)&&$t(a)&&(E.set(a,s),Xs(s,a,e,Zc,E),E.delete(a)),s}function nv(s){return qr(s)?e:s}function Jc(s,a,u,p,x,E){var C=u&v,R=s.length,M=a.length;if(R!=M&&!(C&&M>R))return!1;var k=E.get(s),U=E.get(a);if(k&&U)return k==a&&U==s;var W=-1,Y=!0,tt=u&w?new yn:e;for(E.set(s,a),E.set(a,s);++W<R;){var at=s[W],gt=a[W];if(p)var ht=C?p(gt,at,W,a,s,E):p(at,gt,W,s,a,E);if(ht!==e){if(ht)continue;Y=!1;break}if(tt){if(!Oa(a,function(xt,Et){if(!Lr(tt,Et)&&(at===xt||x(at,xt,u,p,E)))return tt.push(Et)})){Y=!1;break}}else if(!(at===gt||x(at,gt,u,p,E))){Y=!1;break}}return E.delete(s),E.delete(a),Y}function rv(s,a,u,p,x,E,C){switch(u){case Xn:if(s.byteLength!=a.byteLength||s.byteOffset!=a.byteOffset)return!1;s=s.buffer,a=a.buffer;case Fr:return!(s.byteLength!=a.byteLength||!E(new Ms(s),new Ms(a)));case jt:case ne:case ve:return ei(+s,+a);case Dt:return s.name==a.name&&s.message==a.message;case Mr:case Dr:return s==a+"";case Kt:var R=Ha;case Je:var M=p&v;if(R||(R=As),s.size!=a.size&&!M)return!1;var k=C.get(s);if(k)return k==a;p|=w,C.set(s,a);var U=Jc(R(s),R(a),p,x,E,C);return C.delete(s),U;case xs:if(Gr)return Gr.call(s)==Gr.call(a)}return!1}function sv(s,a,u,p,x,E){var C=u&v,R=dh(s),M=R.length,k=dh(a),U=k.length;if(M!=U&&!C)return!1;for(var W=M;W--;){var Y=R[W];if(!(C?Y in a:Bt.call(a,Y)))return!1}var tt=E.get(s),at=E.get(a);if(tt&&at)return tt==a&&at==s;var gt=!0;E.set(s,a),E.set(a,s);for(var ht=C;++W<M;){Y=R[W];var xt=s[Y],Et=a[Y];if(p)var Oe=C?p(Et,xt,Y,a,s,E):p(xt,Et,Y,s,a,E);if(!(Oe===e?xt===Et||x(xt,Et,u,p,E):Oe)){gt=!1;break}ht||(ht=Y=="constructor")}if(gt&&!ht){var Te=s.constructor,Ne=a.constructor;Te!=Ne&&"constructor"in s&&"constructor"in a&&!(typeof Te=="function"&&Te instanceof Te&&typeof Ne=="function"&&Ne instanceof Ne)&&(gt=!1)}return E.delete(s),E.delete(a),gt}function Fi(s){return bh(sf(s,e,pf),s+"")}function dh(s){return vc(s,le,_h)}function ph(s){return vc(s,Ie,Qc)}var gh=Ns?function(s){return Ns.get(s)}:Fh;function Zs(s){for(var a=s.name+"",u=Zn[a],p=Bt.call(Zn,a)?u.length:0;p--;){var x=u[p],E=x.func;if(E==null||E==s)return x.name}return a}function er(s){var a=Bt.call(b,"placeholder")?b:s;return a.placeholder}function ot(){var s=b.iteratee||Dh;return s=s===Dh?bc:s,arguments.length?s(arguments[0],arguments[1]):s}function Js(s,a){var u=s.__data__;return dv(a)?u[typeof a=="string"?"string":"hash"]:u.map}function mh(s){for(var a=le(s),u=a.length;u--;){var p=a[u],x=s[p];a[u]=[p,x,nf(x)]}return a}function En(s,a){var u=m_(s,a);return yc(u)?u:e}function ov(s){var a=Bt.call(s,vn),u=s[vn];try{s[vn]=e;var p=!0}catch{}var x=Rs.call(s);return p&&(a?s[vn]=u:delete s[vn]),x}var _h=$a?function(s){return s==null?[]:(s=Ft(s),Ki($a(s),function(a){return sc.call(s,a)}))}:Lh,Qc=$a?function(s){for(var a=[];s;)Zi(a,_h(s)),s=Ds(s);return a}:Lh,ye=we;(za&&ye(new za(new ArrayBuffer(1)))!=Xn||Nr&&ye(new Nr)!=Kt||Va&&ye(Va.resolve())!=gu||Kn&&ye(new Kn)!=Je||kr&&ye(new kr)!=Br)&&(ye=function(s){var a=we(s),u=a==mi?s.constructor:e,p=u?Tn(u):"";if(p)switch(p){case H_:return Xn;case X_:return Kt;case $_:return gu;case z_:return Je;case V_:return Br}return a});function av(s,a,u){for(var p=-1,x=u.length;++p<x;){var E=u[p],C=E.size;switch(E.type){case"drop":s+=C;break;case"dropRight":a-=C;break;case"take":a=xe(a,s+C);break;case"takeRight":s=ae(s,a-C);break}}return{start:s,end:a}}function hv(s){var a=s.match(pm);return a?a[1].split(gm):[]}function tf(s,a,u){a=nn(a,s);for(var p=-1,x=a.length,E=!1;++p<x;){var C=xi(a[p]);if(!(E=s!=null&&u(s,C)))break;s=s[C]}return E||++p!=x?E:(x=s==null?0:s.length,!!x&&so(x)&&Li(C,x)&&(ct(s)||An(s)))}function lv(s){var a=s.length,u=new s.constructor(a);return a&&typeof s[0]=="string"&&Bt.call(s,"index")&&(u.index=s.index,u.input=s.input),u}function ef(s){return typeof s.constructor=="function"&&!Yr(s)?Jn(Ds(s)):{}}function uv(s,a,u){var p=s.constructor;switch(a){case Fr:return uh(s);case jt:case ne:return new p(+s);case Xn:return Y0(s,u);case ma:case _a:case va:case xa:case ya:case ba:case wa:case Ea:case Ta:return Nc(s,u);case Kt:return new p;case ve:case Dr:return new p(s);case Mr:return j0(s);case Je:return new p;case xs:return q0(s)}}function cv(s,a){var u=a.length;if(!u)return s;var p=u-1;return a[p]=(u>1?"& ":"")+a[p],a=a.join(u>2?", ":" "),s.replace(dm,`{
/* [wrapped with `+a+`] */
`)}function fv(s){return ct(s)||An(s)||!!(oc&&s&&s[oc])}function Li(s,a){var u=typeof s;return a=a??vt,!!a&&(u=="number"||u!="symbol"&&Tm.test(s))&&s>-1&&s%1==0&&s<a}function Ee(s,a,u){if(!$t(u))return!1;var p=typeof a;return(p=="number"?Ce(u)&&Li(a,u.length):p=="string"&&a in u)?ei(u[a],s):!1}function vh(s,a){if(ct(s))return!1;var u=typeof s;return u=="number"||u=="symbol"||u=="boolean"||s==null||Le(s)?!0:lm.test(s)||!hm.test(s)||a!=null&&s in Ft(a)}function dv(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function xh(s){var a=Zs(s),u=b[a];if(typeof u!="function"||!(a in bt.prototype))return!1;if(s===u)return!0;var p=gh(u);return!!p&&s===p[0]}function pv(s){return!!ic&&ic in s}var gv=Cs?Oi:Oh;function Yr(s){var a=s&&s.constructor,u=typeof a=="function"&&a.prototype||qn;return s===u}function nf(s){return s===s&&!$t(s)}function rf(s,a){return function(u){return u==null?!1:u[s]===a&&(a!==e||s in Ft(u))}}function mv(s){var a=no(s,function(p){return u.size===f&&u.clear(),p}),u=a.cache;return a}function _v(s,a){var u=s[1],p=a[1],x=u|p,E=x<(y|T|L),C=p==L&&u==A||p==L&&u==F&&s[7].length<=a[8]||p==(L|F)&&a[7].length<=a[8]&&u==A;if(!(E||C))return s;p&y&&(s[2]=a[2],x|=u&y?0:S);var R=a[3];if(R){var M=s[3];s[3]=M?Uc(M,R,a[4]):R,s[4]=M?Ji(s[3],d):a[4]}return R=a[5],R&&(M=s[5],s[5]=M?Gc(M,R,a[6]):R,s[6]=M?Ji(s[5],d):a[6]),R=a[7],R&&(s[7]=R),p&L&&(s[8]=s[8]==null?a[8]:xe(s[8],a[8])),s[9]==null&&(s[9]=a[9]),s[0]=a[0],s[1]=x,s}function vv(s){var a=[];if(s!=null)for(var u in Ft(s))a.push(u);return a}function xv(s){return Rs.call(s)}function sf(s,a,u){return a=ae(a===e?s.length-1:a,0),function(){for(var p=arguments,x=-1,E=ae(p.length-a,0),C=B(E);++x<E;)C[x]=p[a+x];x=-1;for(var R=B(a+1);++x<a;)R[x]=p[x];return R[a]=u(C),De(s,this,R)}}function of(s,a){return a.length<2?s:wn(s,Ye(a,0,-1))}function yv(s,a){for(var u=s.length,p=xe(a.length,u),x=Se(s);p--;){var E=a[p];s[p]=Li(E,u)?x[E]:e}return s}function yh(s,a){if(!(a==="constructor"&&typeof s[a]=="function")&&a!="__proto__")return s[a]}var af=lf(Rc),jr=L_||function(s,a){return ce.setTimeout(s,a)},bh=lf(X0);function hf(s,a,u){var p=a+"";return bh(s,cv(p,bv(hv(p),u)))}function lf(s){var a=0,u=0;return function(){var p=U_(),x=X-(p-u);if(u=p,x>0){if(++a>=Q)return arguments[0]}else a=0;return s.apply(e,arguments)}}function Qs(s,a){var u=-1,p=s.length,x=p-1;for(a=a===e?p:a;++u<a;){var E=nh(u,x),C=s[E];s[E]=s[u],s[u]=C}return s.length=a,s}var uf=mv(function(s){var a=[];return s.charCodeAt(0)===46&&a.push(""),s.replace(um,function(u,p,x,E){a.push(x?E.replace(vm,"$1"):p||u)}),a});function xi(s){if(typeof s=="string"||Le(s))return s;var a=s+"";return a=="0"&&1/s==-j?"-0":a}function Tn(s){if(s!=null){try{return Is.call(s)}catch{}try{return s+""}catch{}}return""}function bv(s,a){return Xe(Mt,function(u){var p="_."+u[0];a&u[1]&&!Es(s,p)&&s.push(p)}),s.sort()}function cf(s){if(s instanceof bt)return s.clone();var a=new ze(s.__wrapped__,s.__chain__);return a.__actions__=Se(s.__actions__),a.__index__=s.__index__,a.__values__=s.__values__,a}function wv(s,a,u){(u?Ee(s,a,u):a===e)?a=1:a=ae(pt(a),0);var p=s==null?0:s.length;if(!p||a<1)return[];for(var x=0,E=0,C=B(Ls(p/a));x<p;)C[E++]=Ye(s,x,x+=a);return C}function Ev(s){for(var a=-1,u=s==null?0:s.length,p=0,x=[];++a<u;){var E=s[a];E&&(x[p++]=E)}return x}function Tv(){var s=arguments.length;if(!s)return[];for(var a=B(s-1),u=arguments[0],p=s;p--;)a[p-1]=arguments[p];return Zi(ct(u)?Se(u):[u],fe(a,1))}var Av=mt(function(s,a){return Qt(s)?Hr(s,fe(a,1,Qt,!0)):[]}),Sv=mt(function(s,a){var u=je(a);return Qt(u)&&(u=e),Qt(s)?Hr(s,fe(a,1,Qt,!0),ot(u,2)):[]}),Cv=mt(function(s,a){var u=je(a);return Qt(u)&&(u=e),Qt(s)?Hr(s,fe(a,1,Qt,!0),e,u):[]});function Iv(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:pt(a),Ye(s,a<0?0:a,p)):[]}function Rv(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:pt(a),a=p-a,Ye(s,0,a<0?0:a)):[]}function Pv(s,a){return s&&s.length?zs(s,ot(a,3),!0,!0):[]}function Mv(s,a){return s&&s.length?zs(s,ot(a,3),!0):[]}function Dv(s,a,u,p){var x=s==null?0:s.length;return x?(u&&typeof u!="number"&&Ee(s,a,u)&&(u=0,p=x),T0(s,a,u,p)):[]}function ff(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var x=u==null?0:pt(u);return x<0&&(x=ae(p+x,0)),Ts(s,ot(a,3),x)}function df(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var x=p-1;return u!==e&&(x=pt(u),x=u<0?ae(p+x,0):xe(x,p-1)),Ts(s,ot(a,3),x,!0)}function pf(s){var a=s==null?0:s.length;return a?fe(s,1):[]}function Bv(s){var a=s==null?0:s.length;return a?fe(s,j):[]}function Fv(s,a){var u=s==null?0:s.length;return u?(a=a===e?1:pt(a),fe(s,a)):[]}function Lv(s){for(var a=-1,u=s==null?0:s.length,p={};++a<u;){var x=s[a];p[x[0]]=x[1]}return p}function gf(s){return s&&s.length?s[0]:e}function Ov(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var x=u==null?0:pt(u);return x<0&&(x=ae(p+x,0)),zn(s,a,x)}function Nv(s){var a=s==null?0:s.length;return a?Ye(s,0,-1):[]}var kv=mt(function(s){var a=Ht(s,hh);return a.length&&a[0]===s[0]?Ja(a):[]}),Uv=mt(function(s){var a=je(s),u=Ht(s,hh);return a===je(u)?a=e:u.pop(),u.length&&u[0]===s[0]?Ja(u,ot(a,2)):[]}),Gv=mt(function(s){var a=je(s),u=Ht(s,hh);return a=typeof a=="function"?a:e,a&&u.pop(),u.length&&u[0]===s[0]?Ja(u,e,a):[]});function Wv(s,a){return s==null?"":N_.call(s,a)}function je(s){var a=s==null?0:s.length;return a?s[a-1]:e}function Hv(s,a,u){var p=s==null?0:s.length;if(!p)return-1;var x=p;return u!==e&&(x=pt(u),x=x<0?ae(p+x,0):xe(x,p-1)),a===a?b_(s,a,x):Ts(s,ju,x,!0)}function Xv(s,a){return s&&s.length?Ac(s,pt(a)):e}var $v=mt(mf);function mf(s,a){return s&&s.length&&a&&a.length?ih(s,a):s}function zv(s,a,u){return s&&s.length&&a&&a.length?ih(s,a,ot(u,2)):s}function Vv(s,a,u){return s&&s.length&&a&&a.length?ih(s,a,e,u):s}var Yv=Fi(function(s,a){var u=s==null?0:s.length,p=ja(s,a);return Ic(s,Ht(a,function(x){return Li(x,u)?+x:x}).sort(kc)),p});function jv(s,a){var u=[];if(!(s&&s.length))return u;var p=-1,x=[],E=s.length;for(a=ot(a,3);++p<E;){var C=s[p];a(C,p,s)&&(u.push(C),x.push(p))}return Ic(s,x),u}function wh(s){return s==null?s:W_.call(s)}function qv(s,a,u){var p=s==null?0:s.length;return p?(u&&typeof u!="number"&&Ee(s,a,u)?(a=0,u=p):(a=a==null?0:pt(a),u=u===e?p:pt(u)),Ye(s,a,u)):[]}function Kv(s,a){return $s(s,a)}function Zv(s,a,u){return sh(s,a,ot(u,2))}function Jv(s,a){var u=s==null?0:s.length;if(u){var p=$s(s,a);if(p<u&&ei(s[p],a))return p}return-1}function Qv(s,a){return $s(s,a,!0)}function tx(s,a,u){return sh(s,a,ot(u,2),!0)}function ex(s,a){var u=s==null?0:s.length;if(u){var p=$s(s,a,!0)-1;if(ei(s[p],a))return p}return-1}function ix(s){return s&&s.length?Pc(s):[]}function nx(s,a){return s&&s.length?Pc(s,ot(a,2)):[]}function rx(s){var a=s==null?0:s.length;return a?Ye(s,1,a):[]}function sx(s,a,u){return s&&s.length?(a=u||a===e?1:pt(a),Ye(s,0,a<0?0:a)):[]}function ox(s,a,u){var p=s==null?0:s.length;return p?(a=u||a===e?1:pt(a),a=p-a,Ye(s,a<0?0:a,p)):[]}function ax(s,a){return s&&s.length?zs(s,ot(a,3),!1,!0):[]}function hx(s,a){return s&&s.length?zs(s,ot(a,3)):[]}var lx=mt(function(s){return en(fe(s,1,Qt,!0))}),ux=mt(function(s){var a=je(s);return Qt(a)&&(a=e),en(fe(s,1,Qt,!0),ot(a,2))}),cx=mt(function(s){var a=je(s);return a=typeof a=="function"?a:e,en(fe(s,1,Qt,!0),e,a)});function fx(s){return s&&s.length?en(s):[]}function dx(s,a){return s&&s.length?en(s,ot(a,2)):[]}function px(s,a){return a=typeof a=="function"?a:e,s&&s.length?en(s,e,a):[]}function Eh(s){if(!(s&&s.length))return[];var a=0;return s=Ki(s,function(u){if(Qt(u))return a=ae(u.length,a),!0}),Ga(a,function(u){return Ht(s,Na(u))})}function _f(s,a){if(!(s&&s.length))return[];var u=Eh(s);return a==null?u:Ht(u,function(p){return De(a,e,p)})}var gx=mt(function(s,a){return Qt(s)?Hr(s,a):[]}),mx=mt(function(s){return ah(Ki(s,Qt))}),_x=mt(function(s){var a=je(s);return Qt(a)&&(a=e),ah(Ki(s,Qt),ot(a,2))}),vx=mt(function(s){var a=je(s);return a=typeof a=="function"?a:e,ah(Ki(s,Qt),e,a)}),xx=mt(Eh);function yx(s,a){return Fc(s||[],a||[],Wr)}function bx(s,a){return Fc(s||[],a||[],zr)}var wx=mt(function(s){var a=s.length,u=a>1?s[a-1]:e;return u=typeof u=="function"?(s.pop(),u):e,_f(s,u)});function vf(s){var a=b(s);return a.__chain__=!0,a}function Ex(s,a){return a(s),s}function to(s,a){return a(s)}var Tx=Fi(function(s){var a=s.length,u=a?s[0]:0,p=this.__wrapped__,x=function(E){return ja(E,s)};return a>1||this.__actions__.length||!(p instanceof bt)||!Li(u)?this.thru(x):(p=p.slice(u,+u+(a?1:0)),p.__actions__.push({func:to,args:[x],thisArg:e}),new ze(p,this.__chain__).thru(function(E){return a&&!E.length&&E.push(e),E}))});function Ax(){return vf(this)}function Sx(){return new ze(this.value(),this.__chain__)}function Cx(){this.__values__===e&&(this.__values__=Df(this.value()));var s=this.__index__>=this.__values__.length,a=s?e:this.__values__[this.__index__++];return{done:s,value:a}}function Ix(){return this}function Rx(s){for(var a,u=this;u instanceof Us;){var p=cf(u);p.__index__=0,p.__values__=e,a?x.__wrapped__=p:a=p;var x=p;u=u.__wrapped__}return x.__wrapped__=s,a}function Px(){var s=this.__wrapped__;if(s instanceof bt){var a=s;return this.__actions__.length&&(a=new bt(this)),a=a.reverse(),a.__actions__.push({func:to,args:[wh],thisArg:e}),new ze(a,this.__chain__)}return this.thru(wh)}function Mx(){return Bc(this.__wrapped__,this.__actions__)}var Dx=Vs(function(s,a,u){Bt.call(s,u)?++s[u]:Di(s,u,1)});function Bx(s,a,u){var p=ct(s)?Vu:E0;return u&&Ee(s,a,u)&&(a=e),p(s,ot(a,3))}function Fx(s,a){var u=ct(s)?Ki:mc;return u(s,ot(a,3))}var Lx=$c(ff),Ox=$c(df);function Nx(s,a){return fe(eo(s,a),1)}function kx(s,a){return fe(eo(s,a),j)}function Ux(s,a,u){return u=u===e?1:pt(u),fe(eo(s,a),u)}function xf(s,a){var u=ct(s)?Xe:tn;return u(s,ot(a,3))}function yf(s,a){var u=ct(s)?r_:gc;return u(s,ot(a,3))}var Gx=Vs(function(s,a,u){Bt.call(s,u)?s[u].push(a):Di(s,u,[a])});function Wx(s,a,u,p){s=Ce(s)?s:nr(s),u=u&&!p?pt(u):0;var x=s.length;return u<0&&(u=ae(x+u,0)),oo(s)?u<=x&&s.indexOf(a,u)>-1:!!x&&zn(s,a,u)>-1}var Hx=mt(function(s,a,u){var p=-1,x=typeof a=="function",E=Ce(s)?B(s.length):[];return tn(s,function(C){E[++p]=x?De(a,C,u):Xr(C,a,u)}),E}),Xx=Vs(function(s,a,u){Di(s,u,a)});function eo(s,a){var u=ct(s)?Ht:wc;return u(s,ot(a,3))}function $x(s,a,u,p){return s==null?[]:(ct(a)||(a=a==null?[]:[a]),u=p?e:u,ct(u)||(u=u==null?[]:[u]),Sc(s,a,u))}var zx=Vs(function(s,a,u){s[u?0:1].push(a)},function(){return[[],[]]});function Vx(s,a,u){var p=ct(s)?La:Ku,x=arguments.length<3;return p(s,ot(a,4),u,x,tn)}function Yx(s,a,u){var p=ct(s)?s_:Ku,x=arguments.length<3;return p(s,ot(a,4),u,x,gc)}function jx(s,a){var u=ct(s)?Ki:mc;return u(s,ro(ot(a,3)))}function qx(s){var a=ct(s)?cc:W0;return a(s)}function Kx(s,a,u){(u?Ee(s,a,u):a===e)?a=1:a=pt(a);var p=ct(s)?v0:H0;return p(s,a)}function Zx(s){var a=ct(s)?x0:$0;return a(s)}function Jx(s){if(s==null)return 0;if(Ce(s))return oo(s)?Yn(s):s.length;var a=ye(s);return a==Kt||a==Je?s.size:th(s).length}function Qx(s,a,u){var p=ct(s)?Oa:z0;return u&&Ee(s,a,u)&&(a=e),p(s,ot(a,3))}var ty=mt(function(s,a){if(s==null)return[];var u=a.length;return u>1&&Ee(s,a[0],a[1])?a=[]:u>2&&Ee(a[0],a[1],a[2])&&(a=[a[0]]),Sc(s,fe(a,1),[])}),io=F_||function(){return ce.Date.now()};function ey(s,a){if(typeof a!="function")throw new $e(h);return s=pt(s),function(){if(--s<1)return a.apply(this,arguments)}}function bf(s,a,u){return a=u?e:a,a=s&&a==null?s.length:a,Bi(s,L,e,e,e,e,a)}function wf(s,a){var u;if(typeof a!="function")throw new $e(h);return s=pt(s),function(){return--s>0&&(u=a.apply(this,arguments)),s<=1&&(a=e),u}}var Th=mt(function(s,a,u){var p=y;if(u.length){var x=Ji(u,er(Th));p|=D}return Bi(s,p,a,u,x)}),Ef=mt(function(s,a,u){var p=y|T;if(u.length){var x=Ji(u,er(Ef));p|=D}return Bi(a,p,s,u,x)});function Tf(s,a,u){a=u?e:a;var p=Bi(s,A,e,e,e,e,e,a);return p.placeholder=Tf.placeholder,p}function Af(s,a,u){a=u?e:a;var p=Bi(s,I,e,e,e,e,e,a);return p.placeholder=Af.placeholder,p}function Sf(s,a,u){var p,x,E,C,R,M,k=0,U=!1,W=!1,Y=!0;if(typeof s!="function")throw new $e(h);a=qe(a)||0,$t(u)&&(U=!!u.leading,W="maxWait"in u,E=W?ae(qe(u.maxWait)||0,a):E,Y="trailing"in u?!!u.trailing:Y);function tt(te){var ii=p,ki=x;return p=x=e,k=te,C=s.apply(ki,ii),C}function at(te){return k=te,R=jr(xt,a),U?tt(te):C}function gt(te){var ii=te-M,ki=te-k,zf=a-ii;return W?xe(zf,E-ki):zf}function ht(te){var ii=te-M,ki=te-k;return M===e||ii>=a||ii<0||W&&ki>=E}function xt(){var te=io();if(ht(te))return Et(te);R=jr(xt,gt(te))}function Et(te){return R=e,Y&&p?tt(te):(p=x=e,C)}function Oe(){R!==e&&Lc(R),k=0,p=M=x=R=e}function Te(){return R===e?C:Et(io())}function Ne(){var te=io(),ii=ht(te);if(p=arguments,x=this,M=te,ii){if(R===e)return at(M);if(W)return Lc(R),R=jr(xt,a),tt(M)}return R===e&&(R=jr(xt,a)),C}return Ne.cancel=Oe,Ne.flush=Te,Ne}var iy=mt(function(s,a){return pc(s,1,a)}),ny=mt(function(s,a,u){return pc(s,qe(a)||0,u)});function ry(s){return Bi(s,V)}function no(s,a){if(typeof s!="function"||a!=null&&typeof a!="function")throw new $e(h);var u=function(){var p=arguments,x=a?a.apply(this,p):p[0],E=u.cache;if(E.has(x))return E.get(x);var C=s.apply(this,p);return u.cache=E.set(x,C)||E,C};return u.cache=new(no.Cache||Mi),u}no.Cache=Mi;function ro(s){if(typeof s!="function")throw new $e(h);return function(){var a=arguments;switch(a.length){case 0:return!s.call(this);case 1:return!s.call(this,a[0]);case 2:return!s.call(this,a[0],a[1]);case 3:return!s.call(this,a[0],a[1],a[2])}return!s.apply(this,a)}}function sy(s){return wf(2,s)}var oy=V0(function(s,a){a=a.length==1&&ct(a[0])?Ht(a[0],Be(ot())):Ht(fe(a,1),Be(ot()));var u=a.length;return mt(function(p){for(var x=-1,E=xe(p.length,u);++x<E;)p[x]=a[x].call(this,p[x]);return De(s,this,p)})}),Ah=mt(function(s,a){var u=Ji(a,er(Ah));return Bi(s,D,e,a,u)}),Cf=mt(function(s,a){var u=Ji(a,er(Cf));return Bi(s,N,e,a,u)}),ay=Fi(function(s,a){return Bi(s,F,e,e,e,a)});function hy(s,a){if(typeof s!="function")throw new $e(h);return a=a===e?a:pt(a),mt(s,a)}function ly(s,a){if(typeof s!="function")throw new $e(h);return a=a==null?0:ae(pt(a),0),mt(function(u){var p=u[a],x=rn(u,0,a);return p&&Zi(x,p),De(s,this,x)})}function uy(s,a,u){var p=!0,x=!0;if(typeof s!="function")throw new $e(h);return $t(u)&&(p="leading"in u?!!u.leading:p,x="trailing"in u?!!u.trailing:x),Sf(s,a,{leading:p,maxWait:a,trailing:x})}function cy(s){return bf(s,1)}function fy(s,a){return Ah(lh(a),s)}function dy(){if(!arguments.length)return[];var s=arguments[0];return ct(s)?s:[s]}function py(s){return Ve(s,_)}function gy(s,a){return a=typeof a=="function"?a:e,Ve(s,_,a)}function my(s){return Ve(s,g|_)}function _y(s,a){return a=typeof a=="function"?a:e,Ve(s,g|_,a)}function vy(s,a){return a==null||dc(s,a,le(a))}function ei(s,a){return s===a||s!==s&&a!==a}var xy=Ks(Za),yy=Ks(function(s,a){return s>=a}),An=xc(function(){return arguments}())?xc:function(s){return Zt(s)&&Bt.call(s,"callee")&&!sc.call(s,"callee")},ct=B.isArray,by=Gu?Be(Gu):R0;function Ce(s){return s!=null&&so(s.length)&&!Oi(s)}function Qt(s){return Zt(s)&&Ce(s)}function wy(s){return s===!0||s===!1||Zt(s)&&we(s)==jt}var sn=O_||Oh,Ey=Wu?Be(Wu):P0;function Ty(s){return Zt(s)&&s.nodeType===1&&!qr(s)}function Ay(s){if(s==null)return!0;if(Ce(s)&&(ct(s)||typeof s=="string"||typeof s.splice=="function"||sn(s)||ir(s)||An(s)))return!s.length;var a=ye(s);if(a==Kt||a==Je)return!s.size;if(Yr(s))return!th(s).length;for(var u in s)if(Bt.call(s,u))return!1;return!0}function Sy(s,a){return $r(s,a)}function Cy(s,a,u){u=typeof u=="function"?u:e;var p=u?u(s,a):e;return p===e?$r(s,a,e,u):!!p}function Sh(s){if(!Zt(s))return!1;var a=we(s);return a==Dt||a==se||typeof s.message=="string"&&typeof s.name=="string"&&!qr(s)}function Iy(s){return typeof s=="number"&&ac(s)}function Oi(s){if(!$t(s))return!1;var a=we(s);return a==kt||a==qt||a==ie||a==Jg}function If(s){return typeof s=="number"&&s==pt(s)}function so(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=vt}function $t(s){var a=typeof s;return s!=null&&(a=="object"||a=="function")}function Zt(s){return s!=null&&typeof s=="object"}var Rf=Hu?Be(Hu):D0;function Ry(s,a){return s===a||Qa(s,a,mh(a))}function Py(s,a,u){return u=typeof u=="function"?u:e,Qa(s,a,mh(a),u)}function My(s){return Pf(s)&&s!=+s}function Dy(s){if(gv(s))throw new ut(o);return yc(s)}function By(s){return s===null}function Fy(s){return s==null}function Pf(s){return typeof s=="number"||Zt(s)&&we(s)==ve}function qr(s){if(!Zt(s)||we(s)!=mi)return!1;var a=Ds(s);if(a===null)return!0;var u=Bt.call(a,"constructor")&&a.constructor;return typeof u=="function"&&u instanceof u&&Is.call(u)==P_}var Ch=Xu?Be(Xu):B0;function Ly(s){return If(s)&&s>=-vt&&s<=vt}var Mf=$u?Be($u):F0;function oo(s){return typeof s=="string"||!ct(s)&&Zt(s)&&we(s)==Dr}function Le(s){return typeof s=="symbol"||Zt(s)&&we(s)==xs}var ir=zu?Be(zu):L0;function Oy(s){return s===e}function Ny(s){return Zt(s)&&ye(s)==Br}function ky(s){return Zt(s)&&we(s)==tm}var Uy=Ks(eh),Gy=Ks(function(s,a){return s<=a});function Df(s){if(!s)return[];if(Ce(s))return oo(s)?Qe(s):Se(s);if(Or&&s[Or])return v_(s[Or]());var a=ye(s),u=a==Kt?Ha:a==Je?As:nr;return u(s)}function Ni(s){if(!s)return s===0?s:0;if(s=qe(s),s===j||s===-j){var a=s<0?-1:1;return a*Wt}return s===s?s:0}function pt(s){var a=Ni(s),u=a%1;return a===a?u?a-u:a:0}function Bf(s){return s?bn(pt(s),0,it):0}function qe(s){if(typeof s=="number")return s;if(Le(s))return H;if($t(s)){var a=typeof s.valueOf=="function"?s.valueOf():s;s=$t(a)?a+"":a}if(typeof s!="string")return s===0?s:+s;s=Zu(s);var u=bm.test(s);return u||Em.test(s)?e_(s.slice(2),u?2:8):ym.test(s)?H:+s}function Ff(s){return vi(s,Ie(s))}function Wy(s){return s?bn(pt(s),-vt,vt):s===0?s:0}function Pt(s){return s==null?"":Fe(s)}var Hy=Qn(function(s,a){if(Yr(a)||Ce(a)){vi(a,le(a),s);return}for(var u in a)Bt.call(a,u)&&Wr(s,u,a[u])}),Lf=Qn(function(s,a){vi(a,Ie(a),s)}),ao=Qn(function(s,a,u,p){vi(a,Ie(a),s,p)}),Xy=Qn(function(s,a,u,p){vi(a,le(a),s,p)}),$y=Fi(ja);function zy(s,a){var u=Jn(s);return a==null?u:fc(u,a)}var Vy=mt(function(s,a){s=Ft(s);var u=-1,p=a.length,x=p>2?a[2]:e;for(x&&Ee(a[0],a[1],x)&&(p=1);++u<p;)for(var E=a[u],C=Ie(E),R=-1,M=C.length;++R<M;){var k=C[R],U=s[k];(U===e||ei(U,qn[k])&&!Bt.call(s,k))&&(s[k]=E[k])}return s}),Yy=mt(function(s){return s.push(e,Zc),De(Of,e,s)});function jy(s,a){return Yu(s,ot(a,3),_i)}function qy(s,a){return Yu(s,ot(a,3),Ka)}function Ky(s,a){return s==null?s:qa(s,ot(a,3),Ie)}function Zy(s,a){return s==null?s:_c(s,ot(a,3),Ie)}function Jy(s,a){return s&&_i(s,ot(a,3))}function Qy(s,a){return s&&Ka(s,ot(a,3))}function t1(s){return s==null?[]:Hs(s,le(s))}function e1(s){return s==null?[]:Hs(s,Ie(s))}function Ih(s,a,u){var p=s==null?e:wn(s,a);return p===e?u:p}function i1(s,a){return s!=null&&tf(s,a,A0)}function Rh(s,a){return s!=null&&tf(s,a,S0)}var n1=Vc(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=Rs.call(a)),s[a]=u},Mh(Re)),r1=Vc(function(s,a,u){a!=null&&typeof a.toString!="function"&&(a=Rs.call(a)),Bt.call(s,a)?s[a].push(u):s[a]=[u]},ot),s1=mt(Xr);function le(s){return Ce(s)?uc(s):th(s)}function Ie(s){return Ce(s)?uc(s,!0):O0(s)}function o1(s,a){var u={};return a=ot(a,3),_i(s,function(p,x,E){Di(u,a(p,x,E),p)}),u}function a1(s,a){var u={};return a=ot(a,3),_i(s,function(p,x,E){Di(u,x,a(p,x,E))}),u}var h1=Qn(function(s,a,u){Xs(s,a,u)}),Of=Qn(function(s,a,u,p){Xs(s,a,u,p)}),l1=Fi(function(s,a){var u={};if(s==null)return u;var p=!1;a=Ht(a,function(E){return E=nn(E,s),p||(p=E.length>1),E}),vi(s,ph(s),u),p&&(u=Ve(u,g|m|_,nv));for(var x=a.length;x--;)oh(u,a[x]);return u});function u1(s,a){return Nf(s,ro(ot(a)))}var c1=Fi(function(s,a){return s==null?{}:k0(s,a)});function Nf(s,a){if(s==null)return{};var u=Ht(ph(s),function(p){return[p]});return a=ot(a),Cc(s,u,function(p,x){return a(p,x[0])})}function f1(s,a,u){a=nn(a,s);var p=-1,x=a.length;for(x||(x=1,s=e);++p<x;){var E=s==null?e:s[xi(a[p])];E===e&&(p=x,E=u),s=Oi(E)?E.call(s):E}return s}function d1(s,a,u){return s==null?s:zr(s,a,u)}function p1(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:zr(s,a,u,p)}var kf=qc(le),Uf=qc(Ie);function g1(s,a,u){var p=ct(s),x=p||sn(s)||ir(s);if(a=ot(a,4),u==null){var E=s&&s.constructor;x?u=p?new E:[]:$t(s)?u=Oi(E)?Jn(Ds(s)):{}:u={}}return(x?Xe:_i)(s,function(C,R,M){return a(u,C,R,M)}),u}function m1(s,a){return s==null?!0:oh(s,a)}function _1(s,a,u){return s==null?s:Dc(s,a,lh(u))}function v1(s,a,u,p){return p=typeof p=="function"?p:e,s==null?s:Dc(s,a,lh(u),p)}function nr(s){return s==null?[]:Wa(s,le(s))}function x1(s){return s==null?[]:Wa(s,Ie(s))}function y1(s,a,u){return u===e&&(u=a,a=e),u!==e&&(u=qe(u),u=u===u?u:0),a!==e&&(a=qe(a),a=a===a?a:0),bn(qe(s),a,u)}function b1(s,a,u){return a=Ni(a),u===e?(u=a,a=0):u=Ni(u),s=qe(s),C0(s,a,u)}function w1(s,a,u){if(u&&typeof u!="boolean"&&Ee(s,a,u)&&(a=u=e),u===e&&(typeof a=="boolean"?(u=a,a=e):typeof s=="boolean"&&(u=s,s=e)),s===e&&a===e?(s=0,a=1):(s=Ni(s),a===e?(a=s,s=0):a=Ni(a)),s>a){var p=s;s=a,a=p}if(u||s%1||a%1){var x=hc();return xe(s+x*(a-s+t_("1e-"+((x+"").length-1))),a)}return nh(s,a)}var E1=tr(function(s,a,u){return a=a.toLowerCase(),s+(u?Gf(a):a)});function Gf(s){return Ph(Pt(s).toLowerCase())}function Wf(s){return s=Pt(s),s&&s.replace(Am,d_).replace($m,"")}function T1(s,a,u){s=Pt(s),a=Fe(a);var p=s.length;u=u===e?p:bn(pt(u),0,p);var x=u;return u-=a.length,u>=0&&s.slice(u,x)==a}function A1(s){return s=Pt(s),s&&sm.test(s)?s.replace(_u,p_):s}function S1(s){return s=Pt(s),s&&cm.test(s)?s.replace(Aa,"\\$&"):s}var C1=tr(function(s,a,u){return s+(u?"-":"")+a.toLowerCase()}),I1=tr(function(s,a,u){return s+(u?" ":"")+a.toLowerCase()}),R1=Xc("toLowerCase");function P1(s,a,u){s=Pt(s),a=pt(a);var p=a?Yn(s):0;if(!a||p>=a)return s;var x=(a-p)/2;return qs(Os(x),u)+s+qs(Ls(x),u)}function M1(s,a,u){s=Pt(s),a=pt(a);var p=a?Yn(s):0;return a&&p<a?s+qs(a-p,u):s}function D1(s,a,u){s=Pt(s),a=pt(a);var p=a?Yn(s):0;return a&&p<a?qs(a-p,u)+s:s}function B1(s,a,u){return u||a==null?a=0:a&&(a=+a),G_(Pt(s).replace(Sa,""),a||0)}function F1(s,a,u){return(u?Ee(s,a,u):a===e)?a=1:a=pt(a),rh(Pt(s),a)}function L1(){var s=arguments,a=Pt(s[0]);return s.length<3?a:a.replace(s[1],s[2])}var O1=tr(function(s,a,u){return s+(u?"_":"")+a.toLowerCase()});function N1(s,a,u){return u&&typeof u!="number"&&Ee(s,a,u)&&(a=u=e),u=u===e?it:u>>>0,u?(s=Pt(s),s&&(typeof a=="string"||a!=null&&!Ch(a))&&(a=Fe(a),!a&&Vn(s))?rn(Qe(s),0,u):s.split(a,u)):[]}var k1=tr(function(s,a,u){return s+(u?" ":"")+Ph(a)});function U1(s,a,u){return s=Pt(s),u=u==null?0:bn(pt(u),0,s.length),a=Fe(a),s.slice(u,u+a.length)==a}function G1(s,a,u){var p=b.templateSettings;u&&Ee(s,a,u)&&(a=e),s=Pt(s),a=ao({},a,p,Kc);var x=ao({},a.imports,p.imports,Kc),E=le(x),C=Wa(x,E),R,M,k=0,U=a.interpolate||ys,W="__p += '",Y=Xa((a.escape||ys).source+"|"+U.source+"|"+(U===vu?xm:ys).source+"|"+(a.evaluate||ys).source+"|$","g"),tt="//# sourceURL="+(Bt.call(a,"sourceURL")?(a.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qm+"]")+`
`;s.replace(Y,function(ht,xt,Et,Oe,Te,Ne){return Et||(Et=Oe),W+=s.slice(k,Ne).replace(Sm,g_),xt&&(R=!0,W+=`' +
__e(`+xt+`) +
'`),Te&&(M=!0,W+=`';
`+Te+`;
__p += '`),Et&&(W+=`' +
((__t = (`+Et+`)) == null ? '' : __t) +
'`),k=Ne+ht.length,ht}),W+=`';
`;var at=Bt.call(a,"variable")&&a.variable;if(!at)W=`with (obj) {
`+W+`
}
`;else if(_m.test(at))throw new ut(l);W=(M?W.replace(em,""):W).replace(im,"$1").replace(nm,"$1;"),W="function("+(at||"obj")+`) {
`+(at?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(R?", __e = _.escape":"")+(M?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+W+`return __p
}`;var gt=Xf(function(){return It(E,tt+"return "+W).apply(e,C)});if(gt.source=W,Sh(gt))throw gt;return gt}function W1(s){return Pt(s).toLowerCase()}function H1(s){return Pt(s).toUpperCase()}function X1(s,a,u){if(s=Pt(s),s&&(u||a===e))return Zu(s);if(!s||!(a=Fe(a)))return s;var p=Qe(s),x=Qe(a),E=Ju(p,x),C=Qu(p,x)+1;return rn(p,E,C).join("")}function $1(s,a,u){if(s=Pt(s),s&&(u||a===e))return s.slice(0,ec(s)+1);if(!s||!(a=Fe(a)))return s;var p=Qe(s),x=Qu(p,Qe(a))+1;return rn(p,0,x).join("")}function z1(s,a,u){if(s=Pt(s),s&&(u||a===e))return s.replace(Sa,"");if(!s||!(a=Fe(a)))return s;var p=Qe(s),x=Ju(p,Qe(a));return rn(p,x).join("")}function V1(s,a){var u=J,p=z;if($t(a)){var x="separator"in a?a.separator:x;u="length"in a?pt(a.length):u,p="omission"in a?Fe(a.omission):p}s=Pt(s);var E=s.length;if(Vn(s)){var C=Qe(s);E=C.length}if(u>=E)return s;var R=u-Yn(p);if(R<1)return p;var M=C?rn(C,0,R).join(""):s.slice(0,R);if(x===e)return M+p;if(C&&(R+=M.length-R),Ch(x)){if(s.slice(R).search(x)){var k,U=M;for(x.global||(x=Xa(x.source,Pt(xu.exec(x))+"g")),x.lastIndex=0;k=x.exec(U);)var W=k.index;M=M.slice(0,W===e?R:W)}}else if(s.indexOf(Fe(x),R)!=R){var Y=M.lastIndexOf(x);Y>-1&&(M=M.slice(0,Y))}return M+p}function Y1(s){return s=Pt(s),s&&rm.test(s)?s.replace(mu,w_):s}var j1=tr(function(s,a,u){return s+(u?" ":"")+a.toUpperCase()}),Ph=Xc("toUpperCase");function Hf(s,a,u){return s=Pt(s),a=u?e:a,a===e?__(s)?A_(s):h_(s):s.match(a)||[]}var Xf=mt(function(s,a){try{return De(s,e,a)}catch(u){return Sh(u)?u:new ut(u)}}),q1=Fi(function(s,a){return Xe(a,function(u){u=xi(u),Di(s,u,Th(s[u],s))}),s});function K1(s){var a=s==null?0:s.length,u=ot();return s=a?Ht(s,function(p){if(typeof p[1]!="function")throw new $e(h);return[u(p[0]),p[1]]}):[],mt(function(p){for(var x=-1;++x<a;){var E=s[x];if(De(E[0],this,p))return De(E[1],this,p)}})}function Z1(s){return w0(Ve(s,g))}function Mh(s){return function(){return s}}function J1(s,a){return s==null||s!==s?a:s}var Q1=zc(),tb=zc(!0);function Re(s){return s}function Dh(s){return bc(typeof s=="function"?s:Ve(s,g))}function eb(s){return Ec(Ve(s,g))}function ib(s,a){return Tc(s,Ve(a,g))}var nb=mt(function(s,a){return function(u){return Xr(u,s,a)}}),rb=mt(function(s,a){return function(u){return Xr(s,u,a)}});function Bh(s,a,u){var p=le(a),x=Hs(a,p);u==null&&!($t(a)&&(x.length||!p.length))&&(u=a,a=s,s=this,x=Hs(a,le(a)));var E=!($t(u)&&"chain"in u)||!!u.chain,C=Oi(s);return Xe(x,function(R){var M=a[R];s[R]=M,C&&(s.prototype[R]=function(){var k=this.__chain__;if(E||k){var U=s(this.__wrapped__),W=U.__actions__=Se(this.__actions__);return W.push({func:M,args:arguments,thisArg:s}),U.__chain__=k,U}return M.apply(s,Zi([this.value()],arguments))})}),s}function sb(){return ce._===this&&(ce._=M_),this}function Fh(){}function ob(s){return s=pt(s),mt(function(a){return Ac(a,s)})}var ab=ch(Ht),hb=ch(Vu),lb=ch(Oa);function $f(s){return vh(s)?Na(xi(s)):U0(s)}function ub(s){return function(a){return s==null?e:wn(s,a)}}var cb=Yc(),fb=Yc(!0);function Lh(){return[]}function Oh(){return!1}function db(){return{}}function pb(){return""}function gb(){return!0}function mb(s,a){if(s=pt(s),s<1||s>vt)return[];var u=it,p=xe(s,it);a=ot(a),s-=it;for(var x=Ga(p,a);++u<s;)a(u);return x}function _b(s){return ct(s)?Ht(s,xi):Le(s)?[s]:Se(uf(Pt(s)))}function vb(s){var a=++R_;return Pt(s)+a}var xb=js(function(s,a){return s+a},0),yb=fh("ceil"),bb=js(function(s,a){return s/a},1),wb=fh("floor");function Eb(s){return s&&s.length?Ws(s,Re,Za):e}function Tb(s,a){return s&&s.length?Ws(s,ot(a,2),Za):e}function Ab(s){return qu(s,Re)}function Sb(s,a){return qu(s,ot(a,2))}function Cb(s){return s&&s.length?Ws(s,Re,eh):e}function Ib(s,a){return s&&s.length?Ws(s,ot(a,2),eh):e}var Rb=js(function(s,a){return s*a},1),Pb=fh("round"),Mb=js(function(s,a){return s-a},0);function Db(s){return s&&s.length?Ua(s,Re):0}function Bb(s,a){return s&&s.length?Ua(s,ot(a,2)):0}return b.after=ey,b.ary=bf,b.assign=Hy,b.assignIn=Lf,b.assignInWith=ao,b.assignWith=Xy,b.at=$y,b.before=wf,b.bind=Th,b.bindAll=q1,b.bindKey=Ef,b.castArray=dy,b.chain=vf,b.chunk=wv,b.compact=Ev,b.concat=Tv,b.cond=K1,b.conforms=Z1,b.constant=Mh,b.countBy=Dx,b.create=zy,b.curry=Tf,b.curryRight=Af,b.debounce=Sf,b.defaults=Vy,b.defaultsDeep=Yy,b.defer=iy,b.delay=ny,b.difference=Av,b.differenceBy=Sv,b.differenceWith=Cv,b.drop=Iv,b.dropRight=Rv,b.dropRightWhile=Pv,b.dropWhile=Mv,b.fill=Dv,b.filter=Fx,b.flatMap=Nx,b.flatMapDeep=kx,b.flatMapDepth=Ux,b.flatten=pf,b.flattenDeep=Bv,b.flattenDepth=Fv,b.flip=ry,b.flow=Q1,b.flowRight=tb,b.fromPairs=Lv,b.functions=t1,b.functionsIn=e1,b.groupBy=Gx,b.initial=Nv,b.intersection=kv,b.intersectionBy=Uv,b.intersectionWith=Gv,b.invert=n1,b.invertBy=r1,b.invokeMap=Hx,b.iteratee=Dh,b.keyBy=Xx,b.keys=le,b.keysIn=Ie,b.map=eo,b.mapKeys=o1,b.mapValues=a1,b.matches=eb,b.matchesProperty=ib,b.memoize=no,b.merge=h1,b.mergeWith=Of,b.method=nb,b.methodOf=rb,b.mixin=Bh,b.negate=ro,b.nthArg=ob,b.omit=l1,b.omitBy=u1,b.once=sy,b.orderBy=$x,b.over=ab,b.overArgs=oy,b.overEvery=hb,b.overSome=lb,b.partial=Ah,b.partialRight=Cf,b.partition=zx,b.pick=c1,b.pickBy=Nf,b.property=$f,b.propertyOf=ub,b.pull=$v,b.pullAll=mf,b.pullAllBy=zv,b.pullAllWith=Vv,b.pullAt=Yv,b.range=cb,b.rangeRight=fb,b.rearg=ay,b.reject=jx,b.remove=jv,b.rest=hy,b.reverse=wh,b.sampleSize=Kx,b.set=d1,b.setWith=p1,b.shuffle=Zx,b.slice=qv,b.sortBy=ty,b.sortedUniq=ix,b.sortedUniqBy=nx,b.split=N1,b.spread=ly,b.tail=rx,b.take=sx,b.takeRight=ox,b.takeRightWhile=ax,b.takeWhile=hx,b.tap=Ex,b.throttle=uy,b.thru=to,b.toArray=Df,b.toPairs=kf,b.toPairsIn=Uf,b.toPath=_b,b.toPlainObject=Ff,b.transform=g1,b.unary=cy,b.union=lx,b.unionBy=ux,b.unionWith=cx,b.uniq=fx,b.uniqBy=dx,b.uniqWith=px,b.unset=m1,b.unzip=Eh,b.unzipWith=_f,b.update=_1,b.updateWith=v1,b.values=nr,b.valuesIn=x1,b.without=gx,b.words=Hf,b.wrap=fy,b.xor=mx,b.xorBy=_x,b.xorWith=vx,b.zip=xx,b.zipObject=yx,b.zipObjectDeep=bx,b.zipWith=wx,b.entries=kf,b.entriesIn=Uf,b.extend=Lf,b.extendWith=ao,Bh(b,b),b.add=xb,b.attempt=Xf,b.camelCase=E1,b.capitalize=Gf,b.ceil=yb,b.clamp=y1,b.clone=py,b.cloneDeep=my,b.cloneDeepWith=_y,b.cloneWith=gy,b.conformsTo=vy,b.deburr=Wf,b.defaultTo=J1,b.divide=bb,b.endsWith=T1,b.eq=ei,b.escape=A1,b.escapeRegExp=S1,b.every=Bx,b.find=Lx,b.findIndex=ff,b.findKey=jy,b.findLast=Ox,b.findLastIndex=df,b.findLastKey=qy,b.floor=wb,b.forEach=xf,b.forEachRight=yf,b.forIn=Ky,b.forInRight=Zy,b.forOwn=Jy,b.forOwnRight=Qy,b.get=Ih,b.gt=xy,b.gte=yy,b.has=i1,b.hasIn=Rh,b.head=gf,b.identity=Re,b.includes=Wx,b.indexOf=Ov,b.inRange=b1,b.invoke=s1,b.isArguments=An,b.isArray=ct,b.isArrayBuffer=by,b.isArrayLike=Ce,b.isArrayLikeObject=Qt,b.isBoolean=wy,b.isBuffer=sn,b.isDate=Ey,b.isElement=Ty,b.isEmpty=Ay,b.isEqual=Sy,b.isEqualWith=Cy,b.isError=Sh,b.isFinite=Iy,b.isFunction=Oi,b.isInteger=If,b.isLength=so,b.isMap=Rf,b.isMatch=Ry,b.isMatchWith=Py,b.isNaN=My,b.isNative=Dy,b.isNil=Fy,b.isNull=By,b.isNumber=Pf,b.isObject=$t,b.isObjectLike=Zt,b.isPlainObject=qr,b.isRegExp=Ch,b.isSafeInteger=Ly,b.isSet=Mf,b.isString=oo,b.isSymbol=Le,b.isTypedArray=ir,b.isUndefined=Oy,b.isWeakMap=Ny,b.isWeakSet=ky,b.join=Wv,b.kebabCase=C1,b.last=je,b.lastIndexOf=Hv,b.lowerCase=I1,b.lowerFirst=R1,b.lt=Uy,b.lte=Gy,b.max=Eb,b.maxBy=Tb,b.mean=Ab,b.meanBy=Sb,b.min=Cb,b.minBy=Ib,b.stubArray=Lh,b.stubFalse=Oh,b.stubObject=db,b.stubString=pb,b.stubTrue=gb,b.multiply=Rb,b.nth=Xv,b.noConflict=sb,b.noop=Fh,b.now=io,b.pad=P1,b.padEnd=M1,b.padStart=D1,b.parseInt=B1,b.random=w1,b.reduce=Vx,b.reduceRight=Yx,b.repeat=F1,b.replace=L1,b.result=f1,b.round=Pb,b.runInContext=P,b.sample=qx,b.size=Jx,b.snakeCase=O1,b.some=Qx,b.sortedIndex=Kv,b.sortedIndexBy=Zv,b.sortedIndexOf=Jv,b.sortedLastIndex=Qv,b.sortedLastIndexBy=tx,b.sortedLastIndexOf=ex,b.startCase=k1,b.startsWith=U1,b.subtract=Mb,b.sum=Db,b.sumBy=Bb,b.template=G1,b.times=mb,b.toFinite=Ni,b.toInteger=pt,b.toLength=Bf,b.toLower=W1,b.toNumber=qe,b.toSafeInteger=Wy,b.toString=Pt,b.toUpper=H1,b.trim=X1,b.trimEnd=$1,b.trimStart=z1,b.truncate=V1,b.unescape=Y1,b.uniqueId=vb,b.upperCase=j1,b.upperFirst=Ph,b.each=xf,b.eachRight=yf,b.first=gf,Bh(b,function(){var s={};return _i(b,function(a,u){Bt.call(b.prototype,u)||(s[u]=a)}),s}(),{chain:!1}),b.VERSION=n,Xe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(s){b[s].placeholder=b}),Xe(["drop","take"],function(s,a){bt.prototype[s]=function(u){u=u===e?1:ae(pt(u),0);var p=this.__filtered__&&!a?new bt(this):this.clone();return p.__filtered__?p.__takeCount__=xe(u,p.__takeCount__):p.__views__.push({size:xe(u,it),type:s+(p.__dir__<0?"Right":"")}),p},bt.prototype[s+"Right"]=function(u){return this.reverse()[s](u).reverse()}}),Xe(["filter","map","takeWhile"],function(s,a){var u=a+1,p=u==G||u==_t;bt.prototype[s]=function(x){var E=this.clone();return E.__iteratees__.push({iteratee:ot(x,3),type:u}),E.__filtered__=E.__filtered__||p,E}}),Xe(["head","last"],function(s,a){var u="take"+(a?"Right":"");bt.prototype[s]=function(){return this[u](1).value()[0]}}),Xe(["initial","tail"],function(s,a){var u="drop"+(a?"":"Right");bt.prototype[s]=function(){return this.__filtered__?new bt(this):this[u](1)}}),bt.prototype.compact=function(){return this.filter(Re)},bt.prototype.find=function(s){return this.filter(s).head()},bt.prototype.findLast=function(s){return this.reverse().find(s)},bt.prototype.invokeMap=mt(function(s,a){return typeof s=="function"?new bt(this):this.map(function(u){return Xr(u,s,a)})}),bt.prototype.reject=function(s){return this.filter(ro(ot(s)))},bt.prototype.slice=function(s,a){s=pt(s);var u=this;return u.__filtered__&&(s>0||a<0)?new bt(u):(s<0?u=u.takeRight(-s):s&&(u=u.drop(s)),a!==e&&(a=pt(a),u=a<0?u.dropRight(-a):u.take(a-s)),u)},bt.prototype.takeRightWhile=function(s){return this.reverse().takeWhile(s).reverse()},bt.prototype.toArray=function(){return this.take(it)},_i(bt.prototype,function(s,a){var u=/^(?:filter|find|map|reject)|While$/.test(a),p=/^(?:head|last)$/.test(a),x=b[p?"take"+(a=="last"?"Right":""):a],E=p||/^find/.test(a);x&&(b.prototype[a]=function(){var C=this.__wrapped__,R=p?[1]:arguments,M=C instanceof bt,k=R[0],U=M||ct(C),W=function(xt){var Et=x.apply(b,Zi([xt],R));return p&&Y?Et[0]:Et};U&&u&&typeof k=="function"&&k.length!=1&&(M=U=!1);var Y=this.__chain__,tt=!!this.__actions__.length,at=E&&!Y,gt=M&&!tt;if(!E&&U){C=gt?C:new bt(this);var ht=s.apply(C,R);return ht.__actions__.push({func:to,args:[W],thisArg:e}),new ze(ht,Y)}return at&&gt?s.apply(this,R):(ht=this.thru(W),at?p?ht.value()[0]:ht.value():ht)})}),Xe(["pop","push","shift","sort","splice","unshift"],function(s){var a=Ss[s],u=/^(?:push|sort|unshift)$/.test(s)?"tap":"thru",p=/^(?:pop|shift)$/.test(s);b.prototype[s]=function(){var x=arguments;if(p&&!this.__chain__){var E=this.value();return a.apply(ct(E)?E:[],x)}return this[u](function(C){return a.apply(ct(C)?C:[],x)})}}),_i(bt.prototype,function(s,a){var u=b[a];if(u){var p=u.name+"";Bt.call(Zn,p)||(Zn[p]=[]),Zn[p].push({name:a,func:u})}}),Zn[Ys(e,T).name]=[{name:"wrapper",func:e}],bt.prototype.clone=Y_,bt.prototype.reverse=j_,bt.prototype.value=q_,b.prototype.at=Tx,b.prototype.chain=Ax,b.prototype.commit=Sx,b.prototype.next=Cx,b.prototype.plant=Rx,b.prototype.reverse=Px,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=Mx,b.prototype.first=b.prototype.head,Or&&(b.prototype[Or]=Ix),b},jn=S_();_n?((_n.exports=jn)._=jn,Da._=jn):ce._=jn}).call(Hi)})(be,be.exports);const Sn=be.exports;var Wn=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(Wn||{}),gl=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(gl||{}),lt=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(lt||{}),Ti=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(Ti||{}),$=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))($||{}),pr=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(pr||{}),st=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(st||{}),ml=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(ml||{}),Xi=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Xi||{}),cn=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(cn||{}),Ci=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(Ci||{}),gi=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(gi||{}),wi=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(wi||{}),jl=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(jl||{}),Ke=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(Ke||{}),he=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(he||{}),re=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(re||{}),Ai=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(Ai||{});const Nb={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},K={ADAPTER:Nb,RESOLUTION:1,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,premultipliedAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Nh=/iPhone/i,Vf=/iPod/i,Yf=/iPad/i,jf=/\biOS-universal(?:.+)Mac\b/i,kh=/\bAndroid(?:.+)Mobile\b/i,qf=/Android/i,rr=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ho=/Silk/i,Ui=/Windows Phone/i,Kf=/\bWindows(?:.+)ARM\b/i,Zf=/BlackBerry/i,Jf=/BB10/i,Qf=/Opera Mini/i,td=/\b(CriOS|Chrome)(?:.+)Mobile/i,ed=/Mobile(?:.+)Firefox\b/i,id=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function kb(i){return function(t){return t.test(i)}}function Ub(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,n=e.split("[FBAN");typeof n[1]<"u"&&(e=n[0]),n=e.split("Twitter"),typeof n[1]<"u"&&(e=n[0]);var r=kb(e),o={apple:{phone:r(Nh)&&!r(Ui),ipod:r(Vf),tablet:!r(Nh)&&(r(Yf)||id(t))&&!r(Ui),universal:r(jf),device:(r(Nh)||r(Vf)||r(Yf)||r(jf)||id(t))&&!r(Ui)},amazon:{phone:r(rr),tablet:!r(rr)&&r(ho),device:r(rr)||r(ho)},android:{phone:!r(Ui)&&r(rr)||!r(Ui)&&r(kh),tablet:!r(Ui)&&!r(rr)&&!r(kh)&&(r(ho)||r(qf)),device:!r(Ui)&&(r(rr)||r(ho)||r(kh)||r(qf))||r(/\bokhttp\b/i)},windows:{phone:r(Ui),tablet:r(Kf),device:r(Ui)||r(Kf)},other:{blackberry:r(Zf),blackberry10:r(Jf),opera:r(Qf),firefox:r(ed),chrome:r(td),device:r(Zf)||r(Jf)||r(Qf)||r(ed)||r(td)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const $i=Ub(globalThis.navigator);K.RETINA_PREFIX=/@([0-9\.]+)x/;K.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ap={exports:{}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function r(c,f,d){this.fn=c,this.context=f,this.once=d||!1}function o(c,f,d,g,m){if(typeof d!="function")throw new TypeError("The listener must be a function");var _=new r(d,g||c,m),v=e?e+f:f;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],_]:c._events[v].push(_):(c._events[v]=_,c._eventsCount++),c}function h(c,f){--c._eventsCount===0?c._events=new n:delete c._events[f]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var f=[],d,g;if(this._eventsCount===0)return f;for(g in d=this._events)t.call(d,g)&&f.push(e?g.slice(1):g);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(d)):f},l.prototype.listeners=function(f){var d=e?e+f:f,g=this._events[d];if(!g)return[];if(g.fn)return[g.fn];for(var m=0,_=g.length,v=new Array(_);m<_;m++)v[m]=g[m].fn;return v},l.prototype.listenerCount=function(f){var d=e?e+f:f,g=this._events[d];return g?g.fn?1:g.length:0},l.prototype.emit=function(f,d,g,m,_,v){var w=e?e+f:f;if(!this._events[w])return!1;var y=this._events[w],T=arguments.length,S,A;if(y.fn){switch(y.once&&this.removeListener(f,y.fn,void 0,!0),T){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,g),!0;case 4:return y.fn.call(y.context,d,g,m),!0;case 5:return y.fn.call(y.context,d,g,m,_),!0;case 6:return y.fn.call(y.context,d,g,m,_,v),!0}for(A=1,S=new Array(T-1);A<T;A++)S[A-1]=arguments[A];y.fn.apply(y.context,S)}else{var I=y.length,D;for(A=0;A<I;A++)switch(y[A].once&&this.removeListener(f,y[A].fn,void 0,!0),T){case 1:y[A].fn.call(y[A].context);break;case 2:y[A].fn.call(y[A].context,d);break;case 3:y[A].fn.call(y[A].context,d,g);break;case 4:y[A].fn.call(y[A].context,d,g,m);break;default:if(!S)for(D=1,S=new Array(T-1);D<T;D++)S[D-1]=arguments[D];y[A].fn.apply(y[A].context,S)}}return!0},l.prototype.on=function(f,d,g){return o(this,f,d,g,!1)},l.prototype.once=function(f,d,g){return o(this,f,d,g,!0)},l.prototype.removeListener=function(f,d,g,m){var _=e?e+f:f;if(!this._events[_])return this;if(!d)return h(this,_),this;var v=this._events[_];if(v.fn)v.fn===d&&(!m||v.once)&&(!g||v.context===g)&&h(this,_);else{for(var w=0,y=[],T=v.length;w<T;w++)(v[w].fn!==d||m&&!v[w].once||g&&v[w].context!==g)&&y.push(v[w]);y.length?this._events[_]=y.length===1?y[0]:y:h(this,_)}return this},l.prototype.removeAllListeners=function(f){var d;return f?(d=e?e+f:f,this._events[d]&&h(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,i.exports=l})(ap);const ps=ap.exports;var ql={exports:{}};ql.exports=ra;ql.exports.default=ra;function ra(i,t,e){e=e||2;var n=t&&t.length,r=n?t[0]*e:i.length,o=hp(i,0,r,e,!0),h=[];if(!o||o.next===o.prev)return h;var l,c,f,d,g,m,_;if(n&&(o=$b(i,t,o,e)),i.length>80*e){l=f=i[0],c=d=i[1];for(var v=e;v<r;v+=e)g=i[v],m=i[v+1],g<l&&(l=g),m<c&&(c=m),g>f&&(f=g),m>d&&(d=m);_=Math.max(f-l,d-c),_=_!==0?32767/_:0}return os(o,h,e,l,c,_,0),h}function hp(i,t,e,n,r){var o,h;if(r===xl(i,t,e,n)>0)for(o=t;o<e;o+=n)h=nd(o,i[o],i[o+1],h);else for(o=e-n;o>=t;o-=n)h=nd(o,i[o],i[o+1],h);return h&&sa(h,h.next)&&(hs(h),h=h.next),h}function kn(i,t){if(!i)return i;t||(t=i);var e=i,n;do if(n=!1,!e.steiner&&(sa(e,e.next)||Vt(e.prev,e,e.next)===0)){if(hs(e),e=t=e.prev,e===e.next)break;n=!0}else e=e.next;while(n||e!==t);return t}function os(i,t,e,n,r,o,h){if(i){!h&&o&&qb(i,n,r,o);for(var l=i,c,f;i.prev!==i.next;){if(c=i.prev,f=i.next,o?Wb(i,n,r,o):Gb(i)){t.push(c.i/e|0),t.push(i.i/e|0),t.push(f.i/e|0),hs(i),i=f.next,l=f.next;continue}if(i=f,i===l){h?h===1?(i=Hb(kn(i),t,e),os(i,t,e,n,r,o,2)):h===2&&Xb(i,t,e,n,r,o):os(kn(i),t,e,n,r,o,1);break}}}}function Gb(i){var t=i.prev,e=i,n=i.next;if(Vt(t,e,n)>=0)return!1;for(var r=t.x,o=e.x,h=n.x,l=t.y,c=e.y,f=n.y,d=r<o?r<h?r:h:o<h?o:h,g=l<c?l<f?l:f:c<f?c:f,m=r>o?r>h?r:h:o>h?o:h,_=l>c?l>f?l:f:c>f?c:f,v=n.next;v!==t;){if(v.x>=d&&v.x<=m&&v.y>=g&&v.y<=_&&cr(r,l,o,c,h,f,v.x,v.y)&&Vt(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function Wb(i,t,e,n){var r=i.prev,o=i,h=i.next;if(Vt(r,o,h)>=0)return!1;for(var l=r.x,c=o.x,f=h.x,d=r.y,g=o.y,m=h.y,_=l<c?l<f?l:f:c<f?c:f,v=d<g?d<m?d:m:g<m?g:m,w=l>c?l>f?l:f:c>f?c:f,y=d>g?d>m?d:m:g>m?g:m,T=_l(_,v,t,e,n),S=_l(w,y,t,e,n),A=i.prevZ,I=i.nextZ;A&&A.z>=T&&I&&I.z<=S;){if(A.x>=_&&A.x<=w&&A.y>=v&&A.y<=y&&A!==r&&A!==h&&cr(l,d,c,g,f,m,A.x,A.y)&&Vt(A.prev,A,A.next)>=0||(A=A.prevZ,I.x>=_&&I.x<=w&&I.y>=v&&I.y<=y&&I!==r&&I!==h&&cr(l,d,c,g,f,m,I.x,I.y)&&Vt(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;A&&A.z>=T;){if(A.x>=_&&A.x<=w&&A.y>=v&&A.y<=y&&A!==r&&A!==h&&cr(l,d,c,g,f,m,A.x,A.y)&&Vt(A.prev,A,A.next)>=0)return!1;A=A.prevZ}for(;I&&I.z<=S;){if(I.x>=_&&I.x<=w&&I.y>=v&&I.y<=y&&I!==r&&I!==h&&cr(l,d,c,g,f,m,I.x,I.y)&&Vt(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function Hb(i,t,e){var n=i;do{var r=n.prev,o=n.next.next;!sa(r,o)&&lp(r,n,n.next,o)&&as(r,o)&&as(o,r)&&(t.push(r.i/e|0),t.push(n.i/e|0),t.push(o.i/e|0),hs(n),hs(n.next),n=i=o),n=n.next}while(n!==i);return kn(n)}function Xb(i,t,e,n,r,o){var h=i;do{for(var l=h.next.next;l!==h.prev;){if(h.i!==l.i&&Jb(h,l)){var c=up(h,l);h=kn(h,h.next),c=kn(c,c.next),os(h,t,e,n,r,o,0),os(c,t,e,n,r,o,0);return}l=l.next}h=h.next}while(h!==i)}function $b(i,t,e,n){var r=[],o,h,l,c,f;for(o=0,h=t.length;o<h;o++)l=t[o]*n,c=o<h-1?t[o+1]*n:i.length,f=hp(i,l,c,n,!1),f===f.next&&(f.steiner=!0),r.push(Zb(f));for(r.sort(zb),o=0;o<r.length;o++)e=Vb(r[o],e);return e}function zb(i,t){return i.x-t.x}function Vb(i,t){var e=Yb(i,t);if(!e)return t;var n=up(e,i);return kn(n,n.next),kn(e,e.next)}function Yb(i,t){var e=t,n=i.x,r=i.y,o=-1/0,h;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var l=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(l<=n&&l>o&&(o=l,h=e.x<e.next.x?e:e.next,l===n))return h}e=e.next}while(e!==t);if(!h)return null;var c=h,f=h.x,d=h.y,g=1/0,m;e=h;do n>=e.x&&e.x>=f&&n!==e.x&&cr(r<d?n:o,r,f,d,r<d?o:n,r,e.x,e.y)&&(m=Math.abs(r-e.y)/(n-e.x),as(e,i)&&(m<g||m===g&&(e.x>h.x||e.x===h.x&&jb(h,e)))&&(h=e,g=m)),e=e.next;while(e!==c);return h}function jb(i,t){return Vt(i.prev,i,t.prev)<0&&Vt(t.next,i,i.next)<0}function qb(i,t,e,n){var r=i;do r.z===0&&(r.z=_l(r.x,r.y,t,e,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,Kb(r)}function Kb(i){var t,e,n,r,o,h,l,c,f=1;do{for(e=i,i=null,o=null,h=0;e;){for(h++,n=e,l=0,t=0;t<f&&(l++,n=n.nextZ,!!n);t++);for(c=f;l>0||c>0&&n;)l!==0&&(c===0||!n||e.z<=n.z)?(r=e,e=e.nextZ,l--):(r=n,n=n.nextZ,c--),o?o.nextZ=r:i=r,r.prevZ=o,o=r;e=n}o.nextZ=null,f*=2}while(h>1);return i}function _l(i,t,e,n,r){return i=(i-e)*r|0,t=(t-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function Zb(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function cr(i,t,e,n,r,o,h,l){return(r-h)*(t-l)>=(i-h)*(o-l)&&(i-h)*(n-l)>=(e-h)*(t-l)&&(e-h)*(o-l)>=(r-h)*(n-l)}function Jb(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!Qb(i,t)&&(as(i,t)&&as(t,i)&&tw(i,t)&&(Vt(i.prev,i,t.prev)||Vt(i,t.prev,t))||sa(i,t)&&Vt(i.prev,i,i.next)>0&&Vt(t.prev,t,t.next)>0)}function Vt(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function sa(i,t){return i.x===t.x&&i.y===t.y}function lp(i,t,e,n){var r=uo(Vt(i,t,e)),o=uo(Vt(i,t,n)),h=uo(Vt(e,n,i)),l=uo(Vt(e,n,t));return!!(r!==o&&h!==l||r===0&&lo(i,e,t)||o===0&&lo(i,n,t)||h===0&&lo(e,i,n)||l===0&&lo(e,t,n))}function lo(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function uo(i){return i>0?1:i<0?-1:0}function Qb(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&lp(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function as(i,t){return Vt(i.prev,i,i.next)<0?Vt(i,t,i.next)>=0&&Vt(i,i.prev,t)>=0:Vt(i,t,i.prev)<0||Vt(i,i.next,t)<0}function tw(i,t){var e=i,n=!1,r=(i.x+t.x)/2,o=(i.y+t.y)/2;do e.y>o!=e.next.y>o&&e.next.y!==e.y&&r<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(n=!n),e=e.next;while(e!==i);return n}function up(i,t){var e=new vl(i.i,i.x,i.y),n=new vl(t.i,t.x,t.y),r=i.next,o=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,n.next=e,e.prev=n,o.next=n,n.prev=o,n}function nd(i,t,e,n){var r=new vl(i,t,e);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function hs(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function vl(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ra.deviation=function(i,t,e,n){var r=t&&t.length,o=r?t[0]*e:i.length,h=Math.abs(xl(i,0,o,e));if(r)for(var l=0,c=t.length;l<c;l++){var f=t[l]*e,d=l<c-1?t[l+1]*e:i.length;h-=Math.abs(xl(i,f,d,e))}var g=0;for(l=0;l<n.length;l+=3){var m=n[l]*e,_=n[l+1]*e,v=n[l+2]*e;g+=Math.abs((i[m]-i[v])*(i[_+1]-i[m+1])-(i[m]-i[_])*(i[v+1]-i[m+1]))}return h===0&&g===0?0:Math.abs((g-h)/h)};function xl(i,t,e,n){for(var r=0,o=t,h=e-n;o<e;o+=n)r+=(i[h]-i[o])*(i[o+1]+i[h+1]),h=o;return r}ra.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},n=0,r=0;r<i.length;r++){for(var o=0;o<i[r].length;o++)for(var h=0;h<t;h++)e.vertices.push(i[r][o][h]);r>0&&(n+=i[r-1].length,e.holes.push(n))}return e};var yl={exports:{}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(i,t){(function(e){var n=t&&!t.nodeType&&t,r=i&&!i.nodeType&&i,o=typeof Hi=="object"&&Hi;(o.global===o||o.window===o||o.self===o)&&(e=o);var h,l=2147483647,c=36,f=1,d=26,g=38,m=700,_=72,v=128,w="-",y=/^xn--/,T=/[^\x20-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,A={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=c-f,D=Math.floor,N=String.fromCharCode,L;function F(H){throw RangeError(A[H])}function V(H,it){for(var yt=H.length,Rt=[];yt--;)Rt[yt]=it(H[yt]);return Rt}function J(H,it){var yt=H.split("@"),Rt="";yt.length>1&&(Rt=yt[0]+"@",H=yt[1]),H=H.replace(S,".");var Mt=H.split("."),Ot=V(Mt,it).join(".");return Rt+Ot}function z(H){for(var it=[],yt=0,Rt=H.length,Mt,Ot;yt<Rt;)Mt=H.charCodeAt(yt++),Mt>=55296&&Mt<=56319&&yt<Rt?(Ot=H.charCodeAt(yt++),(Ot&64512)==56320?it.push(((Mt&1023)<<10)+(Ot&1023)+65536):(it.push(Mt),yt--)):it.push(Mt);return it}function Q(H){return V(H,function(it){var yt="";return it>65535&&(it-=65536,yt+=N(it>>>10&1023|55296),it=56320|it&1023),yt+=N(it),yt}).join("")}function X(H){return H-48<10?H-22:H-65<26?H-65:H-97<26?H-97:c}function G(H,it){return H+22+75*(H<26)-((it!=0)<<5)}function dt(H,it,yt){var Rt=0;for(H=yt?D(H/m):H>>1,H+=D(H/it);H>I*d>>1;Rt+=c)H=D(H/I);return D(Rt+(I+1)*H/(H+g))}function _t(H){var it=[],yt=H.length,Rt,Mt=0,Ot=v,Nt=_,ie,jt,ne,se,Dt,kt,qt,Kt,ve;for(ie=H.lastIndexOf(w),ie<0&&(ie=0),jt=0;jt<ie;++jt)H.charCodeAt(jt)>=128&&F("not-basic"),it.push(H.charCodeAt(jt));for(ne=ie>0?ie+1:0;ne<yt;){for(se=Mt,Dt=1,kt=c;ne>=yt&&F("invalid-input"),qt=X(H.charCodeAt(ne++)),(qt>=c||qt>D((l-Mt)/Dt))&&F("overflow"),Mt+=qt*Dt,Kt=kt<=Nt?f:kt>=Nt+d?d:kt-Nt,!(qt<Kt);kt+=c)ve=c-Kt,Dt>D(l/ve)&&F("overflow"),Dt*=ve;Rt=it.length+1,Nt=dt(Mt-se,Rt,se==0),D(Mt/Rt)>l-Ot&&F("overflow"),Ot+=D(Mt/Rt),Mt%=Rt,it.splice(Mt++,0,Ot)}return Q(it)}function j(H){var it,yt,Rt,Mt,Ot,Nt,ie,jt,ne,se,Dt,kt=[],qt,Kt,ve,mn;for(H=z(H),qt=H.length,it=v,yt=0,Ot=_,Nt=0;Nt<qt;++Nt)Dt=H[Nt],Dt<128&&kt.push(N(Dt));for(Rt=Mt=kt.length,Mt&&kt.push(w);Rt<qt;){for(ie=l,Nt=0;Nt<qt;++Nt)Dt=H[Nt],Dt>=it&&Dt<ie&&(ie=Dt);for(Kt=Rt+1,ie-it>D((l-yt)/Kt)&&F("overflow"),yt+=(ie-it)*Kt,it=ie,Nt=0;Nt<qt;++Nt)if(Dt=H[Nt],Dt<it&&++yt>l&&F("overflow"),Dt==it){for(jt=yt,ne=c;se=ne<=Ot?f:ne>=Ot+d?d:ne-Ot,!(jt<se);ne+=c)mn=jt-se,ve=c-se,kt.push(N(G(se+mn%ve,0))),jt=D(mn/ve);kt.push(N(G(jt,0))),Ot=dt(yt,Kt,Rt==Mt),yt=0,++Rt}++yt,++it}return kt.join("")}function vt(H){return J(H,function(it){return y.test(it)?_t(it.slice(4).toLowerCase()):it})}function Wt(H){return J(H,function(it){return T.test(it)?"xn--"+j(it):it})}if(h={version:"1.3.2",ucs2:{decode:z,encode:Q},decode:_t,encode:j,toASCII:Wt,toUnicode:vt},n&&r)if(i.exports==n)r.exports=h;else for(L in h)h.hasOwnProperty(L)&&(n[L]=h[L]);else e.punycode=h})(Hi)})(yl,yl.exports);var ew={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},ls={};function iw(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var nw=function(i,t,e,n){t=t||"&",e=e||"=";var r={};if(typeof i!="string"||i.length===0)return r;var o=/\+/g;i=i.split(t);var h=1e3;n&&typeof n.maxKeys=="number"&&(h=n.maxKeys);var l=i.length;h>0&&l>h&&(l=h);for(var c=0;c<l;++c){var f=i[c].replace(o,"%20"),d=f.indexOf(e),g,m,_,v;d>=0?(g=f.substr(0,d),m=f.substr(d+1)):(g=f,m=""),_=decodeURIComponent(g),v=decodeURIComponent(m),iw(r,_)?Array.isArray(r[_])?r[_].push(v):r[_]=[r[_],v]:r[_]=v}return r},Kr=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},rw=function(i,t,e,n){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(r){var o=encodeURIComponent(Kr(r))+e;return Array.isArray(i[r])?i[r].map(function(h){return o+encodeURIComponent(Kr(h))}).join(t):o+encodeURIComponent(Kr(i[r]))}).join(t):n?encodeURIComponent(Kr(n))+e+encodeURIComponent(Kr(i)):""};ls.decode=ls.parse=nw;ls.encode=ls.stringify=rw;var sw=yl.exports,Ei=ew,ow=oa,aw=vw,hw=_w;function ci(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var lw=/^([a-z0-9.+-]+:)/i,uw=/:[0-9]*$/,cw=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,fw=["<",">",'"',"`"," ","\r",`
`,"	"],dw=["{","}","|","\\","^","`"].concat(fw),bl=["'"].concat(dw),rd=["%","/","?",";","#"].concat(bl),sd=["/","?","#"],pw=255,od=/^[+a-z0-9A-Z_-]{0,63}$/,gw=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,mw={javascript:!0,"javascript:":!0},wl={javascript:!0,"javascript:":!0},gr={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},El=ls;function oa(i,t,e){if(i&&Ei.isObject(i)&&i instanceof ci)return i;var n=new ci;return n.parse(i,t,e),n}ci.prototype.parse=function(i,t,e){if(!Ei.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var n=i.indexOf("?"),r=n!==-1&&n<i.indexOf("#")?"?":"#",o=i.split(r),h=/\\/g;o[0]=o[0].replace(h,"/"),i=o.join(r);var l=i;if(l=l.trim(),!e&&i.split("#").length===1){var c=cw.exec(l);if(c)return this.path=l,this.href=l,this.pathname=c[1],c[2]?(this.search=c[2],t?this.query=El.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var f=lw.exec(l);if(f){f=f[0];var d=f.toLowerCase();this.protocol=d,l=l.substr(f.length)}if(e||f||l.match(/^\/\/[^@\/]+@[^@\/]+/)){var g=l.substr(0,2)==="//";g&&!(f&&wl[f])&&(l=l.substr(2),this.slashes=!0)}if(!wl[f]&&(g||f&&!gr[f])){for(var m=-1,_=0;_<sd.length;_++){var v=l.indexOf(sd[_]);v!==-1&&(m===-1||v<m)&&(m=v)}var w,y;m===-1?y=l.lastIndexOf("@"):y=l.lastIndexOf("@",m),y!==-1&&(w=l.slice(0,y),l=l.slice(y+1),this.auth=decodeURIComponent(w)),m=-1;for(var _=0;_<rd.length;_++){var v=l.indexOf(rd[_]);v!==-1&&(m===-1||v<m)&&(m=v)}m===-1&&(m=l.length),this.host=l.slice(0,m),l=l.slice(m),this.parseHost(),this.hostname=this.hostname||"";var T=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!T)for(var S=this.hostname.split(/\./),_=0,A=S.length;_<A;_++){var I=S[_];if(I&&!I.match(od)){for(var D="",N=0,L=I.length;N<L;N++)I.charCodeAt(N)>127?D+="x":D+=I[N];if(!D.match(od)){var F=S.slice(0,_),V=S.slice(_+1),J=I.match(gw);J&&(F.push(J[1]),V.unshift(J[2])),V.length&&(l="/"+V.join(".")+l),this.hostname=F.join(".");break}}}this.hostname.length>pw?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=sw.toASCII(this.hostname));var z=this.port?":"+this.port:"",Q=this.hostname||"";this.host=Q+z,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),l[0]!=="/"&&(l="/"+l))}if(!mw[d])for(var _=0,A=bl.length;_<A;_++){var X=bl[_];if(l.indexOf(X)!==-1){var G=encodeURIComponent(X);G===X&&(G=escape(X)),l=l.split(X).join(G)}}var dt=l.indexOf("#");dt!==-1&&(this.hash=l.substr(dt),l=l.slice(0,dt));var _t=l.indexOf("?");if(_t!==-1?(this.search=l.substr(_t),this.query=l.substr(_t+1),t&&(this.query=El.parse(this.query)),l=l.slice(0,_t)):t&&(this.search="",this.query={}),l&&(this.pathname=l),gr[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var z=this.pathname||"",j=this.search||"";this.path=z+j}return this.href=this.format(),this};function _w(i){return Ei.isString(i)&&(i=oa(i)),i instanceof ci?i.format():ci.prototype.format.call(i)}ci.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",n=this.hash||"",r=!1,o="";this.host?r=i+this.host:this.hostname&&(r=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&Ei.isObject(this.query)&&Object.keys(this.query).length&&(o=El.stringify(this.query));var h=this.search||o&&"?"+o||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||gr[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),n&&n.charAt(0)!=="#"&&(n="#"+n),h&&h.charAt(0)!=="?"&&(h="?"+h),e=e.replace(/[?#]/g,function(l){return encodeURIComponent(l)}),h=h.replace("#","%23"),t+r+e+h+n};function vw(i,t){return oa(i,!1,!0).resolve(t)}ci.prototype.resolve=function(i){return this.resolveObject(oa(i,!1,!0)).format()};ci.prototype.resolveObject=function(i){if(Ei.isString(i)){var t=new ci;t.parse(i,!1,!0),i=t}for(var e=new ci,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];e[o]=this[o]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var h=Object.keys(i),l=0;l<h.length;l++){var c=h[l];c!=="protocol"&&(e[c]=i[c])}return gr[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!gr[i.protocol]){for(var f=Object.keys(i),d=0;d<f.length;d++){var g=f[d];e[g]=i[g]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!wl[i.protocol]){for(var A=(i.pathname||"").split("/");A.length&&!(i.host=A.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),A[0]!==""&&A.unshift(""),A.length<2&&A.unshift(""),e.pathname=A.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var m=e.pathname||"",_=e.search||"";e.path=m+_}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var v=e.pathname&&e.pathname.charAt(0)==="/",w=i.host||i.pathname&&i.pathname.charAt(0)==="/",y=w||v||e.host&&i.pathname,T=y,S=e.pathname&&e.pathname.split("/")||[],A=i.pathname&&i.pathname.split("/")||[],I=e.protocol&&!gr[e.protocol];if(I&&(e.hostname="",e.port=null,e.host&&(S[0]===""?S[0]=e.host:S.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(A[0]===""?A[0]=i.host:A.unshift(i.host)),i.host=null),y=y&&(A[0]===""||S[0]==="")),w)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,S=A;else if(A.length)S||(S=[]),S.pop(),S=S.concat(A),e.search=i.search,e.query=i.query;else if(!Ei.isNullOrUndefined(i.search)){if(I){e.hostname=e.host=S.shift();var D=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;D&&(e.auth=D.shift(),e.host=e.hostname=D.shift())}return e.search=i.search,e.query=i.query,(!Ei.isNull(e.pathname)||!Ei.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!S.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var N=S.slice(-1)[0],L=(e.host||i.host||S.length>1)&&(N==="."||N==="..")||N==="",F=0,V=S.length;V>=0;V--)N=S[V],N==="."?S.splice(V,1):N===".."?(S.splice(V,1),F++):F&&(S.splice(V,1),F--);if(!y&&!T)for(;F--;F)S.unshift("..");y&&S[0]!==""&&(!S[0]||S[0].charAt(0)!=="/")&&S.unshift(""),L&&S.join("/").substr(-1)!=="/"&&S.push("");var J=S[0]===""||S[0]&&S[0].charAt(0)==="/";if(I){e.hostname=e.host=J?"":S.length?S.shift():"";var D=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;D&&(e.auth=D.shift(),e.host=e.hostname=D.shift())}return y=y||e.host&&S.length,y&&!J&&S.unshift(""),S.length?e.pathname=S.join("/"):(e.pathname=null,e.path=null),(!Ei.isNull(e.pathname)||!Ei.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};ci.prototype.parseHost=function(){var i=this.host,t=uw.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const xw={parse:ow,format:hw,resolve:aw};function ni(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function Zr(i){return i.split("?")[0].split("#")[0]}function yw(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function bw(i,t,e){return i.replace(new RegExp(yw(t),"g"),e)}function ww(i,t){let e="",n=0,r=-1,o=0,h=-1;for(let l=0;l<=i.length;++l){if(l<i.length)h=i.charCodeAt(l);else{if(h===47)break;h=47}if(h===47){if(!(r===l-1||o===1))if(r!==l-1&&o===2){if(e.length<2||n!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const c=e.lastIndexOf("/");if(c!==e.length-1){c===-1?(e="",n=0):(e=e.slice(0,c),n=e.length-1-e.lastIndexOf("/")),r=l,o=0;continue}}else if(e.length===2||e.length===1){e="",n=0,r=l,o=0;continue}}t&&(e.length>0?e+="/..":e="..",n=2)}else e.length>0?e+=`/${i.slice(r+1,l)}`:e=i.slice(r+1,l),n=l-r-1;r=l,o=0}else h===46&&o!==-1?++o:o=-1}return e}const _e={toPosix(i){return bw(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){ni(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),n=/^[^/:]+:\/\//.exec(i),r=/^[^/:]+:\//.exec(i);if(e||n||r){const o=(e==null?void 0:e[0])||(n==null?void 0:n[0])||(r==null?void 0:r[0]);t=o,i=i.slice(o.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const n=Zr(this.toPosix(t??K.ADAPTER.getBaseUrl())),r=Zr(this.toPosix(e??this.rootname(n)));return ni(i),i=this.toPosix(i),i.startsWith("/")?_e.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(n,i)},normalize(i){if(i=this.toPosix(i),ni(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const n=i.endsWith("/");return i=ww(i,!1),i.length>0&&n&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return ni(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const n=i[e];if(ni(n),n.length>0)if(t===void 0)t=n;else{const r=i[e-1]??"";this.extname(r)?t+=`/../${n}`:t+=`/${n}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(ni(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let n=-1,r=!0;const o=this.getProtocol(i),h=i;i=i.slice(o.length);for(let l=i.length-1;l>=1;--l)if(t=i.charCodeAt(l),t===47){if(!r){n=l;break}}else r=!1;return n===-1?e?"/":this.isUrl(h)?o+i:o:e&&n===1?"//":o+i.slice(0,n)},rootname(i){ni(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){ni(i),t&&ni(t),i=Zr(this.toPosix(i));let e=0,n=-1,r=!0,o;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let h=t.length-1,l=-1;for(o=i.length-1;o>=0;--o){const c=i.charCodeAt(o);if(c===47){if(!r){e=o+1;break}}else l===-1&&(r=!1,l=o+1),h>=0&&(c===t.charCodeAt(h)?--h===-1&&(n=o):(h=-1,n=l))}return e===n?n=l:n===-1&&(n=i.length),i.slice(e,n)}for(o=i.length-1;o>=0;--o)if(i.charCodeAt(o)===47){if(!r){e=o+1;break}}else n===-1&&(r=!1,n=o+1);return n===-1?"":i.slice(e,n)},extname(i){ni(i),i=Zr(this.toPosix(i));let t=-1,e=0,n=-1,r=!0,o=0;for(let h=i.length-1;h>=0;--h){const l=i.charCodeAt(h);if(l===47){if(!r){e=h+1;break}continue}n===-1&&(r=!1,n=h+1),l===46?t===-1?t=h:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||n===-1||o===0||o===1&&t===n-1&&t===e+1?"":i.slice(t,n)},parse(i){ni(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=Zr(this.toPosix(i));let e=i.charCodeAt(0);const n=this.isAbsolute(i);let r;t.root=this.rootname(i),n||this.hasProtocol(i)?r=1:r=0;let o=-1,h=0,l=-1,c=!0,f=i.length-1,d=0;for(;f>=r;--f){if(e=i.charCodeAt(f),e===47){if(!c){h=f+1;break}continue}l===-1&&(c=!1,l=f+1),e===46?o===-1?o=f:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||l===-1||d===0||d===1&&o===l-1&&o===h+1?l!==-1&&(h===0&&n?t.base=t.name=i.slice(1,l):t.base=t.name=i.slice(h,l)):(h===0&&n?(t.name=i.slice(1,o),t.base=i.slice(1,l)):(t.name=i.slice(h,o),t.base=i.slice(h,l)),t.ext=i.slice(o,l)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},ad={};function St(i,t,e=3){if(ad[t])return;let n=new Error().stack;typeof n>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(n=n.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(n))),ad[t]=!0}let Uh;function Ew(){return typeof Uh>"u"&&(Uh=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:K.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!K.ADAPTER.getWebGLRenderingContext())return!1;const n=K.ADAPTER.createCanvas();let r=n.getContext("webgl",t)||n.getContext("experimental-webgl",t);const o=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const h=r.getExtension("WEBGL_lose_context");h&&h.loseContext()}return r=null,o}catch{return!1}}()),Uh}var Tw="#f0f8ff",Aw="#faebd7",Sw="#00ffff",Cw="#7fffd4",Iw="#f0ffff",Rw="#f5f5dc",Pw="#ffe4c4",Mw="#000000",Dw="#ffebcd",Bw="#0000ff",Fw="#8a2be2",Lw="#a52a2a",Ow="#deb887",Nw="#5f9ea0",kw="#7fff00",Uw="#d2691e",Gw="#ff7f50",Ww="#6495ed",Hw="#fff8dc",Xw="#dc143c",$w="#00ffff",zw="#00008b",Vw="#008b8b",Yw="#b8860b",jw="#a9a9a9",qw="#006400",Kw="#a9a9a9",Zw="#bdb76b",Jw="#8b008b",Qw="#556b2f",tE="#ff8c00",eE="#9932cc",iE="#8b0000",nE="#e9967a",rE="#8fbc8f",sE="#483d8b",oE="#2f4f4f",aE="#2f4f4f",hE="#00ced1",lE="#9400d3",uE="#ff1493",cE="#00bfff",fE="#696969",dE="#696969",pE="#1e90ff",gE="#b22222",mE="#fffaf0",_E="#228b22",vE="#ff00ff",xE="#dcdcdc",yE="#f8f8ff",bE="#daa520",wE="#ffd700",EE="#808080",TE="#008000",AE="#adff2f",SE="#808080",CE="#f0fff0",IE="#ff69b4",RE="#cd5c5c",PE="#4b0082",ME="#fffff0",DE="#f0e68c",BE="#fff0f5",FE="#e6e6fa",LE="#7cfc00",OE="#fffacd",NE="#add8e6",kE="#f08080",UE="#e0ffff",GE="#fafad2",WE="#d3d3d3",HE="#90ee90",XE="#d3d3d3",$E="#ffb6c1",zE="#ffa07a",VE="#20b2aa",YE="#87cefa",jE="#778899",qE="#778899",KE="#b0c4de",ZE="#ffffe0",JE="#00ff00",QE="#32cd32",tT="#faf0e6",eT="#ff00ff",iT="#800000",nT="#66cdaa",rT="#0000cd",sT="#ba55d3",oT="#9370db",aT="#3cb371",hT="#7b68ee",lT="#00fa9a",uT="#48d1cc",cT="#c71585",fT="#191970",dT="#f5fffa",pT="#ffe4e1",gT="#ffe4b5",mT="#ffdead",_T="#000080",vT="#fdf5e6",xT="#808000",yT="#6b8e23",bT="#ffa500",wT="#ff4500",ET="#da70d6",TT="#eee8aa",AT="#98fb98",ST="#afeeee",CT="#db7093",IT="#ffefd5",RT="#ffdab9",PT="#cd853f",MT="#ffc0cb",DT="#dda0dd",BT="#b0e0e6",FT="#800080",LT="#663399",OT="#ff0000",NT="#bc8f8f",kT="#4169e1",UT="#8b4513",GT="#fa8072",WT="#f4a460",HT="#2e8b57",XT="#fff5ee",$T="#a0522d",zT="#c0c0c0",VT="#87ceeb",YT="#6a5acd",jT="#708090",qT="#708090",KT="#fffafa",ZT="#00ff7f",JT="#4682b4",QT="#d2b48c",tA="#008080",eA="#d8bfd8",iA="#ff6347",nA="#40e0d0",rA="#ee82ee",sA="#f5deb3",oA="#ffffff",aA="#f5f5f5",hA="#ffff00",lA="#9acd32",uA={aliceblue:Tw,antiquewhite:Aw,aqua:Sw,aquamarine:Cw,azure:Iw,beige:Rw,bisque:Pw,black:Mw,blanchedalmond:Dw,blue:Bw,blueviolet:Fw,brown:Lw,burlywood:Ow,cadetblue:Nw,chartreuse:kw,chocolate:Uw,coral:Gw,cornflowerblue:Ww,cornsilk:Hw,crimson:Xw,cyan:$w,darkblue:zw,darkcyan:Vw,darkgoldenrod:Yw,darkgray:jw,darkgreen:qw,darkgrey:Kw,darkkhaki:Zw,darkmagenta:Jw,darkolivegreen:Qw,darkorange:tE,darkorchid:eE,darkred:iE,darksalmon:nE,darkseagreen:rE,darkslateblue:sE,darkslategray:oE,darkslategrey:aE,darkturquoise:hE,darkviolet:lE,deeppink:uE,deepskyblue:cE,dimgray:fE,dimgrey:dE,dodgerblue:pE,firebrick:gE,floralwhite:mE,forestgreen:_E,fuchsia:vE,gainsboro:xE,ghostwhite:yE,goldenrod:bE,gold:wE,gray:EE,green:TE,greenyellow:AE,grey:SE,honeydew:CE,hotpink:IE,indianred:RE,indigo:PE,ivory:ME,khaki:DE,lavenderblush:BE,lavender:FE,lawngreen:LE,lemonchiffon:OE,lightblue:NE,lightcoral:kE,lightcyan:UE,lightgoldenrodyellow:GE,lightgray:WE,lightgreen:HE,lightgrey:XE,lightpink:$E,lightsalmon:zE,lightseagreen:VE,lightskyblue:YE,lightslategray:jE,lightslategrey:qE,lightsteelblue:KE,lightyellow:ZE,lime:JE,limegreen:QE,linen:tT,magenta:eT,maroon:iT,mediumaquamarine:nT,mediumblue:rT,mediumorchid:sT,mediumpurple:oT,mediumseagreen:aT,mediumslateblue:hT,mediumspringgreen:lT,mediumturquoise:uT,mediumvioletred:cT,midnightblue:fT,mintcream:dT,mistyrose:pT,moccasin:gT,navajowhite:mT,navy:_T,oldlace:vT,olive:xT,olivedrab:yT,orange:bT,orangered:wT,orchid:ET,palegoldenrod:TT,palegreen:AT,paleturquoise:ST,palevioletred:CT,papayawhip:IT,peachpuff:RT,peru:PT,pink:MT,plum:DT,powderblue:BT,purple:FT,rebeccapurple:LT,red:OT,rosybrown:NT,royalblue:kT,saddlebrown:UT,salmon:GT,sandybrown:WT,seagreen:HT,seashell:XT,sienna:$T,silver:zT,skyblue:VT,slateblue:YT,slategray:jT,slategrey:qT,snow:KT,springgreen:ZT,steelblue:JT,tan:QT,teal:tA,thistle:eA,tomato:iA,turquoise:nA,violet:rA,wheat:sA,white:oA,whitesmoke:aA,yellow:hA,yellowgreen:lA};function us(i,t=[]){return t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,t}function cp(i){let t=i.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function Kl(i){if(typeof i=="string"&&(i=uA[i.toLowerCase()]||i,i[0]==="#"&&(i=i.slice(1)),i.length===3)){const[t,e,n]=i;i=t+t+e+e+n+n}return parseInt(i,16)}function cA(){const i=[],t=[];for(let n=0;n<32;n++)i[n]=n,t[n]=n;i[lt.NORMAL_NPM]=lt.NORMAL,i[lt.ADD_NPM]=lt.ADD,i[lt.SCREEN_NPM]=lt.SCREEN,t[lt.NORMAL]=lt.NORMAL_NPM,t[lt.ADD]=lt.ADD_NPM,t[lt.SCREEN]=lt.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const fp=cA();function dp(i,t){return fp[t?1:0][i]}function fA(i,t,e,n){return e=e||new Float32Array(4),n||n===void 0?(e[0]=i[0]*t,e[1]=i[1]*t,e[2]=i[2]*t):(e[0]=i[0],e[1]=i[1],e[2]=i[2]),e[3]=t,e}function Zl(i,t){if(t===1)return(t*255<<24)+i;if(t===0)return 0;let e=i>>16&255,n=i>>8&255,r=i&255;return e=e*t+.5|0,n=n*t+.5|0,r=r*t+.5|0,(t*255<<24)+(e<<16)+(n<<8)+r}function pp(i,t,e,n){return e=e||new Float32Array(4),e[0]=(i>>16&255)/255,e[1]=(i>>8&255)/255,e[2]=(i&255)/255,(n||n===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function dA(i,t=null){const e=i*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let n=0,r=0;n<e;n+=6,r+=4)t[n+0]=r+0,t[n+1]=r+1,t[n+2]=r+2,t[n+3]=r+0,t[n+4]=r+2,t[n+5]=r+3;return t}function gp(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function Xo(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function hd(i){return!(i&i-1)&&!!i}function ld(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function mr(i,t,e){const n=i.length;let r;if(t>=n||e===0)return;e=t+e>n?n-t:e;const o=n-e;for(r=t;r<o;++r)i[r]=i[r+e];i.length=o}function fr(i){return i===0?0:i<0?-1:1}let pA=0;function Un(){return++pA}const mp=class{constructor(i,t,e,n){this.left=i,this.top=t,this.right=e,this.bottom=n}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};let Tl=mp;Tl.EMPTY=new mp(0,0,0,0);const ud={},bi=Object.create(null),on=Object.create(null);class cd{constructor(t,e,n){this._canvas=K.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=n||K.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function fd(i,t,e){for(let n=0,r=4*e*t;n<t;++n,r+=4)if(i[r+3]!==0)return!1;return!0}function dd(i,t,e,n,r){const o=4*t;for(let h=n,l=n*o+4*e;h<=r;++h,l+=o)if(i[l+3]!==0)return!1;return!0}function gA(i){const{width:t,height:e}=i,n=i.getContext("2d",{willReadFrequently:!0});if(n===null)throw new TypeError("Failed to get canvas 2D context");const o=n.getImageData(0,0,t,e).data;let h=0,l=0,c=t-1,f=e-1;for(;l<e&&fd(o,t,l);)++l;if(l===e)return Tl.EMPTY;for(;fd(o,t,f);)--f;for(;dd(o,t,h,l,f);)++h;for(;dd(o,t,c,l,f);)--c;return++c,++f,new Tl(h,l,c,f)}function mA(i){const t=gA(i),{width:e,height:n}=t;let r=null;if(!t.isEmpty()){const o=i.getContext("2d");if(o===null)throw new TypeError("Failed to get canvas 2D context");r=o.getImageData(t.left,t.top,e,n)}return{width:e,height:n,data:r}}let co;function _A(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,co||(co=document.createElement("a")),co.href=i;const e=xw.parse(co.href),n=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!n||e.protocol!==t.protocol?"anonymous":""}function fn(i,t=1){var n;const e=(n=K.RETINA_PREFIX)==null?void 0:n.exec(i);return e?parseFloat(e[1]):t}var q=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(q||{});const Al=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},pd=(i,t)=>Al(i).priority??t,rt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Al).forEach(t=>{t.type.forEach(e=>{var n,r;return(r=(n=this._removeHandlers)[e])==null?void 0:r.call(n,t)})}),this},add(...i){return i.map(Al).forEach(t=>{t.type.forEach(e=>{const n=this._addHandlers,r=this._queue;n[e]?n[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(i,t,e){const n=this._addHandlers,r=this._removeHandlers;if(n[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);n[i]=t,r[i]=e;const o=this._queue;return o[i]&&(o[i].forEach(h=>t(h)),delete o[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,n=>{t.includes(n.ref)||(t.push(n.ref),t.sort((r,o)=>pd(o,e)-pd(r,e)))},n=>{const r=t.indexOf(n.ref);r!==-1&&t.splice(r,1)})}};class Sl{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const vA=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function xA(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function yA(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const n=vA.replace(/%forloop%/gi,xA(i));if(t.shaderSource(e,n),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const Gh=0,Wh=1,Hh=2,Xh=3,$h=4,zh=5;class qi{constructor(){this.data=0,this.blendMode=lt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Gh)}set blend(t){!!(this.data&1<<Gh)!==t&&(this.data^=1<<Gh)}get offsets(){return!!(this.data&1<<Wh)}set offsets(t){!!(this.data&1<<Wh)!==t&&(this.data^=1<<Wh)}get culling(){return!!(this.data&1<<Hh)}set culling(t){!!(this.data&1<<Hh)!==t&&(this.data^=1<<Hh)}get depthTest(){return!!(this.data&1<<Xh)}set depthTest(t){!!(this.data&1<<Xh)!==t&&(this.data^=1<<Xh)}get depthMask(){return!!(this.data&1<<zh)}set depthMask(t){!!(this.data&1<<zh)!==t&&(this.data^=1<<zh)}get clockwiseFrontFace(){return!!(this.data&1<<$h)}set clockwiseFrontFace(t){!!(this.data&1<<$h)!==t&&(this.data^=1<<$h)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==lt.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new qi;return t.depthTest=!1,t.blend=!0,t}}const Cl=[];function _p(i,t){if(!i)return null;let e="";if(typeof i=="string"){const n=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);n&&(e=n[1].toLowerCase())}for(let n=Cl.length-1;n>=0;--n){const r=Cl[n];if(r.test&&r.test(i,e))return new r(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class fi{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,n,r,o,h,l,c){if(arguments.length>8)throw new Error("max arguments reached");const{name:f,items:d}=this;this._aliasCount++;for(let g=0,m=d.length;g<m;g++)d[g][f](t,e,n,r,o,h,l,c);return d===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(fi.prototype,{dispatch:{value:fi.prototype.emit},run:{value:fi.prototype.emit}});class cs{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new fi("setRealSize"),this.onUpdate=new fi("update"),this.onError=new fi("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,n){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class gs extends cs{constructor(t,e){const{width:n,height:r}=e||{};if(!n||!r)throw new Error("BufferResource width or height invalid");super(n,r),this.data=t}upload(t,e,n){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===gi.UNPACK);const o=e.realWidth,h=e.realHeight;return n.width===o&&n.height===h?r.texSubImage2D(e.target,0,0,0,o,h,e.format,n.type,this.data):(n.width=o,n.height=h,r.texImage2D(e.target,0,n.internalFormat,o,h,0,e.format,n.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const bA={scaleMode:Xi.NEAREST,format:$.RGBA,alphaMode:gi.NPM},hr=class extends ps{constructor(i=null,t=null){super(),t=Object.assign({},hr.defaultOptions,t);const{alphaMode:e,mipmap:n,anisotropicLevel:r,scaleMode:o,width:h,height:l,wrapMode:c,format:f,type:d,target:g,resolution:m,resourceOptions:_}=t;i&&!(i instanceof cs)&&(i=_p(i,_),i.internal=!0),this.resolution=m||K.RESOLUTION,this.width=Math.round((h||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=r,this._wrapMode=c,this._scaleMode=o,this.format=f,this.type=d,this.target=g,this.alphaMode=e,this.uid=Un(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=hd(this.realWidth)&&hd(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete on[this.cacheId],delete bi[this.cacheId],this.cacheId=null),this.dispose(),hr.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=K.STRICT_TEXTURE_CACHE){const n=typeof i=="string";let r=null;if(n)r=i;else{if(!i._pixiId){const h=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${h}_${Un()}`}r=i._pixiId}let o=on[r];if(n&&e&&!o)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return o||(o=new hr(i,t),o.cacheId=r,hr.addToCache(o,r)),o}static fromBuffer(i,t,e,n){i=i||new Float32Array(t*e*4);const r=new gs(i,{width:t,height:e}),o=i instanceof Float32Array?st.FLOAT:st.UNSIGNED_BYTE;return new hr(r,Object.assign({},bA,n||{width:t,height:e,type:o}))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),on[t]&&on[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),on[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=on[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete on[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete on[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let ft=hr;ft.defaultOptions={mipmap:Ci.POW2,anisotropicLevel:0,scaleMode:Xi.LINEAR,wrapMode:cn.CLAMP,alphaMode:gi.UNPACK,target:pr.TEXTURE_2D,format:$.RGBA,type:st.UNSIGNED_BYTE};ft._globalBatch=0;class Il{constructor(){this.texArray=null,this.blend=0,this.type=Ti.TRIANGLES,this.start=0,this.size=0,this.data=null}}let wA=0;class ee{constructor(t,e=!0,n=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=wA++,this.disposeRunner=new fi("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Ai.ELEMENT_ARRAY_BUFFER:Ai.ARRAY_BUFFER}get index(){return this.type===Ai.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new ee(t)}}class $o{constructor(t,e=0,n=!1,r=st.FLOAT,o,h,l,c=1){this.buffer=t,this.size=e,this.normalized=n,this.type=r,this.stride=o,this.start=h,this.instance=l,this.divisor=c}destroy(){this.buffer=null}static from(t,e,n,r,o){return new $o(t,e,n,r,o)}}const EA={Float32Array,Uint32Array,Int32Array,Uint8Array};function TA(i,t){let e=0,n=0;const r={};for(let c=0;c<i.length;c++)n+=t[c],e+=i[c].length;const o=new ArrayBuffer(e*4);let h=null,l=0;for(let c=0;c<i.length;c++){const f=t[c],d=i[c],g=gp(d);r[g]||(r[g]=new EA[g](o)),h=r[g];for(let m=0;m<d.length;m++){const _=(m/f|0)*n+l,v=m%f;h[_+v]=d[m]}l+=f}return new Float32Array(o)}const gd={5126:4,5123:2,5121:1};let AA=0;const SA={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class dn{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=AA++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new fi("disposeGeometry"),this.refCount=0}addAttribute(t,e,n=0,r=!1,o,h,l,c=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof ee||(e instanceof Array&&(e=new Float32Array(e)),e=new ee(e));const f=t.split("|");if(f.length>1){for(let g=0;g<f.length;g++)this.addAttribute(f[g],e,n,r,o);return this}let d=this.buffers.indexOf(e);return d===-1&&(this.buffers.push(e),d=this.buffers.length-1),this.attributes[t]=new $o(d,n,r,o,h,l,c),this.instanced=this.instanced||c,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof ee||(t instanceof Array&&(t=new Uint16Array(t)),t=new ee(t)),t.type=Ai.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],n=new ee;let r;for(r in this.attributes){const o=this.attributes[r],h=this.buffers[o.buffer];t.push(h.data),e.push(o.size*gd[o.type]/4),o.buffer=0}for(n.data=TA(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[n],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new dn;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new ee(this.buffers[e].data.slice(0));for(const e in this.attributes){const n=this.attributes[e];t.attributes[e]=new $o(n.buffer,n.size,n.normalized,n.type,n.stride,n.start,n.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Ai.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new dn,n=[],r=[],o=[];let h;for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)r[c]=r[c]||0,r[c]+=h.buffers[c].data.length,o[c]=0}for(let l=0;l<h.buffers.length;l++)n[l]=new SA[gp(h.buffers[l].data)](r[l]),e.buffers[l]=new ee(n[l]);for(let l=0;l<t.length;l++){h=t[l];for(let c=0;c<h.buffers.length;c++)n[c].set(h.buffers[c].data,o[c]),o[c]+=h.buffers[c].data.length}if(e.attributes=h.attributes,h.indexBuffer){e.indexBuffer=e.buffers[h.buffers.indexOf(h.indexBuffer)],e.indexBuffer.type=Ai.ELEMENT_ARRAY_BUFFER;let l=0,c=0,f=0,d=0;for(let g=0;g<h.buffers.length;g++)if(h.buffers[g]!==h.indexBuffer){d=g;break}for(const g in h.attributes){const m=h.attributes[g];(m.buffer|0)===d&&(c+=m.size*gd[m.type]/4)}for(let g=0;g<t.length;g++){const m=t[g].indexBuffer.data;for(let _=0;_<m.length;_++)e.indexBuffer.data[_+f]+=l;l+=t[g].buffers[d].data.length/c,f+=m.length}}return e}}class vp extends dn{constructor(t=!1){super(),this._buffer=new ee(null,t,!1),this._indexBuffer=new ee(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,st.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,st.FLOAT).addAttribute("aColor",this._buffer,4,!0,st.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,st.FLOAT).addIndex(this._indexBuffer)}}const zo=Math.PI*2,CA=180/Math.PI,IA=Math.PI/180;var pe=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(pe||{});class Tt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new Tt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const fo=[new Tt,new Tt,new Tt,new Tt];class wt{constructor(t=0,e=0,n=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(r),this.type=pe.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new wt(0,0,0,0)}clone(){return new wt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const F=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=F)return!1;const J=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>J}const n=this.left,r=this.right,o=this.top,h=this.bottom;if(r<=n||h<=o)return!1;const l=fo[0].set(t.left,t.top),c=fo[1].set(t.left,t.bottom),f=fo[2].set(t.right,t.top),d=fo[3].set(t.right,t.bottom);if(f.x<=l.x||c.y<=l.y)return!1;const g=Math.sign(e.a*e.d-e.b*e.c);if(g===0||(e.apply(l,l),e.apply(c,c),e.apply(f,f),e.apply(d,d),Math.max(l.x,c.x,f.x,d.x)<=n||Math.min(l.x,c.x,f.x,d.x)>=r||Math.max(l.y,c.y,f.y,d.y)<=o||Math.min(l.y,c.y,f.y,d.y)>=h))return!1;const m=g*(c.y-l.y),_=g*(l.x-c.x),v=m*n+_*o,w=m*r+_*o,y=m*n+_*h,T=m*r+_*h;if(Math.max(v,w,y,T)<=m*l.x+_*l.y||Math.min(v,w,y,T)>=m*d.x+_*d.y)return!1;const S=g*(l.y-f.y),A=g*(f.x-l.x),I=S*n+A*o,D=S*r+A*o,N=S*n+A*h,L=S*r+A*h;return!(Math.max(I,D,N,L)<=S*l.x+A*l.y||Math.min(I,D,N,L)>=S*d.x+A*d.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=r,this.height=Math.max(o-r,0),this}ceil(t=1,e=.001){const n=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=r,this.height=o-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Jl{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.radius=n,this.type=pe.CIRC}clone(){return new Jl(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const n=this.radius*this.radius;let r=this.x-t,o=this.y-e;return r*=r,o*=o,r+o<=n}getBounds(){return new wt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ql{constructor(t=0,e=0,n=0,r=0){this.x=t,this.y=e,this.width=n,this.height=r,this.type=pe.ELIP}clone(){return new Ql(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let n=(t-this.x)/this.width,r=(e-this.y)/this.height;return n*=n,r*=r,n+r<=1}getBounds(){return new wt(this.x-this.width,this.y-this.height,this.width,this.height)}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class _r{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const n=[];for(let r=0,o=e.length;r<o;r++)n.push(e[r].x,e[r].y);e=n}this.points=e,this.type=pe.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new _r(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let n=!1;const r=this.points.length/2;for(let o=0,h=r-1;o<r;h=o++){const l=this.points[o*2],c=this.points[o*2+1],f=this.points[h*2],d=this.points[h*2+1];c>e!=d>e&&t<(f-l)*((e-c)/(d-c))+l&&(n=!n)}return n}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}}class tu{constructor(t=0,e=0,n=0,r=0,o=20){this.x=t,this.y=e,this.width=n,this.height=r,this.radius=o,this.type=pe.RREC}clone(){return new tu(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;let r=t-(this.x+n),o=e-(this.y+n);const h=n*n;if(r*r+o*o<=h||(r=t-(this.x+this.width-n),r*r+o*o<=h)||(o=e-(this.y+this.height-n),r*r+o*o<=h)||(r=t-(this.x+n),r*r+o*o<=h))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}class Xt{constructor(t=1,e=0,n=0,r=1,o=0,h=0){this.array=null,this.a=t,this.b=e,this.c=n,this.d=r,this.tx=o,this.ty=h}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,n,r,o,h){return this.a=t,this.b=e,this.c=n,this.d=r,this.tx=o,this.ty=h,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n}apply(t,e){e=e||new Tt;const n=t.x,r=t.y;return e.x=this.a*n+this.c*r+this.tx,e.y=this.b*n+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Tt;const n=1/(this.a*this.d+this.c*-this.b),r=t.x,o=t.y;return e.x=this.d*n*r+-this.c*n*o+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*o+-this.b*n*r+(-this.ty*this.a+this.tx*this.b)*n,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),r=this.a,o=this.c,h=this.tx;return this.a=r*e-this.b*n,this.b=r*n+this.b*e,this.c=o*e-this.d*n,this.d=o*n+this.d*e,this.tx=h*e-this.ty*n,this.ty=h*n+this.ty*e,this}append(t){const e=this.a,n=this.b,r=this.c,o=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*n+t.b*o,this.c=t.c*e+t.d*r,this.d=t.c*n+t.d*o,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*n+t.ty*o+this.ty,this}setTransform(t,e,n,r,o,h,l,c,f){return this.a=Math.cos(l+f)*o,this.b=Math.sin(l+f)*o,this.c=-Math.sin(l-c)*h,this.d=Math.cos(l-c)*h,this.tx=t-(n*this.a+r*this.c),this.ty=e-(n*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const n=this.a,r=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,n=this.b,r=this.c,o=this.d,h=t.pivot,l=-Math.atan2(-r,o),c=Math.atan2(n,e),f=Math.abs(l+c);return f<1e-5||Math.abs(zo-f)<1e-5?(t.rotation=c,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=l,t.skew.y=c),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(r*r+o*o),t.position.x=this.tx+(h.x*e+h.y*r),t.position.y=this.ty+(h.x*n+h.y*o),t}invert(){const t=this.a,e=this.b,n=this.c,r=this.d,o=this.tx,h=t*r-e*n;return this.a=r/h,this.b=-e/h,this.c=-n/h,this.d=t/h,this.tx=(n*this.ty-r*o)/h,this.ty=-(t*this.ty-e*o)/h,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Xt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Xt}static get TEMP_MATRIX(){return new Xt}}const Rn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Pn=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Mn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Dn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Rl=[],xp=[],po=Math.sign;function RA(){for(let i=0;i<16;i++){const t=[];Rl.push(t);for(let e=0;e<16;e++){const n=po(Rn[i]*Rn[e]+Mn[i]*Pn[e]),r=po(Pn[i]*Rn[e]+Dn[i]*Pn[e]),o=po(Rn[i]*Mn[e]+Mn[i]*Dn[e]),h=po(Pn[i]*Mn[e]+Dn[i]*Dn[e]);for(let l=0;l<16;l++)if(Rn[l]===n&&Pn[l]===r&&Mn[l]===o&&Dn[l]===h){t.push(l);break}}}for(let i=0;i<16;i++){const t=new Xt;t.set(Rn[i],Pn[i],Mn[i],Dn[i],0,0),xp.push(t)}}RA();const zt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Rn[i],uY:i=>Pn[i],vX:i=>Mn[i],vY:i=>Dn[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Rl[i][t],sub:(i,t)=>Rl[i][zt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?zt.S:zt.N:Math.abs(t)*2<=Math.abs(i)?i>0?zt.E:zt.W:t>0?i>0?zt.SE:zt.SW:i>0?zt.NE:zt.NW,matrixAppendRotationInv:(i,t,e=0,n=0)=>{const r=xp[zt.inv(t)];r.tx=e,r.ty=n,i.append(r)}};class ln{constructor(t,e,n=0,r=0){this._x=n,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new ln(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const yp=class{constructor(){this.worldTransform=new Xt,this.localTransform=new Xt,this.position=new ln(this.onChange,this,0,0),this.scale=new ln(this.onChange,this,1,1),this.pivot=new ln(this.onChange,this,0,0),this.skew=new ln(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,n=this.worldTransform;n.a=t.a*e.a+t.b*e.c,n.b=t.a*e.b+t.b*e.d,n.c=t.c*e.a+t.d*e.c,n.d=t.c*e.b+t.d*e.d,n.tx=t.tx*e.a+t.ty*e.c+e.tx,n.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let eu=yp;eu.IDENTITY=new yp;var PA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,MA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function md(i,t,e){const n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),n}function Vh(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function bp(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Vh(2*t);case"bvec3":return Vh(3*t);case"bvec4":return Vh(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const vr=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],DA={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},BA={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function FA(i,t){var n;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in i.uniforms){const o=t[r];if(!o){(n=i.uniforms[r])!=null&&n.group&&(i.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const h=i.uniforms[r];let l=!1;for(let c=0;c<vr.length;c++)if(vr[c].test(o,h)){e.push(vr[c].code(r,h)),l=!0;break}if(!l){const f=(o.size===1&&!o.isArray?DA:BA)[o.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${f};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const wp={};let sr=wp;function LA(){if(sr===wp||sr!=null&&sr.isContextLost()){const i=K.ADAPTER.createCanvas();let t;K.PREFER_ENV>=Wn.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),sr=t}return sr}let go;function OA(){if(!go){go=Ke.MEDIUM;const i=LA();i&&i.getShaderPrecisionFormat&&(go=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?Ke.HIGH:Ke.MEDIUM)}return go}function _d(i,t){const e=i.getShaderSource(t).split(`
`).map((f,d)=>`${d}: ${f}`),n=i.getShaderInfoLog(t),r=n.split(`
`),o={},h=r.map(f=>parseFloat(f.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(f=>f&&!o[f]?(o[f]=!0,!0):!1),l=[""];h.forEach(f=>{e[f-1]=`%c${e[f-1]}%c`,l.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=e.join(`
`);l[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...l),console.groupEnd()}function NA(i,t,e,n){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||_d(i,e),i.getShaderParameter(n,i.COMPILE_STATUS)||_d(i,n),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const kA={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Ep(i){return kA[i]}let mo=null;const vd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Tp(i,t){if(!mo){const e=Object.keys(vd);mo={};for(let n=0;n<e.length;++n){const r=e[n];mo[i[r]]=vd[r]}}return mo[t]}function xd(i,t,e){if(i.substring(0,9)!=="precision"){let n=t;return t===Ke.HIGH&&e!==Ke.HIGH&&(n=Ke.MEDIUM),`precision ${n} float;
${i}`}else if(e!==Ke.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Jr;function UA(){if(typeof Jr=="boolean")return Jr;try{Jr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Jr=!1}return Jr}let GA=0;const _o={},lr=class{constructor(i,t,e="pixi-shader",n={}){this.extra={},this.id=GA++,this.vertexSrc=i||lr.defaultVertexSrc,this.fragmentSrc=t||lr.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=n,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),_o[e]?(_o[e]++,e+=`-${_o[e]}`):_o[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=xd(this.vertexSrc,lr.defaultVertexPrecision,Ke.HIGH),this.fragmentSrc=xd(this.fragmentSrc,lr.defaultFragmentPrecision,OA())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return MA}static get defaultFragmentSrc(){return PA}static from(i,t,e){const n=i+t;let r=ud[n];return r||(ud[n]=r=new lr(i,t,e)),r}};let ui=lr;ui.defaultVertexPrecision=Ke.HIGH;ui.defaultFragmentPrecision=$i.apple.device?Ke.HIGH:Ke.MEDIUM;let WA=0;class di{constructor(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=WA++,this.static=!!e,this.ubo=!!n,t instanceof ee?(this.buffer=t,this.buffer.type=Ai.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ee(new Float32Array(1)),this.buffer.type=Ai.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,n){if(!this.ubo)this.uniforms[t]=new di(e,n);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,n){return new di(t,e,n)}static uboFrom(t,e){return new di(t,e??!0,!0)}}class Si{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof di?this.uniformGroup=e:this.uniformGroup=new di(e):this.uniformGroup=new di({}),this.disposeRunner=new fi("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const n in e.uniforms){const r=e.uniforms[n];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,n){const r=ui.from(t,e);return new Si(r,n)}}class HA{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const n=new Int32Array(t);for(let o=0;o<t;o++)n[o]=o;this.defaultGroupCache[t]=di.from({uSamplers:n},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new ui(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Xt,default:this.defaultGroupCache[t]};return new Si(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let n=0;n<t;n++)n>0&&(e+=`
else `),n<t-1&&(e+=`if(vTextureId < ${n}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${n}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Pl{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function XA(){return!$i.apple.device}function $A(i){let t=!0;const e=K.ADAPTER.getNavigator();if($i.tablet||$i.phone){if($i.apple.device){const n=e.userAgent.match(/OS (\d+)_(\d+)?/);n&&parseInt(n[1],10)<11&&(t=!1)}if($i.android.device){const n=e.userAgent.match(/Android\s([0-9.]*)/);n&&parseInt(n[1],10)<7&&(t=!1)}}return t?i:4}class aa{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var zA=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,VA=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const si=class extends aa{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=vp,this.vertexSize=6,this.state=qi.for2d(),this.size=si.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??$A(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??XA(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return St("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return VA}static get defaultFragmentTemplate(){return zA}setShaderGenerator({vertex:i=si.defaultVertexSrc,fragment:t=si.defaultFragmentTemplate}={}){this.shaderGenerator=new HA(i,t)}contextChange(){const i=this.renderer.gl;K.PREFER_ENV===Wn.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),si.defaultMaxTextures),this.maxTextures=yA(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=si,e=this.size/4,n=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new Il);for(;t.length<n;)t.push(new Pl);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=si._textureArrayPool,n=this.renderer.batch,r=this._tempBoundTextures,o=this.renderer.textureGC.count;let h=++ft._globalBatch,l=0,c=e[0],f=0;n.copyBoundTextures(r,t);for(let d=0;d<this._bufferSize;++d){const g=i[d];i[d]=null,g._batchEnabled!==h&&(c.count>=t&&(n.boundArray(c,r,h,t),this.buildDrawCalls(c,f,d),f=d,c=e[++l],++h),g._batchEnabled=h,g.touched=o,c.elements[c.count++]=g)}c.count>0&&(n.boundArray(c,r,h,t),this.buildDrawCalls(c,f,this._bufferSize),++l,++h);for(let d=0;d<r.length;d++)r[d]=null;ft._globalBatch=h}buildDrawCalls(i,t,e){const{_bufferedElements:n,_attributeBuffer:r,_indexBuffer:o,vertexSize:h}=this,l=si._drawCallPool;let c=this._dcIndex,f=this._aIndex,d=this._iIndex,g=l[c];g.start=this._iIndex,g.texArray=i;for(let m=t;m<e;++m){const _=n[m],v=_._texture.baseTexture,w=fp[v.alphaMode?1:0][_.blendMode];n[m]=null,t<m&&g.blend!==w&&(g.size=d-g.start,t=m,g=l[++c],g.texArray=i,g.start=d),this.packInterleavedGeometry(_,r,o,f,d),f+=_.vertexData.length/2*h,d+=_.indices.length,g.blend=w}t<e&&(g.size=d-g.start,++c),this._dcIndex=c,this._aIndex=f,this._iIndex=d}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;si.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,n=si._drawCallPool;let r=null;for(let o=0;o<i;o++){const{texArray:h,type:l,size:c,start:f,blend:d}=n[o];r!==h&&(r=h,this.bindAndClearTexArray(h)),this.state.blendMode=d,e.set(this.state),t.drawElements(l,c,t.UNSIGNED_SHORT,f*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),si.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=Xo(Math.ceil(i/8)),e=ld(t),n=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[n];return r||(this._aBuffers[n]=r=new Sl(n*this.vertexSize*4)),r}getIndexBuffer(i){const t=Xo(Math.ceil(i/12)),e=ld(t),n=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(n)),r}packInterleavedGeometry(i,t,e,n,r){const{uint32View:o,float32View:h}=t,l=n/this.vertexSize,c=i.uvs,f=i.indices,d=i.vertexData,g=i._texture.baseTexture._batchLocation,m=Math.min(i.worldAlpha,1),_=m<1&&i._texture.baseTexture.alphaMode?Zl(i._tintRGB,m):i._tintRGB+(m*255<<24);for(let v=0;v<d.length;v+=2)h[n++]=d[v],h[n++]=d[v+1],h[n++]=c[v],h[n++]=c[v+1],o[n++]=_,h[n++]=g;for(let v=0;v<f.length;v++)e[r++]=l+f[v]}};let hi=si;hi.defaultBatchSize=4096;hi.extension={name:"batch",type:q.RendererPlugin};hi._drawCallPool=[];hi._textureArrayPool=[];rt.add(hi);var YA=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,jA=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const is=class extends Si{constructor(i,t,e){const n=ui.from(i||is.defaultVertexSrc,t||is.defaultFragmentSrc);super(n,e),this.padding=0,this.resolution=is.defaultResolution,this.multisample=is.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new qi}apply(i,t,e,n,r){i.applyFilter(this,t,e,n)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return jA}static get defaultFragmentSrc(){return YA}};let Ae=is;Ae.defaultResolution=1;Ae.defaultMultisample=re.NONE;class Ap{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?Kl(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=cp(t),us(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Ap.extension={type:[q.RendererSystem,q.CanvasRendererSystem],name:"background"};rt.add(Ap);class Sp{constructor(t){this.renderer=t,this.emptyRenderer=new aa(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:n}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=n[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,n,r){const{elements:o,ids:h,count:l}=t;let c=0;for(let f=0;f<l;f++){const d=o[f],g=d._batchLocation;if(g>=0&&g<r&&e[g]===d){h[f]=g;continue}for(;c<r;){const m=e[c];if(m&&m._batchEnabled===n&&m._batchLocation===c){c++;continue}h[f]=c,d._batchLocation=c,e[c]=d;break}}}destroy(){this.renderer=null}}Sp.extension={type:q.RendererSystem,name:"batch"};rt.add(Sp);let yd=0;class Cp{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=yd++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,n=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:n,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=yd++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let n;if(K.PREFER_ENV>=Wn.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!n)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Cp.extension={type:q.RendererSystem,name:"context"};rt.add(Cp);class qA extends gs{upload(t,e,n){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===gi.UNPACK);const o=e.realWidth,h=e.realHeight;return n.width===o&&n.height===h?r.texSubImage2D(e.target,0,0,0,o,h,e.format,n.type,this.data):(n.width=o,n.height=h,r.texImage2D(e.target,0,n.internalFormat,o,h,0,e.format,n.type,this.data)),!0}}class Ml{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new fi("disposeFramebuffer"),this.multisample=re.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new ft(null,{scaleMode:Xi.NEAREST,resolution:1,mipmap:Ci.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ft(new qA(null,{width:this.width,height:this.height}),{scaleMode:Xi.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Ci.OFF,format:$.DEPTH_COMPONENT,type:st.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let n=0;n<this.colorTextures.length;n++){const r=this.colorTextures[n],o=r.resolution;r.setSize(t/o,e/o)}if(this.depthTexture){const n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class Ip extends ft{constructor(t={}){if(typeof t=="number"){const e=arguments[0],n=arguments[1],r=arguments[2],o=arguments[3];t={width:e,height:n,scaleMode:r,resolution:o}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=re.NONE),super(null,t),this.mipmap=Ci.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Ml(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class pn extends cs{constructor(t){const e=t,n=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(n,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,n){n===void 0&&!e.startsWith("data:")?t.crossOrigin=_A(e):n!==!1&&(t.crossOrigin=typeof n=="string"?n:"anonymous")}upload(t,e,n,r){const o=t.gl,h=e.realWidth,l=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===gi.UNPACK),!this.noSubImage&&e.target===o.TEXTURE_2D&&n.width===h&&n.height===l?o.texSubImage2D(o.TEXTURE_2D,0,0,0,e.format,n.type,r):(n.width=h,n.height=l,o.texImage2D(e.target,0,n.internalFormat,e.format,n.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,n=t.naturalHeight||t.videoHeight||t.height;this.resize(e,n),super.update()}dispose(){this.source=null}}class Rp extends pn{constructor(t,e){if(e=e||{},typeof t=="string"){const n=new Image;pn.crossOrigin(n,t,e.crossorigin),n.src=t,t=n}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??K.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,n)=>{const r=this.source;this.url=r.src;const o=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?o():(r.onload=o,r.onerror=h=>{n(h),this.onError.emit(h)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,n=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:n?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===gi.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,n){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,n);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,n,this.bitmap),!this.preserveBitmap){let r=!0;const o=e._glTextures;for(const h in o){const l=o[h];if(l!==n&&l.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class Pp{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,n){const r=e.width,o=e.height;if(n){const h=t.width/2/r,l=t.height/2/o,c=t.x/r+h,f=t.y/o+l;n=zt.add(n,zt.NW),this.x0=c+h*zt.uX(n),this.y0=f+l*zt.uY(n),n=zt.add(n,2),this.x1=c+h*zt.uX(n),this.y1=f+l*zt.uY(n),n=zt.add(n,2),this.x2=c+h*zt.uX(n),this.y2=f+l*zt.uY(n),n=zt.add(n,2),this.x3=c+h*zt.uX(n),this.y3=f+l*zt.uY(n)}else this.x0=t.x/r,this.y0=t.y/o,this.x1=(t.x+t.width)/r,this.y1=t.y/o,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/o,this.x3=t.x/r,this.y3=(t.y+t.height)/o;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const bd=new Pp;function vo(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class nt extends ps{constructor(t,e,n,r,o,h){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new wt(0,0,1,1)),t instanceof nt&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=bd,this.uvMatrix=null,this.orig=n||e,this._rotate=Number(o||0),o===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=h?new Tt(h.x,h.y):new Tt(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&bi[e.url]&&nt.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,nt.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),n=new nt(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(n._frame=t),n}updateUvs(){this._uvs===bd&&(this._uvs=new Pp),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},n=K.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let o=null;if(r)o=t;else if(t instanceof ft){if(!t.cacheId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${l}-${Un()}`,ft.addToCache(t,t.cacheId)}o=t.cacheId}else{if(!t._pixiId){const l=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${l}_${Un()}`}o=t._pixiId}let h=bi[o];if(r&&n&&!h)throw new Error(`The cacheId "${o}" does not exist in TextureCache.`);return!h&&!(t instanceof ft)?(e.resolution||(e.resolution=fn(t)),h=new nt(new ft(t,e)),h.baseTexture.cacheId=o,ft.addToCache(h.baseTexture,o),nt.addToCache(h,o)):!h&&t instanceof ft&&(h=new nt(t),nt.addToCache(h,o)),h}static fromURL(t,e){const n=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=nt.from(t,Object.assign({resourceOptions:n},e),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,n,r){return new nt(ft.fromBuffer(t,e,n,r))}static fromLoader(t,e,n,r){const o=new ft(t,Object.assign({scaleMode:K.SCALE_MODE,resolution:fn(e)},r)),{resource:h}=o;h instanceof Rp&&(h.url=e);const l=new nt(o);return n||(n=e),ft.addToCache(l.baseTexture,n),nt.addToCache(l,n),n!==e&&(ft.addToCache(l.baseTexture,e),nt.addToCache(l,e)),l.baseTexture.valid?Promise.resolve(l):new Promise(c=>{l.baseTexture.once("loaded",()=>c(l))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),bi[e]&&bi[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),bi[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=bi[t];if(e){const n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete bi[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)bi[t.textureCacheIds[e]]===t&&delete bi[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:n,width:r,height:o}=t,h=e+r>this.baseTexture.width,l=n+o>this.baseTexture.height;if(h||l){const c=h&&l?"and":"or",f=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,d=`Y: ${n} + ${o} = ${n+o} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${f} ${c} ${d}`)}this.valid=r&&o&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return nt._EMPTY||(nt._EMPTY=new nt(new ft),vo(nt._EMPTY),vo(nt._EMPTY.baseTexture)),nt._EMPTY}static get WHITE(){if(!nt._WHITE){const t=K.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),nt._WHITE=new nt(ft.from(t)),vo(nt._WHITE),vo(nt._WHITE.baseTexture)}return nt._WHITE}}class gn extends nt{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,n=!0){const r=this.baseTexture.resolution,o=Math.round(t*r)/r,h=Math.round(e*r)/r;this.valid=o>0&&h>0,this._frame.width=this.orig.width=o,this._frame.height=this.orig.height=h,n&&this.baseTexture.resize(o,h),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new gn(new Ip(t))}}class Mp{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,n=re.NONE){const r=new Ip(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new gn(r)}getOptimalTexture(t,e,n=1,r=re.NONE){let o;t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Xo(t),e=Xo(e),o=((t&65535)<<16|e&65535)>>>0,r>1&&(o+=r*4294967296)):o=r>1?-r:-1,this.texturePool[o]||(this.texturePool[o]=[]);let h=this.texturePool[o].pop();return h||(h=this.createTexture(t,e,r)),h.filterPoolKey=o,h.setResolution(n),h}getFilterTexture(t,e,n){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||re.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const n=this.texturePool[e];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const n=this.texturePool[e];if(n)for(let r=0;r<n.length;r++)n[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Mp.SCREEN_KEY=-1;class KA extends dn{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Dp extends dn{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ee(this.vertices),this.uvBuffer=new ee(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let n=0,r=0;return this.uvs[0]=n,this.uvs[1]=r,this.uvs[2]=n+e.width/t.width,this.uvs[3]=r,this.uvs[4]=n+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=n,this.uvs[7]=r+e.height/t.height,n=e.x,r=e.y,this.vertices[0]=n,this.vertices[1]=r,this.vertices[2]=n+e.width,this.vertices[3]=r,this.vertices[4]=n+e.width,this.vertices[5]=r+e.height,this.vertices[6]=n,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class ZA{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=re.NONE,this.sourceFrame=new wt,this.destinationFrame=new wt,this.bindingSourceFrame=new wt,this.bindingDestinationFrame=new wt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const xo=[new Tt,new Tt,new Tt,new Tt],Yh=new Xt;class Bp{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Mp,this.statePool=[],this.quad=new KA,this.quadUv=new Dp,this.tempRect=new wt,this.activeState={},this.globalUniforms=new di({outputFrame:new wt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const n=this.renderer,r=this.defaultFilterStack,o=this.statePool.pop()||new ZA,h=this.renderer.renderTexture;let l=e[0].resolution,c=e[0].multisample,f=e[0].padding,d=e[0].autoFit,g=e[0].legacy??!0;for(let v=1;v<e.length;v++){const w=e[v];l=Math.min(l,w.resolution),c=Math.min(c,w.multisample),f=this.useMaxPadding?Math.max(f,w.padding):f+w.padding,d=d&&w.autoFit,g=g||(w.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),r.push(o),o.resolution=l,o.multisample=c,o.legacy=g,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(f);const m=this.tempRect.copyFrom(h.sourceFrame);n.projection.transform&&this.transformAABB(Yh.copyFrom(n.projection.transform).invert(),m),d?(o.sourceFrame.fit(m),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(m)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,h.current?h.current.resolution:n.resolution,h.sourceFrame,h.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,l,c),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;const _=this.tempRect;_.x=0,_.y=0,_.width=o.sourceFrame.width,_.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(h.sourceFrame),o.bindingDestinationFrame.copyFrom(h.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,h.bind(o.renderTexture,o.sourceFrame,_),n.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const o=r.inputSize,h=r.inputPixel,l=r.inputClamp;if(o[0]=e.destinationFrame.width,o[1]=e.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],h[0]=Math.round(o[0]*e.resolution),h[1]=Math.round(o[1]*e.resolution),h[2]=1/h[0],h[3]=1/h[1],l[0]=.5*h[2],l[1]=.5*h[3],l[2]=e.sourceFrame.width*o[2]-.5*h[2],l[3]=e.sourceFrame.height*o[3]-.5*h[3],e.legacy){const f=r.filterArea;f[0]=e.destinationFrame.width,f[1]=e.destinationFrame.height,f[2]=e.sourceFrame.x,f[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const c=t[t.length-1];if(this.renderer.framebuffer.blit(),n.length===1)n[0].apply(this,e.renderTexture,c.renderTexture,wi.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let f=e.renderTexture,d=this.getOptimalFilterTexture(f.width,f.height,e.resolution);d.filterFrame=f.filterFrame;let g=0;for(g=0;g<n.length-1;++g){g===1&&e.multisample>1&&(d=this.getOptimalFilterTexture(f.width,f.height,e.resolution),d.filterFrame=f.filterFrame),n[g].apply(this,f,d,wi.CLEAR,e);const m=f;f=d,d=m}n[g].apply(this,f,c.renderTexture,wi.BLEND,e),g>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(f),this.returnFilterTexture(d)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=wi.CLEAR){const{renderTexture:n,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const h=this.tempRect;h.x=0,h.y=0,h.width=t.filterFrame.width,h.height=t.filterFrame.height,n.bind(t,t.filterFrame,h)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?n.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const o=r.stateId&1||this.forceClear;(e===wi.CLEAR||e===wi.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,n,r){const o=this.renderer;o.state.set(t.state),this.bindAndClear(n,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,o.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(Ti.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(Ti.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:n,destinationFrame:r}=this.activeState,{orig:o}=e._texture,h=t.set(r.width,0,0,r.height,n.x,n.y),l=e.worldTransform.copyTo(Xt.TEMP_MATRIX);return l.invert(),h.prepend(l),h.scale(1/o.width,1/o.height),h.translate(e.anchor.x,e.anchor.y),h}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,n=1,r=re.NONE){return this.texturePool.getOptimalTexture(t,e,n,r)}getFilterTexture(t,e,n){if(typeof t=="number"){const o=t;t=e,e=o}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||re.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const n=xo[0],r=xo[1],o=xo[2],h=xo[3];n.set(e.left,e.top),r.set(e.left,e.bottom),o.set(e.right,e.top),h.set(e.right,e.bottom),t.apply(n,n),t.apply(r,r),t.apply(o,o),t.apply(h,h);const l=Math.min(n.x,r.x,o.x,h.x),c=Math.min(n.y,r.y,o.y,h.y),f=Math.max(n.x,r.x,o.x,h.x),d=Math.max(n.y,r.y,o.y,h.y);e.x=l,e.y=c,e.width=f-l,e.height=d-c}roundFrame(t,e,n,r,o){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(o){const{a:h,b:l,c,d:f}=o;if((Math.abs(l)>1e-4||Math.abs(c)>1e-4)&&(Math.abs(h)>1e-4||Math.abs(f)>1e-4))return}o=o?Yh.copyFrom(o):Yh.identity(),o.translate(-n.x,-n.y).scale(r.width/n.width,r.height/n.height).translate(r.x,r.y),this.transformAABB(o,t),t.ceil(e),this.transformAABB(o.invert(),t)}}}Bp.extension={type:q.RendererSystem,name:"filter"};rt.add(Bp);class JA{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=re.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const QA=new wt;class Fp{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ml(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new wt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;K.PREFER_ENV===Wn.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,n=0){const{gl:r}=this;if(t){const o=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,o.framebuffer)),o.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,o.mipLevel=n),o.dirtyId!==t.dirtyId&&(o.dirtyId=t.dirtyId,o.dirtyFormat!==t.dirtyFormat?(o.dirtyFormat=t.dirtyFormat,o.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):o.dirtySize!==t.dirtySize&&(o.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let h=0;h<t.colorTextures.length;h++){const l=t.colorTextures[h];this.renderer.texture.unbind(l.parentTextureArray||l)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const h=e.width>>n,l=e.height>>n,c=h/e.width;this.setViewport(e.x*c,e.y*c,h,l)}else{const h=t.width>>n,l=t.height>>n;this.setViewport(0,0,h,l)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,n,r){const o=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),r=Math.round(r),(o.width!==n||o.height!==r||o.x!==t||o.y!==e)&&(o.x=t,o.y=e,o.width=n,o.height=r,this.gl.viewport(t,e,n,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,n,r,o=gl.COLOR|gl.DEPTH){const{gl:h}=this;h.clearColor(t,e,n,r),h.clear(o)}initFramebuffer(t){const{gl:e}=this,n=new JA(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n}resizeFramebuffer(t){const{gl:e}=this,n=t.glFramebuffers[this.CONTEXT_UID];n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let o=r.length;e.drawBuffers||(o=Math.min(o,1));for(let h=0;h<o;h++){const l=r[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:n}=this,r=t.glFramebuffers[this.CONTEXT_UID],o=t.colorTextures;let h=o.length;n.drawBuffers||(h=Math.min(h,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||n.createRenderbuffer():r.msaaBuffer&&(n.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const l=[];for(let c=0;c<h;c++){const f=o[c],d=f.parentTextureArray||f;this.renderer.texture.bind(d,0),c===0&&r.msaaBuffer?(n.bindRenderbuffer(n.RENDERBUFFER,r.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,d._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,r.msaaBuffer)):(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+c,f.target,d._glTextures[this.CONTEXT_UID].texture,e),l.push(n.COLOR_ATTACHMENT0+c))}if(l.length>1&&n.drawBuffers(l),t.depthTexture&&this.writeDepthTexture){const f=t.depthTexture;this.renderer.texture.bind(f,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,f._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,r.stencil),r.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,r.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,r.stencil)):r.stencil&&(n.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let n=re.NONE;if(t<=1||e===null)return n;for(let r=0;r<e.length;r++)if(e[r]<=t){n=e[r];break}return n===1&&(n=re.NONE),n}blit(t,e,n){const{current:r,renderer:o,gl:h,CONTEXT_UID:l}=this;if(o.context.webGLVersion!==2||!r)return;const c=r.glFramebuffers[l];if(!c)return;if(!t){if(!c.msaaBuffer)return;const d=r.colorTextures[0];if(!d)return;c.blitFramebuffer||(c.blitFramebuffer=new Ml(r.width,r.height),c.blitFramebuffer.addColorTexture(0,d)),t=c.blitFramebuffer,t.colorTextures[0]!==d&&(t.colorTextures[0]=d,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=QA,e.width=r.width,e.height=r.height),n||(n=e);const f=e.width===n.width&&e.height===n.height;this.bind(t),h.bindFramebuffer(h.READ_FRAMEBUFFER,c.framebuffer),h.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,h.COLOR_BUFFER_BIT,f?h.NEAREST:h.LINEAR)}disposeFramebuffer(t,e){const n=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!n)return;delete t.glFramebuffers[this.CONTEXT_UID];const o=this.managedFramebuffers.indexOf(t);o>=0&&this.managedFramebuffers.splice(o,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&r.deleteRenderbuffer(n.msaaBuffer),n.stencil&&r.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const n=t.width,r=t.height,o=this.gl,h=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,h),e.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,e.multisample,o.DEPTH24_STENCIL8,n,r):o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,n,r),e.stencil=h,o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,h)}reset(){this.current=this.unknownFramebuffer,this.viewport=new wt}destroy(){this.renderer=null}}Fp.extension={type:q.RendererSystem,name:"framebuffer"};rt.add(Fp);const jh={5126:4,5123:2,5121:1};class Lp{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let n=this.renderer.context.extensions.vertexArrayObject;K.PREFER_ENV===Wn.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=()=>n.createVertexArrayOES(),t.bindVertexArray=r=>n.bindVertexArrayOES(r),t.deleteVertexArray=r=>n.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const n=t.getExtension("ANGLE_instanced_arrays");n?(t.vertexAttribDivisor=(r,o)=>n.vertexAttribDivisorANGLE(r,o),t.drawElementsInstanced=(r,o,h,l,c)=>n.drawElementsInstancedANGLE(r,o,h,l,c),t.drawArraysInstanced=(r,o,h,l)=>n.drawArraysInstancedANGLE(r,o,h,l)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:n}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],o=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},o=!0);const h=r[e.program.id]||this.initGeometryVao(t,e,o);this._activeGeometry=t,this._activeVao!==h&&(this._activeVao=h,this.hasVao?n.bindVertexArray(h):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let n=0;n<t.buffers.length;n++){const r=t.buffers[n];e.update(r)}}checkCompatibility(t,e){const n=t.attributes,r=e.attributeData;for(const o in r)if(!n[o])throw new Error(`shader and geometry incompatible, geometry missing the "${o}" attribute`)}getSignature(t,e){const n=t.attributes,r=e.attributeData,o=["g",t.id];for(const h in n)r[h]&&o.push(h,r[h].location);return o.join("-")}initGeometryVao(t,e,n=!0){const r=this.gl,o=this.CONTEXT_UID,h=this.renderer.buffer,l=e.program;l.glPrograms[o]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,l);const c=this.getSignature(t,l),f=t.glVertexArrayObjects[this.CONTEXT_UID];let d=f[c];if(d)return f[l.id]=d,d;const g=t.buffers,m=t.attributes,_={},v={};for(const w in g)_[w]=0,v[w]=0;for(const w in m)!m[w].size&&l.attributeData[w]?m[w].size=l.attributeData[w].size:m[w].size||console.warn(`PIXI Geometry attribute '${w}' size cannot be determined (likely the bound shader does not have the attribute)`),_[m[w].buffer]+=m[w].size*jh[m[w].type];for(const w in m){const y=m[w],T=y.size;y.stride===void 0&&(_[y.buffer]===T*jh[y.type]?y.stride=0:y.stride=_[y.buffer]),y.start===void 0&&(y.start=v[y.buffer],v[y.buffer]+=T*jh[y.type])}d=r.createVertexArray(),r.bindVertexArray(d);for(let w=0;w<g.length;w++){const y=g[w];h.bind(y),n&&y._glBuffers[o].refCount++}return this.activateVao(t,l),f[l.id]=d,f[c]=d,r.bindVertexArray(null),h.unbind(Ai.ARRAY_BUFFER),d}disposeGeometry(t,e){var l;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const n=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,o=t.buffers,h=(l=this.renderer)==null?void 0:l.buffer;if(t.disposeRunner.remove(this),!!n){if(h)for(let c=0;c<o.length;c++){const f=o[c]._glBuffers[this.CONTEXT_UID];f&&(f.refCount--,f.refCount===0&&!e&&h.dispose(o[c],e))}if(!e){for(const c in n)if(c[0]==="g"){const f=n[c];this._activeVao===f&&this.unbind(),r.deleteVertexArray(f)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)}activateVao(t,e){const n=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,h=t.buffers,l=t.attributes;t.indexBuffer&&o.bind(t.indexBuffer);let c=null;for(const f in l){const d=l[f],g=h[d.buffer],m=g._glBuffers[r];if(e.attributeData[f]){c!==m&&(o.bind(g),c=m);const _=e.attributeData[f].location;if(n.enableVertexAttribArray(_),n.vertexAttribPointer(_,d.size,d.type||n.FLOAT,d.normalized,d.stride,d.start),d.instance)if(this.hasInstance)n.vertexAttribDivisor(_,d.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,n,r){const{gl:o}=this,h=this._activeGeometry;if(h.indexBuffer){const l=h.indexBuffer.data.BYTES_PER_ELEMENT,c=l===2?o.UNSIGNED_SHORT:o.UNSIGNED_INT;l===2||l===4&&this.canUseUInt32ElementIndex?h.instanced?o.drawElementsInstanced(t,e||h.indexBuffer.data.length,c,(n||0)*l,r||1):o.drawElements(t,e||h.indexBuffer.data.length,c,(n||0)*l):console.warn("unsupported index buffer type: uint32")}else h.instanced?o.drawArraysInstanced(t,n,e||h.getSize(),r||1):o.drawArrays(t,n,e||h.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Lp.extension={type:q.RendererSystem,name:"geometry"};rt.add(Lp);const wd=new Xt;class Op{constructor(t,e){this._texture=t,this.mapCoord=new Xt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const n=this.mapCoord;for(let r=0;r<t.length;r+=2){const o=t[r],h=t[r+1];e[r]=o*n.a+h*n.c+n.tx,e[r+1]=o*n.b+h*n.d+n.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);const r=e.orig,o=e.trim;o&&(wd.set(r.width/o.width,0,0,r.height/o.height,-o.x/o.width,-o.y/o.height),this.mapCoord.append(wd));const h=e.baseTexture,l=this.uClampFrame,c=this.clampMargin/h.resolution,f=this.clampOffset;return l[0]=(e._frame.x+c+f)/h.width,l[1]=(e._frame.y+c+f)/h.height,l[2]=(e._frame.x+e._frame.width-c+f)/h.width,l[3]=(e._frame.y+e._frame.height-c+f)/h.height,this.uClampOffset[0]=f/h.realWidth,this.uClampOffset[1]=f/h.realHeight,this.isSimple=e._frame.width===h.width&&e._frame.height===h.height&&e.rotate===0,!0}}var tS=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,eS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class iS extends Ae{constructor(t,e,n){let r=null;typeof t!="string"&&e===void 0&&n===void 0&&(r=t,t=void 0,e=void 0,n=void 0),super(t||eS,e||tS,n),this.maskSprite=r,this.maskMatrix=new Xt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,n,r){const o=this._maskSprite,h=o._texture;h.valid&&(h.uvMatrix||(h.uvMatrix=new Op(h,0)),h.uvMatrix.update(),this.uniforms.npmAlpha=h.baseTexture.alphaMode?0:1,this.uniforms.mask=h,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,o).prepend(h.uvMatrix.mapCoord),this.uniforms.alpha=o.worldAlpha,this.uniforms.maskClamp=h.uvMatrix.uClampFrame,t.applyFilter(this,e,n,r))}}class nS{constructor(t=null){this.type=he.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=K.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=he.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Np{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let n=e;if(!n.isMaskData){const o=this.maskDataPool.pop()||new nS;o.pooled=!0,o.maskObject=e,n=o}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==he.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case he.SCISSOR:this.renderer.scissor.push(n);break;case he.STENCIL:this.renderer.stencil.push(n);break;case he.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case he.COLOR:this.pushColorMask(n);break}n.type===he.SPRITE&&this.maskStack.push(n)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case he.SCISSOR:this.renderer.scissor.pop(e);break;case he.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case he.SPRITE:this.popSpriteMask(e);break;case he.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const n=this.maskStack[this.maskStack.length-1];n.type===he.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=he.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=he.SCISSOR:t.type=he.STENCIL:t.type=he.COLOR}pushSpriteMask(t){const{maskObject:e}=t,n=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new iS]));const o=this.renderer,h=o.renderTexture;let l,c;if(h.current){const d=h.current;l=t.resolution||d.resolution,c=t.multisample??d.multisample}else l=t.resolution||o.resolution,c=t.multisample??o.multisample;r[0].resolution=l,r[0].multisample=c,r[0].maskSprite=e;const f=n.filterArea;n.filterArea=e.getBounds(!0),o.filter.push(n,r),n.filterArea=f,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}popColorMask(t){const e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)}destroy(){this.renderer=null}}Np.extension={type:q.RendererSystem,name:"mask"};rt.add(Np);class kp{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,n=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==n&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Ed=new Xt,Td=[],Fo=class extends kp{constructor(i){super(i),this.glConst=K.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:n}=this,r=n.renderTexture,o=e.getBounds(!0,Td.pop()??new wt);this.roundFrameToPixels(o,r.current?r.current.resolution:n.resolution,r.sourceFrame,r.destinationFrame,n.projection.transform),t&&o.fit(t),i._scissorRectLocal=o}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:n,d:r}=i;return(Math.abs(e)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||Fo.isMatrixRotated(t.worldTransform)||Fo.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,n,r){Fo.isMatrixRotated(r)||(r=r?Ed.copyFrom(r):Ed.identity(),r.translate(-e.x,-e.y).scale(n.width/e.width,n.height/e.height).translate(n.x,n.y),this.renderer.filter.transformAABB(r,i),i.fit(n),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&Td.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let Up=Fo;Up.extension={type:q.RendererSystem,name:"scissor"};rt.add(Up);class Gp extends kp{constructor(t){super(t),this.glConst=K.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:n}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;const o=t._colorMask;o!==0&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,r,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,o!==0&&(t._colorMask=o,n.colorMask((o&1)!==0,(o&2)!==0,(o&4)!==0,(o&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=n?n._colorMask:15;r!==0&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(n._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Gp.extension={type:q.RendererSystem,name:"stencil"};rt.add(Gp);class Wp{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return St("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Wp.extension={type:[q.RendererSystem,q.CanvasRendererSystem],name:"_plugin"};rt.add(Wp);class Hp{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Xt,this.transform=null}update(t,e,n,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,r),this.transform&&this.projectionMatrix.append(this.transform);const o=this.renderer;o.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,o.globalUniforms.update(),o.shader.shader&&o.shader.syncUniformGroup(o.shader.shader.uniforms.globals)}calculateProjection(t,e,n,r){const o=this.projectionMatrix,h=r?-1:1;o.identity(),o.a=1/e.width*2,o.d=h*(1/e.height*2),o.tx=-1-e.x*o.a,o.ty=-h-e.y*o.d}setTransform(t){}destroy(){this.renderer=null}}Hp.extension={type:q.RendererSystem,name:"projection"};rt.add(Hp);const rS=new eu;class Xp{constructor(t){this.renderer=t,this._tempMatrix=new Xt}generateTexture(t,e){const{region:n,...r}=e||{},o=n||t.getLocalBounds(null,!0);o.width===0&&(o.width=1),o.height===0&&(o.height=1);const h=gn.create({width:o.width,height:o.height,...r});this._tempMatrix.tx=-o.x,this._tempMatrix.ty=-o.y;const l=t.transform;return t.transform=rS,this.renderer.render(t,{renderTexture:h,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,h}destroy(){}}Xp.extension={type:[q.RendererSystem,q.CanvasRendererSystem],name:"textureGenerator"};rt.add(Xp);const Cn=new wt,Qr=new wt;class $p{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new wt,this.destinationFrame=new wt,this.viewportFrame=new wt}bind(t=null,e,n){const r=this.renderer;this.current=t;let o,h,l;t?(o=t.baseTexture,l=o.resolution,e||(Cn.width=t.frame.width,Cn.height=t.frame.height,e=Cn),n||(Qr.x=t.frame.x,Qr.y=t.frame.y,Qr.width=e.width,Qr.height=e.height,n=Qr),h=o.framebuffer):(l=r.resolution,e||(Cn.width=r._view.screen.width,Cn.height=r._view.screen.height,e=Cn),n||(n=Cn,n.width=e.width,n.height=e.height));const c=this.viewportFrame;c.x=n.x*l,c.y=n.y*l,c.width=n.width*l,c.height=n.height*l,t||(c.y=r.view.height-(c.y+c.height)),c.ceil(),this.renderer.framebuffer.bind(h,c),this.renderer.projection.update(n,e,l,!h),t?this.renderer.mask.setMaskStack(o.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const n=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==r.width||n.height!==r.height;if(o){let{x:h,y:l,width:c,height:f}=this.viewportFrame;h=Math.round(h),l=Math.round(l),c=Math.round(c),f=Math.round(f),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(h,l,c,f)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}$p.extension={type:q.RendererSystem,name:"renderTexture"};rt.add($p);class sS{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function oS(i,t){const e={},n=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const o=t.getActiveAttrib(i,r);if(o.name.startsWith("gl_"))continue;const h=Tp(t,o.type),l={type:h,name:o.name,size:Ep(h),location:t.getAttribLocation(i,o.name)};e[o.name]=l}return e}function aS(i,t){const e={},n=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let r=0;r<n;r++){const o=t.getActiveUniform(i,r),h=o.name.replace(/\[.*?\]$/,""),l=!!o.name.match(/\[.*?\]$/),c=Tp(t,o.type);e[h]={name:h,index:r,type:c,size:o.size,isArray:l,value:bp(c,o.size)}}return e}function hS(i,t){var c;const e=md(i,i.VERTEX_SHADER,t.vertexSrc),n=md(i,i.FRAGMENT_SHADER,t.fragmentSrc),r=i.createProgram();i.attachShader(r,e),i.attachShader(r,n);const o=(c=t.extra)==null?void 0:c.transformFeedbackVaryings;if(o&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(r,o.names,o.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(r),i.getProgramParameter(r,i.LINK_STATUS)||NA(i,r,e,n),t.attributeData=oS(r,i),t.uniformData=aS(r,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const f=Object.keys(t.attributeData);f.sort((d,g)=>d>g?1:-1);for(let d=0;d<f.length;d++)t.attributeData[f[d]].location=d,i.bindAttribLocation(r,d,f[d]);i.linkProgram(r)}i.deleteShader(e),i.deleteShader(n);const h={};for(const f in t.uniformData){const d=t.uniformData[f];h[f]={location:i.getUniformLocation(r,f),value:bp(d.type,d.size)}}return new sS(r,h)}function lS(i,t,e,n,r){e.buffer.update(r)}const uS={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},zp={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function cS(i){const t=i.map(o=>({data:o,offset:0,dataLen:0,dirty:0}));let e=0,n=0,r=0;for(let o=0;o<t.length;o++){const h=t[o];if(e=zp[h.data.type],h.data.size>1&&(e=Math.max(e,16)*h.data.size),h.dataLen=e,n%e!==0&&n<16){const l=n%e%16;n+=l,r+=l}n+e>16?(r=Math.ceil(r/16)*16,h.offset=r,r+=e,n=e):(h.offset=r,n+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function fS(i,t){const e=[];for(const n in i)t[n]&&e.push(t[n]);return e.sort((n,r)=>n.index-r.index),e}function dS(i,t){if(!i.autoManage)return{size:0,syncFunc:lS};const e=fS(i.uniforms,t),{uboElements:n,size:r}=cS(e),o=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let h=0;h<n.length;h++){const l=n[h],c=i.uniforms[l.data.name],f=l.data.name;let d=!1;for(let g=0;g<vr.length;g++){const m=vr[g];if(m.codeUbo&&m.test(l.data,c)){o.push(`offset = ${l.offset/4};`,vr[g].codeUbo(l.data.name,c)),d=!0;break}}if(!d)if(l.data.size>1){const g=Ep(l.data.type),m=Math.max(zp[l.data.type]/16,1),_=g/m,v=(4-_%4)%4;o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};

                t = 0;

                for(var i=0; i < ${l.data.size*m}; i++)
                {
                    for(var j = 0; j < ${_}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${v};
                }

                `)}else{const g=uS[l.data.type];o.push(`
                cv = ud.${f}.value;
                v = uv.${f};
                offset = ${l.offset/4};
                ${g};
                `)}}return o.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join(`
`))}}let pS=0;const yo={textureCount:0,uboCount:0};class Vp{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=pS++}systemCheck(){if(!UA())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const n=t.program,r=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(r.program)),e||(yo.textureCount=0,yo.uboCount=0,this.syncUniformGroup(t.uniformGroup,yo)),r}setUniforms(t){const e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)}syncUniformGroup(t,e){const n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))}syncUniforms(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=FA(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const n=this.getGlProgram();if(!t.static||t.dirtyId!==0||!n.uniformGroups[t.id]){t.dirtyId=0;const r=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),r(n.uniformData,t.uniforms,this.renderer,yo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])}createSyncBufferGroup(t,e,n){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const o=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,o,this.shader.uniformBindCount),this.shader.uniformBindCount++;const h=this.getSignature(t,this.shader.program.uniformData,"ubo");let l=this._uboCache[h];if(l||(l=this._uboCache[h]=dS(t,this.shader.program.uniformData)),t.autoManage){const c=new Float32Array(l.size/4);t.buffer.update(c)}return e.uniformGroups[t.id]=l.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,n){const r=t.uniforms,o=[`${n}-`];for(const h in r)o.push(h),e[h]&&o.push(e[h].type);return o.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,n=t.program,r=hS(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Vp.extension={type:q.RendererSystem,name:"shader"};rt.add(Vp);class Yp{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.0 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}Yp.extension={type:[q.RendererSystem,q.CanvasRendererSystem],name:"startup"};rt.add(Yp);function gS(i,t=[]){return t[lt.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD]=[i.ONE,i.ONE],t[lt.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.NONE]=[0,0],t[lt.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[lt.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[lt.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[lt.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[lt.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[lt.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[lt.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[lt.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[lt.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[lt.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const mS=0,_S=1,vS=2,xS=3,yS=4,bS=5,Dl=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=lt.NONE,this._blendEq=!1,this.map=[],this.map[mS]=this.setBlend,this.map[_S]=this.setOffset,this.map[vS]=this.setCullFace,this.map[xS]=this.setDepthTest,this.map[yS]=this.setFrontFace,this.map[bS]=this.setDepthMask,this.checks=[],this.defaultState=new qi,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=gS(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(Dl.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(Dl.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let jp=Dl;jp.extension={type:q.RendererSystem,name:"state"};rt.add(jp);class wS extends ps{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),n=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of n)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new fi(e)})}addSystem(t,e){const n=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=n,this._systemsHash[e]=n;for(const r in this.runners)this.runners[r].add(n);return this}emitWithCustomOptions(t,e){const n=Object.keys(this._systemsHash);t.items.forEach(r=>{const o=n.find(h=>this._systemsHash[h]===r);r[t.name](e[o])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Lo=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=Lo.defaultMaxIdle,this.checkCountMax=Lo.defaultCheckCountMax,this.mode=Lo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==jl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let n=0;n<t.length;n++){const r=t[n];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(i.destroyTexture(r,!0),t[n]=null,e=!0)}if(e){let n=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[n++]=t[r]);t.length=n}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let n=i.children.length-1;n>=0;n--)this.unload(i.children[n])}destroy(){this.renderer=null}};let li=Lo;li.defaultMode=jl.AUTO;li.defaultMaxIdle=60*60;li.defaultCheckCountMax=60*10;li.extension={type:q.RendererSystem,name:"textureGC"};rt.add(li);class qh{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=st.UNSIGNED_BYTE,this.internalFormat=$.RGBA,this.samplerType=0}}function ES(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[st.UNSIGNED_BYTE]:{[$.RGBA]:i.RGBA8,[$.RGB]:i.RGB8,[$.RG]:i.RG8,[$.RED]:i.R8,[$.RGBA_INTEGER]:i.RGBA8UI,[$.RGB_INTEGER]:i.RGB8UI,[$.RG_INTEGER]:i.RG8UI,[$.RED_INTEGER]:i.R8UI,[$.ALPHA]:i.ALPHA,[$.LUMINANCE]:i.LUMINANCE,[$.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.BYTE]:{[$.RGBA]:i.RGBA8_SNORM,[$.RGB]:i.RGB8_SNORM,[$.RG]:i.RG8_SNORM,[$.RED]:i.R8_SNORM,[$.RGBA_INTEGER]:i.RGBA8I,[$.RGB_INTEGER]:i.RGB8I,[$.RG_INTEGER]:i.RG8I,[$.RED_INTEGER]:i.R8I},[st.UNSIGNED_SHORT]:{[$.RGBA_INTEGER]:i.RGBA16UI,[$.RGB_INTEGER]:i.RGB16UI,[$.RG_INTEGER]:i.RG16UI,[$.RED_INTEGER]:i.R16UI,[$.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[st.SHORT]:{[$.RGBA_INTEGER]:i.RGBA16I,[$.RGB_INTEGER]:i.RGB16I,[$.RG_INTEGER]:i.RG16I,[$.RED_INTEGER]:i.R16I},[st.UNSIGNED_INT]:{[$.RGBA_INTEGER]:i.RGBA32UI,[$.RGB_INTEGER]:i.RGB32UI,[$.RG_INTEGER]:i.RG32UI,[$.RED_INTEGER]:i.R32UI,[$.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[st.INT]:{[$.RGBA_INTEGER]:i.RGBA32I,[$.RGB_INTEGER]:i.RGB32I,[$.RG_INTEGER]:i.RG32I,[$.RED_INTEGER]:i.R32I},[st.FLOAT]:{[$.RGBA]:i.RGBA32F,[$.RGB]:i.RGB32F,[$.RG]:i.RG32F,[$.RED]:i.R32F,[$.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[st.HALF_FLOAT]:{[$.RGBA]:i.RGBA16F,[$.RGB]:i.RGB16F,[$.RG]:i.RG16F,[$.RED]:i.R16F},[st.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:i.RGB565},[st.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:i.RGBA4},[st.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:i.RGB5_A1},[st.UNSIGNED_INT_2_10_10_10_REV]:{[$.RGBA]:i.RGB10_A2,[$.RGBA_INTEGER]:i.RGB10_A2UI},[st.UNSIGNED_INT_10F_11F_11F_REV]:{[$.RGB]:i.R11F_G11F_B10F},[st.UNSIGNED_INT_5_9_9_9_REV]:{[$.RGB]:i.RGB9_E5},[st.UNSIGNED_INT_24_8]:{[$.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[st.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[$.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[st.UNSIGNED_BYTE]:{[$.RGBA]:i.RGBA,[$.RGB]:i.RGB,[$.ALPHA]:i.ALPHA,[$.LUMINANCE]:i.LUMINANCE,[$.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[st.UNSIGNED_SHORT_5_6_5]:{[$.RGB]:i.RGB},[st.UNSIGNED_SHORT_4_4_4_4]:{[$.RGBA]:i.RGBA},[st.UNSIGNED_SHORT_5_5_5_1]:{[$.RGBA]:i.RGBA}},t}class qp{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ft,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=ES(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const n=new qh(t.createTexture());t.bindTexture(t.TEXTURE_2D,n.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=n,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new qh(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:n}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:n}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<n.length;r++)n[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<n.length;r++)n[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:n,CONTEXT_UID:r}=this;if(n)for(let o=t-1;o>=0;--o){const h=e[o];h&&h._glTextures[r].samplerType!==ml.FLOAT&&this.renderer.texture.unbind(h)}}initTexture(t){const e=new qh(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var n;e.internalFormat=((n=this.internalFormats[t.type])==null?void 0:n[t.format])??t.format,this.webGLVersion===2&&t.type===st.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const n=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(n,t,e))e.samplerType!==ml.FLOAT&&(this.hasIntegerTextures=!0);else{const o=t.realWidth,h=t.realHeight,l=n.gl;(e.width!==o||e.height!==h||e.dirtyId<0)&&(e.width=o,e.height=h,l.texImage2D(t.target,0,e.internalFormat,o,h,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:n}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&mr(this.managedTextures,r,1)}}updateTextureStyle(t){var n;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Ci.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=cn.CLAMP:e.wrapMode=t.wrapMode,(n=t.resource)!=null&&n.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const n=this.gl;if(e.mipmap&&t.mipmap!==Ci.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Xi.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===Xi.LINEAR){const o=Math.min(t.anisotropicLevel,n.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Xi.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Xi.LINEAR?n.LINEAR:n.NEAREST)}destroy(){this.renderer=null}}qp.extension={type:q.RendererSystem,name:"texture"};rt.add(qp);class Kp{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glTransformFeedbacks[n]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:n,renderer:r}=this;e&&r.shader.bind(e),n.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:n,CONTEXT_UID:r}=this,o=e.createTransformFeedback();t._glTransformFeedbacks[r]=o,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,o);for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];l&&(n.buffer.update(l),l._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,h,l._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),o}disposeTransformFeedback(t,e){const n=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const o=this.renderer.buffer;if(o)for(let h=0;h<t.buffers.length;h++){const l=t.buffers[h];if(!l)continue;const c=l._glBuffers[this.CONTEXT_UID];c&&(c.refCount--,c.refCount===0&&!e&&o.dispose(l,e))}n&&(e||r.deleteTransformFeedback(n),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Kp.extension={type:q.RendererSystem,name:"transformFeedback"};rt.add(Kp);class Zp{constructor(t){this.renderer=t}init(t){this.screen=new wt(0,0,t.width,t.height),this.element=t.view||K.ADAPTER.createCanvas(),this.resolution=t.resolution||K.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const n=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=n,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${n}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",n,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Zp.extension={type:[q.RendererSystem,q.CanvasRendererSystem],name:"_view"};rt.add(Zp);K.PREFER_ENV=Wn.WEBGL2;K.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(K,{WRAP_MODE:{get(){return ft.defaultOptions.wrapMode},set(i){St("7.1.0","settings.WRAP_MODE is deprecated, use BaseTeture.defaultOptions.wrapMode"),ft.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return ft.defaultOptions.scaleMode},set(i){St("7.1.0","settings.SCALE_MODE is deprecated, use BaseTeture.defaultOptions.scaleMode"),ft.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return ft.defaultOptions.mipmap},set(i){St("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTeture.defaultOptions.mipmap"),ft.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return ft.defaultOptions.anisotropicLevel},set(i){St("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTeture.defaultOptions.anisotropicLevel"),ft.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return St("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),Ae.defaultResolution},set(i){Ae.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return St("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),Ae.defaultMultisample},set(i){Ae.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return hi.defaultMaxTextures},set(i){St("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),hi.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return hi.defaultBatchSize},set(i){St("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),hi.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return hi.canUploadSameBuffer},set(i){St("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),hi.canUploadSameBuffer=i}},GC_MODE:{get(){return li.defaultMode},set(i){St("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),li.defaultMode=i}},GC_MAX_IDLE:{get(){return li.defaultMaxIdle},set(i){St("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),li.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return li.defaultCheckCountMax},set(i){St("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),li.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return ui.defaultVertexPrecision},set(i){St("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),ui.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return ui.defaultFragmentPrecision},set(i){St("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),ui.defaultFragmentPrecision=i}}});var xr=(i=>(i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(xr||{});class Kh{constructor(t,e=null,n=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const ke=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Kh(null,null,1/0),this.deltaMS=1/ke.targetFPMS,this.elapsedMS=1/ke.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=xr.NORMAL){return this._addListener(new Kh(i,t,e))}addOnce(i,t,e=xr.NORMAL){return this._addListener(new Kh(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=i-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=i-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ke.targetFPMS;const e=this._head;let n=e.next;for(;n;)n=n.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,ke.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ke._shared){const i=ke._shared=new ke;i.autoStart=!0,i._protected=!0}return ke._shared}static get system(){if(!ke._system){const i=ke._system=new ke;i.autoStart=!0,i._protected=!0}return ke._system}};let Me=ke;Me.targetFPMS=.06;Object.defineProperties(K,{TARGET_FPMS:{get(){return Me.targetFPMS},set(i){St("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Me.targetFPMS=i}}});class Jp{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,xr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Me.shared:new Me,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Jp.extension=q.Application;rt.add(Jp);const Qp=[];rt.handleByList(q.Renderer,Qp);function TS(i){for(const t of Qp)if(t.test(i))return new t(i);throw new Error("Unable to auto-detect a suitable renderer.")}var AS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,SS=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const CS=AS,tg=SS;class eg{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const n=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,n)}else{const n=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,n)}e>=re.HIGH?this.multisample=re.HIGH:e>=re.MEDIUM?this.multisample=re.MEDIUM:e>=re.LOW?this.multisample=re.LOW:this.multisample=re.NONE}destroy(){}}eg.extension={type:q.RendererSystem,name:"_multisample"};rt.add(eg);class IS{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class ig{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:n,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const o=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,o.buffer)}}bindBufferRange(t,e,n){const{gl:r,CONTEXT_UID:o}=this;n=n||0;const h=t._glBuffers[o]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,h.buffer,n*256,256)}update(t){const{gl:e,CONTEXT_UID:n}=this,r=t._glBuffers[n]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const o=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,o)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const n=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),n&&(e||r.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:n}=this;return t._glBuffers[e]=new IS(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}ig.extension={type:q.RendererSystem,name:"buffer"};rt.add(ig);class ng{constructor(t){this.renderer=t}render(t,e){const n=this.renderer;let r,o,h,l;if(e&&(r=e.renderTexture,o=e.clear,h=e.transform,l=e.skipUpdateTransform),this.renderingToScreen=!r,n.runners.prerender.emit(),n.emit("prerender"),n.projection.transform=h,!n.context.isLost){if(r||(this.lastObjectRendered=t),!l){const c=t.enableTempParent();t.updateTransform(),t.disableTempParent(c)}n.renderTexture.bind(r),n.batch.currentRenderer.start(),(o??n.background.clearBeforeRender)&&n.renderTexture.clear(),t.render(n),n.batch.currentRenderer.flush(),r&&(e.blit&&n.framebuffer.blit(),r.baseTexture.update()),n.runners.postrender.emit(),n.projection.transform=null,n.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ng.extension={type:q.RendererSystem,name:"objectRenderer"};rt.add(ng);const Bl=class extends wS{constructor(i){super(),i=Object.assign({},K.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new di({projectionMatrix:new Xt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Bl.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&(St("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha);const e={hello:i.hello,_plugin:Bl.__plugins,background:{alpha:i.backgroundAlpha,color:i.background??i.backgroundColor,clearBeforeRender:i.clearBeforeRender},_view:{height:i.height,width:i.width,autoDensity:i.autoDensity,resolution:i.resolution,view:i.view},context:{antialias:i.antialias,context:i.context,powerPreference:i.powerPreference,premultipliedAlpha:i.premultipliedAlpha,preserveDrawingBuffer:i.preserveDrawingBuffer}};this.startup.run(e),this.options=i}static test(i){return i!=null&&i.forceCanvas?!1:Ew()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return St("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return St("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return St("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return St("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){St("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return St("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(i){St("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return St("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let Ar=Bl;Ar.extension={type:q.Renderer,priority:1};Ar.__plugins={};Ar.__systems={};rt.handleByMap(q.RendererPlugin,Ar.__plugins);rt.handleByMap(q.RendererSystem,Ar.__systems);rt.add(Ar);class rg extends cs{constructor(t,e){const{width:n,height:r}=e||{};super(n,r),this.items=[],this.itemDirtyIds=[];for(let o=0;o<t;o++){const h=new ft;this.items.push(h),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof cs?this.addResourceAt(t[n],n):this.addResourceAt(_p(t[n],e),n))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(n=>n.resource).filter(n=>n).map(n=>n.load());return this._load=Promise.all(e).then(()=>{const{realWidth:n,realHeight:r}=this.items[0];return this.resize(n,r),Promise.resolve(this)}),this._load}}class RS extends rg{constructor(t,e){const{width:n,height:r}=e||{};let o,h;Array.isArray(t)?(o=t,h=t.length):h=t,super(h,{width:n,height:r}),o&&this.initFromArray(o,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=pr.TEXTURE_2D_ARRAY}upload(t,e,n){const{length:r,itemDirtyIds:o,items:h}=this,{gl:l}=t;n.dirtyId<0&&l.texImage3D(l.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(let c=0;c<r;c++){const f=h[c];o[c]<f.dirtyId&&(o[c]=f.dirtyId,f.valid&&l.texSubImage3D(l.TEXTURE_2D_ARRAY,0,0,0,c,f.resource.width,f.resource.height,1,e.format,n.type,f.resource.source))}return!0}}class PS extends pn{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const ns=class extends rg{constructor(i,t){const{width:e,height:n,autoLoad:r,linkBaseTexture:o}=t||{};if(i&&i.length!==ns.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:n});for(let h=0;h<ns.SIDES;h++)this.items[h].target=pr.TEXTURE_CUBE_MAP_POSITIVE_X+h;this.linkBaseTexture=o!==!1,i&&this.initFromArray(i,t),r!==!1&&this.load()}bind(i){super.bind(i),i.target=pr.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=pr.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const n=this.itemDirtyIds;for(let r=0;r<ns.SIDES;r++){const o=this.items[r];(n[r]<o.dirtyId||e.dirtyId<t.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(i,o,e),n[r]=o.dirtyId):n[r]<-1&&(i.gl.texImage2D(o.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),n[r]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===ns.SIDES}};let sg=ns;sg.SIDES=6;class dr extends pn{constructor(t,e){var n=(...r)=>{super(...r)};e=e||{},typeof t=="string"?(n(dr.EMPTY),this.url=t):(n(t),this.url=null),this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const n=await K.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await n.blob();if(this.destroyed)return;const o=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===gi.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=o,this.update(),t(this)}catch(n){if(this.destroyed)return;e(n),this.onError.emit(n)}}),this._load)}upload(t,e,n){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,n)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return dr._EMPTY=dr._EMPTY??K.ADAPTER.createCanvas(0,0),dr._EMPTY}}const Oo=class extends pn{constructor(i,t){t=t||{},super(K.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},Oo.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;pn.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let n=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(n=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),n=Math.round(n),r=Math.round(r);const o=this.source;o.width=n,o.height=r,o._pixiId=`canvas_${Un()}`,o.getContext("2d").drawImage(i,0,0,t,e,0,0,n,r),this._resolve(),this._resolve=null}}static getSize(i){const t=Oo.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&Oo.SVG_XML.test(i)}};let fs=Oo;fs.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;fs.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Fl=class extends pn{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const n=i[0].src||i[0];pn.crossOrigin(e,n,t.crossorigin);for(let r=0;r<i.length;++r){const o=document.createElement("source");let{src:h,mime:l}=i[r];h=h||i[r];const c=h.split("?").shift().toLowerCase(),f=c.slice(c.lastIndexOf(".")+1);l=l||Fl.MIME_TYPES[f]||`video/${f}`,o.src=h,o.type=l,e.appendChild(o)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=Me.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Me.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(Me.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Me.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||Fl.TYPES.includes(t)}};let iu=Fl;iu.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];iu.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Cl.push(dr,Rp,PS,iu,fs,gs,sg,RS);class Vo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?wt.EMPTY:(t=t||new wt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:n,b:r,c:o,d:h,tx:l,ty:c}=t,f=n*e.x+o*e.y+l,d=r*e.x+h*e.y+c;this.minX=Math.min(this.minX,f),this.maxX=Math.max(this.maxX,f),this.minY=Math.min(this.minY,d),this.maxY=Math.max(this.maxY,d)}addQuad(t){let e=this.minX,n=this.minY,r=this.maxX,o=this.maxY,h=t[0],l=t[1];e=h<e?h:e,n=l<n?l:n,r=h>r?h:r,o=l>o?l:o,h=t[2],l=t[3],e=h<e?h:e,n=l<n?l:n,r=h>r?h:r,o=l>o?l:o,h=t[4],l=t[5],e=h<e?h:e,n=l<n?l:n,r=h>r?h:r,o=l>o?l:o,h=t[6],l=t[7],e=h<e?h:e,n=l<n?l:n,r=h>r?h:r,o=l>o?l:o,this.minX=e,this.minY=n,this.maxX=r,this.maxY=o}addFrame(t,e,n,r,o){this.addFrameMatrix(t.worldTransform,e,n,r,o)}addFrameMatrix(t,e,n,r,o){const h=t.a,l=t.b,c=t.c,f=t.d,d=t.tx,g=t.ty;let m=this.minX,_=this.minY,v=this.maxX,w=this.maxY,y=h*e+c*n+d,T=l*e+f*n+g;m=y<m?y:m,_=T<_?T:_,v=y>v?y:v,w=T>w?T:w,y=h*r+c*n+d,T=l*r+f*n+g,m=y<m?y:m,_=T<_?T:_,v=y>v?y:v,w=T>w?T:w,y=h*e+c*o+d,T=l*e+f*o+g,m=y<m?y:m,_=T<_?T:_,v=y>v?y:v,w=T>w?T:w,y=h*r+c*o+d,T=l*r+f*o+g,m=y<m?y:m,_=T<_?T:_,v=y>v?y:v,w=T>w?T:w,this.minX=m,this.minY=_,this.maxX=v,this.maxY=w}addVertexData(t,e,n){let r=this.minX,o=this.minY,h=this.maxX,l=this.maxY;for(let c=e;c<n;c+=2){const f=t[c],d=t[c+1];r=f<r?f:r,o=d<o?d:o,h=f>h?f:h,l=d>l?d:l}this.minX=r,this.minY=o,this.maxX=h,this.maxY=l}addVertices(t,e,n,r){this.addVerticesMatrix(t.worldTransform,e,n,r)}addVerticesMatrix(t,e,n,r,o=0,h=o){const l=t.a,c=t.b,f=t.c,d=t.d,g=t.tx,m=t.ty;let _=this.minX,v=this.minY,w=this.maxX,y=this.maxY;for(let T=n;T<r;T+=2){const S=e[T],A=e[T+1],I=l*S+f*A+g,D=d*A+c*S+m;_=Math.min(_,I-o),w=Math.max(w,I+o),v=Math.min(v,D-h),y=Math.max(y,D+h)}this.minX=_,this.minY=v,this.maxX=w,this.maxY=y}addBounds(t){const e=this.minX,n=this.minY,r=this.maxX,o=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>r?t.maxX:r,this.maxY=t.maxY>o?t.maxY:o}addBoundsMask(t,e){const n=t.minX>e.minX?t.minX:e.minX,r=t.minY>e.minY?t.minY:e.minY,o=t.maxX<e.maxX?t.maxX:e.maxX,h=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=o&&r<=h){const l=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<l?n:l,this.minY=r<c?r:c,this.maxX=o>f?o:f,this.maxY=h>d?h:d}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const n=t.minX>e.x?t.minX:e.x,r=t.minY>e.y?t.minY:e.y,o=t.maxX<e.x+e.width?t.maxX:e.x+e.width,h=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=o&&r<=h){const l=this.minX,c=this.minY,f=this.maxX,d=this.maxY;this.minX=n<l?n:l,this.minY=r<c?r:c,this.maxX=o>f?o:f,this.maxY=h>d?h:d}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,n,r,o,h){t-=o,e-=h,n+=o,r+=h,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>r?this.maxY:r}}class Yt extends ps{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new eu,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Vo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let n=0;n<e.length;++n){const r=e[n];Object.defineProperty(Yt.prototype,r,Object.getOwnPropertyDescriptor(t,r))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new wt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new wt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Vo);const e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;const r=this._bounds,o=this._boundsID;this._bounds=this._localBounds;const h=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=r,this._bounds.updateID+=this._boundsID-o,h}toGlobal(t,e,n=!1){return n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,n,r){return e&&(t=e.toGlobal(t,n,r)),r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,n=1,r=1,o=0,h=0,l=0,c=0,f=0){return this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=r||1,this.rotation=o,this.skew.x=h,this.skew.y=l,this.pivot.x=c,this.pivot.y=f,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new MS),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*CA}set angle(t){this.transform.rotation=t*IA}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class MS extends Yt{constructor(){super(...arguments),this.sortDirty=null}}Yt.prototype.displayObjectUpdateTransform=Yt.prototype.updateTransform;const DS=new Xt;function BS(i,t){return i.zIndex===t.zIndex?i._lastSortedIndex-t._lastSortedIndex:i.zIndex-t.zIndex}const Ll=class extends Yt{constructor(){super(),this.children=[],this.sortableChildren=Ll.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(i){}addChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.addChild(i[t]);else{const t=i[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return i[0]}addChildAt(i,t){if(t<0||t>this.children.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return i.parent&&i.parent.removeChild(i),i.parent=this,this.sortDirty=!0,i.transform._parentID=-1,this.children.splice(t,0,i),this._boundsID++,this.onChildrenChange(t),i.emit("added",this),this.emit("childAdded",i,this,t),i}swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),n=this.getChildIndex(t);this.children[e]=t,this.children[n]=i,this.onChildrenChange(e<n?e:n)}getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);const e=this.getChildIndex(i);mr(this.children,e,1),this.children.splice(t,0,i),this.onChildrenChange(t)}getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]}removeChild(...i){if(i.length>1)for(let t=0;t<i.length;t++)this.removeChild(i[t]);else{const t=i[0],e=this.children.indexOf(t);if(e===-1)return null;t.parent=null,t.transform._parentID=-1,mr(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e)}return i[0]}removeChildAt(i){const t=this.getChildAt(i);return t.parent=null,t.transform._parentID=-1,mr(this.children,i,1),this._boundsID++,this.onChildrenChange(i),t.emit("removed",this),this.emit("childRemoved",t,this,i),t}removeChildren(i=0,t=this.children.length){const e=i,n=t,r=n-e;let o;if(r>0&&r<=n){o=this.children.splice(e,r);for(let h=0;h<o.length;++h)o[h].parent=null,o[h].transform&&(o[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(i);for(let h=0;h<o.length;++h)o[h].emit("removed",this),this.emit("childRemoved",o[h],this,h);return o}else if(r===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let i=!1;for(let t=0,e=this.children.length;t<e;++t){const n=this.children[t];n._lastSortedIndex=t,!i&&n.zIndex!==0&&(i=!0)}i&&this.children.length>1&&this.children.sort(BS),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let i=0,t=this.children.length;i<t;++i){const e=this.children[i];e.visible&&e.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let i=0;i<this.children.length;i++){const t=this.children[i];if(!(!t.visible||!t.renderable))if(t.calculateBounds(),t._mask){const e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(i,t=!1){const e=super.getLocalBounds(i);if(!t)for(let n=0,r=this.children.length;n<r;++n){const o=this.children[n];o.visible&&o.updateTransform()}return e}_calculateBounds(){}_renderWithCulling(i){const t=i.renderTexture.sourceFrame;if(!(t.width>0&&t.height>0))return;let e,n;this.cullArea?(e=this.cullArea,n=this.worldTransform):this._render!==Ll.prototype._render&&(e=this.getBounds(!0));const r=i.projection.transform;if(r&&(n?(n=DS.copyFrom(n),n.prepend(r)):n=r),e&&t.intersects(e,n))this._render(i);else if(this.cullArea)return;for(let o=0,h=this.children.length;o<h;++o){const l=this.children[o],c=l.cullable;l.cullable=c||!this.cullArea,l.render(i),l.cullable=c}}render(i){var t;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(t=this.filters)!=null&&t.length)this.renderAdvanced(i);else if(this.cullable)this._renderWithCulling(i);else{this._render(i);for(let e=0,n=this.children.length;e<n;++e)this.children[e].render(i)}}renderAdvanced(i){var r,o,h;const t=this.filters,e=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<t.length;l++)t[l].enabled&&this._enabledFilters.push(t[l])}const n=t&&((r=this._enabledFilters)==null?void 0:r.length)||e&&(!e.isMaskData||e.enabled&&(e.autoDetect||e.type!==he.NONE));if(n&&i.batch.flush(),t&&((o=this._enabledFilters)!=null&&o.length)&&i.filter.push(this,this._enabledFilters),e&&i.mask.push(this,this._mask),this.cullable)this._renderWithCulling(i);else{this._render(i);for(let l=0,c=this.children.length;l<c;++l)this.children[l].render(i)}n&&i.batch.flush(),e&&i.mask.pop(this),t&&((h=this._enabledFilters)!=null&&h.length)&&i.filter.pop()}_render(i){}destroy(i){super.destroy(),this.sortDirty=!1;const t=typeof i=="boolean"?i:i==null?void 0:i.children,e=this.removeChildren(0,this.children.length);if(t)for(let n=0;n<e.length;++n)e[n].destroy(i)}get width(){return this.scale.x*this.getLocalBounds().width}set width(i){const t=this.getLocalBounds().width;t!==0?this.scale.x=i/t:this.scale.x=1,this._width=i}get height(){return this.scale.y*this.getLocalBounds().height}set height(i){const t=this.getLocalBounds().height;t!==0?this.scale.y=i/t:this.scale.y=1,this._height=i}};let Ge=Ll;Ge.defaultSortableChildren=!1;Ge.prototype.containerUpdateTransform=Ge.prototype.updateTransform;Object.defineProperties(K,{SORTABLE_CHILDREN:{get(){return Ge.defaultSortableChildren},set(i){St("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),Ge.defaultSortableChildren=i}}});const ts=new Tt,FS=new Uint16Array([0,1,2,0,2,3]);class Sr extends Ge{constructor(t){super(),this._anchor=new ln(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tint=null,this._tintRGB=null,this.tint=16777215,this.blendMode=lt.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||nt.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=FS,this.pluginName="batch",this.isSprite=!0,this._roundPixels=K.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=fr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=fr(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,n=e.a,r=e.b,o=e.c,h=e.d,l=e.tx,c=e.ty,f=this.vertexData,d=t.trim,g=t.orig,m=this._anchor;let _=0,v=0,w=0,y=0;if(d?(v=d.x-m._x*g.width,_=v+d.width,y=d.y-m._y*g.height,w=y+d.height):(v=-m._x*g.width,_=v+g.width,y=-m._y*g.height,w=y+g.height),f[0]=n*v+o*y+l,f[1]=h*y+r*v+c,f[2]=n*_+o*y+l,f[3]=h*y+r*_+c,f[4]=n*_+o*w+l,f[5]=h*w+r*_+c,f[6]=n*v+o*w+l,f[7]=h*w+r*v+c,this._roundPixels){const T=K.RESOLUTION;for(let S=0;S<f.length;++S)f[S]=Math.round(f[S]*T)/T}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,n=t.orig,r=this._anchor,o=this.transform.worldTransform,h=o.a,l=o.b,c=o.c,f=o.d,d=o.tx,g=o.ty,m=-r._x*n.width,_=m+n.width,v=-r._y*n.height,w=v+n.height;e[0]=h*m+c*v+d,e[1]=f*v+l*m+g,e[2]=h*_+c*v+d,e[3]=f*v+l*_+g,e[4]=h*_+c*w+d,e[5]=f*w+l*_+g,e[6]=h*m+c*w+d,e[7]=f*w+l*m+g}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Vo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new wt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,ts);const e=this._texture.orig.width,n=this._texture.orig.height,r=-e*this.anchor.x;let o=0;return ts.x>=r&&ts.x<r+e&&(o=-n*this.anchor.y,ts.y>=o&&ts.y<o+n)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const n=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!n)}this._texture=null}static from(t,e){const n=t instanceof nt?t:nt.from(t,e);return new Sr(n)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=fr(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=fr(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tint}set tint(t){this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||nt.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const og=new Xt;Yt.prototype._cacheAsBitmap=!1;Yt.prototype._cacheData=null;Yt.prototype._cacheAsBitmapResolution=null;Yt.prototype._cacheAsBitmapMultisample=null;class LS{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(Yt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(i){i!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(i){i!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=i,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(i){if(this._cacheAsBitmap===i)return;this._cacheAsBitmap=i;let t;i?(this._cacheData||(this._cacheData=new LS),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});Yt.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};Yt.prototype._initCachedDisplayObject=function(t){var m,_;if((m=this._cacheData)!=null&&m.sprite)return;const e=this.alpha;this.alpha=1,t.batch.flush();const n=this.getLocalBounds(null,!0).clone();if((_=this.filters)!=null&&_.length){const v=this.filters[0].padding;n.pad(v)}n.ceil(K.RESOLUTION);const r=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),h=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,c=gn.create({width:n.width,height:n.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:this.cacheAsBitmapMultisample??t.multisample}),f=`cacheAsBitmap_${Un()}`;this._cacheData.textureCacheId=f,ft.addToCache(c.baseTexture,f),nt.addToCache(c,f);const d=this.transform.localTransform.copyTo(og).invert().translate(-n.x,-n.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:d,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(r,o,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const g=new Sr(c);g.transform.worldTransform=this.transform.worldTransform,g.anchor.x=-(n.x/n.width),g.anchor.y=-(n.y/n.height),g.alpha=e,g._bounds=this._bounds,this._cacheData.sprite=g,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=g.containsPoint.bind(g)};Yt.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};Yt.prototype._initCachedDisplayObjectCanvas=function(t){var d;if((d=this._cacheData)!=null&&d.sprite)return;const e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;const r=t.canvasContext.activeContext,o=t._projTransform;e.ceil(K.RESOLUTION);const h=gn.create({width:e.width,height:e.height}),l=`cacheAsBitmap_${Un()}`;this._cacheData.textureCacheId=l,ft.addToCache(h.baseTexture,l),nt.addToCache(h,l);const c=og;this.transform.localTransform.copyTo(c),c.invert(),c.tx-=e.x,c.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:h,clear:!0,transform:c,skipUpdateTransform:!1}),t.canvasContext.activeContext=r,t._projTransform=o,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;const f=new Sr(h);f.transform.worldTransform=this.transform.worldTransform,f.anchor.x=-(e.x/e.width),f.anchor.y=-(e.y/e.height),f.alpha=n,f._bounds=this._bounds,this._cacheData.sprite=f,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=f.containsPoint.bind(f)};Yt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};Yt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};Yt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ft.removeFromCache(this._cacheData.textureCacheId),nt.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};Yt.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};Yt.prototype.name=null;Ge.prototype.getChildByName=function(t,e){for(let n=0,r=this.children.length;n<r;n++)if(this.children[n].name===t)return this.children[n];if(e)for(let n=0,r=this.children.length;n<r;n++){const o=this.children[n];if(!o.getChildByName)continue;const h=o.getChildByName(t,!0);if(h)return h}return null};Yt.prototype.getGlobalPosition=function(t=new Tt,e=!1){return this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var OS=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class NS extends Ae{constructor(t=1){super(CS,OS,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const kS={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},US=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function GS(i){const t=kS[i],e=t.length;let n=US,r="";const o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let h;for(let l=0;l<i;l++){let c=o.replace("%index%",l.toString());h=l,l>=e&&(h=i-l-1),c=c.replace("%value%",t[h].toString()),r+=c,r+=`
`}return n=n.replace("%blur%",r),n=n.replace("%size%",i.toString()),n}const WS=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function HS(i,t){const e=Math.ceil(i/2);let n=WS,r="",o;t?o="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":o="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let h=0;h<i;h++){let l=o.replace("%index%",h.toString());l=l.replace("%sampleIndex%",`${h-(e-1)}.0`),r+=l,r+=`
`}return n=n.replace("%blur%",r),n=n.replace("%size%",i.toString()),n}class Ol extends Ae{constructor(t,e=8,n=4,r=K.FILTER_RESOLUTION,o=5){const h=HS(o,t),l=GS(o);super(h,l),this.horizontal=t,this.resolution=r,this._quality=0,this.quality=n,this.blur=e}apply(t,e,n,r){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,n,r);else{const o=t.getFilterTexture(),h=t.renderer;let l=e,c=o;this.state.blend=!1,t.applyFilter(this,l,c,wi.CLEAR);for(let f=1;f<this.passes-1;f++){t.bindAndClear(l,wi.BLIT),this.uniforms.uSampler=c;const d=c;c=l,l=d,h.shader.bind(this),h.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,c,n,r),t.returnFilterTexture(o)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class XS extends Ae{constructor(t=8,e=4,n=Ae.defaultResolution,r=5){super(),this.blurXFilter=new Ol(!0,t,e,n,r),this.blurYFilter=new Ol(!1,t,e,n,r),this.resolution=n,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,n,r){const o=Math.abs(this.blurXFilter.strength),h=Math.abs(this.blurYFilter.strength);if(o&&h){const l=t.getFilterTexture();this.blurXFilter.apply(t,e,l,wi.CLEAR),this.blurYFilter.apply(t,l,n,r),t.returnFilterTexture(l)}else h?this.blurYFilter.apply(t,e,n,r):this.blurXFilter.apply(t,e,n,r)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var $S=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class Nl extends Ae{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(tg,$S,t),this.alpha=1}_loadMatrix(t,e=!1){let n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n}_multiply(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}tint(t,e){const n=t>>16&255,r=t>>8&255,o=t&255,h=[n/255,0,0,0,0,0,r/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0];this._loadMatrix(h,e)}greyscale(t,e){const n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const n=Math.cos(t),r=Math.sin(t),o=Math.sqrt,h=1/3,l=o(h),c=n+(1-n)*h,f=h*(1-n)-l*r,d=h*(1-n)+l*r,g=h*(1-n)+l*r,m=n+h*(1-n),_=h*(1-n)-l*r,v=h*(1-n)-l*r,w=h*(1-n)+l*r,y=n+h*(1-n),T=[c,f,d,0,0,g,m,_,0,0,v,w,y,0,0,0,0,0,1,0];this._loadMatrix(T,e)}contrast(t,e){const n=(t||0)+1,r=-.5*(n-1),o=[n,0,0,0,r,0,n,0,0,r,0,0,n,0,r,0,0,0,1,0];this._loadMatrix(o,e)}saturate(t=0,e){const n=t*2/3+1,r=(n-1)*-.5,o=[n,r,r,0,0,r,n,r,0,0,r,r,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,n,r,o){t=t||.2,e=e||.15,n=n||16770432,r=r||3375104;const h=(n>>16&255)/255,l=(n>>8&255)/255,c=(n&255)/255,f=(r>>16&255)/255,d=(r>>8&255)/255,g=(r&255)/255,m=[.3,.59,.11,0,0,h,l,c,t,0,f,d,g,e,0,h-f,l-d,c-g,0,0];this._loadMatrix(m,o)}night(t,e){t=t||.1;const n=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(n,e)}predator(t,e){const n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}Nl.prototype.grayscale=Nl.prototype.greyscale;var zS=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,VS=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class YS extends Ae{constructor(t,e){const n=new Xt;t.renderable=!1,super(VS,zS,{mapSampler:t._texture,filterMatrix:n,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=n,e==null&&(e=20),this.scale=new Tt(e,e)}apply(t,e,n,r){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const o=this.maskSprite.worldTransform,h=Math.sqrt(o.a*o.a+o.b*o.b),l=Math.sqrt(o.c*o.c+o.d*o.d);h!==0&&l!==0&&(this.uniforms.rotation[0]=o.a/h,this.uniforms.rotation[1]=o.b/h,this.uniforms.rotation[2]=o.c/l,this.uniforms.rotation[3]=o.d/l),t.applyFilter(this,e,n,r)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var jS=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,qS=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class KS extends Ae{constructor(){super(qS,jS)}}var ZS=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class JS extends Ae{constructor(t=.5,e=Math.random()){super(tg,ZS,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Ad={AlphaFilter:NS,BlurFilter:XS,BlurFilterPass:Ol,ColorMatrixFilter:Nl,DisplacementFilter:YS,FXAAFilter:KS,NoiseFilter:JS};Object.entries(Ad).forEach(([i,t])=>{Object.defineProperty(Ad,i,{get(){return St("7.1.0",`filters.${i} has moved to ${i}`),t}})});class ms{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=ms.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Tt,this.page=new Tt,this.AT_TARGET=1,this.BUBBLING_PHASE=2,this.CAPTURING_PHASE=3,this.NONE=0,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,n){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,n,r,o){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Yo extends ms{constructor(){super(...arguments),this.client=new Tt,this.movement=new Tt,this.offset=new Tt,this.global=new Tt,this.screen=new Tt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,n,r,o,h,l,c,f,d,g,m,_,v,w){throw new Error("Method not implemented.")}}class oi extends Yo{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class kl extends Yo{constructor(){super(...arguments),this.DOM_DELTA_LINE=0,this.DOM_DELTA_PAGE=1,this.DOM_DELTA_PIXEL=2}}const QS=2048,tC=new Tt,Zh=new Tt;class eC{constructor(t){this.dispatch=new ps,this.moveOnAll=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((n,r)=>n.priority-r.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let n=0,r=e.length;n<r;n++)e[n].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){const n=this.hitTestRecursive(this.rootTarget,this.rootTarget.interactive,tC.set(t,e),this.hitTestFn,this.hitPruneFn);return n&&n[0]}propagate(t,e){if(!t.target)return;const n=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let r=0,o=n.length-1;r<o;r++)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let r=n.length-2;r>=0;r--)if(t.currentTarget=n[r],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,n=this.rootTarget){t.eventPhase=t.BUBBLING_PHASE;const r=n.children;if(r)for(let o=0;o<r.length;o++)this.all(t,e,r[o]);t.currentTarget=n,this.notifyTarget(t,e)}propagationPath(t){const e=[t];for(let n=0;n<QS&&t!==this.rootTarget;n++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestRecursive(t,e,n,r,o){if(!t||!t.visible||o(t,n))return null;if(t.interactiveChildren&&t.children){const h=t.children;for(let l=h.length-1;l>=0;l--){const c=h[l],f=this.hitTestRecursive(c,e||c.interactive,n,r,o);if(f){if(f.length>0&&!f[f.length-1].parent)continue;return(f.length>0||t.interactive)&&f.push(t),f}}}return e&&r(t,n)?t.interactive?[t]:[]:null}hitPruneFn(t,e){var n;if(t.hitArea&&(t.worldTransform.applyInverse(e,Zh),!t.hitArea.contains(Zh.x,Zh.y)))return!0;if(t._mask){const r=t._mask.isMaskData?t._mask.maskObject:t._mask;if(r&&!((n=r.containsPoint)!=null&&n.call(r,e)))return!0}return!1}hitTestFn(t,e){return t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var o,h;e=e??t.type;const n=`on${e}`;(h=(o=t.currentTarget)[n])==null||h.call(o,t);const r=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,r),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const r=e.button===2;this.dispatchEvent(e,r?"rightdown":"mousedown")}const n=this.trackingData(t.pointerId);n.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var l;if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t),n=e.pointerType==="mouse"||e.pointerType==="pen",r=this.trackingData(t.pointerId),o=this.findMountedTarget(r.overTargets);if(r.overTargets&&o!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",f=this.createPointerEvent(t,c,o);if(this.dispatchEvent(f,"pointerout"),n&&this.dispatchEvent(f,"mouseout"),!e.composedPath().includes(o)){const d=this.createPointerEvent(t,"pointerleave",o);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),n&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(f)}if(o!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",f=this.clonePointerEvent(e,c);this.dispatchEvent(f,"pointerover"),n&&this.dispatchEvent(f,"mouseover");let d=o==null?void 0:o.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const m=this.clonePointerEvent(e,"pointerenter");for(m.eventPhase=m.AT_TARGET;m.target&&m.target!==o&&m.target!==this.rootTarget.parent;)m.currentTarget=m.target,this.notifyTarget(m),n&&this.notifyTarget(m,"mouseenter"),m.target=m.target.parent;this.freeEvent(m)}this.freeEvent(f)}const h=this.moveOnAll?"all":"dispatchEvent";this[h](e,"pointermove"),e.pointerType==="touch"&&this[h](e,"touchmove"),n&&(this[h](e,"mousemove"),this.cursor=(l=e.target)==null?void 0:l.cursor),r.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var h;if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.createPointerEvent(t),r=n.pointerType==="mouse"||n.pointerType==="pen";this.dispatchEvent(n,"pointerover"),r&&this.dispatchEvent(n,"mouseover"),n.pointerType==="mouse"&&(this.cursor=(h=n.target)==null?void 0:h.cursor);const o=this.clonePointerEvent(n,"pointerenter");for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),r&&this.notifyTarget(o,"mouseenter"),o.target=o.target.parent;e.overTargets=n.composedPath(),this.freeEvent(n),this.freeEvent(o)}mapPointerOut(t){if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const n=t.pointerType==="mouse"||t.pointerType==="pen",r=this.findMountedTarget(e.overTargets),o=this.createPointerEvent(t,"pointerout",r);this.dispatchEvent(o),n&&this.dispatchEvent(o,"mouseout");const h=this.createPointerEvent(t,"pointerleave",r);for(h.eventPhase=h.AT_TARGET;h.target&&h.target!==this.rootTarget.parent;)h.currentTarget=h.target,this.notifyTarget(h),n&&this.notifyTarget(h,"mouseleave"),h.target=h.target.parent;e.overTargets=null,this.freeEvent(o),this.freeEvent(h)}this.cursor=null}mapPointerUp(t){if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),n=this.createPointerEvent(t);if(this.dispatchEvent(n,"pointerup"),n.pointerType==="touch")this.dispatchEvent(n,"touchend");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const l=n.button===2;this.dispatchEvent(n,l?"rightup":"mouseup")}const r=this.trackingData(t.pointerId),o=this.findMountedTarget(r.pressTargetsByButton[t.button]);let h=o;if(o&&!n.composedPath().includes(o)){let l=o;for(;l&&!n.composedPath().includes(l);){if(n.currentTarget=l,this.notifyTarget(n,"pointerupoutside"),n.pointerType==="touch")this.notifyTarget(n,"touchendoutside");else if(n.pointerType==="mouse"||n.pointerType==="pen"){const c=n.button===2;this.notifyTarget(n,c?"rightupoutside":"mouseupoutside")}l=l.parent}delete r.pressTargetsByButton[t.button],h=l}if(h){const l=this.clonePointerEvent(n,"click");l.target=h,l.path=null,r.clicksByButton[t.button]||(r.clicksByButton[t.button]={clickCount:0,target:l.target,timeStamp:e});const c=r.clicksByButton[t.button];c.target===l.target&&e-c.timeStamp<200?++c.clickCount:c.clickCount=1,c.target=l.target,c.timeStamp=e,l.detail=c.clickCount,l.pointerType==="mouse"?this.dispatchEvent(l,"click"):l.pointerType==="touch"&&this.dispatchEvent(l,"tap"),this.dispatchEvent(l,"pointertap"),this.freeEvent(l)}this.freeEvent(n)}mapPointerUpOutside(t){if(!(t instanceof oi)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),n=this.findMountedTarget(e.pressTargetsByButton[t.button]),r=this.createPointerEvent(t);if(n){let o=n;for(;o;)r.currentTarget=o,this.notifyTarget(r,"pointerupoutside"),r.pointerType==="touch"?this.notifyTarget(r,"touchendoutside"):(r.pointerType==="mouse"||r.pointerType==="pen")&&this.notifyTarget(r,r.button===2?"rightupoutside":"mouseupoutside"),o=o.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(r)}mapWheel(t){if(!(t instanceof kl)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let n=1;n<t.length&&t[n].parent===e;n++)e=t[n];return e}createPointerEvent(t,e,n){const r=this.allocateEvent(oi);return this.copyPointerData(t,r),this.copyMouseData(t,r),this.copyData(t,r),r.nativeEvent=t.nativeEvent,r.originalEvent=t,r.target=n??this.hitTest(r.global.x,r.global.y),typeof e=="string"&&(r.type=e),r}createWheelEvent(t){const e=this.allocateEvent(kl);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const n=this.allocateEvent(oi);return n.nativeEvent=t.nativeEvent,n.originalEvent=t.originalEvent,this.copyPointerData(t,n),this.copyMouseData(t,n),this.copyData(t,n),n.target=t.target,n.path=t.composedPath().slice(),n.type=e??n.type,n}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof oi&&e instanceof oi&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Yo&&e instanceof Yo&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const n=t.currentTarget._events[e];if(n)if("fn"in n)n.fn.call(n.context,t);else for(let r=0,o=n.length;r<o&&!t.propagationImmediatelyStopped;r++)n[r].fn.call(n[r].context,t)}}const iC=1,nC={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class ag{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new eC(null),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new oi(null),this.rootWheelEvent=new kl(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}init(){const{view:t,resolution:e}=this.renderer;this.setTargetElement(t),this.resolution=e}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.domElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.domElement.style,n);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}onPointerDown(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let n=0,r=e.length;n<r;n++){const o=e[n],h=this.bootstrapEvent(this.rootPointerEvent,o);this.rootBoundary.mapEvent(h)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,r=e.length;n<r;n++){const o=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const n=e!==this.domElement?"outside":"",r=this.normalizeToPointerData(t);for(let o=0,h=r.length;o<h;o++){const l=this.bootstrapEvent(this.rootPointerEvent,r[o]);l.type+=n,this.rootBoundary.mapEvent(l)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.supportsTouchEvents&&t.pointerType==="touch")return;const e=this.normalizeToPointerData(t);for(let n=0,r=e.length;n<r;n++){const o=this.bootstrapEvent(this.rootPointerEvent,e[n]);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0)),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,n){let r;this.domElement.parentElement?r=this.domElement.getBoundingClientRect():r={x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0};const o=1/this.resolution;t.x=(e-r.left)*(this.domElement.width/r.width)*o,t.y=(n-r.top)*(this.domElement.height/r.height)*o}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let n=0,r=t.changedTouches.length;n<r;n++){const o=t.changedTouches[n];typeof o.button>"u"&&(o.button=0),typeof o.buttons>"u"&&(o.buttons=1),typeof o.isPrimary>"u"&&(o.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof o.width>"u"&&(o.width=o.radiusX||1),typeof o.height>"u"&&(o.height=o.radiusY||1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="touch"),typeof o.pointerId>"u"&&(o.pointerId=o.identifier||0),typeof o.pressure>"u"&&(o.pressure=o.force||.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),typeof o.layerX>"u"&&(o.layerX=o.offsetX=o.clientX),typeof o.layerY>"u"&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,o.type=t.type,e.push(o)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const n=t;typeof n.isPrimary>"u"&&(n.isPrimary=!0),typeof n.width>"u"&&(n.width=1),typeof n.height>"u"&&(n.height=1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="mouse"),typeof n.pointerId>"u"&&(n.pointerId=iC),typeof n.pressure>"u"&&(n.pressure=.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),n.isNormalized=!0,e.push(n)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=nC[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}}ag.extension={name:"events",type:[q.RendererSystem,q.CanvasRendererSystem]};rt.add(ag);const rC={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,ontouchstart:null,onwheel:null,interactive:!1,interactiveChildren:!0,hitArea:null,addEventListener(i,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=n?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.on(i,t,r)},removeEventListener(i,t,e){const n=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,r=typeof t=="function"?void 0:t;i=n?`${i}capture`:i,t=typeof t=="function"?t:t.handleEvent,this.off(i,t,r)},dispatchEvent(i){if(!(i instanceof ms))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return i.defaultPrevented=!1,i.path=null,i.target=this,i.manager.dispatchEvent(i),!i.defaultPrevented}};Yt.mixin(rC);const sC={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};Yt.mixin(sC);const oC=9,bo=100,aC=0,hC=0,Sd=2,Cd=1,lC=-1e3,uC=-1e3,cC=2;class hg{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,($i.tablet||$i.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${bo}px`,e.style.height=`${bo}px`,e.style.position="absolute",e.style.top=`${aC}px`,e.style.left=`${hC}px`,e.style.zIndex=Sd.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${Cd}px`,t.style.height=`${Cd}px`,t.style.position="absolute",t.style.top=`${lC}px`,t.style.left=`${uC}px`,t.style.zIndex=cC.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}update(){const t=performance.now();if($i.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:n,width:r,height:o}=this.renderer.view.getBoundingClientRect(),{width:h,height:l,resolution:c}=this.renderer,f=r/h*c,d=o/l*c;let g=this.div;g.style.left=`${e}px`,g.style.top=`${n}px`,g.style.width=`${h}px`,g.style.height=`${l}px`;for(let m=0;m<this.children.length;m++){const _=this.children[m];if(_.renderId!==this.renderId)_._accessibleActive=!1,mr(this.children,m,1),this.div.removeChild(_._accessibleDiv),this.pool.push(_._accessibleDiv),_._accessibleDiv=null,m--;else{g=_._accessibleDiv;let v=_.hitArea;const w=_.worldTransform;_.hitArea?(g.style.left=`${(w.tx+v.x*w.a)*f}px`,g.style.top=`${(w.ty+v.y*w.d)*d}px`,g.style.width=`${v.width*w.a*f}px`,g.style.height=`${v.height*w.d*d}px`):(v=_.getBounds(),this.capHitArea(v),g.style.left=`${v.x*f}px`,g.style.top=`${v.y*d}px`,g.style.width=`${v.width*f}px`,g.style.height=`${v.height*d}px`,g.title!==_.accessibleTitle&&_.accessibleTitle!==null&&(g.title=_.accessibleTitle),g.getAttribute("aria-label")!==_.accessibleHint&&_.accessibleHint!==null&&g.setAttribute("aria-label",_.accessibleHint)),(_.accessibleTitle!==g.title||_.tabIndex!==g.tabIndex)&&(g.title=_.accessibleTitle,g.tabIndex=_.tabIndex,this.debug&&this.updateDebugHTML(g))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:n}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>n&&(t.height=n-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${bo}px`,e.style.height=`${bo}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Sd.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:n}=t.target,r=this.renderer.events.rootBoundary,o=Object.assign(new ms(r),{target:n});r.rootTarget=this.renderer.lastObjectRendered,e.forEach(h=>r.dispatchEvent(o,h))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===oC&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}hg.extension={name:"accessibility",type:[q.RendererPlugin,q.CanvasRendererPlugin]};rt.add(hg);const Ul=class{constructor(i){this.stage=new Ge,i=Object.assign({forceCanvas:!1},i),this.renderer=TS(i),Ul._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer.view}get screen(){return this.renderer.screen}destroy(i,t){const e=Ul._plugins.slice(0);e.reverse(),e.forEach(n=>{n.destroy.call(this)}),this.stage.destroy(t),this.stage=null,this.renderer.destroy(i),this.renderer=null}};let nu=Ul;nu._plugins=[];rt.handleByList(q.Application,nu._plugins);class lg{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,n;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,n=globalThis.innerHeight;else{const{clientWidth:r,clientHeight:o}=this._resizeTo;e=r,n=o}this.renderer.resize(e,n),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}lg.extension=q.Application;rt.add(lg);const Id={loader:q.LoadParser,resolver:q.ResolveParser,cache:q.CacheParser,detection:q.DetectionParser};rt.handle(q.Asset,i=>{const t=i.ref;Object.entries(Id).filter(([e])=>!!t[e]).forEach(([e,n])=>rt.add(Object.assign(t[e],{extension:t[e].extension??n})))},i=>{const t=i.ref;Object.keys(Id).filter(e=>!!t[e]).forEach(e=>rt.remove(t[e]))});class fC{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let n=0;n<e;n++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function ug(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function ha(i,t){const e=i.split("?")[0],n=_e.extname(e).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const zi=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);function cg(i,t,e,n,r){const o=t[e];for(let h=0;h<o.length;h++){const l=o[h];e<t.length-1?cg(i.replace(n[e],l),t,e+1,n,r):r.push(i.replace(n[e],l))}}function dC(i){const t=/\{(.*?)\}/g,e=i.match(t),n=[];if(e){const r=[];e.forEach(o=>{const h=o.substring(1,o.length-1).split(",");r.push(h)}),cg(i,r,0,e,n)}else n.push(i);return n}const jo=i=>!Array.isArray(i);class pC{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const n=zi(t);let r;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.test(e)){r=c.getCacheableAssets(n,e);break}}r||(r={},n.forEach(l=>{r[l]=e}));const o=Object.keys(r),h={cacheKeys:o,keys:n};if(n.forEach(l=>{this._cacheMap.set(l,h)}),o.forEach(l=>{this._cache.has(l)&&this._cache.get(l)!==e&&console.warn("[Cache] already has key:",l),this._cache.set(l,r[l])}),e instanceof nt){const l=e;n.forEach(c=>{l.baseTexture!==nt.EMPTY.baseTexture&&ft.addToCache(l.baseTexture,c),nt.addToCache(l,c)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const es=new pC;class gC{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const n={promise:null,parser:null};return n.promise=(async()=>{var o,h;let r=null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];if(c.load&&((o=c.test)!=null&&o.call(c,t,e,this))){r=await c.load(t,e,this),n.parser=c;break}}if(!n.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let l=0;l<this.parsers.length;l++){const c=this.parsers[l];c.parse&&c.parse&&await((h=c.testParse)==null?void 0:h.call(c,r,e,this))&&(r=await c.parse(r,e,this)||r,n.parser=c)}return r})(),n}async load(t,e){let n=0;const r={},o=jo(t),h=zi(t,f=>({src:f})),l=h.length,c=h.map(async f=>{const d=_e.toAbsolute(f.src);if(!r[f.src])try{this.promiseCache[d]||(this.promiseCache[d]=this._getLoadPromiseAndParser(d,f)),r[f.src]=await this.promiseCache[d].promise,e&&e(++n/l)}catch(g){throw delete this.promiseCache[d],delete r[f.src],new Error(`[Loader.load] Failed to load ${d}.
${g}`)}});return await Promise.all(c),o?r[h[0].src]:r}async unload(t){const n=zi(t,r=>({src:r})).map(async r=>{var l,c;const o=_e.toAbsolute(r.src),h=this.promiseCache[o];if(h){const f=await h.promise;(c=(l=h.parser)==null?void 0:l.unload)==null||c.call(l,f,r,this),delete this.promiseCache[o]}});await Promise.all(n)}get parsers(){return this._parsers}}var Ri=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Ri||{});const mC={extension:{type:q.LoadParser,priority:Ri.Low},test(i){return _e.extname(i).toLowerCase()===".json"},async load(i){return await(await K.ADAPTER.fetch(i)).json()}};rt.add(mC);const _C={extension:{type:q.LoadParser,priority:Ri.Low},test(i){return _e.extname(i).toLowerCase()===".txt"},async load(i){return await(await K.ADAPTER.fetch(i)).text()}};rt.add(_C);const vC=["normal","bold","100","200","300","400","500","600","700","800","900"],xC=[".ttf",".otf",".woff",".woff2"],yC=["font/ttf","font/otf","font/woff","font/woff2"];function bC(i){const t=_e.extname(i);return _e.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" ")}const wC={extension:{type:q.LoadParser,priority:Ri.Low},test(i){return ug(i,yC)||ha(i,xC)},async load(i,t){var n,r,o;if(!globalThis.navigator.onLine)throw new Error("[loadWebFont] Cannot load font - navigator is offline");const e=K.ADAPTER.getFontFaceSet();if(e){const h=[],l=((n=t.data)==null?void 0:n.family)??bC(i),c=((o=(r=t.data)==null?void 0:r.weights)==null?void 0:o.filter(d=>vC.includes(d)))??["normal"],f=t.data??{};for(let d=0;d<c.length;d++){const g=c[d],m=new FontFace(l,`url(${encodeURI(i)})`,{...f,weight:g});await m.load(),e.add(m),h.push(m)}return h.length===1?h[0]:h}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>K.ADAPTER.getFontFaceSet().delete(t))}};rt.add(wC);let Rd=0,Jh;const EC="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",TC={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${EC}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},AC={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Qh;class SC{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([TC.code],{type:"application/javascript"})),n=new Worker(e);n.addEventListener("message",r=>{n.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Jh===void 0&&(Jh=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Jh&&(Qh||(Qh=URL.createObjectURL(new Blob([AC.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Qh),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const n=new Promise((r,o)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:o})});return this.next(),n}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),n=e.id;this.resolveHash[Rd]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Rd++,id:n})}}const Pd=new SC;function la(i,t,e){const n=new nt(i);return n.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),n}const CC=[".jpeg",".jpg",".png",".webp",".avif"],IC=["image/jpeg","image/png","image/webp","image/avif"];async function RC(i){const t=await K.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const ds={extension:{type:q.LoadParser,priority:Ri.High},config:{preferWorkers:!0},test(i){return ug(i,IC)||ha(i,CC)},async load(i,t,e){let n=null;globalThis.createImageBitmap?this.config.preferWorkers&&await Pd.isImageBitmapSupported()?n=await Pd.loadImageBitmap(i):n=await RC(i):n=await new Promise(o=>{n=new Image,n.crossOrigin="anonymous",n.src=i,n.complete?o(n):n.onload=()=>{o(n)}});const r=new ft(n,{resolution:fn(i),...t.data});return r.resource.src=i,la(r,e,i)},unload(i){i.destroy(!0)}};rt.add(ds);const PC={extension:{type:q.LoadParser,priority:Ri.High},test(i){return _e.extname(i).toLowerCase()===".svg"},async testParse(i){return fs.test(i)},async parse(i,t,e){var h,l,c;const n=new fs(i,(h=t==null?void 0:t.data)==null?void 0:h.resourceOptions),r=new ft(n,{resolution:fn(i),...t==null?void 0:t.data});r.resource.src=i;const o=la(r,e,i);return(c=(l=t==null?void 0:t.data)==null?void 0:l.resourceOptions)!=null&&c.autoLoad||await n.load(),o},async load(i,t){return(await K.ADAPTER.fetch(i)).text()},unload:ds.unload};rt.add(PC);class MC{constructor(){this._bundleIdConnector="-",this._createBundleAssetId=(t,e)=>`${t}${this._bundleIdConnector}${e}`,this._extractAssetIdFromBundle=(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,""),this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this._preferredOrder=[],this._resolverHash={},this._assetMap={},this._rootPath=null,this._basePath=null,this._manifest=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(e[n])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const n=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const o=this._createBundleAssetId(t,r.name);n.push(o),this.add([r.name,o],r.srcs)}else{const o=r.name.map(h=>this._createBundleAssetId(t,h));o.forEach(h=>{n.push(h)}),this.add([...r.name,...o],r.srcs)}}):Object.keys(e).forEach(r=>{n.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=n}add(t,e,n){const r=zi(t);r.forEach(h=>{this._assetMap[h]&&console.warn(`[Resolver] already has key: ${h} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=dC(e):e=[e]);const o=e.map(h=>{let l=h;if(typeof h=="string"){let c=!1;for(let f=0;f<this._parsers.length;f++){const d=this._parsers[f];if(d.test(h)){l=d.parse(h),c=!0;break}}c||(l={src:h})}return l.format||(l.format=l.src.split(".").pop()),l.alias||(l.alias=r),(this._basePath||this._rootPath)&&(l.src=_e.toAbsolute(l.src,this._basePath,this._rootPath)),l.src=this._appendDefaultSearchParams(l.src),l.data=l.data??n,l});r.forEach(h=>{this._assetMap[h]=o})}resolveBundle(t){const e=jo(t);t=zi(t);const n={};return t.forEach(r=>{const o=this._bundles[r];if(o){const h=this.resolve(o),l={};for(const c in h){const f=h[c];l[this._extractAssetIdFromBundle(r,c)]=f}n[r]=l}}),e?n[t[0]]:n}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const n={};for(const r in e)n[r]=e[r].src;return n}return e.src}resolve(t){const e=jo(t);t=zi(t);const n={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let o=this._assetMap[r];const h=this._getPreferredOrder(o),l=o[0];h==null||h.priority.forEach(c=>{h.params[c].forEach(f=>{const d=o.filter(g=>g[c]?g[c]===f:!1);d.length&&(o=d)})}),this._resolverHash[r]=o[0]??l}else{let o=r;(this._basePath||this._rootPath)&&(o=_e.toAbsolute(o,this._basePath,this._rootPath)),o=this._appendDefaultSearchParams(o),this._resolverHash[r]={src:o}}n[r]=this._resolverHash[r]}),e?n[t[0]]:n}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const n=t[0],r=this._preferredOrder.find(o=>o.params.format.includes(n.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class DC{constructor(){this._detections=[],this._initialized=!1,this.resolver=new MC,this.loader=new gC,this.cache=es,this._backgroundLoader=new fC(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var o,h,l;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let c=t.manifest;typeof c=="string"&&(c=await this.load(c)),this.resolver.addManifest(c)}const e=((o=t.texturePreference)==null?void 0:o.resolution)??1,n=typeof e=="number"?[e]:e;let r=[];if((h=t.texturePreference)!=null&&h.format){const c=(l=t.texturePreference)==null?void 0:l.format;r=typeof c=="string"?[c]:c;for(const f of this._detections)await f.test()||(r=await f.remove(r))}else for(const c of this._detections)await c.test()&&(r=await c.add(r));this.resolver.prefer({params:{format:r,resolution:n}})}add(t,e,n){this.resolver.add(t,e,n)}async load(t,e){this._initialized||await this.init();const n=jo(t),r=zi(t).map(l=>typeof l!="string"?(this.resolver.add(l.src,l),l.src):l),o=this.resolver.resolve(r),h=await this._mapLoadToResolve(o,e);return n?h[r[0]]:h}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let n=!1;typeof t=="string"&&(n=!0,t=[t]);const r=this.resolver.resolveBundle(t),o={},h=Object.keys(r);let l=0,c=0;const f=()=>{e==null||e(++l/c)},d=h.map(g=>{const m=r[g];return c+=Object.keys(m).length,this._mapLoadToResolve(m,f).then(_=>{o[g]=_})});return await Promise.all(d),n?o[t[0]]:o}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(n=>{this._backgroundLoader.add(Object.values(n))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return es.get(t);const e={};for(let n=0;n<t.length;n++)e[n]=es.get(t[n]);return e}async _mapLoadToResolve(t,e){const n=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const o=await this.loader.load(n,e);this._backgroundLoader.active=!0;const h={};return n.forEach((l,c)=>{const f=o[l.src],d=[l.src];l.alias&&d.push(...l.alias),h[r[c]]=f,es.set(d,f)}),h}async unload(t){this._initialized||await this.init();const e=zi(t).map(r=>typeof r!="string"?r.src:r),n=this.resolver.resolve(e);await this._unloadFromResolved(n)}async unloadBundle(t){this._initialized||await this.init(),t=zi(t);const e=this.resolver.resolveBundle(t),n=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(n)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(n=>{es.remove(n.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return ds.config.preferWorkers}set preferWorkers(t){ds.config.preferWorkers=t}}const Bn=new DC;rt.handleByList(q.LoadParser,Bn.loader.parsers).handleByList(q.ResolveParser,Bn.resolver.parsers).handleByList(q.CacheParser,Bn.cache.parsers).handleByList(q.DetectionParser,Bn.detections);const BC={extension:q.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof nt),getCacheableAssets:(i,t)=>{const e={};return i.forEach(n=>{t.forEach((r,o)=>{e[n+(o===0?"":o+1)]=r})}),e}};rt.add(BC);const FC={extension:{type:q.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await K.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};rt.add(FC);const LC={extension:{type:q.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await K.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};rt.add(LC);const Md=["png","jpg","jpeg"],OC={extension:{type:q.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...Md],remove:async i=>i.filter(t=>!Md.includes(t))};rt.add(OC);const NC={extension:q.ResolveParser,test:ds.test,parse:i=>{var t;return{resolution:parseFloat(((t=K.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};rt.add(NC);var Ue=(i=>(i[i.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",i[i.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",i[i.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",i[i.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",i[i.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",i[i.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",i[i.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",i[i.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",i[i.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",i[i.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",i[i.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",i[i.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",i[i.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",i[i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",i[i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",i[i.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",i[i.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",i[i.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",i[i.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",i))(Ue||{});const qo={[33776]:.5,[33777]:.5,[33778]:1,[33779]:1,[35916]:.5,[35917]:.5,[35918]:1,[35919]:1,[37488]:.5,[37489]:.5,[37490]:1,[37491]:1,[37492]:.5,[37496]:1,[37493]:.5,[37497]:1,[37494]:.5,[37495]:.5,[35840]:.5,[35842]:.5,[35841]:.25,[35843]:.25,[36196]:.5,[35986]:.5,[35986]:1,[34798]:1,[37808]:1};let Wi,ur;function Dd(){ur={s3tc:Wi.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:Wi.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:Wi.getExtension("WEBGL_compressed_texture_etc"),etc1:Wi.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:Wi.getExtension("WEBGL_compressed_texture_pvrtc")||Wi.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:Wi.getExtension("WEBGL_compressed_texture_atc"),astc:Wi.getExtension("WEBGL_compressed_texture_astc")}}const kC={extension:{type:q.DetectionParser,priority:2},test:async()=>{const t=K.ADAPTER.createCanvas().getContext("webgl");return t?(Wi=t,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async i=>{ur||Dd();const t=[];for(const e in ur)ur[e]&&t.push(e);return[...t,...i]},remove:async i=>(ur||Dd(),i.filter(t=>!(t in ur)))};rt.add(kC);class UC extends gs{constructor(t,e={width:1,height:1,autoLoad:!0}){let n,r;typeof t=="string"?(n=t,r=new Uint8Array):(n=null,r=t),super(r,e),this.origin=n,this.buffer=r?new Sl(r):null,this.origin&&e.autoLoad!==!1&&this.load(),r!=null&&r.length&&(this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}async load(){const n=await(await(await fetch(this.origin)).blob()).arrayBuffer();return this.data=new Uint32Array(n),this.buffer=new Sl(n),this.loaded=!0,this.onBlobLoaded(n),this.update(),this}}class Nn extends UC{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Nn._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Nn._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,n){const r=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;for(let h=0,l=this.levels;h<l;h++){const{levelID:c,levelWidth:f,levelHeight:d,levelBuffer:g}=this._levelBuffers[h];r.compressedTexImage2D(r.TEXTURE_2D,c,this.format,f,d,0,g)}return!0}onBlobLoaded(){this._levelBuffers=Nn._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,n,r,o,h,l){const c=new Array(n);let f=t.byteOffset,d=h,g=l,m=d+r-1&~(r-1),_=g+o-1&~(o-1),v=m*_*qo[e];for(let w=0;w<n;w++)c[w]={levelID:w,levelWidth:n>1?d:m,levelHeight:n>1?g:_,levelBuffer:new Uint8Array(t.buffer,f,v)},f+=v,d=d>>1||1,g=g>>1||1,m=d+r-1&~(r-1),_=g+o-1&~(o-1),v=m*_*qo[e];return c}}const tl=4,wo=124,GC=32,Bd=20,WC=542327876,Eo={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},HC={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},To={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},XC=1,$C=2,zC=4,VC=64,YC=512,jC=131072,qC=827611204,KC=861165636,ZC=894720068,JC=808540228,QC=4,tI={[qC]:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,[KC]:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,[ZC]:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT},eI={[70]:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,[71]:Ue.COMPRESSED_RGBA_S3TC_DXT1_EXT,[73]:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,[74]:Ue.COMPRESSED_RGBA_S3TC_DXT3_EXT,[76]:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,[77]:Ue.COMPRESSED_RGBA_S3TC_DXT5_EXT,[72]:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,[75]:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,[78]:Ue.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function iI(i){const t=new Uint32Array(i);if(t[0]!==WC)throw new Error("Invalid DDS file magic word");const n=new Uint32Array(i,0,wo/Uint32Array.BYTES_PER_ELEMENT),r=n[Eo.HEIGHT],o=n[Eo.WIDTH],h=n[Eo.MIPMAP_COUNT],l=new Uint32Array(i,Eo.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,GC/Uint32Array.BYTES_PER_ELEMENT),c=l[XC];if(c&zC){const f=l[HC.FOURCC];if(f!==JC){const A=tI[f],I=tl+wo,D=new Uint8Array(i,I);return[new Nn(D,{format:A,width:o,height:r,levels:h})]}const d=tl+wo,g=new Uint32Array(t.buffer,d,Bd/Uint32Array.BYTES_PER_ELEMENT),m=g[To.DXGI_FORMAT],_=g[To.RESOURCE_DIMENSION],v=g[To.MISC_FLAG],w=g[To.ARRAY_SIZE],y=eI[m];if(y===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${m}`);if(v===QC)throw new Error("DDSParser does not support cubemap textures");if(_===6)throw new Error("DDSParser does not supported 3D texture data");const T=new Array,S=tl+wo+Bd;if(w===1)T.push(new Uint8Array(i,S));else{const A=qo[y];let I=0,D=o,N=r;for(let F=0;F<h;F++){const V=Math.max(1,D+3&-4),J=Math.max(1,N+3&-4),z=V*J*A;I+=z,D=D>>>1,N=N>>>1}let L=S;for(let F=0;F<w;F++)T.push(new Uint8Array(i,L,I)),L+=I}return T.map(A=>new Nn(A,{format:y,width:o,height:r,levels:h}))}throw c&VC?new Error("DDSParser does not support uncompressed texture data."):c&YC?new Error("DDSParser does not supported YUV uncompressed texture data."):c&jC?new Error("DDSParser does not support single-channel (lumninance) texture data!"):c&$C?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const Fd=[171,75,84,88,32,49,49,187,13,10,26,10],nI=67305985,ri={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Gl=64,Ld={[st.UNSIGNED_BYTE]:1,[st.UNSIGNED_SHORT]:2,[st.INT]:4,[st.UNSIGNED_INT]:4,[st.FLOAT]:4,[st.HALF_FLOAT]:8},rI={[$.RGBA]:4,[$.RGB]:3,[$.RG]:2,[$.RED]:1,[$.LUMINANCE]:1,[$.LUMINANCE_ALPHA]:2,[$.ALPHA]:1},sI={[st.UNSIGNED_SHORT_4_4_4_4]:2,[st.UNSIGNED_SHORT_5_5_5_1]:2,[st.UNSIGNED_SHORT_5_6_5]:2};function oI(i,t,e=!1){const n=new DataView(t);if(!aI(i,n))return null;const r=n.getUint32(ri.ENDIANNESS,!0)===nI,o=n.getUint32(ri.GL_TYPE,r),h=n.getUint32(ri.GL_FORMAT,r),l=n.getUint32(ri.GL_INTERNAL_FORMAT,r),c=n.getUint32(ri.PIXEL_WIDTH,r),f=n.getUint32(ri.PIXEL_HEIGHT,r)||1,d=n.getUint32(ri.PIXEL_DEPTH,r)||1,g=n.getUint32(ri.NUMBER_OF_ARRAY_ELEMENTS,r)||1,m=n.getUint32(ri.NUMBER_OF_FACES,r),_=n.getUint32(ri.NUMBER_OF_MIPMAP_LEVELS,r),v=n.getUint32(ri.BYTES_OF_KEY_VALUE_DATA,r);if(f===0||d!==1)throw new Error("Only 2D textures are supported");if(m!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(g!==1)throw new Error("WebGL does not support array textures");const w=4,y=4,T=c+3&-4,S=f+3&-4,A=new Array(g);let I=c*f;o===0&&(I=T*S);let D;if(o!==0?Ld[o]?D=Ld[o]*rI[h]:D=sI[o]:D=qo[l],D===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const N=e?lI(n,v,r):null;let F=I*D,V=c,J=f,z=T,Q=S,X=Gl+v;for(let G=0;G<_;G++){const dt=n.getUint32(X,r);let _t=X+4;for(let j=0;j<g;j++){let vt=A[j];vt||(vt=A[j]=new Array(_)),vt[G]={levelID:G,levelWidth:_>1||o!==0?V:z,levelHeight:_>1||o!==0?J:Q,levelBuffer:new Uint8Array(t,_t,F)},_t+=F}X+=dt+4,X=X%4!==0?X+4-X%4:X,V=V>>1||1,J=J>>1||1,z=V+w-1&~(w-1),Q=J+y-1&~(y-1),F=z*Q*D}return o!==0?{uncompressed:A.map(G=>{let dt=G[0].levelBuffer,_t=!1;return o===st.FLOAT?dt=new Float32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4):o===st.UNSIGNED_INT?(_t=!0,dt=new Uint32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)):o===st.INT&&(_t=!0,dt=new Int32Array(G[0].levelBuffer.buffer,G[0].levelBuffer.byteOffset,G[0].levelBuffer.byteLength/4)),{resource:new gs(dt,{width:G[0].levelWidth,height:G[0].levelHeight}),type:o,format:_t?hI(h):h}}),kvData:N}:{compressed:A.map(G=>new Nn(null,{format:l,width:c,height:f,levels:_,levelBuffers:G})),kvData:N}}function aI(i,t){for(let e=0;e<Fd.length;e++)if(t.getUint8(e)!==Fd[e])return console.error(`${i} is not a valid *.ktx file!`),!1;return!0}function hI(i){switch(i){case $.RGBA:return $.RGBA_INTEGER;case $.RGB:return $.RGB_INTEGER;case $.RG:return $.RG_INTEGER;case $.RED:return $.RED_INTEGER;default:return i}}function lI(i,t,e){const n=new Map;let r=0;for(;r<t;){const o=i.getUint32(Gl+r,e),h=Gl+r+4,l=3-(o+3)%4;if(o===0||o>t-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let c=0;for(;c<o&&i.getUint8(h+c)!==0;c++);if(c===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const f=new TextDecoder().decode(new Uint8Array(i.buffer,h,c)),d=new DataView(i.buffer,h+c+1,o-c-1);n.set(f,d),r+=4+o+l}return n}const uI={extension:{type:q.LoadParser,priority:Ri.High},test(i){return ha(i,".dds")},async load(i,t,e){const r=await(await K.ADAPTER.fetch(i)).arrayBuffer(),h=iI(r).map(l=>{const c=new ft(l,{mipmap:Ci.OFF,alphaMode:gi.NO_PREMULTIPLIED_ALPHA,resolution:fn(i),...t.data});return la(c,e,i)});return h.length===1?h[0]:h},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};rt.add(uI);const cI={extension:{type:q.LoadParser,priority:Ri.High},test(i){return ha(i,".ktx")},async load(i,t,e){const r=await(await K.ADAPTER.fetch(i)).arrayBuffer(),{compressed:o,uncompressed:h,kvData:l}=oI(i,r),c=o??h,f={mipmap:Ci.OFF,alphaMode:gi.NO_PREMULTIPLIED_ALPHA,resolution:fn(i),...t.data},d=c.map(g=>{c===h&&Object.assign(f,{type:g.type,format:g.format});const m=new ft(g,f);return m.ktxKeyValueData=l,la(m,e,i)});return d.length===1?d[0]:d},unload(i){Array.isArray(i)?i.forEach(t=>t.destroy(!0)):i.destroy(!0)}};rt.add(cI);const fI={extension:q.ResolveParser,test:i=>{const e=i.split("?")[0].split(".").pop();return["basis","ktx","dds"].includes(e)},parse:i=>{var n,r;if(i.split("?")[0].split(".").pop()==="ktx"){const o=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(o.some(h=>i.endsWith(h)))return{resolution:parseFloat(((n=K.RETINA_PREFIX.exec(i))==null?void 0:n[1])??"1"),format:o.find(h=>i.endsWith(h)),src:i}}return{resolution:parseFloat(((r=K.RETINA_PREFIX.exec(i))==null?void 0:r[1])??"1"),format:i.split(".").pop(),src:i}}};rt.add(fI);const Od=new wt,Nd=4,Wl=class{constructor(i){this.renderer=i}async image(i,t,e){const n=new Image;return n.src=await this.base64(i,t,e),n}async base64(i,t,e){const n=this.canvas(i);if(n.toDataURL!==void 0)return n.toDataURL(t,e);if(n.convertToBlob!==void 0){const r=await n.convertToBlob({type:t,quality:e});return await new Promise(o=>{const h=new FileReader;h.onload=()=>o(h.result),h.readAsDataURL(r)})}throw new Error("Extract.base64() requires ICanvas.toDataURL or ICanvas.convertToBlob to be implemented")}canvas(i,t){const e=this.renderer;let n,r=!1,o,h=!1;i&&(i instanceof gn?o=i:(o=this.renderer.generateTexture(i),h=!0)),o?(n=o.baseTexture.resolution,t=t??o.frame,r=!1,e.renderTexture.bind(o)):(n=e.resolution,t||(t=Od,t.width=e.width,t.height=e.height),r=!0,e.renderTexture.bind(null));const l=Math.round(t.width*n),c=Math.round(t.height*n);let f=new cd(l,c,1);const d=new Uint8Array(Nd*l*c),g=e.gl;g.readPixels(Math.round(t.x*n),Math.round(t.y*n),l,c,g.RGBA,g.UNSIGNED_BYTE,d);const m=f.context.getImageData(0,0,l,c);if(Wl.arrayPostDivide(d,m.data),f.context.putImageData(m,0,0),r){const _=new cd(f.width,f.height,1);_.context.scale(1,-1),_.context.drawImage(f.canvas,0,-c),f.destroy(),f=_}return h&&o.destroy(!0),f.canvas}pixels(i,t){const e=this.renderer;let n,r,o=!1;i&&(i instanceof gn?r=i:(r=this.renderer.generateTexture(i),o=!0)),r?(n=r.baseTexture.resolution,t=t??r.frame,e.renderTexture.bind(r)):(n=e.resolution,t||(t=Od,t.width=e.width,t.height=e.height),e.renderTexture.bind(null));const h=Math.round(t.width*n),l=Math.round(t.height*n),c=new Uint8Array(Nd*h*l),f=e.gl;return f.readPixels(Math.round(t.x*n),Math.round(t.y*n),h,l,f.RGBA,f.UNSIGNED_BYTE,c),o&&r.destroy(!0),Wl.arrayPostDivide(c,c),c}destroy(){this.renderer=null}static arrayPostDivide(i,t){for(let e=0;e<i.length;e+=4){const n=t[e+3]=i[e+3];n!==0?(t[e]=Math.round(Math.min(i[e]*255/n,255)),t[e+1]=Math.round(Math.min(i[e+1]*255/n,255)),t[e+2]=Math.round(Math.min(i[e+2]*255/n,255))):(t[e]=i[e],t[e+1]=i[e+1],t[e+2]=i[e+2])}}};let fg=Wl;fg.extension={name:"extract",type:q.RendererSystem};rt.add(fg);const Ko={build(i){const t=i.points;let e,n,r,o,h,l;if(i.type===pe.CIRC){const v=i.shape;e=v.x,n=v.y,h=l=v.radius,r=o=0}else if(i.type===pe.ELIP){const v=i.shape;e=v.x,n=v.y,h=v.width,l=v.height,r=o=0}else{const v=i.shape,w=v.width/2,y=v.height/2;e=v.x+w,n=v.y+y,h=l=Math.max(0,Math.min(v.radius,Math.min(w,y))),r=w-h,o=y-l}if(!(h>=0&&l>=0&&r>=0&&o>=0)){t.length=0;return}const c=Math.ceil(2.3*Math.sqrt(h+l)),f=c*8+(r?4:0)+(o?4:0);if(t.length=f,f===0)return;if(c===0){t.length=8,t[0]=t[6]=e+r,t[1]=t[3]=n+o,t[2]=t[4]=e-r,t[5]=t[7]=n-o;return}let d=0,g=c*4+(r?2:0)+2,m=g,_=f;{const v=r+h,w=o,y=e+v,T=e-v,S=n+w;if(t[d++]=y,t[d++]=S,t[--g]=S,t[--g]=T,o){const A=n-w;t[m++]=T,t[m++]=A,t[--_]=A,t[--_]=y}}for(let v=1;v<c;v++){const w=Math.PI/2*(v/c),y=r+Math.cos(w)*h,T=o+Math.sin(w)*l,S=e+y,A=e-y,I=n+T,D=n-T;t[d++]=S,t[d++]=I,t[--g]=I,t[--g]=A,t[m++]=A,t[m++]=D,t[--_]=D,t[--_]=S}{const v=r,w=o+l,y=e+v,T=e-v,S=n+w,A=n-w;t[d++]=y,t[d++]=S,t[--_]=A,t[--_]=y,r&&(t[d++]=T,t[d++]=S,t[--_]=A,t[--_]=T)}},triangulate(i,t){const e=i.points,n=t.points,r=t.indices;if(e.length===0)return;let o=n.length/2;const h=o;let l,c;if(i.type!==pe.RREC){const d=i.shape;l=d.x,c=d.y}else{const d=i.shape;l=d.x+d.width/2,c=d.y+d.height/2}const f=i.matrix;n.push(i.matrix?f.a*l+f.c*c+f.tx:l,i.matrix?f.b*l+f.d*c+f.ty:c),o++,n.push(e[0],e[1]);for(let d=2;d<e.length;d+=2)n.push(e[d],e[d+1]),r.push(o++,h,o);r.push(h+1,h,o)}};function kd(i,t=!1){const e=i.length;if(e<6)return;let n=0;for(let r=0,o=i[e-2],h=i[e-1];r<e;r+=2){const l=i[r],c=i[r+1];n+=(l-o)*(c+h),o=l,h=c}if(!t&&n>0||t&&n<=0){const r=e/2;for(let o=r+r%2;o<e;o+=2){const h=e-o-2,l=e-o-1,c=o,f=o+1;[i[h],i[c]]=[i[c],i[h]],[i[l],i[f]]=[i[f],i[l]]}}}const dg={build(i){i.points=i.shape.points.slice()},triangulate(i,t){let e=i.points;const n=i.holes,r=t.points,o=t.indices;if(e.length>=6){kd(e,!1);const h=[];for(let f=0;f<n.length;f++){const d=n[f];kd(d.points,!0),h.push(e.length/2),e=e.concat(d.points)}const l=ql.exports(e,h,2);if(!l)return;const c=r.length/2;for(let f=0;f<l.length;f+=3)o.push(l[f]+c),o.push(l[f+1]+c),o.push(l[f+2]+c);for(let f=0;f<e.length;f++)r.push(e[f])}}},dI={build(i){const t=i.shape,e=t.x,n=t.y,r=t.width,o=t.height,h=i.points;h.length=0,r>=0&&o>=0&&h.push(e,n,e+r,n,e+r,n+o,e,n+o)},triangulate(i,t){const e=i.points,n=t.points;if(e.length===0)return;const r=n.length/2;n.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},pI={build(i){Ko.build(i)},triangulate(i,t){Ko.triangulate(i,t)}};var an=(i=>(i.MITER="miter",i.BEVEL="bevel",i.ROUND="round",i))(an||{}),Fn=(i=>(i.BUTT="butt",i.ROUND="round",i.SQUARE="square",i))(Fn||{});const yr={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(i,t=20){if(!this.adaptive||!i||isNaN(i))return t;let e=Math.ceil(i/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class Ud{static curveTo(t,e,n,r,o,h){const l=h[h.length-2],f=h[h.length-1]-e,d=l-t,g=r-e,m=n-t,_=Math.abs(f*m-d*g);if(_<1e-8||o===0)return(h[h.length-2]!==t||h[h.length-1]!==e)&&h.push(t,e),null;const v=f*f+d*d,w=g*g+m*m,y=f*g+d*m,T=o*Math.sqrt(v)/_,S=o*Math.sqrt(w)/_,A=T*y/v,I=S*y/w,D=T*m+S*d,N=T*g+S*f,L=d*(S+A),F=f*(S+A),V=m*(T+I),J=g*(T+I),z=Math.atan2(F-N,L-D),Q=Math.atan2(J-N,V-D);return{cx:D+t,cy:N+e,radius:o,startAngle:z,endAngle:Q,anticlockwise:d*g>m*f}}static arc(t,e,n,r,o,h,l,c,f){const d=l-h,g=yr._segmentsCount(Math.abs(d)*o,Math.ceil(Math.abs(d)/zo)*40),m=d/(g*2),_=m*2,v=Math.cos(m),w=Math.sin(m),y=g-1,T=y%1/y;for(let S=0;S<=y;++S){const A=S+T*S,I=m+h+_*A,D=Math.cos(I),N=-Math.sin(I);f.push((v*D+w*N)*o+n,(v*-N+w*D)*o+r)}}}class gI{constructor(){this.reset()}begin(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class ru{static curveLength(t,e,n,r,o,h,l,c){let d=0,g=0,m=0,_=0,v=0,w=0,y=0,T=0,S=0,A=0,I=0,D=t,N=e;for(let L=1;L<=10;++L)g=L/10,m=g*g,_=m*g,v=1-g,w=v*v,y=w*v,T=y*t+3*w*g*n+3*v*m*o+_*l,S=y*e+3*w*g*r+3*v*m*h+_*c,A=D-T,I=N-S,D=T,N=S,d+=Math.sqrt(A*A+I*I);return d}static curveTo(t,e,n,r,o,h,l){const c=l[l.length-2],f=l[l.length-1];l.length-=2;const d=yr._segmentsCount(ru.curveLength(c,f,t,e,n,r,o,h));let g=0,m=0,_=0,v=0,w=0;l.push(c,f);for(let y=1,T=0;y<=d;++y)T=y/d,g=1-T,m=g*g,_=m*g,v=T*T,w=v*T,l.push(_*c+3*m*T*t+3*g*v*n+w*o,_*f+3*m*T*e+3*g*v*r+w*h)}}function Gd(i,t,e,n,r,o,h,l){const c=i-e*r,f=t-n*r,d=i+e*o,g=t+n*o;let m,_;h?(m=n,_=-e):(m=-n,_=e);const v=c+m,w=f+_,y=d+m,T=g+_;return l.push(v,w),l.push(y,T),2}function In(i,t,e,n,r,o,h,l){const c=e-i,f=n-t;let d=Math.atan2(c,f),g=Math.atan2(r-i,o-t);l&&d<g?d+=Math.PI*2:!l&&d>g&&(g+=Math.PI*2);let m=d;const _=g-d,v=Math.abs(_),w=Math.sqrt(c*c+f*f),y=(15*v*Math.sqrt(w)/Math.PI>>0)+1,T=_/y;if(m+=T,l){h.push(i,t),h.push(e,n);for(let S=1,A=m;S<y;S++,A+=T)h.push(i,t),h.push(i+Math.sin(A)*w,t+Math.cos(A)*w);h.push(i,t),h.push(r,o)}else{h.push(e,n),h.push(i,t);for(let S=1,A=m;S<y;S++,A+=T)h.push(i+Math.sin(A)*w,t+Math.cos(A)*w),h.push(i,t);h.push(r,o),h.push(i,t)}return y*2}function mI(i,t){const e=i.shape;let n=i.points||e.points.slice();const r=t.closePointEps;if(n.length===0)return;const o=i.lineStyle,h=new Tt(n[0],n[1]),l=new Tt(n[n.length-2],n[n.length-1]),c=e.type!==pe.POLY||e.closeStroke,f=Math.abs(h.x-l.x)<r&&Math.abs(h.y-l.y)<r;if(c){n=n.slice(),f&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const j=(h.x+l.x)*.5,vt=(l.y+h.y)*.5;n.unshift(j,vt),n.push(j,vt)}const d=t.points,g=n.length/2;let m=n.length;const _=d.length/2,v=o.width/2,w=v*v,y=o.miterLimit*o.miterLimit;let T=n[0],S=n[1],A=n[2],I=n[3],D=0,N=0,L=-(S-I),F=T-A,V=0,J=0,z=Math.sqrt(L*L+F*F);L/=z,F/=z,L*=v,F*=v;const Q=o.alignment,X=(1-Q)*2,G=Q*2;c||(o.cap===Fn.ROUND?m+=In(T-L*(X-G)*.5,S-F*(X-G)*.5,T-L*X,S-F*X,T+L*G,S+F*G,d,!0)+2:o.cap===Fn.SQUARE&&(m+=Gd(T,S,L,F,X,G,!0,d))),d.push(T-L*X,S-F*X),d.push(T+L*G,S+F*G);for(let j=1;j<g-1;++j){T=n[(j-1)*2],S=n[(j-1)*2+1],A=n[j*2],I=n[j*2+1],D=n[(j+1)*2],N=n[(j+1)*2+1],L=-(S-I),F=T-A,z=Math.sqrt(L*L+F*F),L/=z,F/=z,L*=v,F*=v,V=-(I-N),J=A-D,z=Math.sqrt(V*V+J*J),V/=z,J/=z,V*=v,J*=v;const vt=A-T,Wt=S-I,H=A-D,it=N-I,yt=vt*H+Wt*it,Rt=Wt*H-it*vt,Mt=Rt<0;if(Math.abs(Rt)<.001*Math.abs(yt)){d.push(A-L*X,I-F*X),d.push(A+L*G,I+F*G),yt>=0&&(o.join===an.ROUND?m+=In(A,I,A-L*X,I-F*X,A-V*X,I-J*X,d,!1)+4:m+=2,d.push(A-V*G,I-J*G),d.push(A+V*X,I+J*X));continue}const Ot=(-L+T)*(-F+I)-(-L+A)*(-F+S),Nt=(-V+D)*(-J+I)-(-V+A)*(-J+N),ie=(vt*Nt-H*Ot)/Rt,jt=(it*Ot-Wt*Nt)/Rt,ne=(ie-A)*(ie-A)+(jt-I)*(jt-I),se=A+(ie-A)*X,Dt=I+(jt-I)*X,kt=A-(ie-A)*G,qt=I-(jt-I)*G,Kt=Math.min(vt*vt+Wt*Wt,H*H+it*it),ve=Mt?X:G,mn=Kt+ve*ve*w;ne<=mn?o.join===an.BEVEL||ne/w>y?(Mt?(d.push(se,Dt),d.push(A+L*G,I+F*G),d.push(se,Dt),d.push(A+V*G,I+J*G)):(d.push(A-L*X,I-F*X),d.push(kt,qt),d.push(A-V*X,I-J*X),d.push(kt,qt)),m+=2):o.join===an.ROUND?Mt?(d.push(se,Dt),d.push(A+L*G,I+F*G),m+=In(A,I,A+L*G,I+F*G,A+V*G,I+J*G,d,!0)+4,d.push(se,Dt),d.push(A+V*G,I+J*G)):(d.push(A-L*X,I-F*X),d.push(kt,qt),m+=In(A,I,A-L*X,I-F*X,A-V*X,I-J*X,d,!1)+4,d.push(A-V*X,I-J*X),d.push(kt,qt)):(d.push(se,Dt),d.push(kt,qt)):(d.push(A-L*X,I-F*X),d.push(A+L*G,I+F*G),o.join===an.ROUND?Mt?m+=In(A,I,A+L*G,I+F*G,A+V*G,I+J*G,d,!0)+2:m+=In(A,I,A-L*X,I-F*X,A-V*X,I-J*X,d,!1)+2:o.join===an.MITER&&ne/w<=y&&(Mt?(d.push(kt,qt),d.push(kt,qt)):(d.push(se,Dt),d.push(se,Dt)),m+=2),d.push(A-V*X,I-J*X),d.push(A+V*G,I+J*G),m+=2)}T=n[(g-2)*2],S=n[(g-2)*2+1],A=n[(g-1)*2],I=n[(g-1)*2+1],L=-(S-I),F=T-A,z=Math.sqrt(L*L+F*F),L/=z,F/=z,L*=v,F*=v,d.push(A-L*X,I-F*X),d.push(A+L*G,I+F*G),c||(o.cap===Fn.ROUND?m+=In(A-L*(X-G)*.5,I-F*(X-G)*.5,A-L*X,I-F*X,A+L*G,I+F*G,d,!1)+2:o.cap===Fn.SQUARE&&(m+=Gd(A,I,L,F,X,G,!1,d)));const dt=t.indices,_t=yr.epsilon*yr.epsilon;for(let j=_;j<m+_-2;++j)T=d[j*2],S=d[j*2+1],A=d[(j+1)*2],I=d[(j+1)*2+1],D=d[(j+2)*2],N=d[(j+2)*2+1],!(Math.abs(T*(I-N)+A*(N-S)+D*(S-I))<_t)&&dt.push(j,j+1,j+2)}function _I(i,t){let e=0;const n=i.shape,r=i.points||n.points,o=n.type!==pe.POLY||n.closeStroke;if(r.length===0)return;const h=t.points,l=t.indices,c=r.length/2,f=h.length/2;let d=f;for(h.push(r[0],r[1]),e=1;e<c;e++)h.push(r[e*2],r[e*2+1]),l.push(d,d+1),d++;o&&l.push(d,f)}function Wd(i,t){i.lineStyle.native?_I(i,t):mI(i,t)}class su{static curveLength(t,e,n,r,o,h){const l=t-2*n+o,c=e-2*r+h,f=2*n-2*t,d=2*r-2*e,g=4*(l*l+c*c),m=4*(l*f+c*d),_=f*f+d*d,v=2*Math.sqrt(g+m+_),w=Math.sqrt(g),y=2*g*w,T=2*Math.sqrt(_),S=m/w;return(y*v+w*m*(v-T)+(4*_*g-m*m)*Math.log((2*w+S+v)/(S+T)))/(4*y)}static curveTo(t,e,n,r,o){const h=o[o.length-2],l=o[o.length-1],c=yr._segmentsCount(su.curveLength(h,l,t,e,n,r));let f=0,d=0;for(let g=1;g<=c;++g){const m=g/c;f=h+(t-h)*m,d=l+(e-l)*m,o.push(f+(t+(n-t)*m-f)*m,d+(e+(r-e)*m-d)*m)}}}const el={[pe.POLY]:dg,[pe.CIRC]:Ko,[pe.ELIP]:Ko,[pe.RECT]:dI,[pe.RREC]:pI},Hd=[],Ao=[];class Zo{constructor(t,e=null,n=null,r=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=r,this.type=t.type}clone(){return new Zo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const or=new Tt,pg=class extends vp{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Vo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let i=0;i<this.drawCalls.length;i++)this.drawCalls[i].texArray.clear(),Ao.push(this.drawCalls[i]);this.drawCalls.length=0;for(let i=0;i<this.batches.length;i++){const t=this.batches[i];t.reset(),Hd.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(i,t=null,e=null,n=null){const r=new Zo(i,t,e,n);return this.graphicsData.push(r),this.dirty++,this}drawHole(i,t=null){if(!this.graphicsData.length)return null;const e=new Zo(i,null,null,t),n=this.graphicsData[this.graphicsData.length-1];return e.lineStyle=n.lineStyle,n.holes.push(e),this.dirty++,this}destroy(){super.destroy();for(let i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(i){const t=this.graphicsData;for(let e=0;e<t.length;++e){const n=t[e];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(i,or):or.copyFrom(i),n.shape.contains(or.x,or.y))){let r=!1;if(n.holes){for(let o=0;o<n.holes.length;o++)if(n.holes[o].shape.contains(or.x,or.y)){r=!0;break}}if(!r)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const i=this.uvs,t=this.graphicsData;let e=null,n=null;this.batches.length>0&&(e=this.batches[this.batches.length-1],n=e.style);for(let l=this.shapeIndex;l<t.length;l++){this.shapeIndex++;const c=t[l],f=c.fillStyle,d=c.lineStyle;el[c.type].build(c),c.matrix&&this.transformPoints(c.points,c.matrix),(f.visible||d.visible)&&this.processHoles(c.holes);for(let m=0;m<2;m++){const _=m===0?f:d;if(!_.visible)continue;const v=_.texture.baseTexture,w=this.indices.length,y=this.points.length/2;v.wrapMode=cn.REPEAT,m===0?this.processFill(c):this.processLine(c);const T=this.points.length/2-y;T!==0&&(e&&!this._compareStyles(n,_)&&(e.end(w,y),e=null),e||(e=Hd.pop()||new gI,e.begin(_,w,y),this.batches.push(e),n=_),this.addUvs(this.points,i,_.texture,y,T,_.matrix))}}const r=this.indices.length,o=this.points.length/2;if(e&&e.end(r,o),this.batches.length===0){this.batchable=!0;return}const h=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&h===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=h?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(i,t){return!(!i||!t||i.texture.baseTexture!==t.texture.baseTexture||i.color+i.alpha!==t.color+t.alpha||!!i.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let i=0,t=this.graphicsData.length;i<t;i++){const e=this.graphicsData[i],n=e.fillStyle,r=e.lineStyle;if(n&&!n.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const i=this.batches;for(let t=0,e=i.length;t<e;t++){const n=i[t];for(let r=0;r<n.size;r++){const o=n.start+r;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const i=this.batches;for(let t=0;t<i.length;t++)if(i[t].style.native)return!1;return this.points.length<pg.BATCHABLE_SIZE*2}buildDrawCalls(){let i=++ft._globalBatch;for(let d=0;d<this.drawCalls.length;d++)this.drawCalls[d].texArray.clear(),Ao.push(this.drawCalls[d]);this.drawCalls.length=0;const t=this.colors,e=this.textureIds;let n=Ao.pop();n||(n=new Il,n.texArray=new Pl),n.texArray.count=0,n.start=0,n.size=0,n.type=Ti.TRIANGLES;let r=0,o=null,h=0,l=!1,c=Ti.TRIANGLES,f=0;this.drawCalls.push(n);for(let d=0;d<this.batches.length;d++){const g=this.batches[d],m=8,_=g.style,v=_.texture.baseTexture;l!==!!_.native&&(l=!!_.native,c=l?Ti.LINES:Ti.TRIANGLES,o=null,r=m,i++),o!==v&&(o=v,v._batchEnabled!==i&&(r===m&&(i++,r=0,n.size>0&&(n=Ao.pop(),n||(n=new Il,n.texArray=new Pl),this.drawCalls.push(n)),n.start=f,n.size=0,n.texArray.count=0,n.type=c),v.touched=1,v._batchEnabled=i,v._batchLocation=r,v.wrapMode=cn.REPEAT,n.texArray.elements[n.texArray.count++]=v,r++)),n.size+=g.size,f+=g.size,h=v._batchLocation,this.addColors(t,_.color,_.alpha,g.attribSize,g.attribStart),this.addTextureIds(e,h,g.attribSize,g.attribStart)}ft._globalBatch=i,this.packAttributes()}packAttributes(){const i=this.points,t=this.uvs,e=this.colors,n=this.textureIds,r=new ArrayBuffer(i.length*3*4),o=new Float32Array(r),h=new Uint32Array(r);let l=0;for(let c=0;c<i.length/2;c++)o[l++]=i[c*2],o[l++]=i[c*2+1],o[l++]=t[c*2],o[l++]=t[c*2+1],h[l++]=e[c],o[l++]=n[c];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)}processFill(i){i.holes.length?dg.triangulate(i,this):el[i.type].triangulate(i,this)}processLine(i){Wd(i,this);for(let t=0;t<i.holes.length;t++)Wd(i.holes[t],this)}processHoles(i){for(let t=0;t<i.length;t++){const e=i[t];el[e.type].build(e),e.matrix&&this.transformPoints(e.points,e.matrix)}}calculateBounds(){const i=this._bounds;i.clear(),i.addVertexData(this.points,0,this.points.length),i.pad(this.boundsPadding,this.boundsPadding)}transformPoints(i,t){for(let e=0;e<i.length/2;e++){const n=i[e*2],r=i[e*2+1];i[e*2]=t.a*n+t.c*r+t.tx,i[e*2+1]=t.b*n+t.d*r+t.ty}}addColors(i,t,e,n,r=0){const o=(t>>16)+(t&65280)+((t&255)<<16),h=Zl(o,e);i.length=Math.max(i.length,r+n);for(let l=0;l<n;l++)i[r+l]=h}addTextureIds(i,t,e,n=0){i.length=Math.max(i.length,n+e);for(let r=0;r<e;r++)i[n+r]=t}addUvs(i,t,e,n,r,o=null){let h=0;const l=t.length,c=e.frame;for(;h<r;){let d=i[(n+h)*2],g=i[(n+h)*2+1];if(o){const m=o.a*d+o.c*g+o.tx;g=o.b*d+o.d*g+o.ty,d=m}h++,t.push(d/c.width,g/c.height)}const f=e.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(t,e,l,r)}adjustUvs(i,t,e,n){const r=t.baseTexture,o=1e-6,h=e+n*2,l=t.frame,c=l.width/r.width,f=l.height/r.height;let d=l.x/l.width,g=l.y/l.height,m=Math.floor(i[e]+o),_=Math.floor(i[e+1]+o);for(let v=e+2;v<h;v+=2)m=Math.min(m,Math.floor(i[v]+o)),_=Math.min(_,Math.floor(i[v+1]+o));d-=m,g-=_;for(let v=e;v<h;v+=2)i[v]=(i[v]+d)*c,i[v+1]=(i[v+1]+g)*f}};let gg=pg;gg.BATCHABLE_SIZE=100;class ua{constructor(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new ua;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=nt.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class ou extends ua{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Fn.BUTT,this.join=an.MITER,this.miterLimit=10}clone(){const t=new ou;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1}}const vI=new Float32Array(3),il={},No=class extends Ge{constructor(i=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ua,this._lineStyle=new ou,this._matrix=null,this._holeMode=!1,this.state=qi.for2d(),this._geometry=i||new gg,this._geometry.refCount++,this._transformID=-1,this.tint=16777215,this.blendMode=lt.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new No(this._geometry)}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}get tint(){return this._tint}set tint(i){this._tint=i}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(i=null,t=0,e=1,n=.5,r=!1){return typeof i=="number"&&(i={width:i,color:t,alpha:e,alignment:n,native:r}),this.lineTextureStyle(i)}lineTextureStyle(i){i=Object.assign({width:0,texture:nt.WHITE,color:i!=null&&i.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Fn.BUTT,join:an.MITER,miterLimit:10},i),this.currentPath&&this.startPoly();const t=i.width>0&&i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._lineStyle,{visible:t},i)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const i=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new _r,this.currentPath.closeStroke=!1,this.currentPath.points.push(i[t-2],i[t-1]))}else this.currentPath=new _r,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(i,t){return this.startPoly(),this.currentPath.points[0]=i,this.currentPath.points[1]=t,this}lineTo(i,t){this.currentPath||this.moveTo(0,0);const e=this.currentPath.points,n=e[e.length-2],r=e[e.length-1];return(n!==i||r!==t)&&e.push(i,t),this}_initCurve(i=0,t=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[i,t]):this.moveTo(i,t)}quadraticCurveTo(i,t,e,n){this._initCurve();const r=this.currentPath.points;return r.length===0&&this.moveTo(0,0),su.curveTo(i,t,e,n,r),this}bezierCurveTo(i,t,e,n,r,o){return this._initCurve(),ru.curveTo(i,t,e,n,r,o,this.currentPath.points),this}arcTo(i,t,e,n,r){this._initCurve(i,t);const o=this.currentPath.points,h=Ud.curveTo(i,t,e,n,r,o);if(h){const{cx:l,cy:c,radius:f,startAngle:d,endAngle:g,anticlockwise:m}=h;this.arc(l,c,f,d,g,m)}return this}arc(i,t,e,n,r,o=!1){if(n===r)return this;if(!o&&r<=n?r+=zo:o&&n<=r&&(n+=zo),r-n===0)return this;const l=i+Math.cos(n)*e,c=t+Math.sin(n)*e,f=this._geometry.closePointEps;let d=this.currentPath?this.currentPath.points:null;if(d){const g=Math.abs(d[d.length-2]-l),m=Math.abs(d[d.length-1]-c);g<f&&m<f||d.push(l,c)}else this.moveTo(l,c),d=this.currentPath.points;return Ud.arc(l,c,i,t,e,n,r,o,d),this}beginFill(i=0,t=1){return this.beginTextureFill({texture:nt.WHITE,color:i,alpha:t})}beginTextureFill(i){i=Object.assign({texture:nt.WHITE,color:16777215,alpha:1,matrix:null},i),this.currentPath&&this.startPoly();const t=i.alpha>0;return t?(i.matrix&&(i.matrix=i.matrix.clone(),i.matrix.invert()),Object.assign(this._fillStyle,{visible:t},i)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(i,t,e,n){return this.drawShape(new wt(i,t,e,n))}drawRoundedRect(i,t,e,n,r){return this.drawShape(new tu(i,t,e,n,r))}drawCircle(i,t,e){return this.drawShape(new Jl(i,t,e))}drawEllipse(i,t,e,n){return this.drawShape(new Ql(i,t,e,n))}drawPolygon(...i){let t,e=!0;const n=i[0];n.points?(e=n.closeStroke,t=n.points):Array.isArray(i[0])?t=i[0]:t=i;const r=new _r(t);return r.closeStroke=e,this.drawShape(r),this}drawShape(i){return this._holeMode?this._geometry.drawHole(i,this._matrix):this._geometry.drawShape(i,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const i=this._geometry.graphicsData;return i.length===1&&i[0].shape.type===pe.RECT&&!i[0].matrix&&!i[0].holes.length&&!(i[0].lineStyle.visible&&i[0].lineStyle.width)}_render(i){this.finishPoly();const t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(i)):(i.batch.flush(),this._renderDirect(i))}_populateBatches(){const i=this._geometry,t=this.blendMode,e=i.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=i.batchDirty,this.batches.length=e,this.vertexData=new Float32Array(i.points);for(let n=0;n<e;n++){const r=i.batches[n],o=r.style.color,h=new Float32Array(this.vertexData.buffer,r.attribStart*4*2,r.attribSize*2),l=new Float32Array(i.uvsFloat32.buffer,r.attribStart*4*2,r.attribSize*2),c=new Uint16Array(i.indicesUint16.buffer,r.start*2,r.size),f={vertexData:h,blendMode:t,indices:c,uvs:l,_batchRGB:us(o),_tintRGB:o,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[n]=f}}_renderBatched(i){if(this.batches.length){i.batch.setObjectRenderer(i.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,e=this.batches.length;t<e;t++){const n=this.batches[t];n.worldAlpha=this.worldAlpha*n.alpha,i.plugins[this.pluginName].render(n)}}}_renderDirect(i){const t=this._resolveDirectShader(i),e=this._geometry,n=this.tint,r=this.worldAlpha,o=t.uniforms,h=e.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(n>>16&255)/255*r,o.tint[1]=(n>>8&255)/255*r,o.tint[2]=(n&255)/255*r,o.tint[3]=r,i.shader.bind(t),i.geometry.bind(e,t),i.state.set(this.state);for(let l=0,c=h.length;l<c;l++)this._renderDrawCallDirect(i,e.drawCalls[l])}_renderDrawCallDirect(i,t){const{texArray:e,type:n,size:r,start:o}=t,h=e.count;for(let l=0;l<h;l++)i.texture.bind(e.elements[l],l);i.geometry.draw(n,r,o)}_resolveDirectShader(i){let t=this.shader;const e=this.pluginName;if(!t){if(!il[e]){const{maxTextures:n}=i.plugins[e],r=new Int32Array(n);for(let l=0;l<n;l++)r[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Xt,default:di.from({uSamplers:r},!0)},h=i.plugins[e]._shader.program;il[e]=new Si(h,o)}t=il[e]}return t}_calculateBounds(){this.finishPoly();const i=this._geometry;if(!i.graphicsData.length)return;const{minX:t,minY:e,maxX:n,maxY:r}=i.bounds;this._bounds.addFrame(this.transform,t,e,n,r)}containsPoint(i){return this.worldTransform.applyInverse(i,No._TEMP_POINT),this._geometry.containsPoint(No._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this.tint;const i=us(this.tint,vI);for(let t=0;t<this.batches.length;t++){const e=this.batches[t],n=e._batchRGB,r=i[0]*n[0]*255,o=i[1]*n[1]*255,h=i[2]*n[2]*255,l=(r<<16)+(o<<8)+(h|0);e._tintRGB=(l>>16)+(l&65280)+((l&255)<<16)}}}calculateVertices(){const i=this.transform._worldID;if(this._transformID===i)return;this._transformID=i;const t=this.transform.worldTransform,e=t.a,n=t.b,r=t.c,o=t.d,h=t.tx,l=t.ty,c=this._geometry.points,f=this.vertexData;let d=0;for(let g=0;g<c.length;g+=2){const m=c[g],_=c[g+1];f[d++]=e*m+r*_+h,f[d++]=o*_+n*m+l}}closePath(){const i=this.currentPath;return i&&(i.closeStroke=!0,this.finishPoly()),this}setMatrix(i){return this._matrix=i,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(i){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(i)}};let ca=No;ca.curves=yr;ca._TEMP_POINT=new Tt;class xI{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const nl=new Tt,Xd=new _r,mg=class extends Ge{constructor(i,t,e,n=Ti.TRIANGLES){super(),this.geometry=i,this.shader=t,this.state=e||qi.for2d(),this.drawMode=n,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=K.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(i){this._geometry!==i&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=i,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(i){this.shader=i}get material(){return this.shader}set blendMode(i){this.state.blendMode=i}get blendMode(){return this.state.blendMode}set roundPixels(i){this._roundPixels!==i&&(this._transformID=-1),this._roundPixels=i}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(i){this.shader.tint=i}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(i){this.shader.texture=i}_render(i){const t=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Ti.TRIANGLES&&t.length<mg.BATCHABLE_SIZE*2?this._renderToBatch(i):this._renderDefault(i)}_renderDefault(i){const t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),i.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),i.shader.bind(t),i.state.set(this.state),i.geometry.bind(this.geometry,t),i.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(i){const t=this.geometry,e=this.shader;e.uvMatrix&&(e.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=e._tintRGB,this._texture=e.texture;const n=this.material.pluginName;i.batch.setObjectRenderer(i.plugins[n]),i.plugins[n].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const r=this.transform.worldTransform,o=r.a,h=r.b,l=r.c,c=r.d,f=r.tx,d=r.ty,g=this.vertexData;for(let m=0;m<g.length/2;m++){const _=e[m*2],v=e[m*2+1];g[m*2]=o*_+l*v+f,g[m*2+1]=h*_+c*v+d}if(this._roundPixels){const m=K.RESOLUTION;for(let _=0;_<g.length;++_)g[_]=Math.round(g[_]*m)/m}this.vertexDirty=n}calculateUvs(){const i=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=i.data:(this.batchUvs||(this.batchUvs=new xI(i,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(i){if(!this.getBounds().contains(i.x,i.y))return!1;this.worldTransform.applyInverse(i,nl);const t=this.geometry.getBuffer("aVertexPosition").data,e=Xd.points,n=this.geometry.getIndex().data,r=n.length,o=this.drawMode===4?3:1;for(let h=0;h+2<r;h+=o){const l=n[h]*2,c=n[h+1]*2,f=n[h+2]*2;if(e[0]=t[l],e[1]=t[l+1],e[2]=t[c],e[3]=t[c+1],e[4]=t[f],e[5]=t[f+1],Xd.contains(nl.x,nl.y))return!0}return!1}destroy(i){super.destroy(i),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};let Hl=mg;Hl.BATCHABLE_SIZE=100;class yI extends dn{constructor(t,e,n){super();const r=new ee(t),o=new ee(e,!0),h=new ee(n,!0,!0);this.addAttribute("aVertexPosition",r,2,!1,st.FLOAT).addAttribute("aTextureCoord",o,2,!1,st.FLOAT).addIndex(h),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var bI=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,wI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class $d extends Si{constructor(t,e){const n={uSampler:t,alpha:1,uTextureMatrix:Xt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(n,e.uniforms),super(e.program||ui.from(wI,bI),n),this._colorDirty=!1,this.uvMatrix=new Op(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this.tint=e.tint,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(t&65280)+((t&255)<<16),this._colorDirty=!0)}get tint(){return this._tint}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture;pp(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class zd{constructor(t,e,n){this.geometry=new dn,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<t.length;++r){let o=t[r];o={attributeName:o.attributeName,size:o.size,uploadFunction:o.uploadFunction,type:o.type||st.FLOAT,offset:o.offset},e[r]?this.dynamicProperties.push(o):this.staticProperties.push(o)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new ee(dA(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];l.offset=e,e+=l.size,this.dynamicStride+=l.size}const n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new ee(this.dynamicData,!1,!1);let r=0;this.staticStride=0;for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];l.offset=r,r+=l.size,this.staticStride+=l.size}const o=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(o),this.staticDataUint32=new Uint32Array(o),this.staticBuffer=new ee(this.staticData,!0,!1);for(let h=0;h<this.dynamicProperties.length;++h){const l=this.dynamicProperties[h];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.dynamicStride*4,l.offset*4)}for(let h=0;h<this.staticProperties.length;++h){const l=this.staticProperties[h];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===st.UNSIGNED_BYTE,l.type,this.staticStride*4,l.offset*4)}}uploadDynamic(t,e,n){for(let r=0;r<this.dynamicProperties.length;r++){const o=this.dynamicProperties[r];o.uploadFunction(t,e,n,o.type===st.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,o.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,n){for(let r=0;r<this.staticProperties.length;r++){const o=this.staticProperties[r];o.uploadFunction(t,e,n,o.type===st.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,o.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var EI=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,TI=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class _g extends aa{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Xt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:st.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=Si.from(TI,EI,{}),this.state=qi.for2d()}render(t){const e=t.children,n=t._maxSize,r=t._batchSize,o=this.renderer;let h=e.length;if(h===0)return;h>n&&!t.autoResize&&(h=n);let l=t._buffers;l||(l=t._buffers=this.generateBuffers(t));const c=e[0]._texture.baseTexture,f=c.alphaMode>0;this.state.blendMode=dp(t.blendMode,f),o.state.set(this.state);const d=o.gl,g=t.worldTransform.copyTo(this.tempMatrix);g.prepend(o.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=g.toArray(!0),this.shader.uniforms.uColor=fA(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,f),this.shader.uniforms.uSampler=c,this.renderer.shader.bind(this.shader);let m=!1;for(let _=0,v=0;_<h;_+=r,v+=1){let w=h-_;w>r&&(w=r),v>=l.length&&l.push(this._generateOneMoreBuffer(t));const y=l[v];y.uploadDynamic(e,_,w);const T=t._bufferUpdateIDs[v]||0;m=m||y._updateID<T,m&&(y._updateID=t._updateID,y.uploadStatic(e,_,w)),o.geometry.bind(y.geometry),d.drawElements(d.TRIANGLES,w*6,d.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],n=t._maxSize,r=t._batchSize,o=t._properties;for(let h=0;h<n;h+=r)e.push(new zd(this.properties,o,r));return e}_generateOneMoreBuffer(t){const e=t._batchSize,n=t._properties;return new zd(this.properties,n,e)}uploadVertices(t,e,n,r,o,h){let l=0,c=0,f=0,d=0;for(let g=0;g<n;++g){const m=t[e+g],_=m._texture,v=m.scale.x,w=m.scale.y,y=_.trim,T=_.orig;y?(c=y.x-m.anchor.x*T.width,l=c+y.width,d=y.y-m.anchor.y*T.height,f=d+y.height):(l=T.width*(1-m.anchor.x),c=T.width*-m.anchor.x,f=T.height*(1-m.anchor.y),d=T.height*-m.anchor.y),r[h]=c*v,r[h+1]=d*w,r[h+o]=l*v,r[h+o+1]=d*w,r[h+o*2]=l*v,r[h+o*2+1]=f*w,r[h+o*3]=c*v,r[h+o*3+1]=f*w,h+=o*4}}uploadPosition(t,e,n,r,o,h){for(let l=0;l<n;l++){const c=t[e+l].position;r[h]=c.x,r[h+1]=c.y,r[h+o]=c.x,r[h+o+1]=c.y,r[h+o*2]=c.x,r[h+o*2+1]=c.y,r[h+o*3]=c.x,r[h+o*3+1]=c.y,h+=o*4}}uploadRotation(t,e,n,r,o,h){for(let l=0;l<n;l++){const c=t[e+l].rotation;r[h]=c,r[h+o]=c,r[h+o*2]=c,r[h+o*3]=c,h+=o*4}}uploadUvs(t,e,n,r,o,h){for(let l=0;l<n;++l){const c=t[e+l]._texture._uvs;c?(r[h]=c.x0,r[h+1]=c.y0,r[h+o]=c.x1,r[h+o+1]=c.y1,r[h+o*2]=c.x2,r[h+o*2+1]=c.y2,r[h+o*3]=c.x3,r[h+o*3+1]=c.y3,h+=o*4):(r[h]=0,r[h+1]=0,r[h+o]=0,r[h+o+1]=0,r[h+o*2]=0,r[h+o*2+1]=0,r[h+o*3]=0,r[h+o*3+1]=0,h+=o*4)}}uploadTint(t,e,n,r,o,h){for(let l=0;l<n;++l){const c=t[e+l],f=c._texture.baseTexture.alphaMode>0,d=c.alpha,g=d<1&&f?Zl(c._tintRGB,d):c._tintRGB+(d*255<<24);r[h]=g,r[h+o]=g,r[h+o*2]=g,r[h+o*3]=g,h+=o*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}_g.extension={name:"particle",type:q.RendererPlugin};rt.add(_g);var fa=(i=>(i[i.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",i[i.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",i))(fa||{});const So={willReadFrequently:!0},et=class{static get experimentalLetterSpacingSupported(){let i=et._experimentalLetterSpacingSupported;if(i!==void 0){const t=K.ADAPTER.getCanvasRenderingContext2D().prototype;i=et._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,n,r,o,h,l,c){this.text=i,this.style=t,this.width=e,this.height=n,this.lines=r,this.lineWidths=o,this.lineHeight=h,this.maxLineWidth=l,this.fontProperties=c}static measureText(i,t,e,n=et._canvas){e=e??t.wordWrap;const r=t.toFontString(),o=et.measureFont(r);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const h=n.getContext("2d",So);h.font=r;const c=(e?et.wordWrap(i,t,n):i).split(/(?:\r\n|\r|\n)/),f=new Array(c.length);let d=0;for(let v=0;v<c.length;v++){const w=et._measureText(c[v],t.letterSpacing,h);f[v]=w,d=Math.max(d,w)}let g=d+t.strokeThickness;t.dropShadow&&(g+=t.dropShadowDistance);const m=t.lineHeight||o.fontSize+t.strokeThickness;let _=Math.max(m,o.fontSize+t.strokeThickness*2)+(c.length-1)*(m+t.leading);return t.dropShadow&&(_+=t.dropShadowDistance),new et(i,t,g,_,c,f,m+t.leading,d,o)}static _measureText(i,t,e){let n=!1;et.experimentalLetterSpacingSupported&&(et.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,n=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(i).width;return r>0&&(n?r-=t:r+=(et.graphemeSegmenter(i).length-1)*t),r}static wordWrap(i,t,e=et._canvas){const n=e.getContext("2d",So);let r=0,o="",h="";const l=Object.create(null),{letterSpacing:c,whiteSpace:f}=t,d=et.collapseSpaces(f),g=et.collapseNewlines(f);let m=!d;const _=t.wordWrapWidth+c,v=et.tokenize(i);for(let w=0;w<v.length;w++){let y=v[w];if(et.isNewline(y)){if(!g){h+=et.addLine(o),m=!d,o="",r=0;continue}y=" "}if(d){const S=et.isBreakingSpace(y),A=et.isBreakingSpace(o[o.length-1]);if(S&&A)continue}const T=et.getFromCache(y,c,l,n);if(T>_)if(o!==""&&(h+=et.addLine(o),o="",r=0),et.canBreakWords(y,t.breakWords)){const S=et.wordWrapSplit(y);for(let A=0;A<S.length;A++){let I=S[A],D=I,N=1;for(;S[A+N];){const F=S[A+N];if(!et.canBreakChars(D,F,y,A,t.breakWords))I+=F;else break;D=F,N++}A+=N-1;const L=et.getFromCache(I,c,l,n);L+r>_&&(h+=et.addLine(o),m=!1,o="",r=0),o+=I,r+=L}}else{o.length>0&&(h+=et.addLine(o),o="",r=0);const S=w===v.length-1;h+=et.addLine(y,!S),m=!1,o="",r=0}else T+r>_&&(m=!1,h+=et.addLine(o),o="",r=0),(o.length>0||!et.isBreakingSpace(y)||m)&&(o+=y,r+=T)}return h+=et.addLine(o,!1),h}static addLine(i,t=!0){return i=et.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,n){let r=e[i];return typeof r!="number"&&(r=et._measureText(i,t,n)+t,e[i]=r),r}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!et.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:et._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:et._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let n=0;n<i.length;n++){const r=i[n],o=i[n+1];if(et.isBreakingSpace(r,o)||et.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,n,r){return!0}static wordWrapSplit(i){return et.graphemeSegmenter(i)}static measureFont(i){if(et._fonts[i])return et._fonts[i];const t={ascent:0,descent:0,fontSize:0},e=et._canvas,n=et._context;n.font=i;const r=et.METRICS_STRING+et.BASELINE_SYMBOL,o=Math.ceil(n.measureText(r).width);let h=Math.ceil(n.measureText(et.BASELINE_SYMBOL).width);const l=Math.ceil(et.HEIGHT_MULTIPLIER*h);if(h=h*et.BASELINE_MULTIPLIER|0,o===0||l===0)return et._fonts[i]=t,t;e.width=o,e.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=i,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(r,0,h);const c=n.getImageData(0,0,o,l).data,f=c.length,d=o*4;let g=0,m=0,_=!1;for(g=0;g<h;++g){for(let v=0;v<d;v+=4)if(c[m+v]!==255){_=!0;break}if(!_)m+=d;else break}for(t.ascent=h-g,m=f-d,_=!1,g=l;g>h;--g){for(let v=0;v<d;v+=4)if(c[m+v]!==255){_=!0;break}if(!_)m-=d;else break}return t.descent=g-h,t.fontSize=t.ascent+t.descent,et._fonts[i]=t,t}static clearMetrics(i=""){i?delete et._fonts[i]:et._fonts={}}static get _canvas(){if(!et.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",So);if(e!=null&&e.measureText)return et.__canvas=t,t;i=K.ADAPTER.createCanvas()}catch{i=K.ADAPTER.createCanvas()}i.width=i.height=10,et.__canvas=i}return et.__canvas}static get _context(){return et.__context||(et.__context=et._canvas.getContext("2d",So)),et.__context}};let de=et;de.METRICS_STRING="|ÉqÅ";de.BASELINE_SYMBOL="M";de.BASELINE_MULTIPLIER=1.4;de.HEIGHT_MULTIPLIER=2;de.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();de.experimentalLetterSpacing=!1;de._fonts={};de._newlines=[10,13];de._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const AI=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],rs=class{constructor(i){this.styleID=0,this.reset(),sl(this,i,i)}clone(){const i={};return sl(i,this,rs.defaultStyle),new rs(i)}reset(){sl(this,rs.defaultStyle,rs.defaultStyle)}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(i){this._breakWords!==i&&(this._breakWords=i,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(i){this._dropShadow!==i&&(this._dropShadow=i,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(i){this._dropShadowAlpha!==i&&(this._dropShadowAlpha=i,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(i){this._dropShadowAngle!==i&&(this._dropShadowAngle=i,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(i){this._dropShadowBlur!==i&&(this._dropShadowBlur=i,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(i){const t=rl(i);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(i){this._dropShadowDistance!==i&&(this._dropShadowDistance=i,this.styleID++)}get fill(){return this._fill}set fill(i){const t=rl(i);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(i){this._fillGradientType!==i&&(this._fillGradientType=i,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(i){SI(this._fillGradientStops,i)||(this._fillGradientStops=i,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(i){this.fontFamily!==i&&(this._fontFamily=i,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(i){this._fontStyle!==i&&(this._fontStyle=i,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(i){this._fontVariant!==i&&(this._fontVariant=i,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(i){this._fontWeight!==i&&(this._fontWeight=i,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(i){this._lineHeight!==i&&(this._lineHeight=i,this.styleID++)}get leading(){return this._leading}set leading(i){this._leading!==i&&(this._leading=i,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(i){this._lineJoin!==i&&(this._lineJoin=i,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(i){this._miterLimit!==i&&(this._miterLimit=i,this.styleID++)}get padding(){return this._padding}set padding(i){this._padding!==i&&(this._padding=i,this.styleID++)}get stroke(){return this._stroke}set stroke(i){const t=rl(i);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(i){this._strokeThickness!==i&&(this._strokeThickness=i,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(i){this._textBaseline!==i&&(this._textBaseline=i,this.styleID++)}get trim(){return this._trim}set trim(i){this._trim!==i&&(this._trim=i,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(i){this._whiteSpace!==i&&(this._whiteSpace=i,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(i){this._wordWrap!==i&&(this._wordWrap=i,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(i){this._wordWrapWidth!==i&&(this._wordWrapWidth=i,this.styleID++)}toFontString(){const i=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let n=t[e].trim();!/([\"\'])[^\'\"]+\1/.test(n)&&!AI.includes(n)&&(n=`"${n}"`),t[e]=n}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${i} ${t.join(",")}`}};let Gn=rs;Gn.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:fa.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Vd(i){return typeof i=="number"?cp(i):(typeof i=="string"&&i.startsWith("0x")&&(i=i.replace("0x","#")),i)}function rl(i){if(Array.isArray(i)){for(let t=0;t<i.length;++t)i[t]=Vd(i[t]);return i}else return Vd(i)}function SI(i,t){if(!Array.isArray(i)||!Array.isArray(t)||i.length!==t.length)return!1;for(let e=0;e<i.length;++e)if(i[e]!==t[e])return!1;return!0}function sl(i,t,e){for(const n in e)Array.isArray(t[n])?i[n]=t[n].slice():i[n]=t[n]}const CI={texture:!0,children:!1,baseTexture:!0},Xl=class extends Sr{constructor(i,t,e){let n=!1;e||(e=K.ADAPTER.createCanvas(),n=!0),e.width=3,e.height=3;const r=nt.from(e);r.orig=new wt,r.trim=new wt,super(r),this._ownCanvas=n,this.canvas=e,this.context=e.getContext("2d",{willReadFrequently:!0}),this._resolution=Xl.defaultResolution??K.RESOLUTION,this._autoResolution=Xl.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=i,this.style=t,this.localStyleID=-1}static get experimentalLetterSpacing(){return de.experimentalLetterSpacing}static set experimentalLetterSpacing(i){St("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),de.experimentalLetterSpacing=i}updateText(i){const t=this._style;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&i)return;this._font=this._style.toFontString();const e=this.context,n=de.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),r=n.width,o=n.height,h=n.lines,l=n.lineHeight,c=n.lineWidths,f=n.maxLineWidth,d=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,r)+t.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+t.padding*2)*this._resolution),e.scale(this._resolution,this._resolution),e.clearRect(0,0,this.canvas.width,this.canvas.height),e.font=this._font,e.lineWidth=t.strokeThickness,e.textBaseline=t.textBaseline,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit;let g,m;const _=t.dropShadow?2:1;for(let v=0;v<_;++v){const w=t.dropShadow&&v===0,y=w?Math.ceil(Math.max(1,o)+t.padding*2):0,T=y*this._resolution;if(w){e.fillStyle="black",e.strokeStyle="black";const A=t.dropShadowColor,I=us(typeof A=="number"?A:Kl(A)),D=t.dropShadowBlur*this._resolution,N=t.dropShadowDistance*this._resolution;e.shadowColor=`rgba(${I[0]*255},${I[1]*255},${I[2]*255},${t.dropShadowAlpha})`,e.shadowBlur=D,e.shadowOffsetX=Math.cos(t.dropShadowAngle)*N,e.shadowOffsetY=Math.sin(t.dropShadowAngle)*N+T}else e.fillStyle=this._generateFillStyle(t,h,n),e.strokeStyle=t.stroke,e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;let S=(l-d.fontSize)/2;l-d.fontSize<0&&(S=0);for(let A=0;A<h.length;A++)g=t.strokeThickness/2,m=t.strokeThickness/2+A*l+d.ascent+S,t.align==="right"?g+=f-c[A]:t.align==="center"&&(g+=(f-c[A])/2),t.stroke&&t.strokeThickness&&this.drawLetterSpacing(h[A],g+t.padding,m+t.padding-y,!0),t.fill&&this.drawLetterSpacing(h[A],g+t.padding,m+t.padding-y)}this.updateTexture()}drawLetterSpacing(i,t,e,n=!1){const o=this._style.letterSpacing;let h=!1;if(de.experimentalLetterSpacingSupported&&(de.experimentalLetterSpacing?(this.context.letterSpacing=`${o}px`,this.context.textLetterSpacing=`${o}px`,h=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),o===0||h){n?this.context.strokeText(i,t,e):this.context.fillText(i,t,e);return}let l=t;const c=de.graphemeSegmenter(i);let f=this.context.measureText(i).width,d=0;for(let g=0;g<c.length;++g){const m=c[g];n?this.context.strokeText(m,l,e):this.context.fillText(m,l,e);let _="";for(let v=g+1;v<c.length;++v)_+=c[v];d=this.context.measureText(_).width,l+=f-d+o,f=d}}updateTexture(){const i=this.canvas;if(this._style.trim){const o=mA(i);o.data&&(i.width=o.width,i.height=o.height,this.context.putImageData(o.data,0,0))}const t=this._texture,e=this._style,n=e.trim?0:e.padding,r=t.baseTexture;t.trim.width=t._frame.width=i.width/this._resolution,t.trim.height=t._frame.height=i.height/this._resolution,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-n*2,t.orig.height=t._frame.height-n*2,this._onTextureUpdate(),r.setRealSize(i.width,i.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0),this.updateText(!0),super._render(i)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(i,t){return this.updateText(!0),this._textureID===-1&&(i=!1),super.getBounds(i,t)}getLocalBounds(i){return this.updateText(!0),super.getLocalBounds.call(this,i)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(i,t,e){const n=i.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;let r;const o=i.dropShadow?i.dropShadowDistance:0,h=i.padding||0,l=this.canvas.width/this._resolution-o-h*2,c=this.canvas.height/this._resolution-o-h*2,f=n.slice(),d=i.fillGradientStops.slice();if(!d.length){const g=f.length+1;for(let m=1;m<g;++m)d.push(m/g)}if(f.unshift(n[0]),d.unshift(0),f.push(n[n.length-1]),d.push(1),i.fillGradientType===fa.LINEAR_VERTICAL){r=this.context.createLinearGradient(l/2,h,l/2,c+h);const g=e.fontProperties.fontSize+i.strokeThickness;for(let m=0;m<t.length;m++){const _=e.lineHeight*(m-1)+g,v=e.lineHeight*m;let w=v;m>0&&_>v&&(w=(v+_)/2);const y=v+g,T=e.lineHeight*(m+1);let S=y;m+1<t.length&&T<y&&(S=(y+T)/2);const A=(S-w)/c;for(let I=0;I<f.length;I++){let D=0;typeof d[I]=="number"?D=d[I]:D=I/f.length;let N=Math.min(1,Math.max(0,w/c+D*A));N=Number(N.toFixed(5)),r.addColorStop(N,f[I])}}}else{r=this.context.createLinearGradient(h,c/2,l+h,c/2);const g=f.length+1;let m=1;for(let _=0;_<f.length;_++){let v;typeof d[_]=="number"?v=d[_]:v=m/g,r.addColorStop(v,f[_]),m++}}return r}destroy(i){typeof i=="boolean"&&(i={children:i}),i=Object.assign({},CI,i),super.destroy(i),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(i){this.updateText(!0);const t=fr(this.scale.x)||1;this.scale.x=t*i/this._texture.orig.width,this._width=i}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(i){this.updateText(!0);const t=fr(this.scale.y)||1;this.scale.y=t*i/this._texture.orig.height,this._height=i}get style(){return this._style}set style(i){i=i||{},i instanceof Gn?this._style=i:this._style=new Gn(i),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}};let au=Xl;au.defaultAutoResolution=!0;class II{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function RI(i,t){var n;let e=!1;if((n=i==null?void 0:i._textures)!=null&&n.length){for(let r=0;r<i._textures.length;r++)if(i._textures[r]instanceof nt){const o=i._textures[r].baseTexture;t.includes(o)||(t.push(o),e=!0)}}return e}function PI(i,t){if(i.baseTexture instanceof ft){const e=i.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function MI(i,t){if(i._texture&&i._texture instanceof nt){const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function DI(i,t){return t instanceof au?(t.updateText(!0),!0):!1}function BI(i,t){if(t instanceof Gn){const e=t.toFontString();return de.measureFont(e),!0}return!1}function FI(i,t){if(i instanceof au){t.includes(i.style)||t.push(i.style),t.includes(i)||t.push(i);const e=i._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function LI(i,t){return i instanceof Gn?(t.includes(i)||t.push(i),!0):!1}const vg=class{constructor(i){this.limiter=new II(vg.uploadsPerFrame),this.renderer=i,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(FI),this.registerFindHook(LI),this.registerFindHook(RI),this.registerFindHook(PI),this.registerFindHook(MI),this.registerUploadHook(DI),this.registerUploadHook(BI)}upload(i){return new Promise(t=>{i&&this.add(i),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,Me.system.addOnce(this.tick,this,xr.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const i=this.queue[0];let t=!1;if(i&&!i._destroyed){for(let e=0,n=this.uploadHooks.length;e<n;e++)if(this.uploadHooks[e](this.uploadHookHelper,i)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)Me.system.addOnce(this.tick,this,xr.UTILITY);else{this.ticking=!1;const i=this.completes.slice(0);this.completes.length=0;for(let t=0,e=i.length;t<e;t++)i[t]()}}registerFindHook(i){return i&&this.addHooks.push(i),this}registerUploadHook(i){return i&&this.uploadHooks.push(i),this}add(i){for(let t=0,e=this.addHooks.length;t<e&&!this.addHooks[t](i,this.queue);t++);if(i instanceof Ge)for(let t=i.children.length-1;t>=0;t--)this.add(i.children[t]);return this}destroy(){this.ticking&&Me.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};let Jo=vg;Jo.uploadsPerFrame=4;Object.defineProperties(K,{UPLOADS_PER_FRAME:{get(){return Jo.uploadsPerFrame},set(i){St("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Jo.uploadsPerFrame=i}}});function xg(i,t){return t instanceof ft?(t._glTextures[i.CONTEXT_UID]||i.texture.bind(t),!0):!1}function OI(i,t){if(!(t instanceof ca))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:n}=e;for(let r=0;r<n.length;r++){const{texture:o}=n[r].style;o&&xg(i,o.baseTexture)}return e.batchable||i.geometry.bind(e,t._resolveDirectShader(i)),!0}function NI(i,t){return i instanceof ca?(t.push(i),!0):!1}class yg extends Jo{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(NI),this.registerUploadHook(xg),this.registerUploadHook(OI)}}yg.extension={name:"prepare",type:q.RendererSystem};rt.add(yg);new Tt;var kI=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,UI=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,GI=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,Yd=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,WI=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Co=new Xt;class bg extends aa{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Dp,this.state=qi.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Si.from(Yd,WI,e),this.shader=t.context.webGLVersion>1?Si.from(UI,kI,e):Si.from(Yd,GI,e)}render(t){const e=this.renderer,n=this.quad;let r=n.vertices;r[0]=r[6]=t._width*-t.anchor.x,r[1]=r[3]=t._height*-t.anchor.y,r[2]=r[4]=t._width*(1-t.anchor.x),r[5]=r[7]=t._height*(1-t.anchor.y);const o=t.uvRespectAnchor?t.anchor.x:0,h=t.uvRespectAnchor?t.anchor.y:0;r=n.uvs,r[0]=r[6]=-o,r[1]=r[3]=-h,r[2]=r[4]=1-o,r[5]=r[7]=1-h,n.invalidate();const l=t._texture,c=l.baseTexture,f=c.alphaMode>0,d=t.tileTransform.localTransform,g=t.uvMatrix;let m=c.isPowerOfTwo&&l.frame.width===c.width&&l.frame.height===c.height;m&&(c._glTextures[e.CONTEXT_UID]?m=c.wrapMode!==cn.CLAMP:c.wrapMode===cn.CLAMP&&(c.wrapMode=cn.REPEAT));const _=m?this.simpleShader:this.shader,v=l.width,w=l.height,y=t._width,T=t._height;Co.set(d.a*v/y,d.b*v/T,d.c*w/y,d.d*w/T,d.tx/y,d.ty/T),Co.invert(),m?Co.prepend(g.mapCoord):(_.uniforms.uMapCoord=g.mapCoord.toArray(!0),_.uniforms.uClampFrame=g.uClampFrame,_.uniforms.uClampOffset=g.uClampOffset),_.uniforms.uTransform=Co.toArray(!0),_.uniforms.uColor=pp(t.tint,t.worldAlpha,_.uniforms.uColor,f),_.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),_.uniforms.uSampler=l,e.shader.bind(_),e.geometry.bind(n),this.state.blendMode=dp(t.blendMode,f),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}bg.extension={name:"tilingSprite",type:q.RendererPlugin};rt.add(bg);const ss=class{constructor(i,t,e=null){this.linkedSheets=[],this._texture=i instanceof nt?i:null,this.baseTexture=i instanceof ft?i:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;const n=this.baseTexture.resource;this.resolution=this._updateResolution(e||(n?n.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(i=null){const{scale:t}=this.data.meta;let e=fn(i,null);return e===null&&(e=parseFloat(t??"1")),e!==1&&this.baseTexture.setResolution(e),e}parse(){return new Promise(i=>{this._callback=i,this._batchIndex=0,this._frameKeys.length<=ss.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(i){let t=i;const e=ss.BATCH_SIZE;for(;t-i<e&&t<this._frameKeys.length;){const n=this._frameKeys[t],r=this._frames[n],o=r.frame;if(o){let h=null,l=null;const c=r.trimmed!==!1&&r.sourceSize?r.sourceSize:r.frame,f=new wt(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);r.rotated?h=new wt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):h=new wt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),r.trimmed!==!1&&r.spriteSourceSize&&(l=new wt(Math.floor(r.spriteSourceSize.x)/this.resolution,Math.floor(r.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new nt(this.baseTexture,h,f,l,r.rotated?2:0,r.anchor),nt.addToCache(this.textures[n],n)}t++}}_processAnimations(){const i=this.data.animations||{};for(const t in i){this.animations[t]=[];for(let e=0;e<i[t].length;e++){const n=i[t][e];this.animations[t].push(this.textures[n])}}}_parseComplete(){const i=this._callback;this._callback=null,this._batchIndex=0,i.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ss.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ss.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(i=!1){var t;for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,i&&((t=this._texture)==null||t.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};let $l=ss;$l.BATCH_SIZE=1e3;const HI=["jpg","png","jpeg","avif","webp"];function wg(i,t,e){const n={};if(i.forEach(r=>{n[r]=t}),Object.keys(t.textures).forEach(r=>{n[r]=t.textures[r]}),!e){const r=_e.dirname(i[0]);t.linkedSheets.forEach((o,h)=>{const l=wg([`${r}/${t.data.meta.related_multi_packs[h]}`],o,!0);Object.assign(n,l)})}return n}const XI={extension:q.Asset,cache:{test:i=>i instanceof $l,getCacheableAssets:(i,t)=>wg(i,t,!1)},resolver:{test:i=>{const e=i.split("?")[0].split("."),n=e.pop(),r=e.pop();return n==="json"&&HI.includes(r)},parse:i=>{var e;const t=i.split(".");return{resolution:parseFloat(((e=K.RETINA_PREFIX.exec(i))==null?void 0:e[1])??"1"),format:t[t.length-2],src:i}}},loader:{extension:{type:q.LoadParser,priority:Ri.Normal},async testParse(i,t){return _e.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){var f,d;let n=_e.dirname(t.src);n&&n.lastIndexOf("/")!==n.length-1&&(n+="/");const r=n+i.meta.image,h=(await e.load([r]))[r],l=new $l(h.baseTexture,i,t.src);await l.parse();const c=(f=i==null?void 0:i.meta)==null?void 0:f.related_multi_packs;if(Array.isArray(c)){const g=[];for(const _ of c){if(typeof _!="string")continue;const v=n+_;(d=t.data)!=null&&d.ignoreMultiPack||g.push(e.load({src:v,data:{ignoreMultiPack:!0}}))}const m=await Promise.all(g);l.linkedSheets=m,m.forEach(_=>{_.linkedSheets=[l].concat(l.linkedSheets.filter(v=>v!==_))})}return l},unload(i){i.destroy(!0)}}};rt.add(XI);class Qo{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class ko{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const o in e){const h=e[o].match(/^[a-z]+/gm)[0],l=e[o].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),c={};for(const f in l){const d=l[f].split("="),g=d[0],m=d[1].replace(/"/gm,""),_=parseFloat(m),v=isNaN(_)?m:_;c[g]=v}n[h].push(c)}const r=new Qo;return n.info.forEach(o=>r.info.push({face:o.face,size:parseInt(o.size,10)})),n.common.forEach(o=>r.common.push({lineHeight:parseInt(o.lineHeight,10)})),n.page.forEach(o=>r.page.push({id:parseInt(o.id,10),file:o.file})),n.char.forEach(o=>r.char.push({id:parseInt(o.id,10),page:parseInt(o.page,10),x:parseInt(o.x,10),y:parseInt(o.y,10),width:parseInt(o.width,10),height:parseInt(o.height,10),xoffset:parseInt(o.xoffset,10),yoffset:parseInt(o.yoffset,10),xadvance:parseInt(o.xadvance,10)})),n.kerning.forEach(o=>r.kerning.push({first:parseInt(o.first,10),second:parseInt(o.second,10),amount:parseInt(o.amount,10)})),n.distanceField.forEach(o=>r.distanceField.push({distanceRange:parseInt(o.distanceRange,10),fieldType:o.fieldType})),r}}class zl{static test(t){const e=t;return"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new Qo,n=t.getElementsByTagName("info"),r=t.getElementsByTagName("common"),o=t.getElementsByTagName("page"),h=t.getElementsByTagName("char"),l=t.getElementsByTagName("kerning"),c=t.getElementsByTagName("distanceField");for(let f=0;f<n.length;f++)e.info.push({face:n[f].getAttribute("face"),size:parseInt(n[f].getAttribute("size"),10)});for(let f=0;f<r.length;f++)e.common.push({lineHeight:parseInt(r[f].getAttribute("lineHeight"),10)});for(let f=0;f<o.length;f++)e.page.push({id:parseInt(o[f].getAttribute("id"),10)||0,file:o[f].getAttribute("file")});for(let f=0;f<h.length;f++){const d=h[f];e.char.push({id:parseInt(d.getAttribute("id"),10),page:parseInt(d.getAttribute("page"),10)||0,x:parseInt(d.getAttribute("x"),10),y:parseInt(d.getAttribute("y"),10),width:parseInt(d.getAttribute("width"),10),height:parseInt(d.getAttribute("height"),10),xoffset:parseInt(d.getAttribute("xoffset"),10),yoffset:parseInt(d.getAttribute("yoffset"),10),xadvance:parseInt(d.getAttribute("xadvance"),10)})}for(let f=0;f<l.length;f++)e.kerning.push({first:parseInt(l[f].getAttribute("first"),10),second:parseInt(l[f].getAttribute("second"),10),amount:parseInt(l[f].getAttribute("amount"),10)});for(let f=0;f<c.length;f++)e.distanceField.push({fieldType:c[f].getAttribute("fieldType"),distanceRange:parseInt(c[f].getAttribute("distanceRange"),10)});return e}}class Vl{static test(t){return typeof t=="string"&&t.includes("<font>")?zl.test(K.ADAPTER.parseXML(t)):!1}static parse(t){return zl.parse(K.ADAPTER.parseXML(t))}}const ol=[ko,zl,Vl];function $I(i){for(let t=0;t<ol.length;t++)if(ol[t].test(i))return ol[t];return null}function zI(i,t,e,n,r,o){const h=e.fill;if(Array.isArray(h)){if(h.length===1)return h[0]}else return h;let l;const c=e.dropShadow?e.dropShadowDistance:0,f=e.padding||0,d=i.width/n-c-f*2,g=i.height/n-c-f*2,m=h.slice(),_=e.fillGradientStops.slice();if(!_.length){const v=m.length+1;for(let w=1;w<v;++w)_.push(w/v)}if(m.unshift(h[0]),_.unshift(0),m.push(h[h.length-1]),_.push(1),e.fillGradientType===fa.LINEAR_VERTICAL){l=t.createLinearGradient(d/2,f,d/2,g+f);let v=0;const y=(o.fontProperties.fontSize+e.strokeThickness)/g;for(let T=0;T<r.length;T++){const S=o.lineHeight*T;for(let A=0;A<m.length;A++){let I=0;typeof _[A]=="number"?I=_[A]:I=A/m.length;const D=S/g+I*y;let N=Math.max(v,D);N=Math.min(N,1),l.addColorStop(N,m[A]),v=N}}}else{l=t.createLinearGradient(f,g/2,d+f,g/2);const v=m.length+1;let w=1;for(let y=0;y<m.length;y++){let T;typeof _[y]=="number"?T=_[y]:T=w/v,l.addColorStop(T,m[y]),w++}}return l}function VI(i,t,e,n,r,o,h){const l=e.text,c=e.fontProperties;t.translate(n,r),t.scale(o,o);const f=h.strokeThickness/2,d=-(h.strokeThickness/2);if(t.font=h.toFontString(),t.lineWidth=h.strokeThickness,t.textBaseline=h.textBaseline,t.lineJoin=h.lineJoin,t.miterLimit=h.miterLimit,t.fillStyle=zI(i,t,h,o,[l],e),t.strokeStyle=h.stroke,h.dropShadow){const g=h.dropShadowColor,m=us(typeof g=="number"?g:Kl(g)),_=h.dropShadowBlur*o,v=h.dropShadowDistance*o;t.shadowColor=`rgba(${m[0]*255},${m[1]*255},${m[2]*255},${h.dropShadowAlpha})`,t.shadowBlur=_,t.shadowOffsetX=Math.cos(h.dropShadowAngle)*v,t.shadowOffsetY=Math.sin(h.dropShadowAngle)*v}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;h.stroke&&h.strokeThickness&&t.strokeText(l,f,d+e.lineHeight-c.descent),h.fill&&t.fillText(l,f,d+e.lineHeight-c.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function Uo(i){return i.codePointAt?i.codePointAt(0):i.charCodeAt(0)}function Eg(i){return Array.from?Array.from(i):i.split("")}function YI(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,n=i.length;e<n;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const o=r[0].charCodeAt(0),h=r[1].charCodeAt(0);if(h<o)throw new Error("[BitmapFont]: Invalid character range.");for(let l=o,c=h;l<=c;l++)t.push(String.fromCharCode(l))}else t.push(...Eg(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const ai=class{constructor(i,t,e){var f;const[n]=i.info,[r]=i.common,[o]=i.page,[h]=i.distanceField,l=fn(o.file),c={};this._ownsTextures=e,this.font=n.face,this.size=n.size,this.lineHeight=r.lineHeight/l,this.chars={},this.pageTextures=c;for(let d=0;d<i.page.length;d++){const{id:g,file:m}=i.page[d];c[g]=t instanceof Array?t[d]:t[m],h!=null&&h.fieldType&&h.fieldType!=="none"&&(c[g].baseTexture.alphaMode=gi.NO_PREMULTIPLIED_ALPHA,c[g].baseTexture.mipmap=Ci.OFF)}for(let d=0;d<i.char.length;d++){const{id:g,page:m}=i.char[d];let{x:_,y:v,width:w,height:y,xoffset:T,yoffset:S,xadvance:A}=i.char[d];_/=l,v/=l,w/=l,y/=l,T/=l,S/=l,A/=l;const I=new wt(_+c[m].frame.x/l,v+c[m].frame.y/l,w,y);this.chars[g]={xOffset:T,yOffset:S,xAdvance:A,kerning:{},texture:new nt(c[m].baseTexture,I),page:m}}for(let d=0;d<i.kerning.length;d++){let{first:g,second:m,amount:_}=i.kerning[d];g/=l,m/=l,_/=l,this.chars[m]&&(this.chars[m].kerning[g]=_)}this.distanceFieldRange=h==null?void 0:h.distanceRange,this.distanceFieldType=((f=h==null?void 0:h.fieldType)==null?void 0:f.toLowerCase())??"none"}destroy(){for(const i in this.chars)this.chars[i].texture.destroy(),this.chars[i].texture=null;for(const i in this.pageTextures)this._ownsTextures&&this.pageTextures[i].destroy(!0),this.pageTextures[i]=null;this.chars=null,this.pageTextures=null}static install(i,t,e){let n;if(i instanceof Qo)n=i;else{const o=$I(i);if(!o)throw new Error("Unrecognized data format for font.");n=o.parse(i)}t instanceof nt&&(t=[t]);const r=new ai(n,t,e);return ai.available[r.font]=r,r}static uninstall(i){const t=ai.available[i];if(!t)throw new Error(`No font found named '${i}'`);t.destroy(),delete ai.available[i]}static from(i,t,e){if(!i)throw new Error("[BitmapFont] Property `name` is required.");const{chars:n,padding:r,resolution:o,textureWidth:h,textureHeight:l,...c}=Object.assign({},ai.defaultOptions,e),f=YI(n),d=t instanceof Gn?t:new Gn(t),g=h,m=new Qo;m.info[0]={face:d.fontFamily,size:d.fontSize},m.common[0]={lineHeight:d.fontSize};let _=0,v=0,w,y,T,S=0;const A=[];for(let D=0;D<f.length;D++){w||(w=K.ADAPTER.createCanvas(),w.width=h,w.height=l,y=w.getContext("2d"),T=new ft(w,{resolution:o,...c}),A.push(new nt(T)),m.page.push({id:A.length-1,file:""}));const N=f[D],L=de.measureText(N,d,!1,w),F=L.width,V=Math.ceil(L.height),J=Math.ceil((d.fontStyle==="italic"?2:1)*F);if(v>=l-V*o){if(v===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${N}')`);--D,w=null,y=null,T=null,v=0,_=0,S=0;continue}if(S=Math.max(V+L.fontProperties.descent,S),J*o+_>=g){if(_===0)throw new Error(`[BitmapFont] textureWidth ${h}px is too small (fontFamily: '${d.fontFamily}', fontSize: ${d.fontSize}px, char: '${N}')`);--D,v+=S*o,v=Math.ceil(v),_=0,S=0;continue}VI(w,y,L,_,v,o,d);const z=Uo(L.text);m.char.push({id:z,page:A.length-1,x:_/o,y:v/o,width:J,height:V,xoffset:0,yoffset:0,xadvance:Math.ceil(F-(d.dropShadow?d.dropShadowDistance:0)-(d.stroke?d.strokeThickness:0))}),_+=(J+2*r)*o,_=Math.ceil(_)}for(let D=0,N=f.length;D<N;D++){const L=f[D];for(let F=0;F<N;F++){const V=f[F],J=y.measureText(L).width,z=y.measureText(V).width,X=y.measureText(L+V).width-(J+z);X&&m.kerning.push({first:Uo(L),second:Uo(V),amount:X})}}const I=new ai(m,A,!0);return ai.available[i]!==void 0&&ai.uninstall(i),ai.available[i]=I,I}};let Pe=ai;Pe.ALPHA=[["a","z"],["A","Z"]," "];Pe.NUMERIC=[["0","9"]];Pe.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "];Pe.ASCII=[[" ","~"]];Pe.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:ai.ALPHANUMERIC};Pe.available={};var jI=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r
\r
}\r
`,qI=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const jd=[],qd=[],Kd=[],Tg=class extends Ge{constructor(i,t={}){super(),this._tint=16777215;const{align:e,tint:n,maxWidth:r,letterSpacing:o,fontName:h,fontSize:l}=Object.assign({},Tg.styleDefaults,t);if(!Pe.available[h])throw new Error(`Missing BitmapFont "${h}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=e,this._tint=n,this._font=void 0,this._fontName=h,this._fontSize=l,this.text=i,this._maxWidth=r,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new ln(()=>{this.dirty=!0},this,0,0),this._roundPixels=K.ROUND_PIXELS,this.dirty=!0,this._resolution=K.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var J;const i=Pe.available[this._fontName],t=this.fontSize,e=t/i.size,n=new Tt,r=[],o=[],h=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",c=Eg(l),f=this._maxWidth*i.size/t,d=i.distanceFieldType==="none"?jd:qd;let g=null,m=0,_=0,v=0,w=-1,y=0,T=0,S=0,A=0;for(let z=0;z<c.length;z++){const Q=c[z],X=Uo(Q);if(/(?:\s)/.test(Q)&&(w=z,y=m,A++),Q==="\r"||Q===`
`){o.push(m),h.push(-1),_=Math.max(_,m),++v,++T,n.x=0,n.y+=i.lineHeight,g=null,A=0;continue}const G=i.chars[X];if(!G)continue;g&&G.kerning[g]&&(n.x+=G.kerning[g]);const dt=Kd.pop()||{texture:nt.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Tt};dt.texture=G.texture,dt.line=v,dt.charCode=X,dt.position.x=n.x+G.xOffset+this._letterSpacing/2,dt.position.y=n.y+G.yOffset,dt.prevSpaces=A,r.push(dt),m=dt.position.x+Math.max(G.xAdvance-G.xOffset,G.texture.orig.width),n.x+=G.xAdvance+this._letterSpacing,S=Math.max(S,G.yOffset+G.texture.height),g=X,w!==-1&&f>0&&n.x>f&&(++T,mr(r,1+w-T,1+z-w),z=w,w=-1,o.push(y),h.push(r.length>0?r[r.length-1].prevSpaces:0),_=Math.max(_,y),v++,n.x=0,n.y+=i.lineHeight,g=null,A=0)}const I=c[c.length-1];I!=="\r"&&I!==`
`&&(/(?:\s)/.test(I)&&(m=y),o.push(m),_=Math.max(_,m),h.push(-1));const D=[];for(let z=0;z<=v;z++){let Q=0;this._align==="right"?Q=_-o[z]:this._align==="center"?Q=(_-o[z])/2:this._align==="justify"&&(Q=h[z]<0?0:(_-o[z])/h[z]),D.push(Q)}const N=r.length,L={},F=[],V=this._activePagesMeshData;d.push(...V);for(let z=0;z<N;z++){const Q=r[z].texture,X=Q.baseTexture.uid;if(!L[X]){let G=d.pop();if(!G){const _t=new yI;let j,vt;i.distanceFieldType==="none"?(j=new $d(nt.EMPTY),vt=lt.NORMAL):(j=new $d(nt.EMPTY,{program:ui.from(qI,jI),uniforms:{uFWidth:0}}),vt=lt.NORMAL_NPM);const Wt=new Hl(_t,j);Wt.blendMode=vt,G={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:Wt,vertices:null,uvs:null,indices:null}}G.index=0,G.indexCount=0,G.vertexCount=0,G.uvsCount=0,G.total=0;const{_textureCache:dt}=this;dt[X]=dt[X]||new nt(Q.baseTexture),G.mesh.texture=dt[X],G.mesh.tint=this._tint,F.push(G),L[X]=G}L[X].total++}for(let z=0;z<V.length;z++)F.includes(V[z])||this.removeChild(V[z].mesh);for(let z=0;z<F.length;z++)F[z].mesh.parent!==this&&this.addChild(F[z].mesh);this._activePagesMeshData=F;for(const z in L){const Q=L[z],X=Q.total;if(!(((J=Q.indices)==null?void 0:J.length)>6*X)||Q.vertices.length<Hl.BATCHABLE_SIZE*2)Q.vertices=new Float32Array(4*2*X),Q.uvs=new Float32Array(4*2*X),Q.indices=new Uint16Array(6*X);else{const G=Q.total,dt=Q.vertices;for(let _t=G*4*2;_t<dt.length;_t++)dt[_t]=0}Q.mesh.size=6*X}for(let z=0;z<N;z++){const Q=r[z];let X=Q.position.x+D[Q.line]*(this._align==="justify"?Q.prevSpaces:1);this._roundPixels&&(X=Math.round(X));const G=X*e,dt=Q.position.y*e,_t=Q.texture,j=L[_t.baseTexture.uid],vt=_t.frame,Wt=_t._uvs,H=j.index++;j.indices[H*6+0]=0+H*4,j.indices[H*6+1]=1+H*4,j.indices[H*6+2]=2+H*4,j.indices[H*6+3]=0+H*4,j.indices[H*6+4]=2+H*4,j.indices[H*6+5]=3+H*4,j.vertices[H*8+0]=G,j.vertices[H*8+1]=dt,j.vertices[H*8+2]=G+vt.width*e,j.vertices[H*8+3]=dt,j.vertices[H*8+4]=G+vt.width*e,j.vertices[H*8+5]=dt+vt.height*e,j.vertices[H*8+6]=G,j.vertices[H*8+7]=dt+vt.height*e,j.uvs[H*8+0]=Wt.x0,j.uvs[H*8+1]=Wt.y0,j.uvs[H*8+2]=Wt.x1,j.uvs[H*8+3]=Wt.y1,j.uvs[H*8+4]=Wt.x2,j.uvs[H*8+5]=Wt.y2,j.uvs[H*8+6]=Wt.x3,j.uvs[H*8+7]=Wt.y3}this._textWidth=_*e,this._textHeight=(n.y+i.lineHeight)*e;for(const z in L){const Q=L[z];if(this.anchor.x!==0||this.anchor.y!==0){let _t=0;const j=this._textWidth*this.anchor.x,vt=this._textHeight*this.anchor.y;for(let Wt=0;Wt<Q.total;Wt++)Q.vertices[_t++]-=j,Q.vertices[_t++]-=vt,Q.vertices[_t++]-=j,Q.vertices[_t++]-=vt,Q.vertices[_t++]-=j,Q.vertices[_t++]-=vt,Q.vertices[_t++]-=j,Q.vertices[_t++]-=vt}this._maxLineHeight=S*e;const X=Q.mesh.geometry.getBuffer("aVertexPosition"),G=Q.mesh.geometry.getBuffer("aTextureCoord"),dt=Q.mesh.geometry.getIndex();X.data=Q.vertices,G.data=Q.uvs,dt.data=Q.indices,X.update(),G.update(),dt.update()}for(let z=0;z<r.length;z++)Kd.push(r[z]);this._font=i,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(i){this._autoResolution&&this._resolution!==i.resolution&&(this._resolution=i.resolution,this.dirty=!0);const{distanceFieldRange:t,distanceFieldType:e,size:n}=Pe.available[this._fontName];if(e!=="none"){const{a:r,b:o,c:h,d:l}=this.worldTransform,c=Math.sqrt(r*r+o*o),f=Math.sqrt(h*h+l*l),d=(Math.abs(c)+Math.abs(f))/2,g=this.fontSize/n,m=i._view.resolution;for(const _ of this._activePagesMeshData)_.mesh.shader.uniforms.uFWidth=d*t*g*m}super._render(i)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const i=Pe.available[this._fontName];if(!i)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==i&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tint}set tint(i){if(this._tint!==i){this._tint=i;for(let t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=i}}get align(){return this._align}set align(i){this._align!==i&&(this._align=i,this.dirty=!0)}get fontName(){return this._fontName}set fontName(i){if(!Pe.available[i])throw new Error(`Missing BitmapFont "${i}"`);this._fontName!==i&&(this._fontName=i,this.dirty=!0)}get fontSize(){return this._fontSize??Pe.available[this._fontName].size}set fontSize(i){this._fontSize!==i&&(this._fontSize=i,this.dirty=!0)}get anchor(){return this._anchor}set anchor(i){typeof i=="number"?this._anchor.set(i):this._anchor.copyFrom(i)}get text(){return this._text}set text(i){i=String(i??""),this._text!==i&&(this._text=i,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(i){this._maxWidth!==i&&(this._maxWidth=i,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(i){this._letterSpacing!==i&&(this._letterSpacing=i,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(i){i!==this._roundPixels&&(this._roundPixels=i,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(i){this._autoResolution=!1,this._resolution!==i&&(this._resolution=i,this.dirty=!0)}destroy(i){const{_textureCache:t}=this,n=Pe.available[this._fontName].distanceFieldType==="none"?jd:qd;n.push(...this._activePagesMeshData);for(const r of this._activePagesMeshData)this.removeChild(r.mesh);this._activePagesMeshData=[],n.filter(r=>t[r.mesh.texture.baseTexture.uid]).forEach(r=>{r.mesh.texture=nt.EMPTY});for(const r in t)t[r].destroy(),delete t[r];this._font=null,this._textureCache=null,super.destroy(i)}};let KI=Tg;KI.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const ZI=[".xml",".fnt"],JI={extension:{type:q.LoadParser,priority:Ri.Normal},test(i){return ZI.includes(_e.extname(i).toLowerCase())},async testParse(i){return ko.test(i)||Vl.test(i)},async parse(i,t,e){const n=ko.test(i)?ko.parse(i):Vl.parse(i),{src:r}=t,{page:o}=n,h=[];for(let f=0;f<o.length;++f){const d=o[f].file,g=_e.join(_e.dirname(r),d);h.push(g)}const l=await e.load(h),c=h.map(f=>l[f]);return Pe.install(n,c,!0)},async load(i,t){return(await K.ADAPTER.fetch(i)).text()},unload(i){i.destroy()}};rt.add(JI);const QI={A:"menlo-bold-0.png",B:"menlo-bold-1.png",C:"menlo-bold-2.png",D:"menlo-bold-3.png",E:"menlo-bold-4.png",F:"menlo-bold-5.png",G:"menlo-bold-6.png",H:"menlo-bold-7.png",I:"menlo-bold-8.png",J:"menlo-bold-9.png",K:"menlo-bold-10.png",L:"menlo-bold-11.png",M:"menlo-bold-12.png",N:"menlo-bold-13.png",O:"menlo-bold-14.png",P:"menlo-bold-15.png",Q:"menlo-bold-16.png",R:"menlo-bold-17.png",S:"menlo-bold-18.png",T:"menlo-bold-19.png",U:"menlo-bold-20.png",V:"menlo-bold-21.png",W:"menlo-bold-22.png",X:"menlo-bold-23.png",Y:"menlo-bold-24.png",Z:"menlo-bold-25.png",a:"menlo-bold-26.png",b:"menlo-bold-27.png",c:"menlo-bold-28.png",d:"menlo-bold-29.png",e:"menlo-bold-30.png",f:"menlo-bold-31.png",g:"menlo-bold-32.png",h:"menlo-bold-33.png",i:"menlo-bold-34.png",j:"menlo-bold-35.png",k:"menlo-bold-36.png",l:"menlo-bold-37.png",m:"menlo-bold-38.png",n:"menlo-bold-39.png",o:"menlo-bold-40.png",p:"menlo-bold-41.png",q:"menlo-bold-42.png",r:"menlo-bold-43.png",s:"menlo-bold-44.png",t:"menlo-bold-45.png",u:"menlo-bold-46.png",v:"menlo-bold-47.png",w:"menlo-bold-48.png",x:"menlo-bold-49.png",y:"menlo-bold-50.png",z:"menlo-bold-51.png",0:"menlo-bold-52.png",1:"menlo-bold-53.png",2:"menlo-bold-54.png",3:"menlo-bold-55.png",4:"menlo-bold-56.png",5:"menlo-bold-57.png",6:"menlo-bold-58.png",7:"menlo-bold-59.png",8:"menlo-bold-60.png",9:"menlo-bold-61.png","!":"menlo-bold-62.png","@":"menlo-bold-63.png","#":"menlo-bold-64.png",$:"menlo-bold-65.png","%":"menlo-bold-66.png","^":"menlo-bold-67.png","&":"menlo-bold-68.png","*":"menlo-bold-69.png","(":"menlo-bold-70.png",")":"menlo-bold-71.png","-":"menlo-bold-72.png",_:"menlo-bold-73.png","=":"menlo-bold-74.png","+":"menlo-bold-75.png",",":"menlo-bold-76.png",".":"menlo-bold-77.png","<":"menlo-bold-78.png",">":"menlo-bold-79.png","/":"menlo-bold-80.png","?":"menlo-bold-81.png",";":"menlo-bold-82.png",":":"menlo-bold-83.png",'"':"menlo-bold-84.png","'":"menlo-bold-85.png","[":"menlo-bold-86.png","]":"menlo-bold-87.png","{":"menlo-bold-88.png","}":"menlo-bold-89.png","\\":"menlo-bold-90.png","|":"menlo-bold-91.png","`":"menlo-bold-92.png","~":"menlo-bold-93.png","•":"menlo-bold-94.png"},tR={A:"menlo-bold-half-0.png",B:"menlo-bold-half-1.png",C:"menlo-bold-half-2.png",D:"menlo-bold-half-3.png",E:"menlo-bold-half-4.png",F:"menlo-bold-half-5.png",G:"menlo-bold-half-6.png",H:"menlo-bold-half-7.png",I:"menlo-bold-half-8.png",J:"menlo-bold-half-9.png",K:"menlo-bold-half-10.png",L:"menlo-bold-half-11.png",M:"menlo-bold-half-12.png",N:"menlo-bold-half-13.png",O:"menlo-bold-half-14.png",P:"menlo-bold-half-15.png",Q:"menlo-bold-half-16.png",R:"menlo-bold-half-17.png",S:"menlo-bold-half-18.png",T:"menlo-bold-half-19.png",U:"menlo-bold-half-20.png",V:"menlo-bold-half-21.png",W:"menlo-bold-half-22.png",X:"menlo-bold-half-23.png",Y:"menlo-bold-half-24.png",Z:"menlo-bold-half-25.png",a:"menlo-bold-half-26.png",b:"menlo-bold-half-27.png",c:"menlo-bold-half-28.png",d:"menlo-bold-half-29.png",e:"menlo-bold-half-30.png",f:"menlo-bold-half-31.png",g:"menlo-bold-half-32.png",h:"menlo-bold-half-33.png",i:"menlo-bold-half-34.png",j:"menlo-bold-half-35.png",k:"menlo-bold-half-36.png",l:"menlo-bold-half-37.png",m:"menlo-bold-half-38.png",n:"menlo-bold-half-39.png",o:"menlo-bold-half-40.png",p:"menlo-bold-half-41.png",q:"menlo-bold-half-42.png",r:"menlo-bold-half-43.png",s:"menlo-bold-half-44.png",t:"menlo-bold-half-45.png",u:"menlo-bold-half-46.png",v:"menlo-bold-half-47.png",w:"menlo-bold-half-48.png",x:"menlo-bold-half-49.png",y:"menlo-bold-half-50.png",z:"menlo-bold-half-51.png",0:"menlo-bold-half-52.png",1:"menlo-bold-half-53.png",2:"menlo-bold-half-54.png",3:"menlo-bold-half-55.png",4:"menlo-bold-half-56.png",5:"menlo-bold-half-57.png",6:"menlo-bold-half-58.png",7:"menlo-bold-half-59.png",8:"menlo-bold-half-60.png",9:"menlo-bold-half-61.png","!":"menlo-bold-half-62.png","@":"menlo-bold-half-63.png","#":"menlo-bold-half-64.png",$:"menlo-bold-half-65.png","%":"menlo-bold-half-66.png","^":"menlo-bold-half-67.png","&":"menlo-bold-half-68.png","*":"menlo-bold-half-69.png","(":"menlo-bold-half-70.png",")":"menlo-bold-half-71.png","-":"menlo-bold-half-72.png",_:"menlo-bold-half-73.png","=":"menlo-bold-half-74.png","+":"menlo-bold-half-75.png",",":"menlo-bold-half-76.png",".":"menlo-bold-half-77.png","<":"menlo-bold-half-78.png",">":"menlo-bold-half-79.png","/":"menlo-bold-half-80.png","?":"menlo-bold-half-81.png",";":"menlo-bold-half-82.png",":":"menlo-bold-half-83.png",'"':"menlo-bold-half-84.png","'":"menlo-bold-half-85.png","[":"menlo-bold-half-86.png","]":"menlo-bold-half-87.png","{":"menlo-bold-half-88.png","}":"menlo-bold-half-89.png","\\":"menlo-bold-half-90.png","|":"menlo-bold-half-91.png","`":"menlo-bold-half-92.png","~":"menlo-bold-half-93.png","•":"menlo-bold-half-94.png"};let Ag;const Sg={width:100,height:46},hn=window.innerWidth/Sg.width,eR=(i,t,e)=>{const n=Math.trunc(i/hn),r=Math.trunc(t/hn);return`${n},${r},${e}`},Ln={};async function iR(i){Ag=new nu({view:i,width:window.innerWidth,height:hn*Sg.height,autoDensity:!0,resolution:window.devicePixelRatio||1}),await nR()}const nR=async()=>(Ln.ascii=await Bn.load("/skulltooth/fonts/menlo-bold.json"),Ln.text=await Bn.load("/skulltooth/fonts/menlo-bold-half.json"),Ln.tile=await Bn.load("/skulltooth/tile.png"),Ln),rR=i=>Ln.ascii.textures[QI[i]],sR=i=>Ln.text.textures[tR[i]],oR=()=>Ln.tile;class yi{constructor(t){Jt(this,"x",0);Jt(this,"y",0);Jt(this,"halfWidth",!1);Jt(this,"width");Jt(this,"height");Jt(this,"layers",[]);Jt(this,"sprites",[]);Jt(this,"tileSets",[]);Jt(this,"tints",[]);Jt(this,"alphas",[]);Jt(this,"visible",!0);Jt(this,"_getTexture",t=>{const{tileSet:e,char:n}=t;return e==="ascii"?rR(n):e==="text"?sR(n):oR()});Jt(this,"_createSprite",t=>{const{char:e,width:n,height:r,layer:o,x:h,y:l,tileSet:c,tint:f=16777215,alpha:d=1}=t,g=this._getTexture({tileSet:c,char:e});let m=new Sr(g);m.width=this.halfWidth?n/2:n,m.height=r,m.x=this.halfWidth?h*(n/2):h*n,m.y=l*r,m.tint=f,m.alpha=d,this.sprites[o][l][h]=m,this.layers[o].addChild(m)});Jt(this,"updateCell",t=>(Object.keys(t).forEach(e=>{const{char:n,tint:r,alpha:o,tileSet:h,x:l,y:c}=t[e];this.updateSprite({char:n,tint:r,alpha:o,tileSet:h,x:l,y:c,layer:parseInt(e)})}),this));Jt(this,"updateSprite",async t=>{const{char:e="",layer:n,x:r,y:o,tileSet:h="text",tint:l,alpha:c}=t,f=this.sprites[n][o][r];if(f)return f.texture=this._getTexture({tileSet:h,char:e}),l&&(f.tint=l),c&&(f.alpha=c),this});Jt(this,"updateRows",t=>(t.forEach((e,n)=>{e.forEach((r,o)=>{this.clearRow(o,n),this.updateRow({...r,layer:o,y:n})})}),this));Jt(this,"updateRow",t=>{const{string:e="",layer:n=0,x:r,y:o,tileSet:h,tint:l,alpha:c}=t;return[...e].forEach((d,g)=>this.updateSprite({char:d,layer:n||0,x:r||0+g,y:o||0,tileSet:h||this.tileSets[n],tint:l||this.tints[n],alpha:c||this.alphas[n]})),(h||this.tileSets[n])==="tile"&&Sn.times(this.width,d=>{this.updateSprite({layer:n,x:r||0+d,y:o||0,tileSet:h||this.tileSets[n],tint:l||this.tints[n],alpha:c||this.alphas[n]})}),this});Jt(this,"clearRow",(t,e)=>{const n=new Array(this.width+1).join(" ");this.updateRow({string:n,layer:t,y:e})});Jt(this,"clearView",()=>{let t=0;this.layers.forEach(()=>{Sn.times(this.height,e=>{this.clearRow(t,e)}),t+=1})});Jt(this,"show",()=>{this.visible=!0,this.layers.forEach(t=>t.visible=this.visible)});Jt(this,"hide",()=>{this.visible=!1,this.layers.forEach(t=>t.visible=this.visible)});return this.width=t.width,this.height=t.height,this.tileSets=t.tileSets,this.tints=t.tints,this.alphas=t.alphas,this.halfWidth=this.tileSets.includes("text"),this.visible=t.visible,Sn.times(t.layers,()=>this.layers.push(new Ge)),this.layers.forEach(e=>{const n=this.halfWidth?t.x*(hn/2):t.x*hn,r=t.y*hn;e.x=n,e.y=r,e.interactiveChildren=!1,e.visible=this.visible,Ag.stage.addChild(e)}),Sn.times(t.layers,()=>this.sprites.push(Array.from(Array(this.height),()=>Array.from(Array(this.width))))),Sn.times(t.layers,e=>{Sn.times(this.height,n=>{Sn.times(this.width,async r=>{this._createSprite({char:"",width:hn,height:hn,layer:e,x:r,y:n,tileSet:t.tileSets[e],tint:t.tints[e],alpha:t.alphas[e]})})})}),this}}var Gt=(i=>(i.ActiveEffects="activeEffects",i.Ai="ai",i.Appearance="appearance",i.EffectsComponent="effects",i.Health="health",i.Inventory="inventory",i.IsBlocking="isBlocking",i.IsInFov="isInFov",i.IsOpaque="isOpaque",i.IsPlayer="isPlayer",i.IsRevealed="isRevealed",i.Layer="layer",i.Legendable="legendable",i.Name="name",i.PathThrough="pathThrough",i.Pickup="pickup",i.Position="position",i.TryMove="tryMove",i))(Gt||{});let Cg=0;const da=new Map,pa={},Yi={},Ig=()=>++Cg+Math.random().toString(36).slice(2,10),Ii=i=>Yi[i],Gi=(i,t)=>{const e={name:i,filters:t,entities:new Set};return Yi[i]=e,Yi},aR=(i,t)=>{const e=Yi[t].filters.all;if(e.length){const n=At(i);if(!n)throw`entity ${i} does not exist`;return be.exports.every(e,r=>n.components[r])}return!0},hR=(i,t)=>{const e=Yi[t].filters.any;if(e.length){const n=At(i);if(!n)throw`entity ${i} does not exist`;return be.exports.some(e,r=>n.components[r])}return!0},lR=(i,t)=>{const e=Yi[t].filters.none;if(e.length){const n=At(i);if(!n)throw`entity ${i} does not exist`;return be.exports.every(e,r=>!n.components[r])}return!0},uR=(i,t)=>{const e=Yi[t];return aR(i,t)&&hR(i,t)&&lR(i,t)?e.entities.add(i):e.entities.delete(i),e.entities},Rg=i=>{Object.keys(Yi).forEach(e=>uR(i,e))},cR=i=>{const t=(i==null?void 0:i.wId)||Ig(),e=(i==null?void 0:i.eIds)||new Set,n={id:t,eIds:e};return pa[t]=n,n},Cr=({eId:i,wId:t})=>{const e=i||Ig(),n={id:e,wId:t,components:{}};return da.set(e,n),pa[t].eIds.add(e),n},At=i=>da.get(i),fR=i=>{const t=At(i);t&&(pa[t.wId].eIds.delete(i),da.delete(t.id))},ge=(i,t)=>{const e=At(i);if(!e)throw`entity ${i} does not exist`;return Object.assign(e.components,t),Rg(i),e},Vi=(i,t)=>{const e=At(i);if(!e)throw`entity ${i} does not exist`;return delete e.components[t],Rg(i),e},Ir=(i,t)=>{t.forEach(e=>{ge(i,be.exports.cloneDeep(e))})},dR=()=>({entities:da,worlds:pa,queries:Yi,_id:Cg});var pi=(i=>(i.HasActiveEffects="hasActiveEffects",i.HasAi="hasAi",i.HasAppearance="hasAppearance",i.IsInFov="isInFov",i.IsLegendable="isLegendable",i.IsOpaque="isOpaque",i.IsPlayer="isPlayer",i.IsRevealed="isRevealed",i.IsTryingToMove="isTryingToMove",i))(pi||{});const pR=()=>{Gi("hasAi",{any:[],all:[Gt.Ai],none:[]}),Gi("hasAppearance",{any:[],all:[Gt.Appearance],none:[]}),Gi("isInFov",{any:[Gt.IsInFov],all:[],none:[]}),Gi("isLegendable",{any:[],all:[Gt.IsInFov,Gt.Legendable,Gt.Position],none:[]}),Gi("isOpaque",{any:[Gt.IsOpaque],all:[],none:[]}),Gi("isRevealed",{any:[Gt.IsRevealed],all:[],none:[Gt.IsInFov]}),Gi("isPlayer",{any:[Gt.IsPlayer],all:[],none:[]}),Gi("isTryingToMove",{any:[],all:[Gt.Position,Gt.TryMove],none:[]}),Gi("hasActiveEffects",{any:[],all:[Gt.ActiveEffects],none:[]})};var Pg={exports:{}},_s={exports:{}},Mg={exports:{}};(function(i){(function(){var t,e,n,r,o,h,l,c,f,d,g,m,_,v,w;n=Math.floor,d=Math.min,e=function(y,T){return y<T?-1:y>T?1:0},f=function(y,T,S,A,I){var D;if(S==null&&(S=0),I==null&&(I=e),S<0)throw new Error("lo must be non-negative");for(A==null&&(A=y.length);S<A;)D=n((S+A)/2),I(T,y[D])<0?A=D:S=D+1;return[].splice.apply(y,[S,S-S].concat(T)),T},h=function(y,T,S){return S==null&&(S=e),y.push(T),v(y,0,y.length-1,S)},o=function(y,T){var S,A;return T==null&&(T=e),S=y.pop(),y.length?(A=y[0],y[0]=S,w(y,0,T)):A=S,A},c=function(y,T,S){var A;return S==null&&(S=e),A=y[0],y[0]=T,w(y,0,S),A},l=function(y,T,S){var A;return S==null&&(S=e),y.length&&S(y[0],T)<0&&(A=[y[0],T],T=A[0],y[0]=A[1],w(y,0,S)),T},r=function(y,T){var S,A,I,D,N,L;for(T==null&&(T=e),D=function(){L=[];for(var F=0,V=n(y.length/2);0<=V?F<V:F>V;0<=V?F++:F--)L.push(F);return L}.apply(this).reverse(),N=[],A=0,I=D.length;A<I;A++)S=D[A],N.push(w(y,S,T));return N},_=function(y,T,S){var A;if(S==null&&(S=e),A=y.indexOf(T),A!==-1)return v(y,0,A,S),w(y,A,S)},g=function(y,T,S){var A,I,D,N,L;if(S==null&&(S=e),I=y.slice(0,T),!I.length)return I;for(r(I,S),L=y.slice(T),D=0,N=L.length;D<N;D++)A=L[D],l(I,A,S);return I.sort(S).reverse()},m=function(y,T,S){var A,I,D,N,L,F,V,J,z;if(S==null&&(S=e),T*10<=y.length){if(D=y.slice(0,T).sort(S),!D.length)return D;for(I=D[D.length-1],V=y.slice(T),N=0,F=V.length;N<F;N++)A=V[N],S(A,I)<0&&(f(D,A,0,null,S),D.pop(),I=D[D.length-1]);return D}for(r(y,S),z=[],L=0,J=d(T,y.length);0<=J?L<J:L>J;0<=J?++L:--L)z.push(o(y,S));return z},v=function(y,T,S,A){var I,D,N;for(A==null&&(A=e),I=y[S];S>T;){if(N=S-1>>1,D=y[N],A(I,D)<0){y[S]=D,S=N;continue}break}return y[S]=I},w=function(y,T,S){var A,I,D,N,L;for(S==null&&(S=e),I=y.length,L=T,D=y[T],A=2*T+1;A<I;)N=A+1,N<I&&!(S(y[A],y[N])<0)&&(A=N),y[T]=y[A],T=A,A=2*T+1;return y[T]=D,v(y,L,T,S)},t=function(){y.push=h,y.pop=o,y.replace=c,y.pushpop=l,y.heapify=r,y.updateItem=_,y.nlargest=g,y.nsmallest=m;function y(T){this.cmp=T??e,this.nodes=[]}return y.prototype.push=function(T){return h(this.nodes,T,this.cmp)},y.prototype.pop=function(){return o(this.nodes,this.cmp)},y.prototype.peek=function(){return this.nodes[0]},y.prototype.contains=function(T){return this.nodes.indexOf(T)!==-1},y.prototype.replace=function(T){return c(this.nodes,T,this.cmp)},y.prototype.pushpop=function(T){return l(this.nodes,T,this.cmp)},y.prototype.heapify=function(){return r(this.nodes,this.cmp)},y.prototype.updateItem=function(T){return _(this.nodes,T,this.cmp)},y.prototype.clear=function(){return this.nodes=[]},y.prototype.empty=function(){return this.nodes.length===0},y.prototype.size=function(){return this.nodes.length},y.prototype.clone=function(){var T;return T=new y,T.nodes=this.nodes.slice(0),T},y.prototype.toArray=function(){return this.nodes.slice(0)},y.prototype.insert=y.prototype.push,y.prototype.top=y.prototype.peek,y.prototype.front=y.prototype.peek,y.prototype.has=y.prototype.contains,y.prototype.copy=y.prototype.clone,y}(),i!==null&&i.exports?i.exports=t:window.Heap=t}).call(Hi)})(Mg);(function(i){i.exports=Mg.exports})(_s);function gR(i,t,e){this.x=i,this.y=t,this.walkable=e===void 0?!0:e}var hu=gR,mR={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4},Ze=mR,Dg=hu,Io=Ze;function ji(i,t,e){var n;typeof i!="object"?n=i:(t=i.length,n=i[0].length,e=i),this.width=n,this.height=t,this.nodes=this._buildNodes(n,t,e)}ji.prototype._buildNodes=function(i,t,e){var n,r,o=new Array(t);for(n=0;n<t;++n)for(o[n]=new Array(i),r=0;r<i;++r)o[n][r]=new Dg(r,n);if(e===void 0)return o;if(e.length!==t||e[0].length!==i)throw new Error("Matrix size does not fit");for(n=0;n<t;++n)for(r=0;r<i;++r)e[n][r]&&(o[n][r].walkable=!1);return o};ji.prototype.getNodeAt=function(i,t){return this.nodes[t][i]};ji.prototype.isWalkableAt=function(i,t){return this.isInside(i,t)&&this.nodes[t][i].walkable};ji.prototype.isInside=function(i,t){return i>=0&&i<this.width&&t>=0&&t<this.height};ji.prototype.setWalkableAt=function(i,t,e){this.nodes[t][i].walkable=e};ji.prototype.getNeighbors=function(i,t){var e=i.x,n=i.y,r=[],o=!1,h=!1,l=!1,c=!1,f=!1,d=!1,g=!1,m=!1,_=this.nodes;if(this.isWalkableAt(e,n-1)&&(r.push(_[n-1][e]),o=!0),this.isWalkableAt(e+1,n)&&(r.push(_[n][e+1]),l=!0),this.isWalkableAt(e,n+1)&&(r.push(_[n+1][e]),f=!0),this.isWalkableAt(e-1,n)&&(r.push(_[n][e-1]),g=!0),t===Io.Never)return r;if(t===Io.OnlyWhenNoObstacles)h=g&&o,c=o&&l,d=l&&f,m=f&&g;else if(t===Io.IfAtMostOneObstacle)h=g||o,c=o||l,d=l||f,m=f||g;else if(t===Io.Always)h=!0,c=!0,d=!0,m=!0;else throw new Error("Incorrect value of diagonalMovement");return h&&this.isWalkableAt(e-1,n-1)&&r.push(_[n-1][e-1]),c&&this.isWalkableAt(e+1,n-1)&&r.push(_[n-1][e+1]),d&&this.isWalkableAt(e+1,n+1)&&r.push(_[n+1][e+1]),m&&this.isWalkableAt(e-1,n+1)&&r.push(_[n+1][e-1]),r};ji.prototype.clone=function(){var i,t,e=this.width,n=this.height,r=this.nodes,o=new ji(e,n),h=new Array(n);for(i=0;i<n;++i)for(h[i]=new Array(e),t=0;t<e;++t)h[i][t]=new Dg(t,i,r[i][t].walkable);return o.nodes=h,o};var _R=ji,We={};function Yl(i){for(var t=[[i.x,i.y]];i.parent;)i=i.parent,t.push([i.x,i.y]);return t.reverse()}We.backtrace=Yl;function vR(i,t){var e=Yl(i),n=Yl(t);return e.concat(n.reverse())}We.biBacktrace=vR;function xR(i){var t,e=0,n,r,o,h;for(t=1;t<i.length;++t)n=i[t-1],r=i[t],o=n[0]-r[0],h=n[1]-r[1],e+=Math.sqrt(o*o+h*h);return e}We.pathLength=xR;function lu(i,t,e,n){var r=Math.abs,o=[],h,l,c,f,d,g;for(c=r(e-i),f=r(n-t),h=i<e?1:-1,l=t<n?1:-1,d=c-f;o.push([i,t]),!(i===e&&t===n);)g=2*d,g>-f&&(d=d-f,i=i+h),g<c&&(d=d+c,t=t+l);return o}We.interpolate=lu;function yR(i){var t=[],e=i.length,n,r,o,h,l,c;if(e<2)return t;for(l=0;l<e-1;++l)for(n=i[l],r=i[l+1],o=lu(n[0],n[1],r[0],r[1]),h=o.length,c=0;c<h-1;++c)t.push(o[c]);return t.push(i[e-1]),t}We.expandPath=yR;function bR(i,t){var e=t.length,n=t[0][0],r=t[0][1],o=t[e-1][0],h=t[e-1][1],l,c,f,d,g,m,_,v,w,y,T;for(l=n,c=r,g=[[l,c]],m=2;m<e;++m){for(v=t[m],f=v[0],d=v[1],w=lu(l,c,f,d),T=!1,_=1;_<w.length;++_)if(y=w[_],!i.isWalkableAt(y[0],y[1])){T=!0;break}T&&(lastValidCoord=t[m-1],g.push(lastValidCoord),l=lastValidCoord[0],c=lastValidCoord[1])}return g.push([o,h]),g}We.smoothenPath=bR;function wR(i){if(i.length<3)return i;var t=[],e=i[0][0],n=i[0][1],r=i[1][0],o=i[1][1],h=r-e,l=o-n,c,f,d,g,m,_;for(m=Math.sqrt(h*h+l*l),h/=m,l/=m,t.push([e,n]),_=2;_<i.length;_++)c=r,f=o,d=h,g=l,r=i[_][0],o=i[_][1],h=r-c,l=o-f,m=Math.sqrt(h*h+l*l),h/=m,l/=m,(h!==d||l!==g)&&t.push([c,f]);return t.push([r,o]),t}We.compressPath=wR;var vs={manhattan:function(i,t){return i+t},euclidean:function(i,t){return Math.sqrt(i*i+t*t)},octile:function(i,t){var e=Math.SQRT2-1;return i<t?e*i+t:e*t+i},chebyshev:function(i,t){return Math.max(i,t)}},ER=_s.exports,TR=We,al=vs,Ro=Ze;function Bg(i){i=i||{},this.allowDiagonal=i.allowDiagonal,this.dontCrossCorners=i.dontCrossCorners,this.heuristic=i.heuristic||al.manhattan,this.weight=i.weight||1,this.diagonalMovement=i.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Ro.OnlyWhenNoObstacles:this.diagonalMovement=Ro.IfAtMostOneObstacle:this.diagonalMovement=Ro.Never),this.diagonalMovement===Ro.Never?this.heuristic=i.heuristic||al.manhattan:this.heuristic=i.heuristic||al.octile}Bg.prototype.findPath=function(i,t,e,n,r){var o=new ER(function(D,N){return D.f-N.f}),h=r.getNodeAt(i,t),l=r.getNodeAt(e,n),c=this.heuristic,f=this.diagonalMovement,d=this.weight,g=Math.abs,m=Math.SQRT2,_,v,w,y,T,S,A,I;for(h.g=0,h.f=0,o.push(h),h.opened=!0;!o.empty();){if(_=o.pop(),_.closed=!0,_===l)return TR.backtrace(l);for(v=r.getNeighbors(_,f),y=0,T=v.length;y<T;++y)w=v[y],!w.closed&&(S=w.x,A=w.y,I=_.g+(S-_.x===0||A-_.y===0?1:m),(!w.opened||I<w.g)&&(w.g=I,w.h=w.h||d*c(g(S-e),g(A-n)),w.f=w.g+w.h,w.parent=_,w.opened?o.updateItem(w):(o.push(w),w.opened=!0)))}return[]};var uu=Bg,Fg=uu;function ta(i){Fg.call(this,i);var t=this.heuristic;this.heuristic=function(e,n){return t(e,n)*1e6}}ta.prototype=new Fg;ta.prototype.constructor=ta;var AR=ta,SR=We,hl=Ze;function Lg(i){i=i||{},this.allowDiagonal=i.allowDiagonal,this.dontCrossCorners=i.dontCrossCorners,this.diagonalMovement=i.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=hl.OnlyWhenNoObstacles:this.diagonalMovement=hl.IfAtMostOneObstacle:this.diagonalMovement=hl.Never)}Lg.prototype.findPath=function(i,t,e,n,r){var o=[],h=this.diagonalMovement,l=r.getNodeAt(i,t),c=r.getNodeAt(e,n),f,d,g,m,_;for(o.push(l),l.opened=!0;o.length;){if(g=o.shift(),g.closed=!0,g===c)return SR.backtrace(c);for(f=r.getNeighbors(g,h),m=0,_=f.length;m<_;++m)d=f[m],!(d.closed||d.opened)&&(o.push(d),d.opened=!0,d.parent=g)}return[]};var CR=Lg,Og=uu;function ea(i){Og.call(this,i),this.heuristic=function(t,e){return 0}}ea.prototype=new Og;ea.prototype.constructor=ea;var IR=ea,Zd=_s.exports,Jd=We,ll=vs,Po=Ze;function Ng(i){i=i||{},this.allowDiagonal=i.allowDiagonal,this.dontCrossCorners=i.dontCrossCorners,this.diagonalMovement=i.diagonalMovement,this.heuristic=i.heuristic||ll.manhattan,this.weight=i.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Po.OnlyWhenNoObstacles:this.diagonalMovement=Po.IfAtMostOneObstacle:this.diagonalMovement=Po.Never),this.diagonalMovement===Po.Never?this.heuristic=i.heuristic||ll.manhattan:this.heuristic=i.heuristic||ll.octile}Ng.prototype.findPath=function(i,t,e,n,r){var o=function(V,J){return V.f-J.f},h=new Zd(o),l=new Zd(o),c=r.getNodeAt(i,t),f=r.getNodeAt(e,n),d=this.heuristic,g=this.diagonalMovement,m=this.weight,_=Math.abs,v=Math.SQRT2,w,y,T,S,A,I,D,N,L=1,F=2;for(c.g=0,c.f=0,h.push(c),c.opened=L,f.g=0,f.f=0,l.push(f),f.opened=F;!h.empty()&&!l.empty();){for(w=h.pop(),w.closed=!0,y=r.getNeighbors(w,g),S=0,A=y.length;S<A;++S)if(T=y[S],!T.closed){if(T.opened===F)return Jd.biBacktrace(w,T);I=T.x,D=T.y,N=w.g+(I-w.x===0||D-w.y===0?1:v),(!T.opened||N<T.g)&&(T.g=N,T.h=T.h||m*d(_(I-e),_(D-n)),T.f=T.g+T.h,T.parent=w,T.opened?h.updateItem(T):(h.push(T),T.opened=L))}for(w=l.pop(),w.closed=!0,y=r.getNeighbors(w,g),S=0,A=y.length;S<A;++S)if(T=y[S],!T.closed){if(T.opened===L)return Jd.biBacktrace(T,w);I=T.x,D=T.y,N=w.g+(I-w.x===0||D-w.y===0?1:v),(!T.opened||N<T.g)&&(T.g=N,T.h=T.h||m*d(_(I-i),_(D-t)),T.f=T.g+T.h,T.parent=w,T.opened?l.updateItem(T):(l.push(T),T.opened=F))}}return[]};var cu=Ng,kg=cu;function ia(i){kg.call(this,i);var t=this.heuristic;this.heuristic=function(e,n){return t(e,n)*1e6}}ia.prototype=new kg;ia.prototype.constructor=ia;var RR=ia,Qd=We,ul=Ze;function Ug(i){i=i||{},this.allowDiagonal=i.allowDiagonal,this.dontCrossCorners=i.dontCrossCorners,this.diagonalMovement=i.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=ul.OnlyWhenNoObstacles:this.diagonalMovement=ul.IfAtMostOneObstacle:this.diagonalMovement=ul.Never)}Ug.prototype.findPath=function(i,t,e,n,r){var o=r.getNodeAt(i,t),h=r.getNodeAt(e,n),l=[],c=[],f,d,g,m=this.diagonalMovement,_=0,v=1,w,y;for(l.push(o),o.opened=!0,o.by=_,c.push(h),h.opened=!0,h.by=v;l.length&&c.length;){for(g=l.shift(),g.closed=!0,f=r.getNeighbors(g,m),w=0,y=f.length;w<y;++w)if(d=f[w],!d.closed){if(d.opened){if(d.by===v)return Qd.biBacktrace(g,d);continue}l.push(d),d.parent=g,d.opened=!0,d.by=_}for(g=c.shift(),g.closed=!0,f=r.getNeighbors(g,m),w=0,y=f.length;w<y;++w)if(d=f[w],!d.closed){if(d.opened){if(d.by===_)return Qd.biBacktrace(d,g);continue}c.push(d),d.parent=g,d.opened=!0,d.by=v}}return[]};var PR=Ug,Gg=cu;function na(i){Gg.call(this,i),this.heuristic=function(t,e){return 0}}na.prototype=new Gg;na.prototype.constructor=na;var MR=na,cl=vs,tp=hu,Mo=Ze;function Wg(i){i=i||{},this.allowDiagonal=i.allowDiagonal,this.dontCrossCorners=i.dontCrossCorners,this.diagonalMovement=i.diagonalMovement,this.heuristic=i.heuristic||cl.manhattan,this.weight=i.weight||1,this.trackRecursion=i.trackRecursion||!1,this.timeLimit=i.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=Mo.OnlyWhenNoObstacles:this.diagonalMovement=Mo.IfAtMostOneObstacle:this.diagonalMovement=Mo.Never),this.diagonalMovement===Mo.Never?this.heuristic=i.heuristic||cl.manhattan:this.heuristic=i.heuristic||cl.octile}Wg.prototype.findPath=function(i,t,e,n,r){var o=new Date().getTime(),h=function(w,y){return this.heuristic(Math.abs(y.x-w.x),Math.abs(y.y-w.y))}.bind(this),l=function(w,y){return w.x===y.x||w.y===y.y?1:Math.SQRT2},c=function(w,y,T,S,A){if(this.timeLimit>0&&new Date().getTime()-o>this.timeLimit*1e3)return 1/0;var I=y+h(w,d)*this.weight;if(I>T)return I;if(w==d)return S[A]=[w.x,w.y],w;var D,N,L,F,V=r.getNeighbors(w,this.diagonalMovement);for(L=0,D=1/0;F=V[L];++L){if(this.trackRecursion&&(F.retainCount=F.retainCount+1||1,F.tested!==!0&&(F.tested=!0)),N=c(F,y+l(w,F),T,S,A+1),N instanceof tp)return S[A]=[w.x,w.y],N;this.trackRecursion&&--F.retainCount===0&&(F.tested=!1),N<D&&(D=N)}return D}.bind(this),f=r.getNodeAt(i,t),d=r.getNodeAt(e,n),g=h(f,d),m,_,v;for(m=0;;++m){if(_=[],v=c(f,0,g,_,0),v===1/0)return[];if(v instanceof tp)return _;g=v}return[]};var DR=Wg,BR=_s.exports,ep=We,Hg=vs;function fu(i){i=i||{},this.heuristic=i.heuristic||Hg.manhattan,this.trackJumpRecursion=i.trackJumpRecursion||!1}fu.prototype.findPath=function(i,t,e,n,r){var o=this.openList=new BR(function(f,d){return f.f-d.f}),h=this.startNode=r.getNodeAt(i,t),l=this.endNode=r.getNodeAt(e,n),c;for(this.grid=r,h.g=0,h.f=0,o.push(h),h.opened=!0;!o.empty();){if(c=o.pop(),c.closed=!0,c===l)return ep.expandPath(ep.backtrace(l));this._identifySuccessors(c)}return[]};fu.prototype._identifySuccessors=function(i){var t=this.grid,e=this.heuristic,n=this.openList,r=this.endNode.x,o=this.endNode.y,h,l,c,f,d,g=i.x,m=i.y,_,v,w,y,T,S=Math.abs;for(h=this._findNeighbors(i),f=0,d=h.length;f<d;++f)if(l=h[f],c=this._jump(l[0],l[1],g,m),c){if(_=c[0],v=c[1],T=t.getNodeAt(_,v),T.closed)continue;w=Hg.octile(S(_-g),S(v-m)),y=i.g+w,(!T.opened||y<T.g)&&(T.g=y,T.h=T.h||e(S(_-r),S(v-o)),T.f=T.g+T.h,T.parent=i,T.opened?n.updateItem(T):(n.push(T),T.opened=!0))}};var ga=fu,Xg=ga,FR=Ze;function br(i){Xg.call(this,i)}br.prototype=new Xg;br.prototype.constructor=br;br.prototype._jump=function(i,t,e,n){var r=this.grid,o=i-e,h=t-n;if(!r.isWalkableAt(i,t))return null;if(this.trackJumpRecursion===!0&&(r.getNodeAt(i,t).tested=!0),r.getNodeAt(i,t)===this.endNode)return[i,t];if(o!==0){if(r.isWalkableAt(i,t-1)&&!r.isWalkableAt(i-o,t-1)||r.isWalkableAt(i,t+1)&&!r.isWalkableAt(i-o,t+1))return[i,t]}else if(h!==0){if(r.isWalkableAt(i-1,t)&&!r.isWalkableAt(i-1,t-h)||r.isWalkableAt(i+1,t)&&!r.isWalkableAt(i+1,t-h))return[i,t];if(this._jump(i+1,t,i,t)||this._jump(i-1,t,i,t))return[i,t]}else throw new Error("Only horizontal and vertical movements are allowed");return this._jump(i+o,t+h,i,t)};br.prototype._findNeighbors=function(i){var t=i.parent,e=i.x,n=i.y,r=this.grid,o,h,l,c,f=[],d,g,m,_;if(t)o=t.x,h=t.y,l=(e-o)/Math.max(Math.abs(e-o),1),c=(n-h)/Math.max(Math.abs(n-h),1),l!==0?(r.isWalkableAt(e,n-1)&&f.push([e,n-1]),r.isWalkableAt(e,n+1)&&f.push([e,n+1]),r.isWalkableAt(e+l,n)&&f.push([e+l,n])):c!==0&&(r.isWalkableAt(e-1,n)&&f.push([e-1,n]),r.isWalkableAt(e+1,n)&&f.push([e+1,n]),r.isWalkableAt(e,n+c)&&f.push([e,n+c]));else for(d=r.getNeighbors(i,FR.Never),m=0,_=d.length;m<_;++m)g=d[m],f.push([g.x,g.y]);return f};var LR=br,$g=ga,OR=Ze;function wr(i){$g.call(this,i)}wr.prototype=new $g;wr.prototype.constructor=wr;wr.prototype._jump=function(i,t,e,n){var r=this.grid,o=i-e,h=t-n;if(!r.isWalkableAt(i,t))return null;if(this.trackJumpRecursion===!0&&(r.getNodeAt(i,t).tested=!0),r.getNodeAt(i,t)===this.endNode)return[i,t];if(o!==0&&h!==0){if(r.isWalkableAt(i-o,t+h)&&!r.isWalkableAt(i-o,t)||r.isWalkableAt(i+o,t-h)&&!r.isWalkableAt(i,t-h))return[i,t];if(this._jump(i+o,t,i,t)||this._jump(i,t+h,i,t))return[i,t]}else if(o!==0){if(r.isWalkableAt(i+o,t+1)&&!r.isWalkableAt(i,t+1)||r.isWalkableAt(i+o,t-1)&&!r.isWalkableAt(i,t-1))return[i,t]}else if(r.isWalkableAt(i+1,t+h)&&!r.isWalkableAt(i+1,t)||r.isWalkableAt(i-1,t+h)&&!r.isWalkableAt(i-1,t))return[i,t];return this._jump(i+o,t+h,i,t)};wr.prototype._findNeighbors=function(i){var t=i.parent,e=i.x,n=i.y,r=this.grid,o,h,l,c,f=[],d,g,m,_;if(t)o=t.x,h=t.y,l=(e-o)/Math.max(Math.abs(e-o),1),c=(n-h)/Math.max(Math.abs(n-h),1),l!==0&&c!==0?(r.isWalkableAt(e,n+c)&&f.push([e,n+c]),r.isWalkableAt(e+l,n)&&f.push([e+l,n]),r.isWalkableAt(e+l,n+c)&&f.push([e+l,n+c]),r.isWalkableAt(e-l,n)||f.push([e-l,n+c]),r.isWalkableAt(e,n-c)||f.push([e+l,n-c])):l===0?(r.isWalkableAt(e,n+c)&&f.push([e,n+c]),r.isWalkableAt(e+1,n)||f.push([e+1,n+c]),r.isWalkableAt(e-1,n)||f.push([e-1,n+c])):(r.isWalkableAt(e+l,n)&&f.push([e+l,n]),r.isWalkableAt(e,n+1)||f.push([e+l,n+1]),r.isWalkableAt(e,n-1)||f.push([e+l,n-1]));else for(d=r.getNeighbors(i,OR.Always),m=0,_=d.length;m<_;++m)g=d[m],f.push([g.x,g.y]);return f};var NR=wr,zg=ga,kR=Ze;function Er(i){zg.call(this,i)}Er.prototype=new zg;Er.prototype.constructor=Er;Er.prototype._jump=function(i,t,e,n){var r=this.grid,o=i-e,h=t-n;if(!r.isWalkableAt(i,t))return null;if(this.trackJumpRecursion===!0&&(r.getNodeAt(i,t).tested=!0),r.getNodeAt(i,t)===this.endNode)return[i,t];if(o!==0&&h!==0){if(this._jump(i+o,t,i,t)||this._jump(i,t+h,i,t))return[i,t]}else if(o!==0){if(r.isWalkableAt(i,t-1)&&!r.isWalkableAt(i-o,t-1)||r.isWalkableAt(i,t+1)&&!r.isWalkableAt(i-o,t+1))return[i,t]}else if(h!==0&&(r.isWalkableAt(i-1,t)&&!r.isWalkableAt(i-1,t-h)||r.isWalkableAt(i+1,t)&&!r.isWalkableAt(i+1,t-h)))return[i,t];return r.isWalkableAt(i+o,t)&&r.isWalkableAt(i,t+h)?this._jump(i+o,t+h,i,t):null};Er.prototype._findNeighbors=function(i){var t=i.parent,e=i.x,n=i.y,r=this.grid,o,h,l,c,f=[],d,g,m,_;if(t)if(o=t.x,h=t.y,l=(e-o)/Math.max(Math.abs(e-o),1),c=(n-h)/Math.max(Math.abs(n-h),1),l!==0&&c!==0)r.isWalkableAt(e,n+c)&&f.push([e,n+c]),r.isWalkableAt(e+l,n)&&f.push([e+l,n]),r.isWalkableAt(e,n+c)&&r.isWalkableAt(e+l,n)&&f.push([e+l,n+c]);else{var v;if(l!==0){v=r.isWalkableAt(e+l,n);var w=r.isWalkableAt(e,n+1),y=r.isWalkableAt(e,n-1);v&&(f.push([e+l,n]),w&&f.push([e+l,n+1]),y&&f.push([e+l,n-1])),w&&f.push([e,n+1]),y&&f.push([e,n-1])}else if(c!==0){v=r.isWalkableAt(e,n+c);var T=r.isWalkableAt(e+1,n),S=r.isWalkableAt(e-1,n);v&&(f.push([e,n+c]),T&&f.push([e+1,n+c]),S&&f.push([e-1,n+c])),T&&f.push([e+1,n]),S&&f.push([e-1,n])}}else for(d=r.getNeighbors(i,kR.OnlyWhenNoObstacles),m=0,_=d.length;m<_;++m)g=d[m],f.push([g.x,g.y]);return f};var UR=Er,Vg=ga,GR=Ze;function Tr(i){Vg.call(this,i)}Tr.prototype=new Vg;Tr.prototype.constructor=Tr;Tr.prototype._jump=function(i,t,e,n){var r=this.grid,o=i-e,h=t-n;if(!r.isWalkableAt(i,t))return null;if(this.trackJumpRecursion===!0&&(r.getNodeAt(i,t).tested=!0),r.getNodeAt(i,t)===this.endNode)return[i,t];if(o!==0&&h!==0){if(r.isWalkableAt(i-o,t+h)&&!r.isWalkableAt(i-o,t)||r.isWalkableAt(i+o,t-h)&&!r.isWalkableAt(i,t-h))return[i,t];if(this._jump(i+o,t,i,t)||this._jump(i,t+h,i,t))return[i,t]}else if(o!==0){if(r.isWalkableAt(i+o,t+1)&&!r.isWalkableAt(i,t+1)||r.isWalkableAt(i+o,t-1)&&!r.isWalkableAt(i,t-1))return[i,t]}else if(r.isWalkableAt(i+1,t+h)&&!r.isWalkableAt(i+1,t)||r.isWalkableAt(i-1,t+h)&&!r.isWalkableAt(i-1,t))return[i,t];return r.isWalkableAt(i+o,t)||r.isWalkableAt(i,t+h)?this._jump(i+o,t+h,i,t):null};Tr.prototype._findNeighbors=function(i){var t=i.parent,e=i.x,n=i.y,r=this.grid,o,h,l,c,f=[],d,g,m,_;if(t)o=t.x,h=t.y,l=(e-o)/Math.max(Math.abs(e-o),1),c=(n-h)/Math.max(Math.abs(n-h),1),l!==0&&c!==0?(r.isWalkableAt(e,n+c)&&f.push([e,n+c]),r.isWalkableAt(e+l,n)&&f.push([e+l,n]),(r.isWalkableAt(e,n+c)||r.isWalkableAt(e+l,n))&&f.push([e+l,n+c]),!r.isWalkableAt(e-l,n)&&r.isWalkableAt(e,n+c)&&f.push([e-l,n+c]),!r.isWalkableAt(e,n-c)&&r.isWalkableAt(e+l,n)&&f.push([e+l,n-c])):l===0?r.isWalkableAt(e,n+c)&&(f.push([e,n+c]),r.isWalkableAt(e+1,n)||f.push([e+1,n+c]),r.isWalkableAt(e-1,n)||f.push([e-1,n+c])):r.isWalkableAt(e+l,n)&&(f.push([e+l,n]),r.isWalkableAt(e,n+1)||f.push([e+l,n+1]),r.isWalkableAt(e,n-1)||f.push([e+l,n-1]));else for(d=r.getNeighbors(i,GR.IfAtMostOneObstacle),m=0,_=d.length;m<_;++m)g=d[m],f.push([g.x,g.y]);return f};var WR=Tr,fl=Ze,HR=LR,XR=NR,$R=UR,zR=WR;function VR(i){return i=i||{},i.diagonalMovement===fl.Never?new HR(i):i.diagonalMovement===fl.Always?new XR(i):i.diagonalMovement===fl.OnlyWhenNoObstacles?new $R(i):new zR(i)}var YR=VR,jR={Heap:_s.exports,Node:hu,Grid:_R,Util:We,DiagonalMovement:Ze,Heuristic:vs,AStarFinder:uu,BestFirstFinder:AR,BreadthFirstFinder:CR,DijkstraFinder:IR,BiAStarFinder:cu,BiBestFirstFinder:RR,BiBreadthFirstFinder:PR,BiDijkstraFinder:MR,IDAStarFinder:DR,JumpPointFinder:YR};(function(i){i.exports=jR})(Pg);const ip=Ob(Pg.exports),Hn=i=>`${i.x},${i.y},${i.z}`,qR=i=>{const t=i.split(",").map(e=>parseInt(e,10));return{x:t[0],y:t[1],z:t[2]}},np=(i,t)=>{const{x:e,y:n,z:r,width:o,height:h,hasWalls:l}=i,c={},f=e,d=e+o,g=n,m=n+h;if(l)for(let v=g+1;v<m-1;v++)for(let w=f+1;w<d-1;w++)c[`${w},${v},${r}`]={x:w,y:v,z:r,...t};else for(let v=g;v<m;v++)for(let w=f;w<d;w++)c[`${w},${v},${r}`]={x:w,y:v,z:r,...t};const _={x:Math.round((f+d)/2),y:Math.round((g+m)/2),z:r};return{x1:f,x2:d,y1:g,y2:m,z:r,center:_,hasWalls:l,tiles:c,width:o,height:h}},KR=(i,t)=>i.x1<=t.x2&&i.x2>=t.x1&&i.y1<=t.y2&&i.y2>=t.y1,ZR=(i,t)=>{const e=Math.pow(t.x-i.x,2),n=Math.pow(t.y-i.y,2);return Math.floor(Math.sqrt(e+n))},Yg=(i,t)=>{const{width:e,height:n}=Ct().views.map,r=new ip.Grid(e,n);return Object.keys(Ct().eAP).forEach(c=>{const f=qR(c);be.exports.some([...Ct().eAP[c]],d=>{const g=At(d);if(g)return g.components.isBlocking&&!g.components.pathThrough})&&r.setWalkableAt(f.x,f.y,!1)}),r.setWalkableAt(i.x,i.y,!0),r.setWalkableAt(t.x,t.y,!0),new ip.AStarFinder({}).findPath(i.x,i.y,t.x,t.y,r)},JR=()=>{const i=Ii(pi.IsPlayer),t=Ii(pi.HasAi);let e;i.entities.forEach(n=>{const r=At(n);r&&(e=r)}),t.entities.forEach(n=>{const r=At(n);if(!(r!=null&&r.components.position)||!(e!=null&&e.components.position))return;const o=Yg(r.components.position,e.components.position);if(!o[1])return;const h={x:o[1][0],y:o[1][1],z:r.components.position.z};ge(r.id,{tryMove:h})})},dl=()=>{Ii(pi.HasActiveEffects).entities.forEach(t=>{const e=At(t);if(e)for(const[n,r]of e.components.activeEffects.entries()){const{component:o,delta:h}=r;if(!e.components[o])return;e.components[o].current+=h,e.components[o].current>e.components[o].max&&(e.components[o].current=e.components[o].max),r.duration<=0?e.components.activeEffects.splice(n,1):r.duration-=1}})},QR=[{xx:1,xy:0,yx:0,yy:1},{xx:1,xy:0,yx:0,yy:-1},{xx:-1,xy:0,yx:0,yy:1},{xx:-1,xy:0,yx:0,yy:-1},{xx:0,xy:1,yx:1,yy:0},{xx:0,xy:1,yx:-1,yy:0},{xx:0,xy:-1,yx:1,yy:0},{xx:0,xy:-1,yx:-1,yy:0}];function tP(i,t,e,n,r){const{x:o,y:h,z:l}=n,c=new Set,f=new Set;i.entities.forEach(_=>{const v=At(_);if(v){const w=v.components.position;w.z===l&&f.add(`${w.x},${w.y},${w.z}`)}});const d=(_,v)=>{const w=`${_},${v},${l}`;return!!f.has(w)},g=(_,v)=>c.add(`${_},${v},${l}`);function m(_,v,w,y,T,S,A){let I=0;if(y<T)return;let D=!1;for(let N=w;N<A&&!D;N++){let L=-N;for(let F=-N;F<=0;F++){let V=_+F*S.xx+L*S.xy,J=v+F*S.yx+L*S.yy,z=(F-.5)/(L+.5),Q=(F+.5)/(L-.5);if(!(!(V>=0&&J>=0&&V<t&&J<e)||y<Q)){if(T>z)break;if(Math.sqrt(F*F+L*L)<=A&&g(V,J),D)if(d(V,J)){I=Q;continue}else D=!1,y=I;else d(V,J)&&N<A&&(D=!0,m(_,v,N+1,y,z,S,A),I=Q)}}}}g(o,h);for(let _ of QR)m(o,h,1,1,0,_,r);return{fov:c}}const Go=()=>{const i=Ii(pi.IsInFov),t=Ii(pi.IsOpaque),e=At(Ct().playerEId);if(!e){console.log("no player entity");return}const n=e.components.position;if(!n)return;const r=tP(t,74,39,n,10);i.entities.forEach(o=>{const h=At(o);if(!h)return;const l=h.components.position;if(!l)return;const c=Hn(l);me(f=>f.toRender.add(c)),Vi(o,Gt.IsInFov)}),r.fov.forEach(o=>{me(l=>l.toRender.add(o));const h=Ct().eAP[o];h&&h.forEach(l=>{ge(l,{isInFov:{},isRevealed:{}})})})},Wo=()=>{const i=Ii(pi.IsLegendable),t=Ii(pi.IsPlayer),[e]=t.entities,n=At(e);if(!n)return;const r=[n];i.entities.forEach(h=>{const l=At(h);l&&l.id!==n.id&&l&&r.push(l)});const o=n.components.position;r.sort(h=>ZR(o,h.components.position)),me(h=>{h.legend=r.map(l=>l.id)})},eP=(i,t)=>{const e=At(i);if(!e)return;const{x:n,y:r,z:o}=t;Kg(e),e.components.position.x=n,e.components.position.y=r,e.components.position.z=o,Pr(e)},du=(i,t)=>{const e=At(i);e&&(ge(i,{position:t}),Pr(e))},pu=i=>{const t=At(i);t&&(Kg(t),Vi(i,Gt.Position))},On=i=>{me(t=>t.log.push(i))},iP=(i,t)=>{t.components.activeEffects&&t.components.activeEffects.push(...i)},rp=()=>{Ii(pi.IsTryingToMove).entities.forEach(t=>{const e=At(t);if(!e||rP(e))return;const n=Hn(e.components.tryMove),r=Ct().eAP[n];for(const o of r){const h=At(o);if(h!=null&&h.components.isBlocking){sP(e,h),Vi(e.id,Gt.TryMove);return}}nP(e)})},nP=i=>{const{x:t,y:e,z:n}=i.components.tryMove;Vi(i.id,Gt.TryMove),eP(i.id,{x:t,y:e,z:n})},rP=i=>{const{x:t,y:e}=i.components.tryMove,{width:n,height:r}=Ct().views.map;return t<0||e<0||t>=n||e>=r},sP=(i,t)=>{t!=null&&t.components.health&&(t.components.health.current-=5,On(`${i.components.name} hits ${t.components.name} for 5 damage!`),t.components.health.current<=0&&oP(t,i))},oP=(i,t)=>{i.components.appearance.char="%",On(`${i.components.name} has been defeated by ${t.components.name}!`),i.components.isPlayer&&aP(),Vi(i.id,Gt.Ai),Vi(i.id,Gt.IsBlocking)},aP=()=>{me(i=>i.gameState=un.GAME_OVER),On("Game Over!")},ar=(i,t)=>{let e=i;if(e.length>t){const n=e.length-(t-3);e=e.substring(0,e.length-n).trim().concat("...")}return e},hP=i=>i<4?(100-(5-i)*7)/100:1,Ho=()=>{const i=Ii(pi.IsPlayer),{map:t,log:e,senses:n,legend:r,inventory:o,overlay:h,controls:l}=Ct().views;for(const c of Ct().toRender){const f=Ct().eAP[c];if(f){const d=[];for(const T of f){const S=At(T);if(!S)return;d.push(S)}const g=be.exports.sortBy(d,"components.layer"),m=g[g.length-1],{char:_,tint:v}=m.components.appearance,{x:w,y}=m.components.position;m.components.isRevealed&&(t==null||t.updateCell({0:{char:_,tint:1,alpha:0,tileSet:"tile",x:w,y},1:{char:_,tint:v,alpha:.35,tileSet:"ascii",x:w,y}})),m.components.isInFov&&(t==null||t.updateCell({0:{char:_,tint:1118481,alpha:0,tileSet:"tile",x:w,y},1:{char:_,tint:v,alpha:1,tileSet:"ascii",x:w,y}}))}}me(c=>c.toRender=new Set);{const c=Ct().log,f=c.slice(Math.max(c.length-5,0)),d=e.width-1;e==null||e.updateRows(f.map((g,m)=>[{string:ar(g,d),alpha:hP(m)}]))}{const c=Ct().senses,f=n.width-1;n==null||n.updateRows([[{string:ar(c.feel,f)}],[{string:ar(c.see,f)}],[{string:ar(c.hear,f)}],[{string:ar(c.smell,f)}],[{string:ar(c.taste,f)}]])}{r==null||r.clearView();const c=Ct().legend,f=[];c.forEach(d=>{var w;const g=At(d),m=(w=g==null?void 0:g.components.appearance)==null?void 0:w.char,_=g==null?void 0:g.components.name,v=`${m} ${_}`;f.push([{string:v}])}),r==null||r.updateRows(f)}if(Ct().gameState===un.INVENTORY){const[c]=i.entities,f=At(c);if(!f)return;const d=[];[...f.components.inventory||[]].map(_=>At(_)).forEach(_=>{var v;d.push([{},{string:`${(v=_==null?void 0:_.components.appearance)==null?void 0:v.char} ${_==null?void 0:_.components.name}`}])}),h==null||h.show(),o==null||o.clearView(),o==null||o.updateRows(d),o==null||o.show()}else h==null||h.hide(),o==null||o.hide();{let c="(arrows/hjkl)Move (i)Inventory";Ct().gameState===un.INVENTORY&&(c="(i/escape)Return to Game (d)Drop (c)Consume"),l==null||l.updateRows([[],[{string:c}]])}},lP=(i,t)=>{const e=At(t);e!=null&&e.components.inventory&&(e.components.inventory.add(i),pu(i),Vi(i,Gt.Legendable),Vi(i,Gt.IsInFov),Vi(i,Gt.IsRevealed))},uP=(i,t)=>{const e=At(t),n=At(i);!e||!n||e.components.inventory&&e.components.position&&(e.components.inventory.delete(i),du(i,{...e.components.position}),ge(i,{legendable:{}}))},cP=["ArrowLeft","ArrowDown","ArrowUp","ArrowRight","h","j","k","l"],sp=()=>{const{userInput:i,gameState:t}=Ct(),e=Ii(pi.IsPlayer),[n]=e.entities,r=At(n);if(!r)return;if(!i)return me(h=>{h.userInput=null});const{key:o}=i;if(t===un.GAME){if(o==="i"&&me(h=>h.gameState=un.INVENTORY),cP.includes(o)&&r!=null&&r.components.position){const{x:h,y:l,z:c}=r.components.position,f=r.id;if(o==="h"||o==="ArrowLeft"){const d={x:h-1,y:l,z:c};ge(f,{tryMove:d})}if(o==="j"||o==="ArrowDown"){const d={x:h,y:l+1,z:c};ge(f,{tryMove:d})}if(o==="k"||o==="ArrowUp"){const d={x:h,y:l-1,z:c};ge(f,{tryMove:d})}if(o==="l"||o==="ArrowRight"){const d={x:h+1,y:l,z:c};ge(f,{tryMove:d})}}if(o==="g"){const h=r.components.position;if(!h)return;const l=Ct().eAP[Hn(h)];let c=!0;l.forEach(f=>{const d=At(f);d!=null&&d.components.pickup&&(lP(f,r.id),On(`You pickup ${d.components.name}`),c=!1)}),c&&On("There is nothing to pickup")}}if(t===un.INVENTORY){if((o==="i"||o==="Escape")&&me(h=>h.gameState=un.GAME),o==="c"){if(!r.components.inventory)return;const[h]=r.components.inventory,l=At(h);if(!l||!l.components.effects)return;iP(l.components.effects,r),r.components.inventory.delete(h),On(`You consume the ${l.components.name}.`),fR(l.id)}if(o==="d"){if(!r.components.inventory)return;const[h]=r.components.inventory,l=At(h);if(!l)return;uP(h,r.id),On(`You drop a ${l.components.name}`)}}me(h=>{h.userInput=null})},Rr={appearance:{char:"?",tint:3355443,tileSet:"ascii"},position:{x:0,y:0,z:0},name:"unnamed"},fP={layer:100,name:"unnamed"},dP={isBlocking:{},isOpaque:{},layer:101,name:"unnamed"},jg={health:{max:10,current:10},isBlocking:{},layer:201,name:"unnamed",legendable:{},activeEffects:[]},qg={layer:200,legendable:{},pickup:{}},pP={ai:{},pathThrough:{},legendable:{}},gP=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,fP]),e.components.appearance.char="•",e.components.name="floor",t&&(ge(e.id,{position:t}),Pr(e)),e},mP=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,dP]),e.components.appearance.char="#",e.components.appearance.tint=8421504,e.components.name="wall",t&&(ge(e.id,{position:t}),Pr(e)),e},_P=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,jg]),ge(e.id,{appearance:{char:"@",tint:16711816,tileSet:"ascii"},isPlayer:{},name:"player",inventory:new Set,health:{max:100,current:98}}),t&&(ge(e.id,{position:t}),Pr(e)),e},op=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,jg,pP]),ge(e.id,{appearance:{char:"F",tint:16711816,tileSet:"ascii"},name:"owlbear"}),t&&(ge(e.id,{position:t}),Pr(e)),e},vP=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,qg]),ge(e.id,{appearance:{char:"!",tint:16711816,tileSet:"ascii"},name:"health potion",effects:[{name:"heal",component:Gt.Health,delta:3,duration:1,id:"123"}]}),t?du(e.id,t):pu(e.id),e},xP=(i,t)=>{const e=Cr({wId:i});return Ir(e.id,[Rr,qg]),ge(e.id,{appearance:{char:"!",tint:16711816,tileSet:"ascii"},name:"poison",effects:[{name:"harm",component:Gt.Health,delta:-3,duration:1,id:"123"}]}),t?du(e.id,t):pu(e.id),e};function yP(i,t){const e={},n=Math.min(i.x,t.x),r=Math.max(i.x,t.x)+1;let o=n;for(;o<r;){const h={...t,x:o};e[Hn(h)]={...h,sprite:"FLOOR"},o++}return e}function bP(i,t){const e={},n=Math.min(i.y,t.y),r=Math.max(i.y,t.y)+1;let o=n;for(;o<r;){const h={...i,y:o};e[Hn(h)]={...h,sprite:"FLOOR"},o++}return e}const wP=i=>{const{pos:t,width:e,height:n,minRoomSize:r=6,maxRoomSize:o=12,maxRoomCount:h=30}=i,{x:l,y:c,z:f}=t,d={...np({x:l,y:c,z:f,width:e,height:n,hasWalls:!1},{sprite:"WALL"}),rooms:[]};let g={};be.exports.times(h,()=>{let v=be.exports.random(r,o),w=be.exports.random(r,o),y=be.exports.random(l,e+l-v-1),T=be.exports.random(c,n+c-w-1);const S=np({x:y,y:T,z:f,width:v,height:w,hasWalls:!0},{sprite:"FLOOR"});d.rooms.some(A=>KR(A,S))||(d.rooms.push(S),g={...g,...S.tiles})});let m=null,_={};for(let v of d.rooms)m&&(_={..._,...yP(v.center,m.center),...bP(v.center,m.center)}),m=v;return d.tiles={...d.tiles,...g,..._},d},EP=()=>{const i=wP({pos:{x:0,y:0,z:0},width:74,height:39,minRoomSize:8,maxRoomSize:18,maxRoomCount:100}),t=Object.values(i.tiles);for(const e of t)e.sprite==="WALL"&&mP(Ct().wId,e),e.sprite==="FLOOR"&&gP(Ct().wId,e);return i};var un=(i=>(i.GAME="GAME",i.GAME_OVER="GAME_OVER",i.INVENTORY="INVENTORY",i))(un||{});window.skulltooth=window.skulltooth||{};window.skulltooth.getEngine=()=>dR();window.skulltooth.debug=!1;window.skulltooth.getEntity=i=>At(i);const ue={eAP:{},fps:0,toRender:new Set,turn:"WORLD",userInput:null,views:{},wId:"",playerEId:"",z:0,gameState:"GAME",log:["Welcome to Skulltooth! Your destiny awaits and we will keep describingthat for a long time!","The skulltooth awaits","Seek it's wisdom if you dare","Use your senses to survive","Good luck..."],senses:{feel:"You feel nothing.",see:"You see nothing.",hear:"You hear nothing.",smell:"You smell nothing.",taste:"You taste nothing."},legend:[]};window.skulltooth.state=ue;const me=i=>{i(ue)},Ct=()=>ue,Pr=i=>{if(i.components.position){const t=Hn(i.components.position);ue.eAP[t]||(ue.eAP[t]=new Set),ue.eAP[t].add(i.id),ue.toRender.add(t)}return ue},Kg=i=>{if(i.components.position){const t=Hn(i.components.position);ue.eAP[t]&&ue.eAP[t].delete(i.id),ue.toRender.add(t)}return ue},TP=async()=>{await iR(document.querySelector("#canvas"));const i=cR();me(v=>{v.wId=i.id}),pR();const t=EP(),e=t.rooms[0].center,n=_P(Ct().wId,e);me(v=>{v.playerEId=n.id}),t.rooms.forEach((v,w)=>{if(w){const y=[vP,xP,op,op],T=be.exports.sample(y);if(!T)return;T(Ct().wId,v.center)}}),new yi({width:12,height:2,x:0,y:0,layers:2,tileSets:["tile","text"],tints:[16777215,16711799],alphas:[1,1],visible:!0}).updateRows([[{},{string:" skulltooth"}],[{tint:16711799},{string:"forcecrusher",tint:16777215}]]);const r=new yi({width:25,height:42,x:0,y:2,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),o=new yi({width:74,height:5,x:26,y:0,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),h=new yi({width:74,height:5,x:100,y:0,layers:1,tileSets:["text"],tints:[16711799],alphas:[1],visible:!0}),l=new yi({width:74,height:39,x:13,y:5,layers:3,tileSets:["tile","ascii","tile"],tints:[0,0,0],alphas:[1,1,0],visible:!0}),c=new yi({width:12,height:1,x:0,y:44,layers:1,tileSets:["text"],tints:[14540253],alphas:[1],visible:!0}).updateRows([[{string:"FPS: calc..."}]]);new yi({width:12,height:1,x:0,y:45,layers:1,tileSets:["text"],tints:[16777215],alphas:[1],visible:!0}).updateRows([[{string:"TAG: a5b9f79"}]]);const f=new yi({width:148,height:2,x:26,y:44,layers:1,tileSets:["text"],tints:[15658734],alphas:[1],visible:!0}),d=new yi({width:100,height:44,x:0,y:0,layers:1,tileSets:["tile"],tints:[1118481],alphas:[.75],visible:!1}),g=new yi({width:148,height:39,x:26,y:5,layers:2,tileSets:["text","text"],tints:[1118481,16777215],alphas:[1],visible:!1});me(v=>{v.views.fps=c,v.views.map=l,v.views.log=o,v.views.senses=h,v.views.legend=r,v.views.inventory=g,v.views.overlay=d,v.views.controls=f});const m=t.rooms[0].center,_=t.rooms[1].center;Yg(m,_),Go(),Wo(),Ho(),Zg(),document.addEventListener("keydown",v=>{me(w=>{w.userInput=v})}),document.addEventListener("mousedown",v=>{const w=v.x-ue.views.map.layers[0].x,y=v.layerY-ue.views.map.layers[0].y,T=ue.z,S=eR(w,y,T);ue.eAP[S]&&window.skulltooth.debug===!0&&ue.eAP[S].forEach(A=>{console.log(At(A))})})};let pl=0,Do=Date.now(),Bo=[];function Zg(){var i;requestAnimationFrame(Zg),Ct().gameState==="INVENTORY"&&Ct().userInput&&Ct().turn==="PLAYER"&&(sp(),dl(),Go(),Wo(),Ho()),Ct().gameState==="GAME"&&(Ct().userInput&&Ct().turn==="PLAYER"&&(sp(),dl(),rp(),Go(),Wo(),Ho(),me(t=>{t.turn="WORLD"})),Ct().turn==="WORLD"&&(JR(),dl(),rp(),Go(),Wo(),Ho(),me(t=>{t.turn="PLAYER"}))),Ct().gameState,Do||(Do=Date.now()),Date.now()-Do>1e3&&(Bo.unshift(pl),Bo.length>3&&Bo.pop(),isNaN(Ct().fps)||(i=Ct().views.fps)==null||i.updateRow({string:`FPS: ${Ct().fps}     `,layer:0,x:0,y:0,tileSet:"text"}),Do=Date.now(),pl=0),me(t=>t.fps=Math.round(be.exports.mean(Bo))),pl++}TP();
